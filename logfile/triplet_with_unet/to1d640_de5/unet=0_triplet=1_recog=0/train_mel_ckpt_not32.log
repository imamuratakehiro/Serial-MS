
=== Using cuda(utils.func). ===

[2023-11-07 11:16:50,465][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-07 11:16:50,470][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 5.0e-05                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 5                                                         
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 50                                                          
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 5.0e-05                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-07 11:16:50,545][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-07 11:16:50,569][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-07 11:16:53,671][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpik24ttcr
[2023-11-07 11:16:53,671][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpik24ttcr/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-07 11:16:55,850][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-07 11:16:55,850][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-07 11:16:55,860][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-07 11:16:55,861][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-07 11:16:55,862][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-07 11:16:55,862][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-07 11:16:55,918][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-07 11:16:56,231][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-07 11:16:56,562][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.550365686416626 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:08<00:00,  0.24it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  4.93it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:01<00:00,  1.57it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  4.73it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  5.86it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  2.19it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.209639, 0.206759, 0.204857, 0.218436
Valid average loss UNet                 (all)                : 0.839690

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.185877, 0.032605, 0.046728
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.199982, 0.001002, 0.001020
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.200104, 0.001145, 0.001040
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199967, 0.000962, 0.000995
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.200059, 0.001012, 0.000954
Valid average loss all      (Triplet)                 : 0.197383

== Recognize ==
Valid average loss Recognize     : 2.354070
Valid average accuracy drums     : 44.531250 %
Valid average accuracy bass      : 53.125000 %
Valid average accuracy piano     : 46.875000 %
Valid average accuracy guitar    : 51.562500 %
Valid average accuracy residuals : 56.250000 %

== Valid average loss all : 0.197383

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.5522797107696533 sec. =
Valid knn accuracy drums     : 83.59375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.1920676231384277 sec. =
Valid knn accuracy bass      : 21.875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.3268959522247314 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.0754027366638184 sec. =
Valid knn accuracy guitar    : 39.84375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.3397738933563232 sec. =
Valid knn accuracy residuals : 93.75%

Valid knn accuracy average   : 56.71874999999999%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s]Epoch 0:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.070]Epoch 0:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.070]Epoch 0:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.884]Epoch 0:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.884]Epoch 0:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.880, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.816]Epoch 0:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.880, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.816]Epoch 0:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.852]Epoch 0:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.852]Epoch 0:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.826]Epoch 0:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.826]Epoch 0:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.885]Epoch 0: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.885]Epoch 0: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.754]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198522, 0.198400, 0.200327, 0.226993
Valid average loss UNet                 (all)                : 0.824242

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044927, 0.445130, 0.836651
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.174988, 0.172866, 0.210648
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.225775, 0.253538, 0.233984
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.168432, 0.211514, 0.259149
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.119036, 0.272574, 0.400992
Valid average loss all      (Triplet)                 : 0.150598

== Recognize ==
Valid average loss Recognize     : 0.765340
Valid average accuracy drums     : 64.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 39.500000 %

== Valid average loss all : 0.150598

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.631081581115723 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5560832023620605 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.655860424041748 sec. =
Valid knn accuracy piano     : 28.3203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.482800245285034 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.474370956420898 sec. =
Valid knn accuracy residuals : 50.90909090909091%

Valid knn accuracy average   : 44.92929332457514%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [05:23<00:00,  0.97it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.754, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449]Epoch 0: 100%|██████████| 313/313 [05:23<00:00,  0.97it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.754, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203562, 0.204304, 0.204055, 0.221455
Train average loss UNet                 (all)                : 0.833377

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.036575, 0.457382, 0.889650
Train average loss bass     (Triplet, dist_p, dist_n) : 0.197300, 0.181130, 0.192745
Train average loss piano    (Triplet, dist_p, dist_n) : 0.198068, 0.179934, 0.186988
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.179148, 0.196136, 0.233452
Train average loss residuals(Triplet, dist_p, dist_n) : 0.152309, 0.243562, 0.323145
Train average loss all      (Triplet)                 : 0.154468

== Recognize ==
Train average loss Recognize     : 0.896485
Train average accuracy drums     : 50.884998 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 50.115002 %
Train average accuracy guitar    : 49.634998 %
Train average accuracy residuals : 50.029999 %

== Train average loss all : 0.154468

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.754, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.754, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  16%|█▌        | 50/313 [00:43<03:46,  1.16it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.754, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  16%|█▌        | 50/313 [00:43<03:46,  1.16it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.817, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  32%|███▏      | 100/313 [01:19<02:49,  1.25it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.817, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  32%|███▏      | 100/313 [01:19<02:49,  1.25it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.802, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  48%|████▊     | 150/313 [01:56<02:06,  1.29it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.802, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  48%|████▊     | 150/313 [01:56<02:06,  1.29it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.748, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  64%|██████▍   | 200/313 [02:34<01:27,  1.30it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.748, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  64%|██████▍   | 200/313 [02:34<01:27,  1.30it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.849, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  80%|███████▉  | 250/313 [03:09<00:47,  1.32it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.849, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  80%|███████▉  | 250/313 [03:09<00:47,  1.32it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.837, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  96%|█████████▌| 300/313 [03:47<00:09,  1.32it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.837, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1:  96%|█████████▌| 300/313 [03:47<00:09,  1.32it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.756, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1: 100%|██████████| 313/313 [03:54<00:00,  1.33it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.756, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1: 100%|██████████| 313/313 [03:54<00:00,  1.33it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.726, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.804, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.449, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.09it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197526, 0.197796, 0.199386, 0.230051
Valid average loss UNet                 (all)                : 0.824759

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039912, 0.533209, 0.903455
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.198382, 0.217540, 0.248612
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.229273, 0.333337, 0.320605
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.160436, 0.302927, 0.378345
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.148694, 0.353143, 0.452647
Valid average loss all      (Triplet)                 : 0.154764

== Recognize ==
Valid average loss Recognize     : 0.726638
Valid average accuracy drums     : 64.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 41.000000 %

== Valid average loss all : 0.154764

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.634842395782471 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.340923309326172 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.702282428741455 sec. =
Valid knn accuracy piano     : 28.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.484166622161865 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.48591423034668 sec. =
Valid knn accuracy residuals : 58.18181818181818%

Valid knn accuracy average   : 47.660682410156475%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.726, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.896]Epoch 1: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.726, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203588, 0.204336, 0.204086, 0.221462
Train average loss UNet                 (all)                : 0.833471

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.023739, 0.440218, 0.937152
Train average loss bass     (Triplet, dist_p, dist_n) : 0.173314, 0.213315, 0.265200
Train average loss piano    (Triplet, dist_p, dist_n) : 0.182151, 0.212848, 0.241194
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.152854, 0.242464, 0.329242
Train average loss residuals(Triplet, dist_p, dist_n) : 0.118951, 0.323563, 0.479758
Train average loss all      (Triplet)                 : 0.131526

== Recognize ==
Train average loss Recognize     : 0.766757
Train average accuracy drums     : 55.089996 %
Train average accuracy bass      : 50.465000 %
Train average accuracy piano     : 49.325001 %
Train average accuracy guitar    : 49.810001 %
Train average accuracy residuals : 50.340004 %

== Train average loss all : 0.131526

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.726, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.726, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0965, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0965, Train/loss_recog_step=0.726, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.716, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]  Epoch 2:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.716, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.701, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.701, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  48%|████▊     | 150/313 [02:06<02:17,  1.18it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.883, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.680, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.883, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.680, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  64%|██████▍   | 200/313 [02:45<01:33,  1.21it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.774, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.774, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  80%|███████▉  | 250/313 [03:23<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.698, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  96%|█████████▌| 300/313 [04:02<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.698, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2:  96%|█████████▌| 300/313 [04:02<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.725, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.725, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2: 100%|██████████| 313/313 [04:10<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0868, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.707, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.155, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.477, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.95it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.09it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198192, 0.198457, 0.200010, 0.235631
Valid average loss UNet                 (all)                : 0.832290

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041734, 0.544846, 0.964526
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.189708, 0.234154, 0.272695
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.222082, 0.411807, 0.402916
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.197469, 0.399024, 0.433060
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.174442, 0.383315, 0.445186
Valid average loss all      (Triplet)                 : 0.161624

== Recognize ==
Valid average loss Recognize     : 0.693256
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 70.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.161624

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.704204797744751 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.182841539382935 sec. =
Valid knn accuracy bass      : 19.959677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.533366441726685 sec. =
Valid knn accuracy piano     : 31.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.8404130935668945 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.471584320068359 sec. =
Valid knn accuracy residuals : 62.04545454545455%

Valid knn accuracy average   : 50.66383695196809%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [05:12<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.0868, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.707, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=0.767]Epoch 2: 100%|██████████| 313/313 [05:12<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.0868, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.707, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203434, 0.204194, 0.203924, 0.221611
Train average loss UNet                 (all)                : 0.833163

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.017056, 0.509984, 1.056112
Train average loss bass     (Triplet, dist_p, dist_n) : 0.162142, 0.257925, 0.335953
Train average loss piano    (Triplet, dist_p, dist_n) : 0.164448, 0.283357, 0.340511
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.134858, 0.306589, 0.430956
Train average loss residuals(Triplet, dist_p, dist_n) : 0.104668, 0.381516, 0.579632
Train average loss all      (Triplet)                 : 0.118059

== Recognize ==
Train average loss Recognize     : 0.715233
Train average accuracy drums     : 66.739998 %
Train average accuracy bass      : 50.844997 %
Train average accuracy piano     : 50.410004 %
Train average accuracy guitar    : 50.185001 %
Train average accuracy residuals : 51.235001 %

== Train average loss all : 0.118059

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0868, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.707, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0868, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.707, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  16%|█▌        | 50/313 [00:43<03:49,  1.14it/s, v_num=0, Train/loss_all_step=0.0868, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.707, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  16%|█▌        | 50/313 [00:43<03:49,  1.14it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.722, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]  Epoch 3:  32%|███▏      | 100/313 [01:20<02:52,  1.24it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.722, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  32%|███▏      | 100/313 [01:20<02:52,  1.24it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.694, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  48%|████▊     | 150/313 [01:58<02:08,  1.27it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.694, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  48%|████▊     | 150/313 [01:58<02:08,  1.27it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.646, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  64%|██████▍   | 200/313 [02:36<01:28,  1.28it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.646, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  64%|██████▍   | 200/313 [02:36<01:28,  1.28it/s, v_num=0, Train/loss_all_step=0.0947, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=0.703, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  80%|███████▉  | 250/313 [03:14<00:48,  1.29it/s, v_num=0, Train/loss_all_step=0.0947, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=0.703, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  80%|███████▉  | 250/313 [03:14<00:48,  1.29it/s, v_num=0, Train/loss_all_step=0.0952, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0952, Train/loss_recog_step=0.638, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0952, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0952, Train/loss_recog_step=0.638, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.694, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]  Epoch 3: 100%|██████████| 313/313 [04:03<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.694, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3: 100%|██████████| 313/313 [04:03<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.0756, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0756, Train/loss_recog_step=0.694, Valid/loss_all_step=0.199, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=0.691, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.693, Valid/knn_avr=0.507, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.24it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.94it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198181, 0.198321, 0.199955, 0.232552
Valid average loss UNet                 (all)                : 0.829009

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040452, 0.692481, 1.266529
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.167641, 0.301409, 0.362663
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.249575, 0.552136, 0.520369
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151672, 0.477269, 0.589373
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.209529, 0.491534, 0.548172
Valid average loss all      (Triplet)                 : 0.159600

== Recognize ==
Valid average loss Recognize     : 0.680175
Valid average accuracy drums     : 58.000000 %
Valid average accuracy bass      : 58.999996 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.159600

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.834421157836914 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.287924528121948 sec. =
Valid knn accuracy bass      : 32.056451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.467407703399658 sec. =
Valid knn accuracy piano     : 36.71875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.678310871124268 sec. =
Valid knn accuracy guitar    : 56.91964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.308000802993774 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 55.74766454618312%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [05:19<00:00,  0.98it/s, v_num=0, Train/loss_all_step=0.0756, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0756, Train/loss_recog_step=0.694, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.118, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.715]Epoch 3: 100%|██████████| 313/313 [05:19<00:00,  0.98it/s, v_num=0, Train/loss_all_step=0.0756, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0756, Train/loss_recog_step=0.694, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203576, 0.204304, 0.204042, 0.221510
Train average loss UNet                 (all)                : 0.833432

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013607, 0.611824, 1.220712
Train average loss bass     (Triplet, dist_p, dist_n) : 0.149833, 0.318477, 0.419079
Train average loss piano    (Triplet, dist_p, dist_n) : 0.146503, 0.365212, 0.459361
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.116764, 0.381701, 0.548910
Train average loss residuals(Triplet, dist_p, dist_n) : 0.090083, 0.458639, 0.704581
Train average loss all      (Triplet)                 : 0.104745

== Recognize ==
Train average loss Recognize     : 0.688946
Train average accuracy drums     : 76.730003 %
Train average accuracy bass      : 52.420002 %
Train average accuracy piano     : 50.755001 %
Train average accuracy guitar    : 51.190002 %
Train average accuracy residuals : 55.400002 %

== Train average loss all : 0.104745

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0756, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0756, Train/loss_recog_step=0.694, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0756, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0756, Train/loss_recog_step=0.694, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  16%|█▌        | 50/313 [00:45<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0756, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0756, Train/loss_recog_step=0.694, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  16%|█▌        | 50/313 [00:45<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0873, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.670, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  32%|███▏      | 100/313 [01:22<02:56,  1.21it/s, v_num=0, Train/loss_all_step=0.0873, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.670, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  32%|███▏      | 100/313 [01:22<02:56,  1.21it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0979, Train/loss_recog_step=0.693, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.0979, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0979, Train/loss_recog_step=0.693, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.0755, Train/loss_recog_step=0.664, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  64%|██████▍   | 200/313 [02:36<01:28,  1.27it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.0755, Train/loss_recog_step=0.664, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  64%|██████▍   | 200/313 [02:36<01:28,  1.27it/s, v_num=0, Train/loss_all_step=0.0826, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0826, Train/loss_recog_step=0.704, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0826, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0826, Train/loss_recog_step=0.704, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0722, Train/loss_recog_step=0.676, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0722, Train/loss_recog_step=0.676, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4:  96%|█████████▌| 300/313 [03:53<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.692, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]  Epoch 4: 100%|██████████| 313/313 [04:01<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.692, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4: 100%|██████████| 313/313 [04:01<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.674, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.806, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=0.643, Valid/loss_all_epoch=0.160, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.680, Valid/knn_avr=0.557, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.05it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197882, 0.198127, 0.199644, 0.230830
Valid average loss UNet                 (all)                : 0.826484

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045388, 0.789341, 1.507636
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.179326, 0.365842, 0.427625
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.264513, 0.618488, 0.578277
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.139917, 0.602821, 0.734370
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.173584, 0.590421, 0.694915
Valid average loss all      (Triplet)                 : 0.165538

== Recognize ==
Valid average loss Recognize     : 0.690847
Valid average accuracy drums     : 77.500000 %
Valid average accuracy bass      : 62.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.165538

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.647016286849976 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.20205020904541 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8093273639678955 sec. =
Valid knn accuracy piano     : 33.984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.535616636276245 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.452566385269165 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 53.49914818263783%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.674, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=0.689]Epoch 4: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.674, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203528, 0.204278, 0.204015, 0.221502
Train average loss UNet                 (all)                : 0.833324

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010250, 0.749556, 1.447454
Train average loss bass     (Triplet, dist_p, dist_n) : 0.139578, 0.396318, 0.522831
Train average loss piano    (Triplet, dist_p, dist_n) : 0.129298, 0.442135, 0.575698
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.101523, 0.477762, 0.695389
Train average loss residuals(Triplet, dist_p, dist_n) : 0.076779, 0.538011, 0.834224
Train average loss all      (Triplet)                 : 0.092919

== Recognize ==
Train average loss Recognize     : 0.680667
Train average accuracy drums     : 63.475002 %
Train average accuracy bass      : 52.995003 %
Train average accuracy piano     : 51.689999 %
Train average accuracy guitar    : 54.459999 %
Train average accuracy residuals : 58.724998 %

== Train average loss all : 0.092919

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.674, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.674, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  16%|█▌        | 50/313 [00:42<03:43,  1.17it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.674, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  16%|█▌        | 50/313 [00:42<03:43,  1.17it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=0.649, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  32%|███▏      | 100/313 [01:20<02:52,  1.24it/s, v_num=0, Train/loss_all_step=0.0754, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=0.649, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  32%|███▏      | 100/313 [01:20<02:52,  1.24it/s, v_num=0, Train/loss_all_step=0.0769, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=0.677, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.0769, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=0.677, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0651, Train/loss_recog_step=0.657, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  64%|██████▍   | 200/313 [02:37<01:28,  1.27it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0651, Train/loss_recog_step=0.657, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  64%|██████▍   | 200/313 [02:37<01:29,  1.27it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=0.689, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.0819, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=0.689, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0704, Train/loss_recog_step=0.685, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0704, Train/loss_recog_step=0.685, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.701, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]  Epoch 5: 100%|██████████| 313/313 [04:04<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.701, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5: 100%|██████████| 313/313 [04:04<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=0.712, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.678, Valid/loss_all_epoch=0.166, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.691, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198120, 0.198462, 0.199966, 0.228824
Valid average loss UNet                 (all)                : 0.825372

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067786, 0.931514, 1.640507
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.210635, 0.492405, 0.552166
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.316120, 0.785545, 0.721284
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155821, 0.690892, 0.802888
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.162847, 0.696323, 0.834902
Valid average loss all      (Triplet)                 : 0.190190

== Recognize ==
Valid average loss Recognize     : 0.685878
Valid average accuracy drums     : 63.000000 %
Valid average accuracy bass      : 61.000000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 58.999996 %
Valid average accuracy residuals : 42.500000 %

== Valid average loss all : 0.190190

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.649972677230835 sec. =
Valid knn accuracy drums     : 90.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.450314521789551 sec. =
Valid knn accuracy bass      : 22.379032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.625272750854492 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.502759218215942 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.5164642333984375 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 53.87597761197428%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=0.712, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0929, Train/loss_unet_all_epoch=0.833, Train/loss_triplet_all_epoch=0.0929, Train/loss_recog_epoch=0.681]Epoch 5: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=0.712, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203740, 0.204478, 0.204222, 0.221080
Train average loss UNet                 (all)                : 0.833520

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008003, 0.893676, 1.705560
Train average loss bass     (Triplet, dist_p, dist_n) : 0.126599, 0.484138, 0.645080
Train average loss piano    (Triplet, dist_p, dist_n) : 0.114027, 0.534887, 0.712649
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.084940, 0.575627, 0.852484
Train average loss residuals(Triplet, dist_p, dist_n) : 0.061754, 0.645343, 1.009003
Train average loss all      (Triplet)                 : 0.080498

== Recognize ==
Train average loss Recognize     : 0.678657
Train average accuracy drums     : 57.720001 %
Train average accuracy bass      : 56.424999 %
Train average accuracy piano     : 53.520000 %
Train average accuracy guitar    : 56.965000 %
Train average accuracy residuals : 58.299999 %

== Train average loss all : 0.080498

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=0.712, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=0.712, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.0388, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0388, Train/loss_recog_step=0.712, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0616, Train/loss_recog_step=0.671, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0616, Train/loss_recog_step=0.671, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  32%|███▏      | 100/313 [01:24<02:59,  1.19it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0636, Train/loss_recog_step=0.675, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0636, Train/loss_recog_step=0.675, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0486, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0486, Train/loss_recog_step=0.667, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  64%|██████▍   | 200/313 [02:38<01:29,  1.27it/s, v_num=0, Train/loss_all_step=0.0486, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0486, Train/loss_recog_step=0.667, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  64%|██████▍   | 200/313 [02:38<01:29,  1.27it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0566, Train/loss_recog_step=0.691, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0566, Train/loss_recog_step=0.691, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0457, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0457, Train/loss_recog_step=0.652, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  96%|█████████▌| 300/313 [03:54<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0457, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0457, Train/loss_recog_step=0.652, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6:  96%|█████████▌| 300/313 [03:54<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.704, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]  Epoch 6: 100%|██████████| 313/313 [04:01<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.704, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6: 100%|██████████| 313/313 [04:01<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.674, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=0.686, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.686, Valid/knn_avr=0.539, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.73it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.89it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198901, 0.199140, 0.200793, 0.230564
Valid average loss UNet                 (all)                : 0.829398

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067743, 1.042899, 1.830668
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.232138, 0.574725, 0.632130
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.340167, 0.875779, 0.804075
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.144200, 0.818579, 1.002841
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.189174, 0.811141, 0.904402
Valid average loss all      (Triplet)                 : 0.199532

== Recognize ==
Valid average loss Recognize     : 0.682642
Valid average accuracy drums     : 70.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 58.499996 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.199532

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.594066619873047 sec. =
Valid knn accuracy drums     : 89.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.236026287078857 sec. =
Valid knn accuracy bass      : 19.758064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.411893129348755 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.7790281772613525 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.462226152420044 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 53.112675685552176%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.674, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0805, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0805, Train/loss_recog_epoch=0.679]Epoch 6: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.674, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203794, 0.204520, 0.204278, 0.222164
Train average loss UNet                 (all)                : 0.834757

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005914, 1.023289, 1.932307
Train average loss bass     (Triplet, dist_p, dist_n) : 0.110289, 0.577619, 0.784429
Train average loss piano    (Triplet, dist_p, dist_n) : 0.097114, 0.629377, 0.850608
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.070654, 0.686213, 1.028016
Train average loss residuals(Triplet, dist_p, dist_n) : 0.052662, 0.775060, 1.219178
Train average loss all      (Triplet)                 : 0.068649

== Recognize ==
Train average loss Recognize     : 0.676546
Train average accuracy drums     : 70.964996 %
Train average accuracy bass      : 59.934998 %
Train average accuracy piano     : 54.474998 %
Train average accuracy guitar    : 56.309998 %
Train average accuracy residuals : 57.584999 %

== Train average loss all : 0.068649

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.674, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.674, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.674, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=0.679, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  32%|███▏      | 100/313 [01:22<02:55,  1.22it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=0.679, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  32%|███▏      | 100/313 [01:22<02:55,  1.22it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=0.677, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=0.677, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  48%|████▊     | 150/313 [01:59<02:09,  1.26it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0409, Train/loss_recog_step=0.685, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  64%|██████▍   | 200/313 [02:36<01:28,  1.27it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.0409, Train/loss_recog_step=0.685, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  64%|██████▍   | 200/313 [02:36<01:28,  1.27it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=0.684, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  80%|███████▉  | 250/313 [03:19<00:50,  1.26it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=0.684, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  80%|███████▉  | 250/313 [03:19<00:50,  1.26it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=0.671, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0465, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=0.671, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.069, Train/loss_recog_step=0.673, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]  Epoch 7: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.069, Train/loss_recog_step=0.673, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7: 100%|██████████| 313/313 [04:07<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=0.682, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.190, Valid/loss_recog_step=0.664, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.683, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.25it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.82it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199114, 0.199142, 0.200981, 0.220931
Valid average loss UNet                 (all)                : 0.820168

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083619, 1.214757, 1.924757
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.203201, 0.671367, 0.796286
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.334071, 1.049385, 1.015555
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.168243, 0.930158, 1.100159
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.216952, 0.946303, 1.056276
Valid average loss all      (Triplet)                 : 0.204124

== Recognize ==
Valid average loss Recognize     : 0.710474
Valid average accuracy drums     : 63.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 39.000000 %

== Valid average loss all : 0.204124

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.613676071166992 sec. =
Valid knn accuracy drums     : 91.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.286293029785156 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.727663040161133 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.519676446914673 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.495589971542358 sec. =
Valid knn accuracy residuals : 60.22727272727273%

Valid knn accuracy average   : 53.97891915675489%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=0.682, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0686, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0686, Train/loss_recog_epoch=0.677]Epoch 7: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=0.682, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203662, 0.204432, 0.204155, 0.221938
Train average loss UNet                 (all)                : 0.834188

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006181, 1.146973, 2.153323
Train average loss bass     (Triplet, dist_p, dist_n) : 0.098931, 0.658388, 0.898839
Train average loss piano    (Triplet, dist_p, dist_n) : 0.083979, 0.730214, 1.001432
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.061295, 0.802708, 1.211716
Train average loss residuals(Triplet, dist_p, dist_n) : 0.041838, 0.874590, 1.382408
Train average loss all      (Triplet)                 : 0.059583

== Recognize ==
Train average loss Recognize     : 0.679457
Train average accuracy drums     : 67.404999 %
Train average accuracy bass      : 59.665001 %
Train average accuracy piano     : 52.780003 %
Train average accuracy guitar    : 55.379997 %
Train average accuracy residuals : 55.725002 %

== Train average loss all : 0.059583

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=0.682, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=0.682, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.0328, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0328, Train/loss_recog_step=0.682, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.0419, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0419, Train/loss_recog_step=0.680, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.0419, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0419, Train/loss_recog_step=0.680, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.0554, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0554, Train/loss_recog_step=0.689, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  48%|████▊     | 150/313 [02:02<02:13,  1.23it/s, v_num=0, Train/loss_all_step=0.0554, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0554, Train/loss_recog_step=0.689, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  48%|████▊     | 150/313 [02:02<02:13,  1.23it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=0.665, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.0499, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=0.665, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=0.690, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=0.690, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.664, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.664, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8:  96%|█████████▌| 300/313 [04:01<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0714, Train/loss_recog_step=0.680, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0714, Train/loss_recog_step=0.680, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8: 100%|██████████| 313/313 [04:09<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=0.660, Valid/loss_all_step=0.258, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=0.725, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.710, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.27it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.17it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197954, 0.198088, 0.199773, 0.209246
Valid average loss UNet                 (all)                : 0.805061

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080764, 1.354402, 2.067387
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.231581, 0.806504, 0.928034
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.297117, 1.120582, 1.112979
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.198102, 1.145642, 1.329839
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.253125, 1.229640, 1.315367
Valid average loss all      (Triplet)                 : 0.200061

== Recognize ==
Valid average loss Recognize     : 0.730133
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 43.500000 %

== Valid average loss all : 0.200061

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6090168952941895 sec. =
Valid knn accuracy drums     : 90.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3108508586883545 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.472396373748779 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.756645679473877 sec. =
Valid knn accuracy guitar    : 43.973214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.456284999847412 sec. =
Valid knn accuracy residuals : 62.04545454545455%

Valid knn accuracy average   : 52.66141697100235%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [05:22<00:00,  0.97it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=0.660, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0596, Train/loss_recog_epoch=0.679]Epoch 8: 100%|██████████| 313/313 [05:22<00:00,  0.97it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=0.660, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203556, 0.204308, 0.204067, 0.221962
Train average loss UNet                 (all)                : 0.833894

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005163, 1.267843, 2.354099
Train average loss bass     (Triplet, dist_p, dist_n) : 0.081591, 0.755850, 1.051723
Train average loss piano    (Triplet, dist_p, dist_n) : 0.068190, 0.840979, 1.175786
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.055114, 0.929224, 1.391599
Train average loss residuals(Triplet, dist_p, dist_n) : 0.036693, 1.001009, 1.583805
Train average loss all      (Triplet)                 : 0.050027

== Recognize ==
Train average loss Recognize     : 0.684559
Train average accuracy drums     : 58.974998 %
Train average accuracy bass      : 56.250000 %
Train average accuracy piano     : 51.794998 %
Train average accuracy guitar    : 53.055000 %
Train average accuracy residuals : 54.820000 %

== Train average loss all : 0.050027

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=0.660, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=0.660, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.046, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=0.660, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.0426, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0426, Train/loss_recog_step=0.678, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0426, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0426, Train/loss_recog_step=0.678, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0793, Train/loss_recog_step=0.699, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0793, Train/loss_recog_step=0.699, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=0.681, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=0.681, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  64%|██████▍   | 200/313 [02:44<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0479, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.700, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  80%|███████▉  | 250/313 [03:22<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0479, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.700, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  80%|███████▉  | 250/313 [03:22<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0526, Train/loss_recog_step=0.701, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0526, Train/loss_recog_step=0.701, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=0.734, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.0618, Train/loss_recog_step=0.734, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9: 100%|██████████| 313/313 [04:11<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.693, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.730, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.750, Valid/loss_all_epoch=0.200, Valid/loss_unet_all_epoch=0.805, Valid/loss_triplet_all_epoch=0.200, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.527, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.08it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.05it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197922, 0.198234, 0.199916, 0.230540
Valid average loss UNet                 (all)                : 0.826612

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061405, 1.493351, 2.430220
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.267289, 0.947638, 1.029992
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.324508, 1.341980, 1.403185
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167759, 1.266609, 1.495588
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.346896, 1.452944, 1.471520
Valid average loss all      (Triplet)                 : 0.226341

== Recognize ==
Valid average loss Recognize     : 0.699219
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 59.500004 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.226341

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.8714447021484375 sec. =
Valid knn accuracy drums     : 90.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.321891784667969 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.487672328948975 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.641676664352417 sec. =
Valid knn accuracy guitar    : 52.67857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.707197189331055 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 54.170995149223145%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [05:14<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.693, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.050, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.685]Epoch 9: 100%|██████████| 313/313 [05:14<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.693, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203504, 0.204251, 0.204007, 0.222466
Train average loss UNet                 (all)                : 0.834228

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004934, 1.406714, 2.576437
Train average loss bass     (Triplet, dist_p, dist_n) : 0.074311, 0.864023, 1.203292
Train average loss piano    (Triplet, dist_p, dist_n) : 0.057080, 0.960199, 1.362392
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.041300, 1.044129, 1.583383
Train average loss residuals(Triplet, dist_p, dist_n) : 0.030282, 1.138221, 1.791838
Train average loss all      (Triplet)                 : 0.042349

== Recognize ==
Train average loss Recognize     : 0.694887
Train average accuracy drums     : 51.505001 %
Train average accuracy bass      : 54.814999 %
Train average accuracy piano     : 51.660000 %
Train average accuracy guitar    : 51.345001 %
Train average accuracy residuals : 52.799999 %

== Train average loss all : 0.042349

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.693, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.693, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.693, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0363, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0363, Train/loss_recog_step=0.679, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  32%|███▏      | 100/313 [01:24<03:01,  1.18it/s, v_num=0, Train/loss_all_step=0.0363, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0363, Train/loss_recog_step=0.679, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  32%|███▏      | 100/313 [01:24<03:01,  1.18it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.752, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  48%|████▊     | 150/313 [02:00<02:11,  1.24it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.752, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  48%|████▊     | 150/313 [02:00<02:11,  1.24it/s, v_num=0, Train/loss_all_step=0.0447, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=0.690, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0447, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=0.690, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0331, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0331, Train/loss_recog_step=0.700, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.0331, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0331, Train/loss_recog_step=0.700, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  80%|███████▉  | 250/313 [03:21<00:50,  1.24it/s, v_num=0, Train/loss_all_step=0.00985, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.00985, Train/loss_recog_step=0.670, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.00985, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.00985, Train/loss_recog_step=0.670, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10:  96%|█████████▌| 300/313 [03:59<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.043, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.043, Train/loss_recog_step=0.740, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]    Epoch 10: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.043, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.043, Train/loss_recog_step=0.740, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.714, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=0.660, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.226, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197438, 0.197668, 0.199386, 0.231252
Valid average loss UNet                 (all)                : 0.825744

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075014, 1.601593, 2.601547
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.250033, 0.990423, 1.106874
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.365274, 1.485345, 1.454333
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.214811, 1.437016, 1.576626
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.299616, 1.446198, 1.594394
Valid average loss all      (Triplet)                 : 0.245015

== Recognize ==
Valid average loss Recognize     : 0.702361
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 58.999996 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 38.500000 %

== Valid average loss all : 0.245015

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.699898958206177 sec. =
Valid knn accuracy drums     : 90.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.599187850952148 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.463567495346069 sec. =
Valid knn accuracy piano     : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.704841375350952 sec. =
Valid knn accuracy guitar    : 47.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.495997190475464 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 55.58546406258537%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [05:17<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.714, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0423, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0423, Train/loss_recog_epoch=0.695]Epoch 10: 100%|██████████| 313/313 [05:17<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.714, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203732, 0.204477, 0.204245, 0.221538
Train average loss UNet                 (all)                : 0.833991

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003593, 1.510932, 2.756720
Train average loss bass     (Triplet, dist_p, dist_n) : 0.066278, 0.959928, 1.349086
Train average loss piano    (Triplet, dist_p, dist_n) : 0.046647, 1.073505, 1.541623
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.035053, 1.154913, 1.764142
Train average loss residuals(Triplet, dist_p, dist_n) : 0.026022, 1.246473, 1.981026
Train average loss all      (Triplet)                 : 0.036175

== Recognize ==
Train average loss Recognize     : 0.699621
Train average accuracy drums     : 50.285000 %
Train average accuracy bass      : 54.500000 %
Train average accuracy piano     : 52.070000 %
Train average accuracy guitar    : 52.280003 %
Train average accuracy residuals : 52.014999 %

== Train average loss all : 0.036175

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.714, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.714, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.714, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.0303, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0303, Train/loss_recog_step=0.694, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.0303, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.0303, Train/loss_recog_step=0.694, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0642, Train/loss_recog_step=0.719, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0642, Train/loss_recog_step=0.719, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.892, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.702, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.892, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.702, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  64%|██████▍   | 200/313 [02:41<01:31,  1.24it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.686, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.686, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0354, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0354, Train/loss_recog_step=0.679, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0354, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.0354, Train/loss_recog_step=0.679, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11:  96%|█████████▌| 300/313 [04:02<00:10,  1.24it/s, v_num=0, Train/loss_all_step=0.0475, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0475, Train/loss_recog_step=0.718, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0475, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0475, Train/loss_recog_step=0.718, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11: 100%|██████████| 313/313 [04:11<00:00,  1.25it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.708, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=0.659, Valid/loss_all_epoch=0.245, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.245, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.556, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.86it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197402, 0.197739, 0.199358, 0.233503
Valid average loss UNet                 (all)                : 0.828002

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091864, 1.798682, 3.050550
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.263511, 1.144917, 1.205845
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.270041, 1.572761, 1.695361
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.201249, 1.573499, 1.778432
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.192699, 1.545989, 1.808936
Valid average loss all      (Triplet)                 : 0.215173

== Recognize ==
Valid average loss Recognize     : 0.707223
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 39.000000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.215173

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.641418218612671 sec. =
Valid knn accuracy drums     : 89.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.372958660125732 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.753483295440674 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.635916709899902 sec. =
Valid knn accuracy guitar    : 58.03571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.491391658782959 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 57.262173617056156%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [05:13<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.708, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0362, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0362, Train/loss_recog_epoch=0.700]Epoch 11: 100%|██████████| 313/313 [05:13<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.708, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203735, 0.204515, 0.204263, 0.222190
Train average loss UNet                 (all)                : 0.834702

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003152, 1.665814, 3.099674
Train average loss bass     (Triplet, dist_p, dist_n) : 0.053552, 1.065264, 1.520692
Train average loss piano    (Triplet, dist_p, dist_n) : 0.040612, 1.206034, 1.736470
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.030170, 1.297032, 1.987809
Train average loss residuals(Triplet, dist_p, dist_n) : 0.021157, 1.392449, 2.221805
Train average loss all      (Triplet)                 : 0.030084

== Recognize ==
Train average loss Recognize     : 0.714401
Train average accuracy drums     : 50.384998 %
Train average accuracy bass      : 53.014999 %
Train average accuracy piano     : 51.279999 %
Train average accuracy guitar    : 50.309998 %
Train average accuracy residuals : 52.474998 %

== Train average loss all : 0.030084

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.708, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.708, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.708, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=0.719, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=0.719, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.747, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0321, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.747, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.707, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.707, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  64%|██████▍   | 200/313 [02:38<01:29,  1.26it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.667, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.667, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0417, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0417, Train/loss_recog_step=0.703, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0417, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0417, Train/loss_recog_step=0.703, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.760, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]  Epoch 12: 100%|██████████| 313/313 [04:05<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.760, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12: 100%|██████████| 313/313 [04:05<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.703, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.707, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.10it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.64it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198141, 0.198424, 0.200113, 0.231789
Valid average loss UNet                 (all)                : 0.828468

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053016, 1.850907, 3.166204
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.288303, 1.188247, 1.250652
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331424, 1.584000, 1.665671
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210983, 1.666724, 1.838195
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269152, 1.626631, 1.832026
Valid average loss all      (Triplet)                 : 0.236721

== Recognize ==
Valid average loss Recognize     : 0.719906
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.236721

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.750442266464233 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.308334112167358 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.343634366989136 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.802650451660156 sec. =
Valid knn accuracy guitar    : 45.089285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.528386116027832 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 53.63695418799293%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.703, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0301, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0301, Train/loss_recog_epoch=0.714]Epoch 12: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.703, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203727, 0.204489, 0.204228, 0.222506
Train average loss UNet                 (all)                : 0.834949

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002579, 1.737000, 3.275418
Train average loss bass     (Triplet, dist_p, dist_n) : 0.045038, 1.152687, 1.664541
Train average loss piano    (Triplet, dist_p, dist_n) : 0.038947, 1.283060, 1.859706
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.025807, 1.358982, 2.102233
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018235, 1.464111, 2.345202
Train average loss all      (Triplet)                 : 0.026503

== Recognize ==
Train average loss Recognize     : 0.717908
Train average accuracy drums     : 50.120003 %
Train average accuracy bass      : 51.650002 %
Train average accuracy piano     : 50.645000 %
Train average accuracy guitar    : 51.099998 %
Train average accuracy residuals : 51.735001 %

== Train average loss all : 0.026503

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.703, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.703, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=0.703, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.0356, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0356, Train/loss_recog_step=0.718, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0356, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0356, Train/loss_recog_step=0.718, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.748, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  48%|████▊     | 150/313 [02:01<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.748, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  48%|████▊     | 150/313 [02:02<02:12,  1.23it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.903, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.694, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  64%|██████▍   | 200/313 [02:39<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.903, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.694, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  64%|██████▍   | 200/313 [02:39<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.755, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.755, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=0.716, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  96%|█████████▌| 300/313 [03:54<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=0.716, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13:  96%|█████████▌| 300/313 [03:54<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0404, Train/loss_recog_step=0.780, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13: 100%|██████████| 313/313 [04:02<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0404, Train/loss_recog_step=0.780, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13: 100%|██████████| 313/313 [04:02<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.713, Valid/loss_all_step=0.302, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.302, Valid/loss_recog_step=0.724, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198838, 0.198979, 0.200818, 0.226086
Valid average loss UNet                 (all)                : 0.824721

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089974, 1.985663, 3.257344
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.286628, 1.310760, 1.363265
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.355981, 1.752537, 1.826749
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.256453, 1.743842, 2.001003
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326568, 1.884411, 2.101193
Valid average loss all      (Triplet)                 : 0.263217

== Recognize ==
Valid average loss Recognize     : 0.726794
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.263217

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.961043357849121 sec. =
Valid knn accuracy drums     : 90.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.267084121704102 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.460684537887573 sec. =
Valid knn accuracy piano     : 46.484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.78091287612915 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.517895698547363 sec. =
Valid knn accuracy residuals : 72.04545454545455%

Valid knn accuracy average   : 58.38250868608951%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.713, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0265, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0265, Train/loss_recog_epoch=0.718]Epoch 13: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.713, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203861, 0.204594, 0.204373, 0.222465
Train average loss UNet                 (all)                : 0.835292

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003334, 1.837983, 3.414112
Train average loss bass     (Triplet, dist_p, dist_n) : 0.037502, 1.234854, 1.804632
Train average loss piano    (Triplet, dist_p, dist_n) : 0.026896, 1.362177, 2.006632
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.022230, 1.459569, 2.255450
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016799, 1.593460, 2.555869
Train average loss all      (Triplet)                 : 0.021631

== Recognize ==
Train average loss Recognize     : 0.724975
Train average accuracy drums     : 50.255001 %
Train average accuracy bass      : 50.454998 %
Train average accuracy piano     : 50.800003 %
Train average accuracy guitar    : 50.650002 %
Train average accuracy residuals : 50.795002 %

== Train average loss all : 0.021631

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.713, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.713, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.713, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.729, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]  Epoch 14:  32%|███▏      | 100/313 [01:22<02:56,  1.21it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.729, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  32%|███▏      | 100/313 [01:22<02:56,  1.21it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.730, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  48%|████▊     | 150/313 [02:00<02:11,  1.24it/s, v_num=0, Train/loss_all_step=0.0277, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.730, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  48%|████▊     | 150/313 [02:00<02:11,  1.24it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=0.723, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  64%|██████▍   | 200/313 [02:37<01:29,  1.27it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=0.723, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  64%|██████▍   | 200/313 [02:37<01:29,  1.27it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.728, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.728, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  80%|███████▉  | 250/313 [03:15<00:49,  1.28it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.693, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  96%|█████████▌| 300/313 [03:55<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.693, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14:  96%|█████████▌| 300/313 [03:55<00:10,  1.28it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.730, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14: 100%|██████████| 313/313 [04:02<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.730, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14: 100%|██████████| 313/313 [04:02<00:00,  1.29it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.791, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.727, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198323, 0.198500, 0.200282, 0.228486
Valid average loss UNet                 (all)                : 0.825590

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041154, 2.084377, 3.341300
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.317209, 1.433779, 1.501911
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.465417, 2.030998, 1.980227
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.247556, 1.755150, 2.004896
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.373251, 1.914528, 2.079294
Valid average loss all      (Triplet)                 : 0.281179

== Recognize ==
Valid average loss Recognize     : 0.741748
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.281179

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.258042573928833 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.194617986679077 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.487278461456299 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.722015142440796 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.488882303237915 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 55.20700712987924%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.791, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0216, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0216, Train/loss_recog_epoch=0.725]Epoch 14: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.791, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203806, 0.204586, 0.204328, 0.221592
Train average loss UNet                 (all)                : 0.834312

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002204, 1.903401, 3.552505
Train average loss bass     (Triplet, dist_p, dist_n) : 0.033654, 1.317520, 1.939337
Train average loss piano    (Triplet, dist_p, dist_n) : 0.025435, 1.474429, 2.171969
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.021113, 1.548451, 2.421076
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014478, 1.669456, 2.697346
Train average loss all      (Triplet)                 : 0.019739

== Recognize ==
Train average loss Recognize     : 0.731364
Train average accuracy drums     : 50.190002 %
Train average accuracy bass      : 50.285000 %
Train average accuracy piano     : 50.449997 %
Train average accuracy guitar    : 50.000000 %
Train average accuracy residuals : 50.575001 %

== Train average loss all : 0.019739

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.791, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.791, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=0.791, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00959, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=0.719, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00959, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00959, Train/loss_recog_step=0.719, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.00437, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=0.756, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.00437, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=0.756, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.00735, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.699, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.00735, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.699, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00914, Train/loss_recog_step=0.726, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  80%|███████▉  | 250/313 [03:17<00:49,  1.26it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00914, Train/loss_recog_step=0.726, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  80%|███████▉  | 250/313 [03:17<00:49,  1.26it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=0.733, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]  Epoch 15:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=0.733, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.773, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15: 100%|██████████| 313/313 [04:04<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.773, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15: 100%|██████████| 313/313 [04:04<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=0.692, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.281, Valid/loss_recog_epoch=0.742, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198994, 0.199146, 0.200922, 0.228021
Valid average loss UNet                 (all)                : 0.827083

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077074, 2.314212, 3.747534
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.329168, 1.617150, 1.687508
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.374302, 2.174705, 2.325727
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274101, 2.126021, 2.505454
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.397093, 2.247520, 2.421981
Valid average loss all      (Triplet)                 : 0.275533

== Recognize ==
Valid average loss Recognize     : 0.711884
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.275533

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.864200115203857 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.268207550048828 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.410587310791016 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.779412269592285 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.5087058544158936 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 55.956593601437135%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=0.692, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=0.731]Epoch 15: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=0.692, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203833, 0.204594, 0.204360, 0.222879
Train average loss UNet                 (all)                : 0.835666

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002441, 1.985577, 3.645399
Train average loss bass     (Triplet, dist_p, dist_n) : 0.024290, 1.417449, 2.131944
Train average loss piano    (Triplet, dist_p, dist_n) : 0.023225, 1.551086, 2.307515
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018397, 1.676429, 2.636331
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009919, 1.763115, 2.860976
Train average loss all      (Triplet)                 : 0.015861

== Recognize ==
Train average loss Recognize     : 0.736999
Train average accuracy drums     : 50.105000 %
Train average accuracy bass      : 49.994999 %
Train average accuracy piano     : 50.809998 %
Train average accuracy guitar    : 50.855000 %
Train average accuracy residuals : 50.445004 %

== Train average loss all : 0.015861

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=0.692, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=0.692, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=0.692, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  16%|█▌        | 50/313 [00:45<03:58,  1.10it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.733, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0127, Train/loss_recog_step=0.733, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  32%|███▏      | 100/313 [01:21<02:53,  1.23it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.730, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  48%|████▊     | 150/313 [01:57<02:08,  1.27it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.730, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  48%|████▊     | 150/313 [01:57<02:08,  1.27it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.740, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  64%|██████▍   | 200/313 [02:33<01:26,  1.30it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.740, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  64%|██████▍   | 200/313 [02:33<01:26,  1.30it/s, v_num=0, Train/loss_all_step=0.00842, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00842, Train/loss_recog_step=0.714, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  80%|███████▉  | 250/313 [03:11<00:48,  1.30it/s, v_num=0, Train/loss_all_step=0.00842, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00842, Train/loss_recog_step=0.714, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  80%|███████▉  | 250/313 [03:11<00:48,  1.30it/s, v_num=0, Train/loss_all_step=0.00784, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00784, Train/loss_recog_step=0.745, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  96%|█████████▌| 300/313 [03:48<00:09,  1.31it/s, v_num=0, Train/loss_all_step=0.00784, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00784, Train/loss_recog_step=0.745, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16:  96%|█████████▌| 300/313 [03:48<00:09,  1.31it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.750, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]  Epoch 16: 100%|██████████| 313/313 [03:55<00:00,  1.33it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.750, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16: 100%|██████████| 313/313 [03:55<00:00,  1.33it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.745, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.589, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.712, Valid/knn_avr=0.560, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199056, 0.199182, 0.200923, 0.225663
Valid average loss UNet                 (all)                : 0.824824

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062276, 2.108951, 3.564055
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.377601, 1.604880, 1.637168
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.447154, 2.144177, 2.129019
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187888, 2.007681, 2.346295
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.492793, 2.191819, 2.208174
Valid average loss all      (Triplet)                 : 0.274203

== Recognize ==
Valid average loss Recognize     : 0.787522
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.274203

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.833081960678101 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.230115175247192 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3736677169799805 sec. =
Valid knn accuracy piano     : 47.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.564450979232788 sec. =
Valid knn accuracy guitar    : 59.82142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.744796991348267 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 58.099928166153624%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.745, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0159, Train/loss_recog_epoch=0.737]Epoch 16: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.745, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203891, 0.204670, 0.204412, 0.222501
Train average loss UNet                 (all)                : 0.835474

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003253, 2.052725, 3.798513
Train average loss bass     (Triplet, dist_p, dist_n) : 0.028773, 1.475351, 2.178031
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019855, 1.589317, 2.384180
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.016669, 1.717339, 2.711557
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014500, 1.824785, 2.946723
Train average loss all      (Triplet)                 : 0.017056

== Recognize ==
Train average loss Recognize     : 0.741743
Train average accuracy drums     : 50.720001 %
Train average accuracy bass      : 50.239998 %
Train average accuracy piano     : 49.875000 %
Train average accuracy guitar    : 49.904999 %
Train average accuracy residuals : 49.959999 %

== Train average loss all : 0.017056

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.745, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.745, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.745, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.677, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.677, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00263, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=0.793, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00263, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=0.793, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.0234, Train/loss_recog_step=0.757, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]  Epoch 17:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.0234, Train/loss_recog_step=0.757, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.713, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]  Epoch 17:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.713, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  80%|███████▉  | 250/313 [03:19<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.0339, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.709, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0339, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=0.709, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17:  96%|█████████▌| 300/313 [04:00<00:10,  1.25it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.777, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]  Epoch 17: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.777, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17: 100%|██████████| 313/313 [04:08<00:00,  1.26it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.838, Valid/loss_all_epoch=0.274, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.274, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.581, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.26it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199152, 0.199330, 0.201065, 0.224135
Valid average loss UNet                 (all)                : 0.823681

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062383, 2.368393, 3.907840
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.337690, 1.709019, 1.833155
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.385301, 2.183919, 2.303577
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.237190, 2.092064, 2.397057
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.368750, 2.237400, 2.495846
Valid average loss all      (Triplet)                 : 0.276481

== Recognize ==
Valid average loss Recognize     : 0.780419
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 58.999996 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.276481

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.638219356536865 sec. =
Valid knn accuracy drums     : 89.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.537754774093628 sec. =
Valid knn accuracy bass      : 24.596774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4495790004730225 sec. =
Valid knn accuracy piano     : 45.1171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.605312347412109 sec. =
Valid knn accuracy guitar    : 58.70535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.480344533920288 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 57.60085981471194%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0171, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0171, Train/loss_recog_epoch=0.742]Epoch 17: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203793, 0.204552, 0.204301, 0.222615
Train average loss UNet                 (all)                : 0.835261

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001353, 2.117267, 3.964806
Train average loss bass     (Triplet, dist_p, dist_n) : 0.020534, 1.520986, 2.306977
Train average loss piano    (Triplet, dist_p, dist_n) : 0.017097, 1.651071, 2.500501
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013275, 1.783646, 2.838180
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010803, 1.881281, 3.051341
Train average loss all      (Triplet)                 : 0.012754

== Recognize ==
Train average loss Recognize     : 0.744779
Train average accuracy drums     : 50.099998 %
Train average accuracy bass      : 50.035000 %
Train average accuracy piano     : 49.935001 %
Train average accuracy guitar    : 50.000000 %
Train average accuracy residuals : 50.290001 %

== Train average loss all : 0.012754

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  16%|█▌        | 50/313 [00:45<03:59,  1.10it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=0.729, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.0227, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=0.729, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  32%|███▏      | 100/313 [01:23<02:57,  1.20it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.745, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]  Epoch 18:  48%|████▊     | 150/313 [01:59<02:10,  1.25it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.745, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  48%|████▊     | 150/313 [01:59<02:10,  1.25it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.880, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.787, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  64%|██████▍   | 200/313 [02:36<01:28,  1.28it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.880, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.787, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  64%|██████▍   | 200/313 [02:36<01:28,  1.28it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=0.769, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  80%|███████▉  | 250/313 [03:13<00:48,  1.29it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=0.769, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  80%|███████▉  | 250/313 [03:13<00:48,  1.29it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.729, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]  Epoch 18:  96%|█████████▌| 300/313 [03:52<00:10,  1.29it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.729, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18:  96%|█████████▌| 300/313 [03:52<00:10,  1.29it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00964, Train/loss_recog_step=0.792, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18: 100%|██████████| 313/313 [04:00<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00964, Train/loss_recog_step=0.792, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18: 100%|██████████| 313/313 [04:00<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.828, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=0.792, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198288, 0.198529, 0.200144, 0.212033
Valid average loss UNet                 (all)                : 0.808994

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047642, 2.258372, 3.826552
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.303411, 1.751556, 1.885485
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.510260, 2.473565, 2.388364
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.265507, 2.241447, 2.589428
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.324301, 2.359050, 2.637226
Valid average loss all      (Triplet)                 : 0.301002

== Recognize ==
Valid average loss Recognize     : 0.770644
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.301002

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.588744878768921 sec. =
Valid knn accuracy drums     : 90.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.378744125366211 sec. =
Valid knn accuracy bass      : 21.975806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8690268993377686 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.522390842437744 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.429152488708496 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 54.71116831319102%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.828, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0128, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=0.745]Epoch 18: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.828, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203795, 0.204557, 0.204322, 0.222411
Train average loss UNet                 (all)                : 0.835084

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001788, 2.186856, 4.076849
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019172, 1.604565, 2.448473
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015205, 1.741991, 2.642894
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011472, 1.851442, 2.962483
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010652, 2.007426, 3.298473
Train average loss all      (Triplet)                 : 0.011755

== Recognize ==
Train average loss Recognize     : 0.752482
Train average accuracy drums     : 49.559998 %
Train average accuracy bass      : 49.739998 %
Train average accuracy piano     : 50.125004 %
Train average accuracy guitar    : 49.974998 %
Train average accuracy residuals : 50.870003 %

== Train average loss all : 0.011755

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.828, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.828, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.828, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=0.725, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=0.725, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  32%|███▏      | 100/313 [01:25<03:01,  1.17it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.777, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.777, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.753, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.753, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.00952, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00952, Train/loss_recog_step=0.762, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  80%|███████▉  | 250/313 [03:18<00:50,  1.26it/s, v_num=0, Train/loss_all_step=0.00952, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00952, Train/loss_recog_step=0.762, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  80%|███████▉  | 250/313 [03:18<00:50,  1.26it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.00501, Train/loss_recog_step=0.705, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.00501, Train/loss_recog_step=0.705, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=0.772, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]  Epoch 19: 100%|██████████| 313/313 [04:05<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.0265, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=0.772, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19: 100%|██████████| 313/313 [04:05<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.00727, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.747, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.708, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.856, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.809, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.547, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198287, 0.198569, 0.200071, 0.214089
Valid average loss UNet                 (all)                : 0.811015

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075842, 2.333560, 4.021859
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.391041, 1.881725, 1.956594
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.518997, 2.626714, 2.576076
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.215321, 2.295935, 2.744462
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.321200, 2.293851, 2.597758
Valid average loss all      (Triplet)                 : 0.317398

== Recognize ==
Valid average loss Recognize     : 0.771746
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.317398

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.646373510360718 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.239196538925171 sec. =
Valid knn accuracy bass      : 24.596774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.732879877090454 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.9013261795043945 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6662304401397705 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 55.84678813910493%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.00727, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=0.752]Epoch 19: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.00727, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203878, 0.204630, 0.204390, 0.222469
Train average loss UNet                 (all)                : 0.835368

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001983, 2.177198, 4.026897
Train average loss bass     (Triplet, dist_p, dist_n) : 0.021093, 1.623063, 2.482050
Train average loss piano    (Triplet, dist_p, dist_n) : 0.016044, 1.778691, 2.703680
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010485, 1.858436, 2.974359
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009652, 1.988986, 3.277560
Train average loss all      (Triplet)                 : 0.011981

== Recognize ==
Train average loss Recognize     : 0.757136
Train average accuracy drums     : 49.619999 %
Train average accuracy bass      : 50.370003 %
Train average accuracy piano     : 49.915001 %
Train average accuracy guitar    : 49.555000 %
Train average accuracy residuals : 50.349998 %

== Train average loss all : 0.011981

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00727, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00727, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.00727, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]  Epoch 20:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  32%|███▏      | 100/313 [01:26<03:03,  1.16it/s, v_num=0, Train/loss_all_step=0.0235, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.793, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0235, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=0.793, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  48%|████▊     | 150/313 [02:03<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.747, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.00716, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00716, Train/loss_recog_step=0.825, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  80%|███████▉  | 250/313 [03:18<00:49,  1.26it/s, v_num=0, Train/loss_all_step=0.00716, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00716, Train/loss_recog_step=0.825, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  80%|███████▉  | 250/313 [03:18<00:49,  1.26it/s, v_num=0, Train/loss_all_step=0.00996, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=0.758, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.00996, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=0.758, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.750, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]    Epoch 20: 100%|██████████| 313/313 [04:03<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.750, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20: 100%|██████████| 313/313 [04:03<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.812, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=0.775, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.558, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198368, 0.198699, 0.200211, 0.223129
Valid average loss UNet                 (all)                : 0.820407

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057106, 2.275822, 3.923146
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.369419, 1.780300, 1.938146
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.417627, 2.308759, 2.440256
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.148394, 2.245355, 2.851271
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.351652, 2.480631, 2.677483
Valid average loss all      (Triplet)                 : 0.252813

== Recognize ==
Valid average loss Recognize     : 0.739405
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.252813

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.847046852111816 sec. =
Valid knn accuracy drums     : 91.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.267667770385742 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.485929250717163 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.77148962020874 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.47288703918457 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 55.701587431239865%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.812, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=0.757]Epoch 20: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.812, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203867, 0.204628, 0.204358, 0.221022
Train average loss UNet                 (all)                : 0.833875

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001935, 2.229711, 4.178186
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017106, 1.663264, 2.568833
Train average loss piano    (Triplet, dist_p, dist_n) : 0.016759, 1.836618, 2.809153
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010050, 1.929442, 3.132096
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010596, 2.046183, 3.344018
Train average loss all      (Triplet)                 : 0.011457

== Recognize ==
Train average loss Recognize     : 0.761641
Train average accuracy drums     : 49.544998 %
Train average accuracy bass      : 49.480000 %
Train average accuracy piano     : 50.430000 %
Train average accuracy guitar    : 50.035000 %
Train average accuracy residuals : 49.974998 %

== Train average loss all : 0.011457

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.812, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.812, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.812, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.726, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.726, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.000681, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.000681, Train/loss_recog_step=0.753, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.000681, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.000681, Train/loss_recog_step=0.753, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  48%|████▊     | 150/313 [02:05<02:16,  1.20it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.755, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]  Epoch 21:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.881, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.755, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00446, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=0.779, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.00446, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=0.779, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  80%|███████▉  | 250/313 [03:22<00:51,  1.23it/s, v_num=0, Train/loss_all_step=0.000378, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000378, Train/loss_recog_step=0.759, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.000378, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000378, Train/loss_recog_step=0.759, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21:  96%|█████████▌| 300/313 [04:03<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.762, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]    Epoch 21: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.762, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.738, Valid/loss_all_epoch=0.253, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=0.739, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.54it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197969, 0.198202, 0.199839, 0.224419
Valid average loss UNet                 (all)                : 0.820429

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071542, 2.340988, 4.103164
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.323114, 1.833147, 1.993325
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.425543, 2.427887, 2.493959
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.255278, 2.345390, 2.787025
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.533753, 2.617279, 2.686287
Valid average loss all      (Triplet)                 : 0.315852

== Recognize ==
Valid average loss Recognize     : 0.778572
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.315852

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.606753826141357 sec. =
Valid knn accuracy drums     : 93.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.531600713729858 sec. =
Valid knn accuracy bass      : 22.782258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.463228225708008 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.541705131530762 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.453908205032349 sec. =
Valid knn accuracy residuals : 63.86363636363637%

Valid knn accuracy average   : 55.20893432041311%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [05:13<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=0.762]Epoch 21: 100%|██████████| 313/313 [05:13<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203917, 0.204690, 0.204415, 0.222569
Train average loss UNet                 (all)                : 0.835591

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001800, 2.226320, 4.107328
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015901, 1.674345, 2.588367
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015238, 1.865429, 2.852969
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012602, 1.966437, 3.165270
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007545, 2.050030, 3.398238
Train average loss all      (Triplet)                 : 0.010619

== Recognize ==
Train average loss Recognize     : 0.760163
Train average accuracy drums     : 50.155003 %
Train average accuracy bass      : 50.459999 %
Train average accuracy piano     : 50.395000 %
Train average accuracy guitar    : 50.089996 %
Train average accuracy residuals : 50.505001 %

== Train average loss all : 0.010619

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.760, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  48%|████▊     | 150/313 [02:04<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.760, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  48%|████▊     | 150/313 [02:04<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.902, Train/loss_triplet_all_step=0.0224, Train/loss_recog_step=0.741, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.902, Train/loss_triplet_all_step=0.0224, Train/loss_recog_step=0.741, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=0.767, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=0.767, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  80%|███████▉  | 250/313 [03:24<00:51,  1.22it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=0.762, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=0.762, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22:  96%|█████████▌| 300/313 [04:04<00:10,  1.23it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.768, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]    Epoch 22: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.768, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22: 100%|██████████| 313/313 [04:12<00:00,  1.24it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.732, Valid/loss_all_step=0.442, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=0.795, Valid/loss_all_epoch=0.316, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.316, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.66it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198044, 0.198393, 0.199904, 0.225797
Valid average loss UNet                 (all)                : 0.822139

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078421, 2.322726, 4.121360
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.290277, 1.800088, 1.986243
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.561502, 2.478473, 2.413968
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.205689, 2.313673, 2.837756
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.551798, 2.610716, 2.660005
Valid average loss all      (Triplet)                 : 0.329582

== Recognize ==
Valid average loss Recognize     : 0.771761
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 57.500000 %
Valid average accuracy guitar    : 41.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.329582

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6688268184661865 sec. =
Valid knn accuracy drums     : 93.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4922003746032715 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.541327714920044 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.524330139160156 sec. =
Valid knn accuracy guitar    : 63.83928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.501609563827515 sec. =
Valid knn accuracy residuals : 71.5909090909091%

Valid knn accuracy average   : 59.340783438598564%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [05:15<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.732, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=0.760]Epoch 22: 100%|██████████| 313/313 [05:15<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.732, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203939, 0.204715, 0.204447, 0.222338
Train average loss UNet                 (all)                : 0.835440

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001667, 2.295651, 4.222070
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014980, 1.792732, 2.764527
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012066, 1.917037, 2.961008
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013117, 2.042300, 3.265724
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006642, 2.173860, 3.579422
Train average loss all      (Triplet)                 : 0.009864

== Recognize ==
Train average loss Recognize     : 0.769620
Train average accuracy drums     : 50.505001 %
Train average accuracy bass      : 49.700001 %
Train average accuracy piano     : 50.169998 %
Train average accuracy guitar    : 49.730000 %
Train average accuracy residuals : 49.590000 %

== Train average loss all : 0.009864

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.732, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.732, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.008, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.732, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=0.680, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=0.680, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  32%|███▏      | 100/313 [01:25<03:02,  1.17it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.788, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.788, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.906, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.780, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]  Epoch 23:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.0032, Train/loss_unet_all_step=0.906, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.780, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  64%|██████▍   | 200/313 [02:43<01:32,  1.23it/s, v_num=0, Train/loss_all_step=0.00215, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=0.755, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.00215, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=0.755, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  80%|███████▉  | 250/313 [03:26<00:51,  1.21it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.793, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]  Epoch 23:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.793, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00631, Train/loss_recog_step=0.793, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00631, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00631, Train/loss_recog_step=0.793, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.796, Valid/loss_all_step=0.517, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.517, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.330, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.330, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198452, 0.198624, 0.200402, 0.227580
Valid average loss UNet                 (all)                : 0.825059

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067783, 2.376107, 4.198324
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.366162, 1.927814, 2.004668
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.560427, 2.483622, 2.402887
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224968, 2.383921, 2.724549
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.349035, 2.496962, 2.770854
Valid average loss all      (Triplet)                 : 0.313828

== Recognize ==
Valid average loss Recognize     : 0.771395
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 58.999996 %
Valid average accuracy piano     : 41.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.313828

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.654209136962891 sec. =
Valid knn accuracy drums     : 90.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.451586008071899 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.398051500320435 sec. =
Valid knn accuracy piano     : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6199891567230225 sec. =
Valid knn accuracy guitar    : 54.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.4531941413879395 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 57.91654182073186%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [05:19<00:00,  0.98it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.796, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00986, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=0.770]Epoch 23: 100%|██████████| 313/313 [05:19<00:00,  0.98it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.796, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203949, 0.204718, 0.204447, 0.222148
Train average loss UNet                 (all)                : 0.835263

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002893, 2.289487, 4.252568
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019879, 1.764927, 2.716010
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013954, 1.925174, 2.949546
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010119, 2.030506, 3.266207
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007940, 2.159981, 3.558335
Train average loss all      (Triplet)                 : 0.011187

== Recognize ==
Train average loss Recognize     : 0.771725
Train average accuracy drums     : 49.540001 %
Train average accuracy bass      : 50.800003 %
Train average accuracy piano     : 49.834999 %
Train average accuracy guitar    : 49.829998 %
Train average accuracy residuals : 50.244999 %

== Train average loss all : 0.011187

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.796, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.796, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.796, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0494, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0494, Train/loss_recog_step=0.753, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0494, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0494, Train/loss_recog_step=0.753, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.026, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.748, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]  Epoch 24:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.026, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.748, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  48%|████▊     | 150/313 [02:04<02:15,  1.20it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.897, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.792, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.897, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.792, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  64%|██████▍   | 200/313 [02:42<01:31,  1.23it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.765, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  80%|███████▉  | 250/313 [03:18<00:50,  1.26it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.765, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  80%|███████▉  | 250/313 [03:18<00:50,  1.26it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.798, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.798, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.0028, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.832, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]  Epoch 24: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0028, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.832, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24: 100%|██████████| 313/313 [04:06<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.916, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.642, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.579, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198490, 0.198675, 0.200437, 0.231516
Valid average loss UNet                 (all)                : 0.829118

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078496, 2.526346, 4.579065
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.318807, 1.904858, 2.096516
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.560437, 2.714537, 2.607445
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.179722, 2.423860, 2.872215
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.351687, 2.595929, 2.937041
Valid average loss all      (Triplet)                 : 0.303338

== Recognize ==
Valid average loss Recognize     : 0.809263
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.303338

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.641761302947998 sec. =
Valid knn accuracy drums     : 90.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.367406368255615 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.675596714019775 sec. =
Valid knn accuracy piano     : 44.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.553333282470703 sec. =
Valid knn accuracy guitar    : 56.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.5049779415130615 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 57.2776470658549%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [05:15<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.916, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.772]Epoch 24: 100%|██████████| 313/313 [05:15<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.916, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203872, 0.204630, 0.204382, 0.221661
Train average loss UNet                 (all)                : 0.834544

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002255, 2.365258, 4.491653
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014229, 1.813669, 2.808772
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013209, 1.973399, 3.046171
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012761, 2.106905, 3.356115
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008401, 2.224282, 3.657302
Train average loss all      (Triplet)                 : 0.010167

== Recognize ==
Train average loss Recognize     : 0.782270
Train average accuracy drums     : 50.545002 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 49.755001 %
Train average accuracy guitar    : 49.924999 %
Train average accuracy residuals : 50.580002 %

== Train average loss all : 0.010167

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.916, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.916, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.916, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00752, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00752, Train/loss_recog_step=0.734, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00752, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00752, Train/loss_recog_step=0.734, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  32%|███▏      | 100/313 [01:24<03:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00767, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00767, Train/loss_recog_step=0.771, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.00767, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00767, Train/loss_recog_step=0.771, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  48%|████▊     | 150/313 [02:02<02:13,  1.22it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.886, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.808, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]  Epoch 25:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.886, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.808, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  64%|██████▍   | 200/313 [02:40<01:30,  1.25it/s, v_num=0, Train/loss_all_step=0.00824, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=0.842, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.00824, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=0.842, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  80%|███████▉  | 250/313 [03:16<00:49,  1.27it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.777, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]    Epoch 25:  96%|█████████▌| 300/313 [03:52<00:10,  1.29it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.777, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25:  96%|█████████▌| 300/313 [03:52<00:10,  1.29it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=0.840, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25: 100%|██████████| 313/313 [04:00<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=0.840, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25: 100%|██████████| 313/313 [04:00<00:00,  1.30it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.766, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.847, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197659, 0.197871, 0.199561, 0.222149
Valid average loss UNet                 (all)                : 0.817241

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084681, 2.577083, 4.415525
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.335216, 1.995629, 2.157260
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.609328, 2.878997, 2.790727
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304648, 2.645186, 3.098515
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.325105, 2.667925, 3.039629
Valid average loss all      (Triplet)                 : 0.348529

== Recognize ==
Valid average loss Recognize     : 0.811024
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.348529

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.68736720085144 sec. =
Valid knn accuracy drums     : 91.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.234162092208862 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.661554574966431 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.630980491638184 sec. =
Valid knn accuracy guitar    : 59.82142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.512844085693359 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 58.03596587493851%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.766, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=0.782]Epoch 25: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.766, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203700, 0.204453, 0.204206, 0.222078
Train average loss UNet                 (all)                : 0.834438

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000697, 2.391814, 4.527282
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013218, 1.869112, 2.887379
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011742, 2.049318, 3.150964
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009579, 2.167729, 3.504506
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008940, 2.224308, 3.647475
Train average loss all      (Triplet)                 : 0.009073

== Recognize ==
Train average loss Recognize     : 0.788250
Train average accuracy drums     : 50.070000 %
Train average accuracy bass      : 50.599998 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 49.744999 %
Train average accuracy residuals : 50.599998 %

== Train average loss all : 0.009073

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.766, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.766, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.766, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=0.773, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=0.773, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00726, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00726, Train/loss_recog_step=0.880, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00726, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00726, Train/loss_recog_step=0.880, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.775, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]  Epoch 26:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.775, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  64%|██████▍   | 200/313 [02:43<01:32,  1.22it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.763, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.763, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  80%|███████▉  | 250/313 [03:20<00:50,  1.25it/s, v_num=0, Train/loss_all_step=0.00192, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=0.816, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.00192, Train/loss_unet_all_step=0.858, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=0.816, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26:  96%|█████████▌| 300/313 [03:57<00:10,  1.26it/s, v_num=0, Train/loss_all_step=0.00975, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=0.732, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26: 100%|██████████| 313/313 [04:05<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.00975, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=0.732, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26: 100%|██████████| 313/313 [04:05<00:00,  1.27it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.712, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.448, Valid/loss_recog_step=0.808, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.37it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198597, 0.198752, 0.200481, 0.234839
Valid average loss UNet                 (all)                : 0.832669

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074988, 2.382760, 4.353090
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.417345, 2.105641, 2.213756
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.430870, 2.673209, 2.683660
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.288977, 2.545712, 3.042757
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.291928, 2.494085, 2.858147
Valid average loss all      (Triplet)                 : 0.298818

== Recognize ==
Valid average loss Recognize     : 0.800829
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.298818

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.742800951004028 sec. =
Valid knn accuracy drums     : 88.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.27154541015625 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.756891250610352 sec. =
Valid knn accuracy piano     : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.5354719161987305 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.5240068435668945 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 57.52128376532304%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [05:14<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.712, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00907, Train/loss_unet_all_epoch=0.834, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=0.788]Epoch 26: 100%|██████████| 313/313 [05:14<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.712, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203948, 0.204690, 0.204434, 0.221975
Train average loss UNet                 (all)                : 0.835047

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001219, 2.377356, 4.479300
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015337, 1.921756, 2.965925
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012047, 2.066603, 3.205846
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008791, 2.214372, 3.577905
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008214, 2.285756, 3.778188
Train average loss all      (Triplet)                 : 0.009299

== Recognize ==
Train average loss Recognize     : 0.787885
Train average accuracy drums     : 49.695000 %
Train average accuracy bass      : 50.085003 %
Train average accuracy piano     : 50.400002 %
Train average accuracy guitar    : 50.414997 %
Train average accuracy residuals : 50.134998 %

== Train average loss all : 0.009299

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.712, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.712, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.712, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00941, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00941, Train/loss_recog_step=0.769, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00941, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00941, Train/loss_recog_step=0.769, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  32%|███▏      | 100/313 [01:26<03:04,  1.15it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.829, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.829, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  48%|████▊     | 150/313 [02:03<02:14,  1.21it/s, v_num=0, Train/loss_all_step=0.00176, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.747, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.00176, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.747, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  64%|██████▍   | 200/313 [02:40<01:30,  1.24it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.803, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  80%|███████▉  | 250/313 [03:18<00:49,  1.26it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.803, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  80%|███████▉  | 250/313 [03:18<00:49,  1.26it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=0.790, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=0.790, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27:  96%|█████████▌| 300/313 [03:56<00:10,  1.27it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=0.825, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27: 100%|██████████| 313/313 [04:04<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=0.825, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27: 100%|██████████| 313/313 [04:04<00:00,  1.28it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=0.847, Valid/loss_all_step=0.240, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=0.786, Valid/loss_all_epoch=0.299, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.299, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.575, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198014, 0.198355, 0.199870, 0.225852
Valid average loss UNet                 (all)                : 0.822091

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095861, 2.674051, 4.528453
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.407353, 2.268055, 2.419869
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.499818, 2.907810, 2.970010
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.250238, 2.657055, 3.100844
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.600469, 3.021163, 3.150226
Valid average loss all      (Triplet)                 : 0.342992

== Recognize ==
Valid average loss Recognize     : 0.810706
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 41.000000 %

== Valid average loss all : 0.342992

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.7842347621917725 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.369753360748291 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.552550554275513 sec. =
Valid knn accuracy piano     : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.87174391746521 sec. =
Valid knn accuracy guitar    : 62.72321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.577384948730469 sec. =
Valid knn accuracy residuals : 72.04545454545455%

Valid knn accuracy average   : 58.354680470301076%

                                                                      [AEpoch 27: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=0.847, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.0093, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0093, Train/loss_recog_epoch=0.788]Epoch 27: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=0.847, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203985, 0.204735, 0.204485, 0.222006
Train average loss UNet                 (all)                : 0.835212

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001913, 2.401874, 4.559246
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011932, 1.918984, 3.012410
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011222, 2.059376, 3.208833
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010515, 2.173892, 3.547222
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007085, 2.312254, 3.813035
Train average loss all      (Triplet)                 : 0.008528

== Recognize ==
Train average loss Recognize     : 0.790815
Train average accuracy drums     : 49.689999 %
Train average accuracy bass      : 49.919998 %
Train average accuracy piano     : 49.744999 %
Train average accuracy guitar    : 50.540001 %
Train average accuracy residuals : 49.965000 %

== Train average loss all : 0.008528

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=0.847, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=0.847, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=0.847, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.000263, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000263, Train/loss_recog_step=0.755, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.000263, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000263, Train/loss_recog_step=0.755, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.00614, Train/loss_recog_step=0.777, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]  Epoch 28:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.00614, Train/loss_recog_step=0.777, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.884, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.848, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]  Epoch 28:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.884, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.848, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.780, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  80%|███████▉  | 250/313 [03:30<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.780, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  80%|███████▉  | 250/313 [03:30<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.816, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.816, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28:  96%|█████████▌| 300/313 [04:06<00:10,  1.22it/s, v_num=0, Train/loss_all_step=0.000309, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000309, Train/loss_recog_step=0.805, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.000309, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000309, Train/loss_recog_step=0.805, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28: 100%|██████████| 313/313 [04:14<00:00,  1.23it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.732, Valid/loss_all_step=0.362, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=0.755, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.08it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197502, 0.197794, 0.199408, 0.231836
Valid average loss UNet                 (all)                : 0.826541

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.082509, 2.703951, 4.711650
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.396257, 2.210939, 2.281399
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.519744, 2.891272, 2.954588
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270254, 2.854105, 3.320645
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.347441, 2.794686, 3.150366
Valid average loss all      (Triplet)                 : 0.347382

== Recognize ==
Valid average loss Recognize     : 0.783563
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.347382

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.5726916790008545 sec. =
Valid knn accuracy drums     : 92.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.449540138244629 sec. =
Valid knn accuracy bass      : 31.048387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.44330096244812 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.592392683029175 sec. =
Valid knn accuracy guitar    : 60.49107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.422452688217163 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 59.100227426412985%

                                                                      [AEpoch 28: 100%|██████████| 313/313 [05:17<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.732, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00853, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=0.791]Epoch 28: 100%|██████████| 313/313 [05:17<00:00,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.732, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203997, 0.204770, 0.204507, 0.222388
Train average loss UNet                 (all)                : 0.835662

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002193, 2.479163, 4.687437
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012220, 2.000404, 3.130685
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011255, 2.175997, 3.371262
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007650, 2.248852, 3.664651
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007998, 2.440401, 4.037642
Train average loss all      (Triplet)                 : 0.008412

== Recognize ==
Train average loss Recognize     : 0.798698
Train average accuracy drums     : 49.805000 %
Train average accuracy bass      : 49.715000 %
Train average accuracy piano     : 49.865002 %
Train average accuracy guitar    : 50.529999 %
Train average accuracy residuals : 50.070000 %

== Train average loss all : 0.008412

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.732, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.732, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.732, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=0.812, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=0.812, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=0.865, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]  Epoch 29:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=0.865, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.906, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.906, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  64%|██████▍   | 200/313 [02:48<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.789, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.789, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]  Epoch 29:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000694, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000694, Train/loss_recog_step=0.830, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000694, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000694, Train/loss_recog_step=0.830, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.896, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.695, Valid/loss_all_epoch=0.347, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.347, Valid/loss_recog_epoch=0.784, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.90it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198137, 0.198510, 0.200082, 0.223585
Valid average loss UNet                 (all)                : 0.820313

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083533, 2.490541, 4.517507
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.329669, 2.230815, 2.429395
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.417329, 2.792242, 2.925694
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.223371, 2.664894, 3.220892
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326436, 2.837537, 3.185809
Valid average loss all      (Triplet)                 : 0.266136

== Recognize ==
Valid average loss Recognize     : 0.787978
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.266136

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.706396579742432 sec. =
Valid knn accuracy drums     : 91.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.790219306945801 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.746485948562622 sec. =
Valid knn accuracy piano     : 41.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.678653240203857 sec. =
Valid knn accuracy guitar    : 61.38392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.604527711868286 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 58.44795447145772%

                                                                      [AEpoch 29: 100%|██████████| 313/313 [05:23<00:00,  0.97it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.896, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.799]Epoch 29: 100%|██████████| 313/313 [05:23<00:00,  0.97it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.896, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203954, 0.204698, 0.204443, 0.222203
Train average loss UNet                 (all)                : 0.835298

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001439, 2.512814, 4.729226
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012805, 1.995744, 3.137902
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014304, 2.166251, 3.345308
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007261, 2.257000, 3.658861
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006283, 2.445726, 4.054534
Train average loss all      (Triplet)                 : 0.008363

== Recognize ==
Train average loss Recognize     : 0.796840
Train average accuracy drums     : 50.320000 %
Train average accuracy bass      : 50.305004 %
Train average accuracy piano     : 50.164997 %
Train average accuracy guitar    : 50.400002 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.008363

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.896, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.896, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.896, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.000247, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=0.764, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000247, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=0.764, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=0.808, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]    Epoch 30:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=0.808, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.00248, Train/loss_unet_all_step=0.885, Train/loss_triplet_all_step=0.00248, Train/loss_recog_step=0.787, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00248, Train/loss_unet_all_step=0.885, Train/loss_triplet_all_step=0.00248, Train/loss_recog_step=0.787, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00165, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=0.841, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00165, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=0.841, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.817, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]  Epoch 30:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.817, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.848, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.848, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.774, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.788, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198291, 0.198525, 0.200217, 0.220528
Valid average loss UNet                 (all)                : 0.817561

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056624, 2.721713, 4.642167
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.430782, 2.289840, 2.419443
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.553208, 3.192775, 3.157553
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.234065, 2.787236, 3.204030
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.313047, 3.012690, 3.480227
Valid average loss all      (Triplet)                 : 0.340318

== Recognize ==
Valid average loss Recognize     : 0.765564
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.340318

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.715745687484741 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.354219436645508 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.851695775985718 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.577162265777588 sec. =
Valid knn accuracy guitar    : 56.91964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.455260276794434 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 56.79572292626729%

                                                                      [AEpoch 30: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.774, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00836, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00836, Train/loss_recog_epoch=0.797]Epoch 30: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.774, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203944, 0.204721, 0.204445, 0.223295
Train average loss UNet                 (all)                : 0.836405

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001828, 2.525563, 4.784649
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010342, 2.030050, 3.205990
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009425, 2.214395, 3.467236
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007632, 2.322049, 3.771930
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005415, 2.496462, 4.189177
Train average loss all      (Triplet)                 : 0.007082

== Recognize ==
Train average loss Recognize     : 0.803446
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 49.895000 %
Train average accuracy piano     : 49.325001 %
Train average accuracy guitar    : 49.555000 %
Train average accuracy residuals : 50.674999 %

== Train average loss all : 0.007082

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.774, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.774, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.774, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00469, Train/loss_recog_step=0.763, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00469, Train/loss_recog_step=0.763, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.814, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]  Epoch 31:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.865, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.814, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]  Epoch 31:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.803, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.803, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00819, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.796, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00819, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.796, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.846, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]  Epoch 31: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.846, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.753, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=0.600, Valid/loss_all_epoch=0.340, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.340, Valid/loss_recog_epoch=0.766, Valid/knn_avr=0.568, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198129, 0.198414, 0.200028, 0.225908
Valid average loss UNet                 (all)                : 0.822479

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081927, 2.668312, 4.530796
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.456218, 2.256552, 2.250803
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.488407, 3.179722, 3.253627
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167997, 2.712080, 3.298366
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.349358, 3.059419, 3.498462
Valid average loss all      (Triplet)                 : 0.301056

== Recognize ==
Valid average loss Recognize     : 0.801753
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.301056

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.349372625350952 sec. =
Valid knn accuracy drums     : 91.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.500163316726685 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.703564882278442 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.63939905166626 sec. =
Valid knn accuracy guitar    : 59.82142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.705172777175903 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 58.39044897292399%

                                                                      [AEpoch 31: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00708, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00708, Train/loss_recog_epoch=0.803]Epoch 31: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204088, 0.204851, 0.204592, 0.222158
Train average loss UNet                 (all)                : 0.835691

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001435, 2.531421, 4.767469
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010854, 2.062956, 3.255786
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009304, 2.267488, 3.536264
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008967, 2.376121, 3.873016
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007869, 2.554546, 4.245916
Train average loss all      (Triplet)                 : 0.007852

== Recognize ==
Train average loss Recognize     : 0.805244
Train average accuracy drums     : 50.099998 %
Train average accuracy bass      : 50.000000 %
Train average accuracy piano     : 49.399998 %
Train average accuracy guitar    : 50.209999 %
Train average accuracy residuals : 50.510002 %

== Train average loss all : 0.007852

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.797, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.797, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.843, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.843, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.884, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.774, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.884, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.774, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00167, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.818, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00167, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.818, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.762, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]  Epoch 32:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.762, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.805, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.805, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.824, Valid/loss_all_epoch=0.301, Valid/loss_unet_all_epoch=0.822, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=0.802, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.84it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197331, 0.197729, 0.199284, 0.216828
Valid average loss UNet                 (all)                : 0.811172

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064588, 2.665419, 4.357812
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.390103, 2.325149, 2.466017
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.643436, 3.224823, 3.235869
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.265938, 2.936542, 3.594950
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396774, 2.965527, 3.356783
Valid average loss all      (Triplet)                 : 0.343895

== Recognize ==
Valid average loss Recognize     : 0.850986
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.343895

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.78908634185791 sec. =
Valid knn accuracy drums     : 91.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.709800958633423 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.699839353561401 sec. =
Valid knn accuracy piano     : 49.21875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.731325149536133 sec. =
Valid knn accuracy guitar    : 63.16964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.585410118103027 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 60.22455476676198%

                                                                      [AEpoch 32: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.00785, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00785, Train/loss_recog_epoch=0.805]Epoch 32: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203945, 0.204681, 0.204427, 0.222527
Train average loss UNet                 (all)                : 0.835580

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001072, 2.548362, 4.717976
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011836, 2.099595, 3.313608
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008470, 2.286468, 3.567509
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010181, 2.425875, 3.944595
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006988, 2.595068, 4.330664
Train average loss all      (Triplet)                 : 0.007798

== Recognize ==
Train average loss Recognize     : 0.810129
Train average accuracy drums     : 50.050003 %
Train average accuracy bass      : 50.050003 %
Train average accuracy piano     : 50.110001 %
Train average accuracy guitar    : 49.695000 %
Train average accuracy residuals : 50.389999 %

== Train average loss all : 0.007798

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.794, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.794, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=0.797, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=0.797, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=0.818, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=0.818, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=0.846, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]  Epoch 33:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=0.846, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]  Epoch 33:  96%|█████████▌| 300/313 [04:13<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33:  96%|█████████▌| 300/313 [04:13<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.875, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.875, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.344, Valid/loss_unet_all_epoch=0.811, Valid/loss_triplet_all_epoch=0.344, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.602, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198000, 0.198343, 0.199811, 0.221004
Valid average loss UNet                 (all)                : 0.817159

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050604, 2.755280, 4.684673
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.464095, 2.408107, 2.487024
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.525731, 3.204254, 3.198540
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184645, 2.961824, 3.602075
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.864011, 3.323914, 3.251119
Valid average loss all      (Triplet)                 : 0.378076

== Recognize ==
Valid average loss Recognize     : 0.839931
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.378076

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.825654745101929 sec. =
Valid knn accuracy drums     : 93.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3589701652526855 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.870850086212158 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.638021469116211 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.977692127227783 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 57.15423970533324%

                                                                      [AEpoch 33: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.0078, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.0078, Train/loss_recog_epoch=0.810]Epoch 33: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203995, 0.204731, 0.204489, 0.222040
Train average loss UNet                 (all)                : 0.835255

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001572, 2.583673, 4.779928
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010200, 2.112437, 3.340622
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010383, 2.341553, 3.671430
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008942, 2.469908, 4.016371
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007384, 2.637073, 4.407584
Train average loss all      (Triplet)                 : 0.007844

== Recognize ==
Train average loss Recognize     : 0.820053
Train average accuracy drums     : 49.430000 %
Train average accuracy bass      : 49.880001 %
Train average accuracy piano     : 49.799999 %
Train average accuracy guitar    : 50.260002 %
Train average accuracy residuals : 49.744999 %

== Train average loss all : 0.007844

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.00399, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00399, Train/loss_recog_step=0.816, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.00399, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00399, Train/loss_recog_step=0.816, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.894, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]  Epoch 34:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.894, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.833, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.833, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.871, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.871, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00964, Train/loss_recog_step=0.822, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00964, Train/loss_recog_step=0.822, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.810, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]    Epoch 34: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.810, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.583, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.583, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.13it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.31it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197854, 0.198132, 0.199765, 0.227749
Valid average loss UNet                 (all)                : 0.823500

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059808, 2.824053, 4.704194
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.421703, 2.347028, 2.461909
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.536242, 3.263337, 3.273707
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.196345, 2.784560, 3.326176
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.552749, 3.224640, 3.393530
Valid average loss all      (Triplet)                 : 0.319902

== Recognize ==
Valid average loss Recognize     : 0.782659
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.319902

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.196270942687988 sec. =
Valid knn accuracy drums     : 90.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.997673273086548 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.656558513641357 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.960138320922852 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.705544710159302 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 56.10803807649223%

                                                                      [AEpoch 34: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00784, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00784, Train/loss_recog_epoch=0.820]Epoch 34: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203886, 0.204648, 0.204393, 0.221791
Train average loss UNet                 (all)                : 0.834718

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001506, 2.640512, 5.034346
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010055, 2.155760, 3.420821
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009576, 2.384407, 3.769183
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008377, 2.527850, 4.156482
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007701, 2.677381, 4.448373
Train average loss all      (Triplet)                 : 0.007587

== Recognize ==
Train average loss Recognize     : 0.818466
Train average accuracy drums     : 50.384998 %
Train average accuracy bass      : 50.484997 %
Train average accuracy piano     : 49.810001 %
Train average accuracy guitar    : 50.250000 %
Train average accuracy residuals : 49.294998 %

== Train average loss all : 0.007587

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.0081, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.773, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.0081, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.773, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.849, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.849, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00167, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.848, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.00167, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.848, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.00143, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.798, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00143, Train/loss_unet_all_step=0.816, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.798, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0202, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=0.820, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]  Epoch 35:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0202, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=0.820, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000432, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000432, Train/loss_recog_step=0.841, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000432, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000432, Train/loss_recog_step=0.841, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.280, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=0.650, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.783, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.40it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197617, 0.198043, 0.199458, 0.230661
Valid average loss UNet                 (all)                : 0.825779

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079997, 2.974179, 4.920256
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.473331, 2.506059, 2.637528
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.599487, 3.337715, 3.377914
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187862, 2.930139, 3.699864
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.480884, 3.303029, 3.525383
Valid average loss all      (Triplet)                 : 0.373155

== Recognize ==
Valid average loss Recognize     : 0.809859
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.373155

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.839225769042969 sec. =
Valid knn accuracy drums     : 93.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.510267972946167 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.552754878997803 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.909912109375 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6780383586883545 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 55.25626966608076%

                                                                      [AEpoch 35: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00759, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00759, Train/loss_recog_epoch=0.818]Epoch 35: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203924, 0.204695, 0.204431, 0.221786
Train average loss UNet                 (all)                : 0.834836

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000529, 2.592451, 4.879031
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009461, 2.129359, 3.369997
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009767, 2.348119, 3.715717
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008259, 2.444633, 3.994861
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006147, 2.653762, 4.446966
Train average loss all      (Triplet)                 : 0.006803

== Recognize ==
Train average loss Recognize     : 0.815275
Train average accuracy drums     : 49.665001 %
Train average accuracy bass      : 50.430000 %
Train average accuracy piano     : 50.489998 %
Train average accuracy guitar    : 50.285000 %
Train average accuracy residuals : 49.764999 %

== Train average loss all : 0.006803

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.818, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.818, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]  Epoch 36:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00141, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=0.855, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00141, Train/loss_unet_all_step=0.864, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=0.855, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]    Epoch 36:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.856, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.856, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.878, Valid/loss_all_step=0.500, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.500, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.810, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.84it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197311, 0.197694, 0.199185, 0.235050
Valid average loss UNet                 (all)                : 0.829241

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055016, 3.042973, 4.990738
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.623075, 2.874946, 2.829195
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.578989, 3.608572, 3.701158
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.216242, 3.250320, 3.880100
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.494206, 3.352365, 3.689310
Valid average loss all      (Triplet)                 : 0.390135

== Recognize ==
Valid average loss Recognize     : 0.847628
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.390135

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.021324872970581 sec. =
Valid knn accuracy drums     : 91.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.450103282928467 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.591415643692017 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.586076498031616 sec. =
Valid knn accuracy guitar    : 55.80357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.370176076889038 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 56.201006983023994%

                                                                      [AEpoch 36: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.878, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.815]Epoch 36: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.878, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203910, 0.204671, 0.204416, 0.222158
Train average loss UNet                 (all)                : 0.835155

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001601, 2.722211, 5.105128
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009301, 2.262044, 3.594388
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009494, 2.506441, 3.925978
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006529, 2.621054, 4.305838
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005239, 2.791734, 4.674513
Train average loss all      (Triplet)                 : 0.006584

== Recognize ==
Train average loss Recognize     : 0.833626
Train average accuracy drums     : 50.475002 %
Train average accuracy bass      : 49.564999 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 49.669998 %
Train average accuracy residuals : 49.779999 %

== Train average loss all : 0.006584

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.878, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.878, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.0259, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=0.878, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.00187, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=0.778, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00187, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=0.778, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0082, Train/loss_recog_step=0.796, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]  Epoch 37:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0082, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0082, Train/loss_recog_step=0.796, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.892, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.792, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]  Epoch 37:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.892, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.792, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.811, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.811, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00324, Train/loss_recog_step=0.835, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.00324, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00324, Train/loss_recog_step=0.835, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.828, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]  Epoch 37: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.828, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.868, Valid/loss_all_step=0.494, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.848, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:04<00:00,  0.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.20it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.92it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197685, 0.198070, 0.199563, 0.236316
Valid average loss UNet                 (all)                : 0.831633

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.042041, 2.908473, 4.969235
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.477444, 2.561322, 2.556307
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.478001, 3.185931, 3.437106
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.128769, 2.982693, 3.880096
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.504482, 3.103934, 3.403004
Valid average loss all      (Triplet)                 : 0.305951

== Recognize ==
Valid average loss Recognize     : 0.821517
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.305951

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.75285267829895 sec. =
Valid knn accuracy drums     : 88.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.93510913848877 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.899091005325317 sec. =
Valid knn accuracy piano     : 46.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.660869836807251 sec. =
Valid knn accuracy guitar    : 51.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.56045937538147 sec. =
Valid knn accuracy residuals : 71.81818181818181%

Valid knn accuracy average   : 56.98250814534344%

                                                                      [AEpoch 37: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.868, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00658, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00658, Train/loss_recog_epoch=0.834]Epoch 37: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.868, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203922, 0.204686, 0.204424, 0.222316
Train average loss UNet                 (all)                : 0.835348

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001767, 2.721316, 5.138675
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012635, 2.344404, 3.678510
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007317, 2.451418, 3.858911
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008955, 2.607700, 4.232644
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009443, 2.739833, 4.547648
Train average loss all      (Triplet)                 : 0.008040

== Recognize ==
Train average loss Recognize     : 0.832539
Train average accuracy drums     : 50.570000 %
Train average accuracy bass      : 50.900002 %
Train average accuracy piano     : 50.160004 %
Train average accuracy guitar    : 50.195004 %
Train average accuracy residuals : 49.540001 %

== Train average loss all : 0.008040

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.868, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.868, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.868, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00642, Train/loss_recog_step=0.828, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00642, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00642, Train/loss_recog_step=0.828, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.047, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.047, Train/loss_recog_step=0.882, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]    Epoch 38:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.047, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.047, Train/loss_recog_step=0.882, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.887, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.833, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.887, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.833, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.838, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]  Epoch 38:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.838, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.860, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.860, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00926, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00926, Train/loss_recog_step=0.853, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00926, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00926, Train/loss_recog_step=0.853, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.832, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.97it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.54it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197463, 0.197922, 0.199355, 0.217844
Valid average loss UNet                 (all)                : 0.812582

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077796, 2.852533, 4.536959
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.450555, 2.705868, 2.822201
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.515127, 3.286624, 3.310327
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.145153, 3.181946, 3.749248
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.740315, 3.313368, 3.427890
Valid average loss all      (Triplet)                 : 0.337985

== Recognize ==
Valid average loss Recognize     : 0.845904
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.337985

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.752672910690308 sec. =
Valid knn accuracy drums     : 93.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.61050009727478 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.644496440887451 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.061322212219238 sec. =
Valid knn accuracy guitar    : 58.92857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.993093252182007 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 58.07508259184715%

                                                                      [AEpoch 38: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00804, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00804, Train/loss_recog_epoch=0.833]Epoch 38: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.203944, 0.204714, 0.204433, 0.222558
Train average loss UNet                 (all)                : 0.835649

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001230, 2.687060, 5.070199
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013049, 2.314304, 3.653533
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009598, 2.442352, 3.846551
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007771, 2.650571, 4.298005
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004825, 2.724460, 4.541924
Train average loss all      (Triplet)                 : 0.007469

== Recognize ==
Train average loss Recognize     : 0.840915
Train average accuracy drums     : 49.829998 %
Train average accuracy bass      : 50.005001 %
Train average accuracy piano     : 50.529999 %
Train average accuracy guitar    : 50.349998 %
Train average accuracy residuals : 49.974998 %

== Train average loss all : 0.007469

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00671, Train/loss_recog_step=0.859, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.00671, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00671, Train/loss_recog_step=0.859, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.836, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]  Epoch 39:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.836, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=0.876, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=0.876, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.849, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.849, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]    Epoch 39:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.865, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.865, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.368, Valid/loss_unet_all_step=0.746, Valid/loss_triplet_all_step=0.368, Valid/loss_recog_step=0.870, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.813, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.581, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.71it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.48it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197890, 0.198204, 0.199720, 0.232945
Valid average loss UNet                 (all)                : 0.828760

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078150, 2.951023, 5.129953
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.468082, 2.659919, 2.753984
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.768117, 3.789783, 3.640066
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304007, 3.321315, 4.069471
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.402957, 3.151968, 3.548296
Valid average loss all      (Triplet)                 : 0.417452

== Recognize ==
Valid average loss Recognize     : 0.845559
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.417452

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.7344865798950195 sec. =
Valid knn accuracy drums     : 89.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.756729364395142 sec. =
Valid knn accuracy bass      : 26.61290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.36073899269104 sec. =
Valid knn accuracy piano     : 42.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.774645566940308 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.550386190414429 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 56.544012745669484%

                                                                      [AEpoch 39: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00747, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00747, Train/loss_recog_epoch=0.841]Epoch 39: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204003, 0.204768, 0.204499, 0.222047
Train average loss UNet                 (all)                : 0.835317

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001267, 2.722014, 5.137248
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010362, 2.361861, 3.737904
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009123, 2.467845, 3.897025
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008776, 2.689323, 4.393239
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003676, 2.684175, 4.510404
Train average loss all      (Triplet)                 : 0.006683

== Recognize ==
Train average loss Recognize     : 0.842582
Train average accuracy drums     : 49.990002 %
Train average accuracy bass      : 50.430000 %
Train average accuracy piano     : 50.515003 %
Train average accuracy guitar    : 50.204998 %
Train average accuracy residuals : 49.610001 %

== Train average loss all : 0.006683

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.00502, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00502, Train/loss_recog_step=0.782, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00502, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00502, Train/loss_recog_step=0.782, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00143, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.788, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00143, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.788, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.896, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.798, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]  Epoch 40:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.896, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.798, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]  Epoch 40:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.842, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.842, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.813, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]  Epoch 40: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.813, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.861, Valid/loss_all_step=0.535, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.95it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.97it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197977, 0.198284, 0.199863, 0.200790
Valid average loss UNet                 (all)                : 0.796914

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091623, 2.998822, 5.365898
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.491259, 2.696935, 2.874043
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.616080, 3.594372, 3.535386
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.234472, 3.205829, 3.961865
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.467934, 3.340811, 3.787582
Valid average loss all      (Triplet)                 : 0.364646

== Recognize ==
Valid average loss Recognize     : 0.945217
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.364646

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.974746942520142 sec. =
Valid knn accuracy drums     : 92.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.869847774505615 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.061862468719482 sec. =
Valid knn accuracy piano     : 47.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.813427448272705 sec. =
Valid knn accuracy guitar    : 58.48214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.630850315093994 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 58.47281854497186%

                                                                      [AEpoch 40: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.861, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.843]Epoch 40: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.861, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204317, 0.205043, 0.204794, 0.222509
Train average loss UNet                 (all)                : 0.836663

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001253, 2.757424, 5.158326
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009902, 2.396042, 3.819489
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007439, 2.502281, 3.967340
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005483, 2.684228, 4.451381
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004694, 2.776301, 4.667448
Train average loss all      (Triplet)                 : 0.005837

== Recognize ==
Train average loss Recognize     : 0.846854
Train average accuracy drums     : 49.860001 %
Train average accuracy bass      : 49.544998 %
Train average accuracy piano     : 49.849998 %
Train average accuracy guitar    : 50.365002 %
Train average accuracy residuals : 49.974998 %

== Train average loss all : 0.005837

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.861, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.861, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.861, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.779, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]  Epoch 41:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.779, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.873, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  48%|████▊     | 150/313 [02:18<02:30,  1.09it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.873, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  48%|████▊     | 150/313 [02:18<02:30,  1.09it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.896, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=0.929, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.896, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=0.929, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.000875, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000875, Train/loss_recog_step=0.869, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000875, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000875, Train/loss_recog_step=0.869, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]      Epoch 41:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.881, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.700, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.365, Valid/loss_unet_all_epoch=0.797, Valid/loss_triplet_all_epoch=0.365, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.585, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.92it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197878, 0.198214, 0.199779, 0.230322
Valid average loss UNet                 (all)                : 0.826193

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070503, 3.024904, 5.706342
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.520479, 2.759475, 2.904545
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.632169, 3.443602, 3.450465
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.193246, 3.083877, 3.932697
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.661214, 3.469356, 3.620524
Valid average loss all      (Triplet)                 : 0.398228

== Recognize ==
Valid average loss Recognize     : 0.893320
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.398228

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.933427572250366 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.809974670410156 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.465482473373413 sec. =
Valid knn accuracy piano     : 44.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.783270597457886 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.888319253921509 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 57.15916106377844%

                                                                      [AEpoch 41: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.881, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.847]Epoch 41: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.881, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204060, 0.204813, 0.204535, 0.222260
Train average loss UNet                 (all)                : 0.835668

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001606, 2.865118, 5.358352
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008101, 2.457890, 3.936927
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006457, 2.558454, 4.062439
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005293, 2.735366, 4.542436
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007726, 2.922158, 4.862360
Train average loss all      (Triplet)                 : 0.005889

== Recognize ==
Train average loss Recognize     : 0.857552
Train average accuracy drums     : 49.910000 %
Train average accuracy bass      : 50.070000 %
Train average accuracy piano     : 49.654999 %
Train average accuracy guitar    : 49.689999 %
Train average accuracy residuals : 49.799999 %

== Train average loss all : 0.005889

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.881, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.881, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.881, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.876, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.876, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]    Epoch 42:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00125, Train/loss_unet_all_step=0.901, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=0.784, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00125, Train/loss_unet_all_step=0.901, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=0.784, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.841, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.841, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.782, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]    Epoch 42:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.782, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.877, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=0.877, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=0.862, Valid/loss_all_step=0.430, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=0.917, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.02it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197934, 0.198236, 0.199756, 0.226952
Valid average loss UNet                 (all)                : 0.822879

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065374, 3.021390, 5.164474
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.451524, 2.725253, 2.922052
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.606847, 3.685659, 3.694827
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.234330, 2.996801, 3.686436
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.559397, 3.470160, 3.820242
Valid average loss all      (Triplet)                 : 0.363417

== Recognize ==
Valid average loss Recognize     : 0.826313
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.363417

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.774611949920654 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.67695426940918 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.662779092788696 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.439183235168457 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.492655515670776 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 55.55071956225752%

                                                                      [AEpoch 42: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=0.862, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00589, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00589, Train/loss_recog_epoch=0.858]Epoch 42: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=0.862, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]    

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204211, 0.204954, 0.204694, 0.221157
Train average loss UNet                 (all)                : 0.835016

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001810, 2.803815, 5.339159
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006129, 2.407717, 3.861998
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010014, 2.573705, 4.059217
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007748, 2.695597, 4.424804
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004497, 2.905909, 4.879397
Train average loss all      (Triplet)                 : 0.006002

== Recognize ==
Train average loss Recognize     : 0.853270
Train average accuracy drums     : 49.915001 %
Train average accuracy bass      : 49.829998 %
Train average accuracy piano     : 49.674999 %
Train average accuracy guitar    : 50.010002 %
Train average accuracy residuals : 49.349998 %

== Train average loss all : 0.006002

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=0.862, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=0.862, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.0418, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0418, Train/loss_recog_step=0.862, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.00874, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00874, Train/loss_recog_step=0.858, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00874, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00874, Train/loss_recog_step=0.858, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00302, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=0.866, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.00302, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00302, Train/loss_recog_step=0.866, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  48%|████▊     | 150/313 [02:05<02:16,  1.19it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.903, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.844, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]  Epoch 43:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.903, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.844, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.884, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.884, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.865, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]  Epoch 43:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.865, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]  Epoch 43: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.305, Valid/loss_recog_step=0.719, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.556, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.63it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198344, 0.198650, 0.200189, 0.227562
Valid average loss UNet                 (all)                : 0.824746

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078998, 3.165926, 5.239824
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.522492, 2.800973, 2.860856
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.558823, 3.521282, 3.506483
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177165, 3.041089, 3.679162
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.466982, 3.025309, 3.342921
Valid average loss all      (Triplet)                 : 0.338512

== Recognize ==
Valid average loss Recognize     : 0.856352
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.338512

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.747570753097534 sec. =
Valid knn accuracy drums     : 91.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.672801494598389 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7779624462127686 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.616518259048462 sec. =
Valid knn accuracy guitar    : 56.02678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.480210304260254 sec. =
Valid knn accuracy residuals : 71.5909090909091%

Valid knn accuracy average   : 57.688149322189034%

                                                                      [AEpoch 43: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.835, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=0.853]Epoch 43: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204534, 0.205277, 0.205007, 0.222297
Train average loss UNet                 (all)                : 0.837116

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001735, 2.809149, 5.284643
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008658, 2.454964, 3.900319
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008907, 2.572865, 4.045566
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005839, 2.672652, 4.404422
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004285, 2.832437, 4.764853
Train average loss all      (Triplet)                 : 0.005868

== Recognize ==
Train average loss Recognize     : 0.855866
Train average accuracy drums     : 49.645000 %
Train average accuracy bass      : 50.005001 %
Train average accuracy piano     : 50.500000 %
Train average accuracy guitar    : 50.389999 %
Train average accuracy residuals : 50.139999 %

== Train average loss all : 0.005868

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00227, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.813, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.00227, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.813, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.866, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]  Epoch 44:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.866, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=0.835, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.875, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=0.835, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00316, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=0.878, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00316, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=0.878, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.894, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]  Epoch 44:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.894, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0316, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0316, Train/loss_recog_step=0.930, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0316, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0316, Train/loss_recog_step=0.930, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.834, Valid/loss_all_step=0.315, Valid/loss_unet_all_step=0.807, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198627, 0.198875, 0.200549, 0.222173
Valid average loss UNet                 (all)                : 0.820224

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080254, 3.111653, 5.179561
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460282, 2.870138, 3.029406
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.741941, 3.714214, 3.639049
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.228097, 3.063598, 3.942444
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.435081, 3.262901, 3.746010
Valid average loss all      (Triplet)                 : 0.391124

== Recognize ==
Valid average loss Recognize     : 0.856024
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.391124

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.802753686904907 sec. =
Valid knn accuracy drums     : 92.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.449319362640381 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.949156284332275 sec. =
Valid knn accuracy piano     : 45.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.487699747085571 sec. =
Valid knn accuracy guitar    : 54.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.096519470214844 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 57.553023994326146%

                                                                      [AEpoch 44: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.834, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00587, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00587, Train/loss_recog_epoch=0.856]Epoch 44: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.834, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204701, 0.205468, 0.205196, 0.222553
Train average loss UNet                 (all)                : 0.837919

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002146, 2.766153, 5.133832
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009184, 2.453075, 3.894135
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008726, 2.575007, 4.048759
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005547, 2.676330, 4.414590
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005764, 2.890775, 4.831448
Train average loss all      (Triplet)                 : 0.006404

== Recognize ==
Train average loss Recognize     : 0.854992
Train average accuracy drums     : 50.005001 %
Train average accuracy bass      : 50.035000 %
Train average accuracy piano     : 49.805000 %
Train average accuracy guitar    : 50.400002 %
Train average accuracy residuals : 50.129997 %

== Train average loss all : 0.006404

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.834, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.834, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.834, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00503, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.840, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00503, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.840, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.829, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.829, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.901, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.917, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]  Epoch 45:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.901, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.917, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0077, Train/loss_recog_step=0.835, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0077, Train/loss_recog_step=0.835, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]  Epoch 45:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00257, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.885, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00257, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.885, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.410, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.576, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.36it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.22it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198005, 0.198275, 0.199792, 0.220710
Valid average loss UNet                 (all)                : 0.816782

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061357, 2.896448, 4.953081
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.496157, 2.784288, 2.868082
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.720628, 3.588918, 3.429336
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.267593, 3.163728, 3.828841
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.610489, 3.338137, 3.606643
Valid average loss all      (Triplet)                 : 0.416497

== Recognize ==
Valid average loss Recognize     : 0.859174
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 42.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.416497

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.179608345031738 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.45252537727356 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.676015138626099 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.800777912139893 sec. =
Valid knn accuracy guitar    : 56.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.821322679519653 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 56.46869322166263%

                                                                      [AEpoch 45: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0064, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0064, Train/loss_recog_epoch=0.855]Epoch 45: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204467, 0.205232, 0.204954, 0.222522
Train average loss UNet                 (all)                : 0.837176

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001231, 2.766335, 5.234777
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009261, 2.446036, 3.899742
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008617, 2.583244, 4.067465
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007537, 2.696165, 4.403320
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003962, 2.880655, 4.838804
Train average loss all      (Triplet)                 : 0.006180

== Recognize ==
Train average loss Recognize     : 0.862215
Train average accuracy drums     : 49.980000 %
Train average accuracy bass      : 50.059998 %
Train average accuracy piano     : 49.814999 %
Train average accuracy guitar    : 49.935001 %
Train average accuracy residuals : 50.019997 %

== Train average loss all : 0.006180

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=0.904, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=0.904, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.00858, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.926, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00858, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.926, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00035, Train/loss_unet_all_step=0.909, Train/loss_triplet_all_step=0.00035, Train/loss_recog_step=0.838, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00035, Train/loss_unet_all_step=0.909, Train/loss_triplet_all_step=0.00035, Train/loss_recog_step=0.838, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00197, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=0.858, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00197, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=0.858, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=0.849, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.862, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=0.849, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]    Epoch 46: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=0.528, Valid/loss_unet_all_step=0.735, Valid/loss_triplet_all_step=0.528, Valid/loss_recog_step=0.834, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197591, 0.197979, 0.199432, 0.223798
Valid average loss UNet                 (all)                : 0.818801

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069137, 3.152940, 5.250493
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.509391, 2.887167, 2.929948
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.710241, 3.831268, 3.747929
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.197662, 3.148788, 3.935532
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.594052, 3.477163, 3.776775
Valid average loss all      (Triplet)                 : 0.392826

== Recognize ==
Valid average loss Recognize     : 0.856871
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.392826

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.1768670082092285 sec. =
Valid knn accuracy drums     : 90.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.373666524887085 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.720265626907349 sec. =
Valid knn accuracy piano     : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.46049690246582 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.704221248626709 sec. =
Valid knn accuracy residuals : 75.45454545454545%

Valid knn accuracy average   : 57.69975501356988%

                                                                      [AEpoch 46: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00618, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=0.862]Epoch 46: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204234, 0.204991, 0.204694, 0.222750
Train average loss UNet                 (all)                : 0.836669

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000830, 2.819634, 5.280496
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009197, 2.562514, 4.059957
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008401, 2.670607, 4.234423
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007435, 2.808365, 4.567358
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003594, 2.946672, 4.934102
Train average loss all      (Triplet)                 : 0.006013

== Recognize ==
Train average loss Recognize     : 0.864142
Train average accuracy drums     : 49.965000 %
Train average accuracy bass      : 49.775002 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 49.865002 %
Train average accuracy residuals : 49.700001 %

== Train average loss all : 0.006013

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0078, Train/loss_recog_step=0.880, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0078, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0078, Train/loss_recog_step=0.880, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=0.820, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.861, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=0.820, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0047, Train/loss_unet_all_step=0.890, Train/loss_triplet_all_step=0.0047, Train/loss_recog_step=0.854, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]  Epoch 47:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0047, Train/loss_unet_all_step=0.890, Train/loss_triplet_all_step=0.0047, Train/loss_recog_step=0.854, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.870, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.870, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]    Epoch 47:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.819, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.469, Valid/loss_recog_step=0.809, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.857, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.24it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198273, 0.198485, 0.200129, 0.230023
Valid average loss UNet                 (all)                : 0.826910

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056732, 2.882568, 4.757021
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.523876, 2.924246, 2.964607
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.646571, 3.745099, 3.687686
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.183424, 3.203867, 4.080079
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.742303, 3.514858, 3.589226
Valid average loss all      (Triplet)                 : 0.393332

== Recognize ==
Valid average loss Recognize     : 0.840172
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.393332

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.877995014190674 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.664515018463135 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.672328472137451 sec. =
Valid knn accuracy piano     : 43.5546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.858440637588501 sec. =
Valid knn accuracy guitar    : 60.71428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.89854621887207 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 57.72779056278574%

                                                                      [AEpoch 47: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.819, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00601, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00601, Train/loss_recog_epoch=0.864]Epoch 47: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.819, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204185, 0.204938, 0.204664, 0.223105
Train average loss UNet                 (all)                : 0.836893

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001671, 2.867013, 5.381347
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007481, 2.577540, 4.100773
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007724, 2.701444, 4.264285
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005939, 2.827631, 4.637938
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004826, 2.952181, 4.944288
Train average loss all      (Triplet)                 : 0.005625

== Recognize ==
Train average loss Recognize     : 0.864080
Train average accuracy drums     : 50.185001 %
Train average accuracy bass      : 49.689999 %
Train average accuracy piano     : 49.634998 %
Train average accuracy guitar    : 50.085003 %
Train average accuracy residuals : 50.340004 %

== Train average loss all : 0.005625

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.819, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.819, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.819, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.774, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.774, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00886, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.854, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00886, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.854, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.905, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.905, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.820, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.820, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]    Epoch 48:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00657, Train/loss_recog_step=0.970, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00657, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00657, Train/loss_recog_step=0.970, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.835, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=0.743, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.840, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197896, 0.198368, 0.199641, 0.226597
Valid average loss UNet                 (all)                : 0.822502

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073362, 3.035810, 5.384320
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.491330, 2.928825, 3.128183
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.625433, 3.756090, 3.847626
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178751, 3.222198, 4.128894
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.796176, 3.622077, 3.618828
Valid average loss all      (Triplet)                 : 0.397273

== Recognize ==
Valid average loss Recognize     : 0.882553
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.397273

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.861469030380249 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5440168380737305 sec. =
Valid knn accuracy bass      : 22.379032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.903400421142578 sec. =
Valid knn accuracy piano     : 47.8515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.223552942276001 sec. =
Valid knn accuracy guitar    : 56.91964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.662215232849121 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 56.58815028983989%

                                                                      [AEpoch 48: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.835, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.864]Epoch 48: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.835, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204248, 0.205009, 0.204750, 0.222449
Train average loss UNet                 (all)                : 0.836456

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000929, 2.898653, 5.474236
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006647, 2.546143, 4.084926
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007879, 2.711339, 4.295574
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005406, 2.827307, 4.692934
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004011, 3.008569, 5.045074
Train average loss all      (Triplet)                 : 0.004988

== Recognize ==
Train average loss Recognize     : 0.869207
Train average accuracy drums     : 49.470001 %
Train average accuracy bass      : 49.634998 %
Train average accuracy piano     : 50.320000 %
Train average accuracy guitar    : 50.035000 %
Train average accuracy residuals : 49.355000 %

== Train average loss all : 0.004988

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.835, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.835, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.00634, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.835, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.820, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.820, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00159, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.826, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00159, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.826, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.874, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.855, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  64%|██████▍   | 200/313 [02:49<01:36,  1.18it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.874, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.855, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  64%|██████▍   | 200/313 [02:49<01:36,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]    Epoch 49:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0271, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0271, Train/loss_recog_step=0.831, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0271, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.0271, Train/loss_recog_step=0.831, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.893, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=0.893, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.970, Valid/loss_all_step=0.493, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.493, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.397, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.49it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198235, 0.198583, 0.200061, 0.221507
Valid average loss UNet                 (all)                : 0.818386

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064367, 3.176835, 5.710054
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.446788, 2.874176, 3.069294
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.672176, 3.900878, 3.876955
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177089, 3.245127, 4.142961
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.730923, 3.794689, 3.989185
Valid average loss all      (Triplet)                 : 0.371717

== Recognize ==
Valid average loss Recognize     : 0.909713
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 57.500000 %

== Valid average loss all : 0.371717

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.905748605728149 sec. =
Valid knn accuracy drums     : 89.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.446928262710571 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.855981111526489 sec. =
Valid knn accuracy piano     : 45.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.132984161376953 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.268739938735962 sec. =
Valid knn accuracy residuals : 71.36363636363636%

Valid knn accuracy average   : 57.38369889665034%

                                                                      [AEpoch 49: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.970, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00499, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00499, Train/loss_recog_epoch=0.869]Epoch 49: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.970, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204155, 0.204936, 0.204646, 0.222068
Train average loss UNet                 (all)                : 0.835804

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001819, 2.994583, 5.694436
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009919, 2.661819, 4.201301
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005903, 2.793009, 4.428943
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005562, 2.851688, 4.727442
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005131, 3.112010, 5.185294
Train average loss all      (Triplet)                 : 0.005840

== Recognize ==
Train average loss Recognize     : 0.878233
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 50.384998 %
Train average accuracy piano     : 49.680000 %
Train average accuracy guitar    : 49.720001 %
Train average accuracy residuals : 50.465000 %

== Train average loss all : 0.005840

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.970, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.970, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.970, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]  Epoch 50:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00139, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.906, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00139, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.906, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.904, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.909, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]    Epoch 50:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.904, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.909, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00252, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.841, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00252, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.841, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=0.890, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=0.890, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.739, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.71it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198437, 0.198855, 0.200310, 0.231380
Valid average loss UNet                 (all)                : 0.828982

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074627, 3.316330, 5.784587
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.510181, 3.040579, 3.203730
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.677297, 3.821885, 3.876855
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301844, 3.523510, 4.173585
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.619349, 3.728097, 4.009182
Valid average loss all      (Triplet)                 : 0.449075

== Recognize ==
Valid average loss Recognize     : 0.889543
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.449075

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.62370252609253 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.533368110656738 sec. =
Valid knn accuracy bass      : 21.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.639313220977783 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.674768924713135 sec. =
Valid knn accuracy guitar    : 64.95535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.729914903640747 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 57.67610406117375%

                                                                      [AEpoch 50: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00584, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00584, Train/loss_recog_epoch=0.878]Epoch 50: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204389, 0.205120, 0.204858, 0.222275
Train average loss UNet                 (all)                : 0.836643

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001009, 2.964449, 5.541800
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007127, 2.662878, 4.255336
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005637, 2.813975, 4.496191
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004963, 2.881243, 4.782867
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003523, 3.129179, 5.267408
Train average loss all      (Triplet)                 : 0.004672

== Recognize ==
Train average loss Recognize     : 0.877439
Train average accuracy drums     : 50.634998 %
Train average accuracy bass      : 50.410004 %
Train average accuracy piano     : 50.260002 %
Train average accuracy guitar    : 49.579998 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.004672

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.867, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.867, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.872, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]  Epoch 51:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.872, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00289, Train/loss_unet_all_step=0.883, Train/loss_triplet_all_step=0.00289, Train/loss_recog_step=0.840, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00289, Train/loss_unet_all_step=0.883, Train/loss_triplet_all_step=0.00289, Train/loss_recog_step=0.840, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00301, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=0.892, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00301, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=0.892, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]    Epoch 51:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.449, Valid/loss_unet_all_epoch=0.829, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.67it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.197993, 0.198362, 0.199771, 0.226741
Valid average loss UNet                 (all)                : 0.822866

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090817, 3.496252, 6.159725
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.544127, 3.182398, 3.244910
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.696860, 3.884470, 4.022010
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.164209, 3.736148, 4.581411
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.641733, 4.168393, 4.562463
Valid average loss all      (Triplet)                 : 0.412254

== Recognize ==
Valid average loss Recognize     : 0.900469
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.412254

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.798140287399292 sec. =
Valid knn accuracy drums     : 91.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.728760957717896 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.849323034286499 sec. =
Valid knn accuracy piano     : 47.265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.675297498703003 sec. =
Valid knn accuracy guitar    : 59.59821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.612242221832275 sec. =
Valid knn accuracy residuals : 71.36363636363636%

Valid knn accuracy average   : 59.84009541037503%

                                                                      [AEpoch 51: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00467, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00467, Train/loss_recog_epoch=0.877]Epoch 51: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204394, 0.205160, 0.204882, 0.222702
Train average loss UNet                 (all)                : 0.837138

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001189, 3.022399, 5.748077
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008132, 2.717476, 4.348197
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006341, 2.865701, 4.529152
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004673, 2.973510, 4.876743
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004836, 3.204313, 5.419816
Train average loss all      (Triplet)                 : 0.005156

== Recognize ==
Train average loss Recognize     : 0.881444
Train average accuracy drums     : 49.884998 %
Train average accuracy bass      : 49.779999 %
Train average accuracy piano     : 49.685001 %
Train average accuracy guitar    : 50.010002 %
Train average accuracy residuals : 50.449997 %

== Train average loss all : 0.005156

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.826, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.826, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00482, Train/loss_recog_step=0.860, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00482, Train/loss_recog_step=0.860, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.885, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.865, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]  Epoch 52:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.885, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=0.865, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=0.874, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=0.874, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00105, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.851, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00105, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.851, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]    Epoch 52: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00408, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.871, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.900, Valid/knn_avr=0.598, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.53it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.23it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198972, 0.199248, 0.200793, 0.235375
Valid average loss UNet                 (all)                : 0.834389

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047825, 3.156693, 6.006107
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395594, 2.965516, 3.265660
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.566392, 3.845605, 4.006442
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220891, 3.561453, 4.361805
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.498456, 3.899532, 4.289518
Valid average loss all      (Triplet)                 : 0.343412

== Recognize ==
Valid average loss Recognize     : 0.836870
Valid average accuracy drums     : 58.999996 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.343412

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.722084760665894 sec. =
Valid knn accuracy drums     : 91.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.374879360198975 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.898193597793579 sec. =
Valid knn accuracy piano     : 46.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6970155239105225 sec. =
Valid knn accuracy guitar    : 59.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.954867362976074 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 59.10256259562667%

                                                                      [AEpoch 52: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00408, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.871, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00516, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00516, Train/loss_recog_epoch=0.881]Epoch 52: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00408, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.871, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204345, 0.205106, 0.204832, 0.222283
Train average loss UNet                 (all)                : 0.836566

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000913, 2.987761, 5.728985
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006856, 2.704875, 4.332752
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006800, 2.806725, 4.484651
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007173, 2.984020, 4.927185
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005700, 3.206906, 5.373806
Train average loss all      (Triplet)                 : 0.005565

== Recognize ==
Train average loss Recognize     : 0.887507
Train average accuracy drums     : 50.085003 %
Train average accuracy bass      : 49.849998 %
Train average accuracy piano     : 49.834999 %
Train average accuracy guitar    : 50.204998 %
Train average accuracy residuals : 49.704998 %

== Train average loss all : 0.005565

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00408, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.871, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00408, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.871, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.00408, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.871, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.948, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.948, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.922, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]  Epoch 53:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.922, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.890, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.897, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]  Epoch 53:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.890, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.897, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.865, Valid/loss_all_step=0.335, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=0.756, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.343, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.591, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198586, 0.198874, 0.200340, 0.229897
Valid average loss UNet                 (all)                : 0.827696

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060867, 3.150678, 5.692710
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.547752, 3.251068, 3.409547
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.714644, 3.860018, 4.009569
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.214880, 3.244933, 4.317032
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.719563, 3.831707, 4.045976
Valid average loss all      (Triplet)                 : 0.445866

== Recognize ==
Valid average loss Recognize     : 0.901967
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 44.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.445866

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.000612735748291 sec. =
Valid knn accuracy drums     : 92.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.891838788986206 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.511061668395996 sec. =
Valid knn accuracy piano     : 47.0703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.86837100982666 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.976966857910156 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 58.65732651158449%

                                                                      [AEpoch 53: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.865, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00556, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00556, Train/loss_recog_epoch=0.888]Epoch 53: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.865, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204438, 0.205224, 0.204936, 0.221535
Train average loss UNet                 (all)                : 0.836133

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001377, 2.977895, 5.660440
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009386, 2.749080, 4.386290
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005882, 2.846742, 4.527837
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006668, 3.028742, 4.991360
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005000, 3.186985, 5.341856
Train average loss all      (Triplet)                 : 0.005628

== Recognize ==
Train average loss Recognize     : 0.888132
Train average accuracy drums     : 49.945000 %
Train average accuracy bass      : 50.540001 %
Train average accuracy piano     : 50.059998 %
Train average accuracy guitar    : 49.454998 %
Train average accuracy residuals : 49.990002 %

== Train average loss all : 0.005628

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.865, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.865, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.865, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.892, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]  Epoch 54:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.892, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.884, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.884, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000195, Train/loss_unet_all_step=0.909, Train/loss_triplet_all_step=0.000195, Train/loss_recog_step=0.830, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000195, Train/loss_unet_all_step=0.909, Train/loss_triplet_all_step=0.000195, Train/loss_recog_step=0.830, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]      Epoch 54:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.940, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.940, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.906, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.906, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.674, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.674, Valid/loss_recog_step=0.802, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.587, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198479, 0.198780, 0.200243, 0.208637
Valid average loss UNet                 (all)                : 0.806138

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.037313, 3.110209, 5.727934
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.485351, 3.063981, 3.203173
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.653566, 3.808153, 3.818490
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.235060, 3.429454, 4.320717
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.525061, 3.853686, 4.395347
Valid average loss all      (Triplet)                 : 0.370785

== Recognize ==
Valid average loss Recognize     : 0.930688
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.370785

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.826175689697266 sec. =
Valid knn accuracy drums     : 92.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.57943058013916 sec. =
Valid knn accuracy bass      : 22.177419354838708%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.113659858703613 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.193294525146484 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.611736059188843 sec. =
Valid knn accuracy residuals : 72.72727272727273%

Valid knn accuracy average   : 57.31294540399994%

                                                                      [AEpoch 54: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.00563, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=0.888]Epoch 54: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204805, 0.205577, 0.205303, 0.222613
Train average loss UNet                 (all)                : 0.838297

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001551, 2.960412, 5.626205
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007625, 2.732840, 4.395505
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006454, 2.807413, 4.445860
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005015, 2.973419, 4.934763
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005302, 3.198215, 5.364466
Train average loss all      (Triplet)                 : 0.005300

== Recognize ==
Train average loss Recognize     : 0.892233
Train average accuracy drums     : 50.000000 %
Train average accuracy bass      : 49.744999 %
Train average accuracy piano     : 49.849998 %
Train average accuracy guitar    : 49.930000 %
Train average accuracy residuals : 49.900002 %

== Train average loss all : 0.005300

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00382, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00382, Train/loss_recog_step=0.862, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00382, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.00382, Train/loss_recog_step=0.862, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=0.827, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]  Epoch 55:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=0.827, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00764, Train/loss_recog_step=0.887, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00764, Train/loss_recog_step=0.887, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]    Epoch 55:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.853, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.863, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.863, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.815, Valid/loss_all_step=0.383, Valid/loss_unet_all_step=0.748, Valid/loss_triplet_all_step=0.383, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.371, Valid/loss_unet_all_epoch=0.806, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.573, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.73it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.85it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198123, 0.198535, 0.199899, 0.229709
Valid average loss UNet                 (all)                : 0.826267

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034899, 3.274435, 5.833394
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.528264, 2.893600, 3.033427
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.688749, 3.891325, 3.885631
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.212840, 3.315248, 4.331394
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.774240, 3.884256, 4.135276
Valid average loss all      (Triplet)                 : 0.427459

== Recognize ==
Valid average loss Recognize     : 0.924203
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.427459

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.700410604476929 sec. =
Valid knn accuracy drums     : 91.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.769747972488403 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.419078588485718 sec. =
Valid knn accuracy piano     : 47.0703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.354596853256226 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.7237513065338135 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 57.95651049730425%

                                                                      [AEpoch 55: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.815, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.0053, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.0053, Train/loss_recog_epoch=0.892]Epoch 55: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.815, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204767, 0.205550, 0.205253, 0.222317
Train average loss UNet                 (all)                : 0.837887

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001173, 2.959491, 5.668162
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007040, 2.683356, 4.294548
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005321, 2.768405, 4.383962
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006007, 2.910586, 4.825014
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004270, 3.198718, 5.410983
Train average loss all      (Triplet)                 : 0.004757

== Recognize ==
Train average loss Recognize     : 0.885541
Train average accuracy drums     : 50.120003 %
Train average accuracy bass      : 50.045002 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 50.000000 %
Train average accuracy residuals : 50.099998 %

== Train average loss all : 0.004757

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.815, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.815, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.815, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]  Epoch 56:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.00709, Train/loss_recog_step=0.907, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.859, Train/loss_triplet_all_step=0.00709, Train/loss_recog_step=0.907, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.896, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]    Epoch 56:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.896, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00422, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.912, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.00422, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=0.912, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.893, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]  Epoch 56:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.893, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.937, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.937, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.858, Valid/loss_all_step=0.604, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.604, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.580, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.84it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.84it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198453, 0.198794, 0.200239, 0.228972
Valid average loss UNet                 (all)                : 0.826458

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053359, 3.246114, 5.731437
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.657593, 3.433831, 3.340666
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.811238, 4.296412, 4.211566
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301414, 3.931772, 4.652361
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.596489, 4.011929, 4.474355
Valid average loss all      (Triplet)                 : 0.496529

== Recognize ==
Valid average loss Recognize     : 0.929182
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.496529

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.891453266143799 sec. =
Valid knn accuracy drums     : 89.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.372970342636108 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.996105909347534 sec. =
Valid knn accuracy piano     : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.667019128799438 sec. =
Valid knn accuracy guitar    : 56.47321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.726353645324707 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 58.332423362051685%

                                                                      [AEpoch 56: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.858, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.886]Epoch 56: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.858, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204634, 0.205391, 0.205127, 0.221730
Train average loss UNet                 (all)                : 0.836883

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001164, 3.080098, 5.883432
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007232, 2.792485, 4.480794
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007585, 2.931560, 4.651415
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005138, 3.087747, 5.086671
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003900, 3.331634, 5.613340
Train average loss all      (Triplet)                 : 0.005146

== Recognize ==
Train average loss Recognize     : 0.905119
Train average accuracy drums     : 49.759998 %
Train average accuracy bass      : 50.620003 %
Train average accuracy piano     : 49.105000 %
Train average accuracy guitar    : 49.910000 %
Train average accuracy residuals : 49.500000 %

== Train average loss all : 0.005146

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.858, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.858, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.858, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]  Epoch 57:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.891, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00322, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.891, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.923, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00389, Train/loss_unet_all_step=0.872, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.923, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.895, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.895, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]    Epoch 57:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=0.984, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.817, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=0.984, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.873, Valid/loss_all_step=0.770, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.583, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.16it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198511, 0.198890, 0.200345, 0.223348
Valid average loss UNet                 (all)                : 0.821094

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047378, 3.300864, 5.949882
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.579907, 3.085009, 3.019869
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.622586, 4.009193, 4.103354
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284802, 3.619893, 4.379845
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.419503, 3.767048, 4.488323
Valid average loss all      (Triplet)                 : 0.401136

== Recognize ==
Valid average loss Recognize     : 0.922302
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.401136

= T-SNE...
T-SNE was finished!
= T-SNE time is 31.845556497573853 sec. =
Valid knn accuracy drums     : 93.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.491199016571045 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9924821853637695 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.183933734893799 sec. =
Valid knn accuracy guitar    : 61.38392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.77921724319458 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 58.647257392852595%

                                                                      [AEpoch 57: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.873, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00515, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00515, Train/loss_recog_epoch=0.905]Epoch 57: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.873, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204935, 0.205673, 0.205397, 0.221156
Train average loss UNet                 (all)                : 0.837160

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001925, 3.076254, 5.797919
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009686, 2.811296, 4.485704
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007122, 2.959221, 4.693801
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004738, 3.058344, 5.052307
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003781, 3.370203, 5.674186
Train average loss all      (Triplet)                 : 0.005492

== Recognize ==
Train average loss Recognize     : 0.908293
Train average accuracy drums     : 49.994999 %
Train average accuracy bass      : 49.049999 %
Train average accuracy piano     : 50.330002 %
Train average accuracy guitar    : 49.860001 %
Train average accuracy residuals : 49.649998 %

== Train average loss all : 0.005492

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.873, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.873, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0292, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=0.873, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00412, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00412, Train/loss_recog_step=0.847, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.00412, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00412, Train/loss_recog_step=0.847, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]    Epoch 58:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.919, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.906, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.919, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.906, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.861, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.861, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00134, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=0.860, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00134, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=0.860, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.977, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]    Epoch 58: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.977, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.842, Valid/loss_all_epoch=0.401, Valid/loss_unet_all_epoch=0.821, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.37it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199185, 0.199493, 0.201019, 0.234793
Valid average loss UNet                 (all)                : 0.834490

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062962, 3.383327, 5.974429
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.652738, 3.219944, 3.215085
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.630246, 4.103702, 4.101458
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.225416, 3.579651, 4.489021
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.522679, 3.762840, 4.256629
Valid average loss all      (Triplet)                 : 0.419163

== Recognize ==
Valid average loss Recognize     : 0.929041
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.419163

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.743367910385132 sec. =
Valid knn accuracy drums     : 95.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.698650121688843 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.27896499633789 sec. =
Valid knn accuracy piano     : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6058030128479 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.647854328155518 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 56.53900202182109%

                                                                      [AEpoch 58: 100%|██████████| 313/313 [05:27<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00549, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00549, Train/loss_recog_epoch=0.908]Epoch 58: 100%|██████████| 313/313 [05:27<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204565, 0.205318, 0.205032, 0.222660
Train average loss UNet                 (all)                : 0.837575

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001061, 3.101388, 5.870067
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006853, 2.753751, 4.444231
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005625, 2.925703, 4.640139
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003923, 3.050860, 5.078482
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003711, 3.300077, 5.552635
Train average loss all      (Triplet)                 : 0.004326

== Recognize ==
Train average loss Recognize     : 0.907055
Train average accuracy drums     : 49.334999 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 49.990002 %
Train average accuracy guitar    : 49.865002 %
Train average accuracy residuals : 50.230003 %

== Train average loss all : 0.004326

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=0.896, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=0.896, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]  Epoch 59:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00765, Train/loss_recog_step=0.920, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.00765, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00765, Train/loss_recog_step=0.920, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]    Epoch 59:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.842, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00297, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.958, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00297, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.958, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.834, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.29it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.45it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199706, 0.199948, 0.201528, 0.226425
Valid average loss UNet                 (all)                : 0.827606

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073435, 3.301788, 6.077896
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.625990, 3.235185, 3.217827
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.701847, 4.160056, 4.130950
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242971, 3.809086, 4.651423
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.620883, 3.934272, 4.356987
Valid average loss all      (Triplet)                 : 0.450885

== Recognize ==
Valid average loss Recognize     : 0.926459
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.450885

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.803854465484619 sec. =
Valid knn accuracy drums     : 94.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.207619428634644 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.933922290802002 sec. =
Valid knn accuracy piano     : 47.265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.710712432861328 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.578618288040161 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 58.62920671982296%

                                                                      [AEpoch 59: 100%|██████████| 313/313 [05:31<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.907]Epoch 59: 100%|██████████| 313/313 [05:31<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204805, 0.205563, 0.205289, 0.222390
Train average loss UNet                 (all)                : 0.838047

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000603, 3.114565, 5.938053
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006535, 2.809532, 4.518879
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004959, 2.960001, 4.715351
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005958, 3.110922, 5.138155
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004288, 3.386727, 5.693010
Train average loss all      (Triplet)                 : 0.004540

== Recognize ==
Train average loss Recognize     : 0.913213
Train average accuracy drums     : 50.195004 %
Train average accuracy bass      : 49.875000 %
Train average accuracy piano     : 49.584999 %
Train average accuracy guitar    : 50.094997 %
Train average accuracy residuals : 50.120003 %

== Train average loss all : 0.004540

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=0.918, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=0.918, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.939, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]  Epoch 60:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.939, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0023, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.865, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0023, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.865, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00931, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.00931, Train/loss_recog_step=0.965, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00931, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.00931, Train/loss_recog_step=0.965, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.923, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]  Epoch 60: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.923, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.910, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.559, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.586, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.63it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198233, 0.198653, 0.200008, 0.228268
Valid average loss UNet                 (all)                : 0.825162

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.044831, 3.048330, 5.575042
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.679850, 3.203613, 3.100305
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.889025, 4.225390, 4.053391
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.244429, 3.657370, 4.511563
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.509909, 3.934659, 4.418318
Valid average loss all      (Triplet)                 : 0.468149

== Recognize ==
Valid average loss Recognize     : 0.914717
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.468149

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.840489625930786 sec. =
Valid knn accuracy drums     : 92.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3818604946136475 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.945997476577759 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.602452039718628 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.741118431091309 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 56.72653218975976%

                                                                      [AEpoch 60: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.910, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.913]Epoch 60: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.910, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204751, 0.205520, 0.205247, 0.222163
Train average loss UNet                 (all)                : 0.837681

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000704, 3.108468, 5.897798
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007557, 2.861362, 4.594370
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007190, 3.008492, 4.781441
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005002, 3.133898, 5.209148
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003225, 3.380752, 5.723587
Train average loss all      (Triplet)                 : 0.004861

== Recognize ==
Train average loss Recognize     : 0.912658
Train average accuracy drums     : 50.209999 %
Train average accuracy bass      : 49.834999 %
Train average accuracy piano     : 49.794998 %
Train average accuracy guitar    : 49.529999 %
Train average accuracy residuals : 50.080002 %

== Train average loss all : 0.004861

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.910, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.910, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=0.910, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.915, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.915, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.000962, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.000962, Train/loss_recog_step=0.927, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000962, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.000962, Train/loss_recog_step=0.927, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]      Epoch 61:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.879, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00917, Train/loss_recog_step=0.927, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00917, Train/loss_recog_step=0.927, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0049, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=0.883, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]  Epoch 61:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.0049, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=0.883, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000771, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.000771, Train/loss_recog_step=0.890, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000771, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.000771, Train/loss_recog_step=0.890, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.637, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.637, Valid/loss_recog_step=0.827, Valid/loss_all_epoch=0.468, Valid/loss_unet_all_epoch=0.825, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=0.915, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.16it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.03it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198188, 0.198687, 0.200022, 0.227471
Valid average loss UNet                 (all)                : 0.824369

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041557, 3.234044, 5.889389
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.521000, 3.207628, 3.375929
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.844421, 4.187566, 4.156674
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.190324, 3.754493, 4.658310
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.702233, 4.298400, 4.638312
Valid average loss all      (Triplet)                 : 0.455099

== Recognize ==
Valid average loss Recognize     : 0.911381
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.455099

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.690719127655029 sec. =
Valid knn accuracy drums     : 91.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.346311569213867 sec. =
Valid knn accuracy bass      : 23.387096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.732301235198975 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.209438800811768 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6566526889801025 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 55.99973019617129%

                                                                      [AEpoch 61: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00486, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00486, Train/loss_recog_epoch=0.913]Epoch 61: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204589, 0.205342, 0.205071, 0.221901
Train average loss UNet                 (all)                : 0.836904

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001210, 3.186936, 6.102706
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006935, 2.901708, 4.662742
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006003, 2.989897, 4.789250
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005722, 3.189605, 5.309125
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003870, 3.439463, 5.815938
Train average loss all      (Triplet)                 : 0.004820

== Recognize ==
Train average loss Recognize     : 0.915379
Train average accuracy drums     : 50.325001 %
Train average accuracy bass      : 49.915001 %
Train average accuracy piano     : 50.325001 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 49.849998 %

== Train average loss all : 0.004820

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000822, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000822, Train/loss_recog_step=0.906, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000822, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000822, Train/loss_recog_step=0.906, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]      Epoch 62:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.886, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.980, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.886, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.980, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00842, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00842, Train/loss_recog_step=0.904, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.00842, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00842, Train/loss_recog_step=0.904, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.00176, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.899, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00176, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=0.899, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=0.953, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00979, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=0.953, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.886, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=0.828, Valid/loss_all_epoch=0.455, Valid/loss_unet_all_epoch=0.824, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=0.911, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.32it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.62it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199008, 0.199398, 0.200796, 0.231539
Valid average loss UNet                 (all)                : 0.830742

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058254, 3.401464, 6.045876
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.590370, 3.214586, 3.298484
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.732028, 4.181945, 4.049879
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.239086, 3.823283, 4.623317
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.486083, 3.802907, 4.430712
Valid average loss all      (Triplet)                 : 0.404301

== Recognize ==
Valid average loss Recognize     : 0.910190
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.404301

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.826813220977783 sec. =
Valid knn accuracy drums     : 91.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.805571794509888 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.190183877944946 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.759031534194946 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.934975862503052 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 54.84805903467149%

                                                                      [AEpoch 62: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.886, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00482, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00482, Train/loss_recog_epoch=0.915]Epoch 62: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.886, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204461, 0.205231, 0.204948, 0.222706
Train average loss UNet                 (all)                : 0.837347

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000540, 3.139214, 5.991110
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005096, 2.863530, 4.654044
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006434, 3.067147, 4.830460
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004070, 3.135978, 5.237606
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004645, 3.433505, 5.816762
Train average loss all      (Triplet)                 : 0.004151

== Recognize ==
Train average loss Recognize     : 0.915422
Train average accuracy drums     : 50.335003 %
Train average accuracy bass      : 49.625000 %
Train average accuracy piano     : 50.105000 %
Train average accuracy guitar    : 49.489998 %
Train average accuracy residuals : 49.970001 %

== Train average loss all : 0.004151

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.886, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.886, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.00796, Train/loss_recog_step=0.886, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]    Epoch 63:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00247, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00247, Train/loss_recog_step=1.020, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00247, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.00247, Train/loss_recog_step=1.020, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]    Epoch 63:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00269, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=0.893, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00269, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=0.893, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0054, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0054, Train/loss_recog_step=0.897, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]  Epoch 63:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0054, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0054, Train/loss_recog_step=0.897, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00138, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=0.934, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00138, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=0.934, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.495, Valid/loss_unet_all_step=0.812, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.404, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.52it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.42it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.98it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199439, 0.199679, 0.201248, 0.226140
Valid average loss UNet                 (all)                : 0.826507

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051681, 3.348521, 5.719857
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.622739, 3.231438, 3.199376
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.683624, 3.883820, 3.983688
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.147387, 3.445264, 4.355807
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.440537, 3.835150, 4.423413
Valid average loss all      (Triplet)                 : 0.379076

== Recognize ==
Valid average loss Recognize     : 0.879948
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.379076

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.761307716369629 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9746315479278564 sec. =
Valid knn accuracy bass      : 38.306451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.640949487686157 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.81067156791687 sec. =
Valid knn accuracy guitar    : 57.14285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.517848014831543 sec. =
Valid knn accuracy residuals : 72.72727272727273%

Valid knn accuracy average   : 60.08979999225878%

                                                                      [AEpoch 63: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00415, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00415, Train/loss_recog_epoch=0.915]Epoch 63: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204469, 0.205239, 0.204959, 0.221460
Train average loss UNet                 (all)                : 0.836126

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002182, 3.185109, 6.065225
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010930, 2.897199, 4.640009
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004932, 3.047868, 4.848891
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004186, 3.173050, 5.306987
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005597, 3.486014, 5.875023
Train average loss all      (Triplet)                 : 0.005731

== Recognize ==
Train average loss Recognize     : 0.919745
Train average accuracy drums     : 49.829998 %
Train average accuracy bass      : 49.950001 %
Train average accuracy piano     : 49.865002 %
Train average accuracy guitar    : 50.045002 %
Train average accuracy residuals : 50.015003 %

== Train average loss all : 0.005731

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.858, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.841, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.858, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0052, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=0.902, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0052, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=0.902, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=0.902, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.882, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=0.902, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]  Epoch 64:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.856, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.897, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.897, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.379, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.880, Valid/knn_avr=0.601, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198630, 0.198948, 0.200465, 0.231815
Valid average loss UNet                 (all)                : 0.829858

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059219, 3.646417, 6.263247
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.637820, 3.575081, 3.628148
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.701539, 4.441425, 4.512411
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.226998, 3.989940, 5.080843
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.525562, 4.225119, 4.827232
Valid average loss all      (Triplet)                 : 0.422123

== Recognize ==
Valid average loss Recognize     : 0.887791
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 57.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.422123

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.716105222702026 sec. =
Valid knn accuracy drums     : 92.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.386252164840698 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.968440532684326 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.774552345275879 sec. =
Valid knn accuracy guitar    : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.729953765869141 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 58.81414059511667%

                                                                      [AEpoch 64: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00573, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00573, Train/loss_recog_epoch=0.920]Epoch 64: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204743, 0.205480, 0.205216, 0.221255
Train average loss UNet                 (all)                : 0.836693

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001077, 3.191737, 6.102093
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005893, 2.950768, 4.777872
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003664, 3.025617, 4.842766
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004177, 3.173773, 5.331676
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003893, 3.464322, 5.837948
Train average loss all      (Triplet)                 : 0.003714

== Recognize ==
Train average loss Recognize     : 0.919987
Train average accuracy drums     : 50.110001 %
Train average accuracy bass      : 49.869999 %
Train average accuracy piano     : 50.285000 %
Train average accuracy guitar    : 50.054996 %
Train average accuracy residuals : 49.805000 %

== Train average loss all : 0.003714

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.862, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.862, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=0.980, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.00463, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=0.980, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  48%|████▊     | 150/313 [02:07<02:18,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]    Epoch 65:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.878, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  64%|██████▍   | 200/313 [02:47<01:34,  1.19it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00621, Train/loss_recog_step=0.886, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  80%|███████▉  | 250/313 [03:30<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00621, Train/loss_recog_step=0.886, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=0.883, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]  Epoch 65:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0209, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=0.883, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00032, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00032, Train/loss_recog_step=0.971, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00032, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00032, Train/loss_recog_step=0.971, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.464, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.830, Valid/loss_triplet_all_epoch=0.422, Valid/loss_recog_epoch=0.888, Valid/knn_avr=0.588, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.63it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198286, 0.198674, 0.200134, 0.220657
Valid average loss UNet                 (all)                : 0.817751

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069285, 3.255030, 5.960557
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.634298, 3.428008, 3.477893
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.692194, 4.288424, 4.436851
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.198527, 3.749121, 4.741318
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.572035, 3.869586, 4.319306
Valid average loss all      (Triplet)                 : 0.423605

== Recognize ==
Valid average loss Recognize     : 0.964052
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.423605

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.915462255477905 sec. =
Valid knn accuracy drums     : 89.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.44658350944519 sec. =
Valid knn accuracy bass      : 35.685483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.795636415481567 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.751907825469971 sec. =
Valid knn accuracy guitar    : 61.60714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.649643659591675 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 59.47044481202528%

                                                                      [AEpoch 65: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=0.920]Epoch 65: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204436, 0.205188, 0.204907, 0.221817
Train average loss UNet                 (all)                : 0.836348

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000609, 3.238940, 6.238339
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005609, 2.971626, 4.794556
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004827, 3.103679, 4.924510
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007183, 3.277233, 5.417924
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004976, 3.548407, 5.945201
Train average loss all      (Triplet)                 : 0.004751

== Recognize ==
Train average loss Recognize     : 0.925695
Train average accuracy drums     : 49.980000 %
Train average accuracy bass      : 49.450001 %
Train average accuracy piano     : 50.795002 %
Train average accuracy guitar    : 49.645000 %
Train average accuracy residuals : 49.945000 %

== Train average loss all : 0.004751

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.914, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.914, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]  Epoch 66:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.849, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000762, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000762, Train/loss_recog_step=0.921, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000762, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000762, Train/loss_recog_step=0.921, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.953, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]  Epoch 66:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.953, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=6.55e-5, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=6.55e-5, Train/loss_recog_step=0.947, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=6.55e-5, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=6.55e-5, Train/loss_recog_step=0.947, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.537, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=0.982, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.818, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.595, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199166, 0.199405, 0.200916, 0.231379
Valid average loss UNet                 (all)                : 0.830866

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068887, 3.369002, 5.926775
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.669056, 3.546805, 3.549639
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.719046, 4.567234, 4.685629
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.321989, 3.981620, 4.843481
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.514486, 4.134990, 4.759438
Valid average loss all      (Triplet)                 : 0.467341

== Recognize ==
Valid average loss Recognize     : 0.927736
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.467341

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.839492321014404 sec. =
Valid knn accuracy drums     : 91.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.616240501403809 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.505948066711426 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.007034063339233 sec. =
Valid knn accuracy guitar    : 56.69642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6439149379730225 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 56.913697211799416%

                                                                      [AEpoch 66: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00475, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00475, Train/loss_recog_epoch=0.926]Epoch 66: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204649, 0.205417, 0.205147, 0.221845
Train average loss UNet                 (all)                : 0.837058

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000420, 3.149506, 5.982337
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005262, 2.974029, 4.833900
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007098, 3.098727, 4.912751
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006041, 3.246726, 5.392114
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003721, 3.444573, 5.820379
Train average loss all      (Triplet)                 : 0.004536

== Recognize ==
Train average loss Recognize     : 0.926358
Train average accuracy drums     : 49.814999 %
Train average accuracy bass      : 49.790001 %
Train average accuracy piano     : 50.180000 %
Train average accuracy guitar    : 50.080002 %
Train average accuracy residuals : 49.695000 %

== Train average loss all : 0.004536

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=1.020, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=1.020, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]    Epoch 67:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.989, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.989, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=0.958, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.0033, Train/loss_unet_all_step=0.852, Train/loss_triplet_all_step=0.0033, Train/loss_recog_step=0.958, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=0.904, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67: 100%|██████████| 313/313 [04:16<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=0.904, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67: 100%|██████████| 313/313 [04:16<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.877, Valid/loss_all_step=0.618, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.618, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198734, 0.199027, 0.200557, 0.218734
Valid average loss UNet                 (all)                : 0.817052

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059262, 3.364152, 5.461239
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.529313, 3.287134, 3.422775
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.737435, 4.479880, 4.516067
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.258532, 4.013867, 4.913094
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.690397, 4.060591, 4.393039
Valid average loss all      (Triplet)                 : 0.420241

== Recognize ==
Valid average loss Recognize     : 1.011782
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.420241

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.021168947219849 sec. =
Valid knn accuracy drums     : 92.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.90887975692749 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.606693744659424 sec. =
Valid knn accuracy piano     : 43.5546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.658060073852539 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.917846441268921 sec. =
Valid knn accuracy residuals : 74.77272727272727%

Valid knn accuracy average   : 59.3084778453489%

                                                                      [AEpoch 67: 100%|██████████| 313/313 [05:31<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.877, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00454, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00454, Train/loss_recog_epoch=0.926]Epoch 67: 100%|██████████| 313/313 [05:31<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.877, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204569, 0.205332, 0.205054, 0.221203
Train average loss UNet                 (all)                : 0.836158

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000778, 3.208140, 6.154180
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008918, 3.082848, 4.935414
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006669, 3.167753, 5.037538
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003451, 3.297427, 5.484087
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002187, 3.495167, 5.898467
Train average loss all      (Triplet)                 : 0.004437

== Recognize ==
Train average loss Recognize     : 0.936074
Train average accuracy drums     : 50.024998 %
Train average accuracy bass      : 50.459999 %
Train average accuracy piano     : 49.454998 %
Train average accuracy guitar    : 49.810001 %
Train average accuracy residuals : 49.779999 %

== Train average loss all : 0.004437

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.877, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.877, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=0.877, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]    Epoch 68:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  64%|██████▍   | 200/313 [02:49<01:36,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.868, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  64%|██████▍   | 200/313 [02:49<01:36,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.963, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.963, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00211, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.946, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.00211, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.946, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]    Epoch 68: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.817, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.593, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199013, 0.199305, 0.200819, 0.214550
Valid average loss UNet                 (all)                : 0.813687

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047541, 3.583316, 6.218087
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.571302, 3.490629, 3.566762
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.696978, 4.456357, 4.546798
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.241328, 4.079147, 5.190478
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.548358, 4.005288, 4.569770
Valid average loss all      (Triplet)                 : 0.387828

== Recognize ==
Valid average loss Recognize     : 0.979790
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 43.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.387828

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.9279608726501465 sec. =
Valid knn accuracy drums     : 89.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.636589527130127 sec. =
Valid knn accuracy bass      : 30.443548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7868571281433105 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.931272506713867 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.754583358764648 sec. =
Valid knn accuracy residuals : 72.04545454545455%

Valid knn accuracy average   : 58.420840182783564%

                                                                      [AEpoch 68: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00444, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=0.936]Epoch 68: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204515, 0.205272, 0.205000, 0.221978
Train average loss UNet                 (all)                : 0.836765

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001174, 3.270476, 6.309559
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006064, 3.042922, 4.905461
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006564, 3.199208, 5.136696
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003216, 3.297533, 5.548878
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003155, 3.506673, 5.915063
Train average loss all      (Triplet)                 : 0.003974

== Recognize ==
Train average loss Recognize     : 0.938594
Train average accuracy drums     : 50.075001 %
Train average accuracy bass      : 49.410000 %
Train average accuracy piano     : 49.654999 %
Train average accuracy guitar    : 50.160004 %
Train average accuracy residuals : 50.440002 %

== Train average loss all : 0.003974

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00648, Train/loss_recog_step=0.845, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00648, Train/loss_recog_step=0.845, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]    Epoch 69:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.847, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00547, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.00547, Train/loss_recog_step=0.993, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00547, Train/loss_unet_all_step=0.898, Train/loss_triplet_all_step=0.00547, Train/loss_recog_step=0.993, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]    Epoch 69:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.864, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.848, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.864, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00525, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00525, Train/loss_recog_step=0.951, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00525, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.00525, Train/loss_recog_step=0.951, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.402, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.814, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.584, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.68it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199082, 0.199368, 0.200824, 0.219602
Valid average loss UNet                 (all)                : 0.818876

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067781, 3.521249, 6.051956
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.711949, 3.633381, 3.506581
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.785640, 4.720992, 4.668249
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.294398, 4.128784, 5.182628
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.588249, 3.967651, 4.455610
Valid average loss all      (Triplet)                 : 0.461672

== Recognize ==
Valid average loss Recognize     : 0.941707
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.461672

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.028126239776611 sec. =
Valid knn accuracy drums     : 90.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.470610857009888 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.175220251083374 sec. =
Valid knn accuracy piano     : 48.2421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.733520984649658 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.679286241531372 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 57.381157532422%

                                                                      [AEpoch 69: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00397, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=0.939]Epoch 69: 100%|██████████| 313/313 [05:38<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204352, 0.205123, 0.204863, 0.222682
Train average loss UNet                 (all)                : 0.837019

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000633, 3.271187, 6.355279
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005281, 3.055759, 4.913544
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006872, 3.202985, 5.115144
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006378, 3.373316, 5.599758
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003656, 3.517045, 5.944300
Train average loss all      (Triplet)                 : 0.004589

== Recognize ==
Train average loss Recognize     : 0.935261
Train average accuracy drums     : 50.875004 %
Train average accuracy bass      : 49.895000 %
Train average accuracy piano     : 49.974998 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 50.110001 %

== Train average loss all : 0.004589

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.00529, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00529, Train/loss_recog_step=0.968, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00529, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.00529, Train/loss_recog_step=0.968, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.926, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]  Epoch 70:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.926, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0025, Train/loss_unet_all_step=0.890, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.935, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0025, Train/loss_unet_all_step=0.890, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.935, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.936, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.936, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.886, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00398, Train/loss_unet_all_step=0.860, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.886, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00711, Train/loss_recog_step=0.956, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00711, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00711, Train/loss_recog_step=0.956, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.819, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.574, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199356, 0.199706, 0.201079, 0.227204
Valid average loss UNet                 (all)                : 0.827345

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054761, 3.407429, 5.855017
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.754608, 3.695602, 3.588687
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.830446, 4.487668, 4.471189
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.254871, 3.878242, 4.955344
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.835167, 4.232949, 4.448353
Valid average loss all      (Triplet)                 : 0.500702

== Recognize ==
Valid average loss Recognize     : 1.070987
Valid average accuracy drums     : 43.000000 %
Valid average accuracy bass      : 42.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.500702

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.789641618728638 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.310721397399902 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.891221761703491 sec. =
Valid knn accuracy piano     : 49.609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.743250131607056 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.150362491607666 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 56.00071236179669%

                                                                      [AEpoch 70: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00459, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00459, Train/loss_recog_epoch=0.935]Epoch 70: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204477, 0.205245, 0.204967, 0.221981
Train average loss UNet                 (all)                : 0.836670

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000713, 3.202580, 6.177127
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008763, 3.014683, 4.839382
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006100, 3.218191, 5.131647
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002853, 3.273128, 5.493893
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002648, 3.512550, 5.990437
Train average loss all      (Triplet)                 : 0.004274

== Recognize ==
Train average loss Recognize     : 0.937235
Train average accuracy drums     : 50.204998 %
Train average accuracy bass      : 50.535000 %
Train average accuracy piano     : 50.225002 %
Train average accuracy guitar    : 49.980000 %
Train average accuracy residuals : 49.919998 %

== Train average loss all : 0.004274

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.00142, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00142, Train/loss_recog_step=0.915, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00142, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00142, Train/loss_recog_step=0.915, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=7.81e-5, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=7.81e-5, Train/loss_recog_step=0.955, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=7.81e-5, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=7.81e-5, Train/loss_recog_step=0.955, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.886, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]    Epoch 71:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.886, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  64%|██████▍   | 200/313 [02:47<01:34,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  80%|███████▉  | 250/313 [03:27<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00191, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=0.848, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00191, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=0.848, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71:  96%|█████████▌| 300/313 [04:07<00:10,  1.21it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00436, Train/loss_recog_step=0.976, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.00436, Train/loss_recog_step=0.976, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71: 100%|██████████| 313/313 [04:15<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.927, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.501, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198759, 0.199127, 0.200569, 0.236171
Valid average loss UNet                 (all)                : 0.834626

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056766, 3.580353, 5.825463
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.662470, 3.722636, 3.672581
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.890983, 4.661992, 4.494870
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.217098, 3.844928, 5.063519
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.600822, 4.376246, 5.008169
Valid average loss all      (Triplet)                 : 0.469742

== Recognize ==
Valid average loss Recognize     : 0.928824
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.469742

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.123714923858643 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.128919124603271 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.554073095321655 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.9533843994140625 sec. =
Valid knn accuracy guitar    : 56.69642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.726054906845093 sec. =
Valid knn accuracy residuals : 73.18181818181819%

Valid knn accuracy average   : 57.20326374405749%

                                                                      [AEpoch 71: 100%|██████████| 313/313 [05:26<00:00,  0.96it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.927, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00427, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=0.937]Epoch 71: 100%|██████████| 313/313 [05:26<00:00,  0.96it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.927, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204570, 0.205354, 0.205087, 0.222241
Train average loss UNet                 (all)                : 0.837252

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001381, 3.299828, 6.341828
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006107, 3.078593, 5.037166
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007128, 3.273175, 5.210137
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004170, 3.341711, 5.553308
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002973, 3.557546, 6.049571
Train average loss all      (Triplet)                 : 0.004461

== Recognize ==
Train average loss Recognize     : 0.942558
Train average accuracy drums     : 49.759998 %
Train average accuracy bass      : 49.980000 %
Train average accuracy piano     : 50.080002 %
Train average accuracy guitar    : 50.835003 %
Train average accuracy residuals : 50.285000 %

== Train average loss all : 0.004461

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.927, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.927, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.927, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.946, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.946, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]    Epoch 72:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0285, Train/loss_recog_step=0.948, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.844, Train/loss_triplet_all_step=0.0285, Train/loss_recog_step=0.948, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.971, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.971, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.804, Valid/loss_triplet_all_step=0.567, Valid/loss_recog_step=0.839, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.572, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198952, 0.199275, 0.200752, 0.228939
Valid average loss UNet                 (all)                : 0.827917

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077066, 3.731273, 6.162507
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.615786, 3.644320, 3.704517
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.770735, 4.630800, 4.476415
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.345246, 4.222806, 5.115460
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.457155, 4.156547, 4.876097
Valid average loss all      (Triplet)                 : 0.436683

== Recognize ==
Valid average loss Recognize     : 0.870229
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.436683

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.894520998001099 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8406922817230225 sec. =
Valid knn accuracy bass      : 23.18548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.703292369842529 sec. =
Valid knn accuracy piano     : 45.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.855503082275391 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.943382978439331 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 55.559761405757634%

                                                                      [AEpoch 72: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00446, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00446, Train/loss_recog_epoch=0.943]Epoch 72: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204403, 0.205161, 0.204887, 0.221569
Train average loss UNet                 (all)                : 0.836020

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000968, 3.387892, 6.514215
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005477, 3.127182, 5.063230
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003305, 3.303452, 5.315352
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007115, 3.471558, 5.736689
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002890, 3.654309, 6.190912
Train average loss all      (Triplet)                 : 0.003934

== Recognize ==
Train average loss Recognize     : 0.947634
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 49.825001 %
Train average accuracy piano     : 50.169998 %
Train average accuracy guitar    : 50.024998 %
Train average accuracy residuals : 49.904999 %

== Train average loss all : 0.003934

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000449, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000449, Train/loss_recog_step=0.990, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000449, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.000449, Train/loss_recog_step=0.990, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00944, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00944, Train/loss_recog_step=0.947, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]  Epoch 73:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00944, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.00944, Train/loss_recog_step=0.947, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.0083, Train/loss_recog_step=0.916, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]  Epoch 73:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.0083, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.0083, Train/loss_recog_step=0.916, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]  Epoch 73:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.846, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.0002, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0002, Train/loss_recog_step=0.897, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0002, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.0002, Train/loss_recog_step=0.897, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.010, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.198821, 0.199253, 0.200596, 0.221819
Valid average loss UNet                 (all)                : 0.820489

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080012, 3.561655, 6.116765
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.716219, 3.719861, 3.607906
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.872187, 4.710587, 4.521128
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.202052, 4.093236, 5.292882
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.395238, 4.249674, 5.024814
Valid average loss all      (Triplet)                 : 0.432894

== Recognize ==
Valid average loss Recognize     : 0.927206
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.432894

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.957482576370239 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.315930128097534 sec. =
Valid knn accuracy bass      : 32.66129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.782322645187378 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.710742473602295 sec. =
Valid knn accuracy guitar    : 56.91964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.788182735443115 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 57.63271331578659%

                                                                      [AEpoch 73: 100%|██████████| 313/313 [05:28<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.010, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.948]Epoch 73: 100%|██████████| 313/313 [05:28<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.010, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204520, 0.205282, 0.205006, 0.222366
Train average loss UNet                 (all)                : 0.837174

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001193, 3.424815, 6.642186
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005386, 3.148710, 5.110186
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006219, 3.371948, 5.376740
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005787, 3.561698, 5.909508
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003110, 3.706837, 6.313319
Train average loss all      (Triplet)                 : 0.004325

== Recognize ==
Train average loss Recognize     : 0.958763
Train average accuracy drums     : 50.239998 %
Train average accuracy bass      : 49.149998 %
Train average accuracy piano     : 49.935001 %
Train average accuracy guitar    : 49.974998 %
Train average accuracy residuals : 50.265003 %

== Train average loss all : 0.004325

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.010, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.010, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.010, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00908, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00908, Train/loss_recog_step=0.985, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00908, Train/loss_unet_all_step=0.831, Train/loss_triplet_all_step=0.00908, Train/loss_recog_step=0.985, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=1.060, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]  Epoch 74:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.823, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=1.060, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.876, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]  Epoch 74:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.876, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.962, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.962, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00688, Train/loss_recog_step=0.936, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00688, Train/loss_unet_all_step=0.819, Train/loss_triplet_all_step=0.00688, Train/loss_recog_step=0.936, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.294, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.294, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.820, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.576, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.29it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.62it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199839, 0.200138, 0.201684, 0.233182
Valid average loss UNet                 (all)                : 0.834843

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096570, 3.500268, 6.149802
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.695679, 3.764160, 3.680631
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.995446, 4.823576, 4.609721
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.216918, 4.064309, 5.171325
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.711800, 4.425755, 4.748086
Valid average loss all      (Triplet)                 : 0.554690

== Recognize ==
Valid average loss Recognize     : 0.966928
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.554690

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.810242414474487 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4282755851745605 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.008634567260742 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.021933794021606 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.593337535858154 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 54.333213562822166%

                                                                      [AEpoch 74: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00433, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00433, Train/loss_recog_epoch=0.959]Epoch 74: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204516, 0.205272, 0.205007, 0.222282
Train average loss UNet                 (all)                : 0.837077

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000928, 3.435844, 6.590793
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006881, 3.245151, 5.217393
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007099, 3.414725, 5.434868
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005402, 3.504919, 5.860739
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003534, 3.701158, 6.287773
Train average loss all      (Triplet)                 : 0.004758

== Recognize ==
Train average loss Recognize     : 0.963308
Train average accuracy drums     : 50.625004 %
Train average accuracy bass      : 49.649998 %
Train average accuracy piano     : 50.015003 %
Train average accuracy guitar    : 50.220001 %
Train average accuracy residuals : 49.924999 %

== Train average loss all : 0.004758

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.973, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00375, Train/loss_unet_all_step=0.828, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.973, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00183, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=1.030, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00183, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=1.030, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00156, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.00156, Train/loss_recog_step=0.898, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00156, Train/loss_unet_all_step=0.877, Train/loss_triplet_all_step=0.00156, Train/loss_recog_step=0.898, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  64%|██████▍   | 200/313 [02:48<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00142, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00142, Train/loss_recog_step=0.889, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  80%|███████▉  | 250/313 [03:30<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.00142, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00142, Train/loss_recog_step=0.889, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  80%|███████▉  | 250/313 [03:30<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]    Epoch 75:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75: 100%|██████████| 313/313 [04:17<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=1.030, Valid/loss_all_step=0.881, Valid/loss_unet_all_step=0.815, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.555, Valid/loss_unet_all_epoch=0.835, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.200197, 0.200414, 0.201966, 0.225364
Valid average loss UNet                 (all)                : 0.827942

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077012, 3.470010, 6.262719
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.722233, 3.730858, 3.584026
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.051794, 4.793789, 4.376080
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.255362, 4.081592, 5.070966
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.833702, 4.124448, 4.338998
Valid average loss all      (Triplet)                 : 0.579543

== Recognize ==
Valid average loss Recognize     : 1.028053
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 42.500000 %

== Valid average loss all : 0.579543

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.733652830123901 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.704923391342163 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.092530012130737 sec. =
Valid knn accuracy piano     : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.01698923110962 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.781125783920288 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 54.85372192674085%

                                                                      [AEpoch 75: 100%|██████████| 313/313 [05:27<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=1.030, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00476, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=0.963]Epoch 75: 100%|██████████| 313/313 [05:27<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=1.030, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204574, 0.205322, 0.205059, 0.221623
Train average loss UNet                 (all)                : 0.836578

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000880, 3.436443, 6.666883
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005857, 3.200255, 5.197742
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007242, 3.337883, 5.368929
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004199, 3.467085, 5.858916
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002411, 3.637852, 6.128854
Train average loss all      (Triplet)                 : 0.004114

== Recognize ==
Train average loss Recognize     : 0.965415
Train average accuracy drums     : 49.465000 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 49.825001 %
Train average accuracy guitar    : 49.794998 %
Train average accuracy residuals : 50.809998 %

== Train average loss all : 0.004114

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=1.030, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=1.030, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00775, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=1.030, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0039, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=0.990, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]  Epoch 76:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.0039, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=0.990, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]  Epoch 76:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.994, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00695, Train/loss_unet_all_step=0.889, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=0.994, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.976, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]  Epoch 76:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.818, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.976, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]  Epoch 76:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.835, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.908, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.908, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.580, Valid/loss_unet_all_epoch=0.828, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:04<00:00,  0.94it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199830, 0.200048, 0.201630, 0.229592
Valid average loss UNet                 (all)                : 0.831099

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081598, 3.474245, 5.838066
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.524885, 3.517933, 3.723166
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.060773, 4.631292, 4.291663
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.306357, 4.058895, 4.888466
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.635912, 4.175121, 4.720884
Valid average loss all      (Triplet)                 : 0.510001

== Recognize ==
Valid average loss Recognize     : 0.992881
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.510001

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.073527812957764 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.41368055343628 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.34919285774231 sec. =
Valid knn accuracy piano     : 44.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.7878663539886475 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.908323049545288 sec. =
Valid knn accuracy residuals : 71.36363636363636%

Valid knn accuracy average   : 55.601717893344386%

                                                                      [AEpoch 76: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.965]Epoch 76: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204725, 0.205505, 0.205206, 0.223062
Train average loss UNet                 (all)                : 0.838499

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000427, 3.340094, 6.459625
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006008, 3.187806, 5.120787
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005769, 3.339854, 5.347292
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002389, 3.416889, 5.709172
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002924, 3.676399, 6.212849
Train average loss all      (Triplet)                 : 0.003611

== Recognize ==
Train average loss Recognize     : 0.965739
Train average accuracy drums     : 50.209999 %
Train average accuracy bass      : 49.779999 %
Train average accuracy piano     : 50.400002 %
Train average accuracy guitar    : 50.349998 %
Train average accuracy residuals : 50.555004 %

== Train average loss all : 0.003611

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=1.000, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=1.000, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00976, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=1.030, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00976, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00976, Train/loss_recog_step=1.030, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00138, Train/loss_unet_all_step=0.897, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=0.914, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00138, Train/loss_unet_all_step=0.897, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=0.914, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=0.962, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]  Epoch 77:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=0.962, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00347, Train/loss_recog_step=0.916, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00347, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.00347, Train/loss_recog_step=0.916, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00183, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=0.917, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00183, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=0.917, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.739, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.831, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.12it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199457, 0.199909, 0.201284, 0.232096
Valid average loss UNet                 (all)                : 0.832746

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057887, 3.484803, 6.023432
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.687010, 3.577369, 3.500374
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.946472, 4.633119, 4.395661
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.243669, 4.012950, 5.119061
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.829317, 4.219201, 4.470638
Valid average loss all      (Triplet)                 : 0.497397

== Recognize ==
Valid average loss Recognize     : 0.973689
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.497397

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.749133825302124 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.26408338546753 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.670062065124512 sec. =
Valid knn accuracy piano     : 48.2421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.89008903503418 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.649826765060425 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 56.52043095184969%

                                                                      [AEpoch 77: 100%|██████████| 313/313 [05:31<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00361, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.00361, Train/loss_recog_epoch=0.966]Epoch 77: 100%|██████████| 313/313 [05:31<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]    

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204672, 0.205444, 0.205167, 0.222460
Train average loss UNet                 (all)                : 0.837744

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000533, 3.292325, 6.338831
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007122, 3.117661, 5.057717
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004771, 3.300187, 5.296181
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004011, 3.412430, 5.659927
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002993, 3.629287, 6.107782
Train average loss all      (Triplet)                 : 0.003997

== Recognize ==
Train average loss Recognize     : 0.968051
Train average accuracy drums     : 50.309998 %
Train average accuracy bass      : 50.424999 %
Train average accuracy piano     : 49.829998 %
Train average accuracy guitar    : 50.054996 %
Train average accuracy residuals : 49.610001 %

== Train average loss all : 0.003997

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.826, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.932, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.932, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]    Epoch 78:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.855, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.905, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.967, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.905, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.967, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]  Epoch 78:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.010, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.845, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.010, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78:  96%|█████████▌| 300/313 [04:10<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.931, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.931, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.565, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.20it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.200043, 0.200307, 0.201802, 0.225234
Valid average loss UNet                 (all)                : 0.827386

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065654, 3.611128, 6.080183
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.682144, 3.700320, 3.730098
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.923540, 4.702176, 4.453506
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.265192, 4.012844, 5.108879
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.663912, 4.174584, 4.570798
Valid average loss all      (Triplet)                 : 0.478122

== Recognize ==
Valid average loss Recognize     : 1.011490
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.478122

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.776180267333984 sec. =
Valid knn accuracy drums     : 89.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.433674097061157 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.359103918075562 sec. =
Valid knn accuracy piano     : 45.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.496122598648071 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.602465867996216 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 56.70125558391469%

                                                                      [AEpoch 78: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.004, Train/loss_unet_all_epoch=0.838, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=0.968]Epoch 78: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204632, 0.205396, 0.205114, 0.222325
Train average loss UNet                 (all)                : 0.837467

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001235, 3.387596, 6.460208
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008917, 3.254915, 5.220602
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004734, 3.386713, 5.438851
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002875, 3.490201, 5.809899
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002050, 3.655369, 6.106051
Train average loss all      (Triplet)                 : 0.004095

== Recognize ==
Train average loss Recognize     : 0.972157
Train average accuracy drums     : 50.115002 %
Train average accuracy bass      : 49.924999 %
Train average accuracy piano     : 50.510002 %
Train average accuracy guitar    : 49.935001 %
Train average accuracy residuals : 49.994999 %

== Train average loss all : 0.004095

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.00206, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00206, Train/loss_recog_step=0.982, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00206, Train/loss_unet_all_step=0.833, Train/loss_triplet_all_step=0.00206, Train/loss_recog_step=0.982, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=1.010, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.843, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=1.010, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.926, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]  Epoch 79:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.895, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.926, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00241, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=0.940, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00241, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=0.940, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]    Epoch 79:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.838, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.821, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.827, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.11it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199986, 0.200257, 0.201806, 0.221283
Valid average loss UNet                 (all)                : 0.823332

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053326, 3.625596, 5.942344
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.646884, 3.822884, 3.813864
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.964222, 4.793962, 4.496976
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.214060, 4.280084, 5.142500
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.863884, 4.243236, 4.379158
Valid average loss all      (Triplet)                 : 0.525735

== Recognize ==
Valid average loss Recognize     : 0.976438
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.525735

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.084918022155762 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.508559703826904 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.620507001876831 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.989847898483276 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.800881385803223 sec. =
Valid knn accuracy residuals : 71.81818181818181%

Valid knn accuracy average   : 56.33233940410921%

                                                                      [AEpoch 79: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00409, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00409, Train/loss_recog_epoch=0.972]Epoch 79: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204536, 0.205306, 0.205040, 0.221358
Train average loss UNet                 (all)                : 0.836240

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001391, 3.396255, 6.487912
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007320, 3.266028, 5.262281
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004161, 3.377044, 5.453837
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006932, 3.576602, 5.878925
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002896, 3.801587, 6.384440
Train average loss all      (Triplet)                 : 0.004706

== Recognize ==
Train average loss Recognize     : 0.982479
Train average accuracy drums     : 50.234997 %
Train average accuracy bass      : 49.660000 %
Train average accuracy piano     : 50.225002 %
Train average accuracy guitar    : 49.744999 %
Train average accuracy residuals : 49.639999 %

== Train average loss all : 0.004706

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.832, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.993, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.837, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.993, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000843, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.000843, Train/loss_recog_step=0.991, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000843, Train/loss_unet_all_step=0.888, Train/loss_triplet_all_step=0.000843, Train/loss_recog_step=0.991, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]      Epoch 80:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.959, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0125, Train/loss_unet_all_step=0.854, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=0.959, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.901, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.824, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.901, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.870, Valid/loss_all_step=0.766, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.823, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.71it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199474, 0.199794, 0.201244, 0.238592
Valid average loss UNet                 (all)                : 0.839103

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075912, 3.528818, 5.836937
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.648666, 3.708913, 3.793526
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.854892, 4.549306, 4.484662
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.252192, 4.386233, 5.122487
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.820073, 4.394190, 4.648985
Valid average loss all      (Triplet)                 : 0.482677

== Recognize ==
Valid average loss Recognize     : 0.949184
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 58.499996 %

== Valid average loss all : 0.482677

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.104226589202881 sec. =
Valid knn accuracy drums     : 92.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.96999192237854 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.932793855667114 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.974336624145508 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6334943771362305 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 55.19693829575053%

                                                                      [AEpoch 80: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.870, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00471, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00471, Train/loss_recog_epoch=0.982]Epoch 80: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.870, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204357, 0.205140, 0.204861, 0.221938
Train average loss UNet                 (all)                : 0.836297

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001058, 3.369590, 6.562847
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005464, 3.222698, 5.196402
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003061, 3.389725, 5.466089
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004608, 3.569981, 5.939109
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003531, 3.719057, 6.252185
Train average loss all      (Triplet)                 : 0.003563

== Recognize ==
Train average loss Recognize     : 0.979995
Train average accuracy drums     : 49.700001 %
Train average accuracy bass      : 50.320000 %
Train average accuracy piano     : 49.715000 %
Train average accuracy guitar    : 50.230003 %
Train average accuracy residuals : 50.305004 %

== Train average loss all : 0.003563

Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.870, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]          Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.870, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.851, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.870, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000313, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000313, Train/loss_recog_step=0.985, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000313, Train/loss_unet_all_step=0.827, Train/loss_triplet_all_step=0.000313, Train/loss_recog_step=0.985, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00764, Train/loss_recog_step=0.943, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]  Epoch 81:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00764, Train/loss_unet_all_step=0.836, Train/loss_triplet_all_step=0.00764, Train/loss_recog_step=0.943, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=0.924, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]  Epoch 81:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.866, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=0.924, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]  Epoch 81:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.822, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.850, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.030, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.825, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.030, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81: 100%|██████████| 313/313 [04:18<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.571, Valid/loss_unet_all_step=0.809, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=0.879, Valid/loss_all_epoch=0.483, Valid/loss_unet_all_epoch=0.839, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.22it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.48it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  6.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.199635, 0.200013, 0.201451, 0.232026
Valid average loss UNet                 (all)                : 0.833126

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079205, 3.491430, 5.796224
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.447561, 3.491968, 3.804455
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.907801, 4.607945, 4.530525
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242751, 4.273177, 5.077786
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.837746, 4.472673, 4.675951
Valid average loss all      (Triplet)                 : 0.497662

== Recognize ==
Valid average loss Recognize     : 0.933610
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.497662

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.833158016204834 sec. =
Valid knn accuracy drums     : 90.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.060750961303711 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.698074817657471 sec. =
Valid knn accuracy piano     : 47.8515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.682396173477173 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.596268177032471 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 57.896912880685235%

                                                                      [AEpoch 81: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.836, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.980]Epoch 81: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204643, 0.205390, 0.205124, 0.222258
Train average loss UNet                 (all)                : 0.837415

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000477, 3.361557, 6.427052
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004792, 3.206443, 5.229009
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004241, 3.363606, 5.421777
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005884, 3.562297, 5.969053
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003073, 3.728336, 6.314971
Train average loss all      (Triplet)                 : 0.003683

== Recognize ==
Train average loss Recognize     : 0.984076
Train average accuracy drums     : 49.814999 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 50.220001 %
Train average accuracy guitar    : 50.274998 %
Train average accuracy residuals : 49.919998 %

== Train average loss all : 0.003683

Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]          Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.839, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00521, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.976, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00521, Train/loss_unet_all_step=0.834, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.976, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00519, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00519, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00519, Train/loss_unet_all_step=0.840, Train/loss_triplet_all_step=0.00519, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]    Epoch 82:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.893, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00766, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.981, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00766, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.981, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000649, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000649, Train/loss_recog_step=0.988, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  96%|█████████▌| 300/313 [04:13<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000649, Train/loss_unet_all_step=0.857, Train/loss_triplet_all_step=0.000649, Train/loss_recog_step=0.988, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82:  96%|█████████▌| 300/313 [04:13<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]      Epoch 82: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.830, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=0.734, Valid/loss_all_epoch=0.498, Valid/loss_unet_all_epoch=0.833, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.579, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  6.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  6.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.200054, 0.200205, 0.201823, 0.223812
Valid average loss UNet                 (all)                : 0.825894

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064211, 3.461524, 5.997290
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.489699, 3.525094, 3.747247
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.847720, 4.598137, 4.630336
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.292038, 4.254177, 5.101493
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.725271, 4.464084, 4.901788
Valid average loss all      (Triplet)                 : 0.473237

== Recognize ==
Valid average loss Recognize     : 0.964191
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.473237

= T-SNE...
T-SNE was finished!
= T-SNE time is 6.705314636230469 sec. =
Valid knn accuracy drums     : 88.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.760307312011719 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.97275972366333 sec. =
Valid knn accuracy piano     : 48.828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.64023232460022 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.6650614738464355 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 57.847733021711804%

                                                                      [AEpoch 82: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.629, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.578, Train/loss_all_epoch=0.00368, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00368, Train/loss_recog_epoch=0.984]Epoch 82: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.629, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.578, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.989]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.204572, 0.205344, 0.205057, 0.222386
Train average loss UNet                 (all)                : 0.837359

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000636, 3.339007, 6.355313
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003006, 3.167034, 5.242328
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004165, 3.341528, 5.362638
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003908, 3.548259, 5.989049
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001573, 3.745122, 6.380778
Train average loss all      (Triplet)                 : 0.002652

== Recognize ==
Train average loss Recognize     : 0.989290
Train average accuracy drums     : 50.620003 %
Train average accuracy bass      : 49.654999 %
Train average accuracy piano     : 49.660000 %
Train average accuracy guitar    : 50.054996 %
Train average accuracy residuals : 50.050003 %

== Train average loss all : 0.002652

Epoch 82: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.829, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.629, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.473, Valid/loss_unet_all_epoch=0.826, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.964, Valid/knn_avr=0.578, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.837, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.989]
[2023-11-07 18:48:51,472][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 16/16 [00:09<00:00,  1.77it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:09<00:00,  1.61it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:04<00:00,  3.46it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:02<00:00,  4.69it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:02<00:00,  5.62it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:02<00:00,  5.56it/s]
Test average accuracy drums     :  48.599998 %
Test average accuracy bass      :  49.099998 %
Test average accuracy piano     :  50.099998 %
Test average accuracy guitar    :  49.099998 %
Test average accuracy residuals :  50.800003 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.899507522583008 sec. =
Test knn accuracy drums     : 87.44541484716157%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.221008062362671 sec. =
Test knn accuracy bass      : 21.816168327796234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.757871150970459 sec. =
Test knn accuracy piano     : 27.128953771289538%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.696656227111816 sec. =
Test knn accuracy guitar    : 34.841628959276015%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.337504625320435 sec. =
Test knn accuracy residuals : 56.189451022604956%

Test knn accuracy average   : 45.484323385625665%
Testing DataLoader 5: 100%|██████████| 15/15 [01:25<00:00,  0.18it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.45484322309494… │ 0.45484322309494… │ 0.4548432230949… │
│   Test/knn_bass   │ 0.21816168725490… │ 0.21816168725490… │ 0.2181616872549… │
│  Test/knn_drums   │ 0.874454140663147 │ 0.874454140663147 │ 0.8744541406631… │
│  Test/knn_guitar  │ 0.34841629862785… │ 0.34841629862785… │ 0.3484162986278… │
│  Test/knn_piano   │ 0.27128952741622… │ 0.27128952741622… │ 0.2712895274162… │
│ Test/knn_residua… │ 0.56189453601837… │ 0.56189453601837… │ 0.5618945360183… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.45484322309494… │ 0.45484322309494… │ 0.4548432230949… │
│   Test/knn_bass   │ 0.21816168725490… │ 0.21816168725490… │ 0.2181616872549… │
│  Test/knn_drums   │ 0.874454140663147 │ 0.874454140663147 │ 0.8744541406631… │
│  Test/knn_guitar  │ 0.34841629862785… │ 0.34841629862785… │ 0.3484162986278… │
│  Test/knn_piano   │ 0.27128952741622… │ 0.27128952741622… │ 0.2712895274162… │
│ Test/knn_residua… │ 0.56189453601837… │ 0.56189453601837… │ 0.5618945360183… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-07 18:51:15,176][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-07/11-16-50/checkpoints/epoch_032.ckpt
[2023-11-07 18:51:15,180][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-07/11-16-50
[2023-11-07 18:51:15,183][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 07:34:24

All prosess was Done!
