
=== Using cuda(utils.func). ===

[2023-11-10 10:45:08,198][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-10 10:45:08,205][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 100                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-10 10:45:08,310][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-10 10:45:08,355][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-10 10:45:12,121][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp019ifsfj
[2023-11-10 10:45:12,122][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp019ifsfj/_remote_module_non_scriptable.py
== Loading pretrained model...
== pretrained model was loaded!
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-10 10:45:15,390][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-10 10:45:15,391][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-10 10:45:15,396][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-10 10:45:15,398][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-10 10:45:15,399][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-10 10:45:15,399][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-10 10:45:15,481][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-10 10:45:15,914][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-10 10:45:16,293][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.7487761974334717 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:04<00:00,  0.44it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  4.95it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00,  4.93it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  5.31it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  2.87it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00,  5.16it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.188158, 0.186757, 0.191691, 0.188870
Valid average loss UNet                 (all)                : 0.755476

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.183960, 0.031968, 0.048009
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200114, 0.001034, 0.000920
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.200065, 0.001019, 0.000954
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.200114, 0.001099, 0.000985
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.199947, 0.001021, 0.001074
Valid average loss all      (Triplet)                 : 0.196596

== Recognize ==
Valid average loss Recognize     : 2.209661
Valid average accuracy drums     : 63.281250 %
Valid average accuracy bass      : 52.343750 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 63.281250 %
Valid average accuracy residuals : 46.875000 %

== Valid average loss all : 0.196596

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.9054770469665527 sec. =
Valid knn accuracy drums     : 83.59375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.0397372245788574 sec. =
Valid knn accuracy bass      : 21.875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.654010772705078 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.395904541015625 sec. =
Valid knn accuracy guitar    : 39.84375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.7771944999694824 sec. =
Valid knn accuracy residuals : 93.75%

Valid knn accuracy average   : 56.71874999999999%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:55<04:50,  0.90it/s]Epoch 0:  16%|█▌        | 50/313 [00:55<04:50,  0.90it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.000]Epoch 0:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.000]Epoch 0:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.925]Epoch 0:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.925]Epoch 0:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.867]Epoch 0:  64%|██████▍   | 200/313 [03:07<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.867]Epoch 0:  64%|██████▍   | 200/313 [03:07<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.959]Epoch 0:  80%|███████▉  | 250/313 [03:50<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.959]Epoch 0:  80%|███████▉  | 250/313 [03:50<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.738]Epoch 0:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.738]Epoch 0:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.800]Epoch 0: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.800]Epoch 0: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.827]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185520, 0.188699, 0.191477, 0.200301
Valid average loss UNet                 (all)                : 0.765997

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047649, 0.324896, 0.722330
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.194852, 0.158230, 0.164757
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.188544, 0.163586, 0.175042
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.164471, 0.170102, 0.226119
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.115396, 0.211944, 0.302808
Valid average loss all      (Triplet)                 : 0.150009

== Recognize ==
Valid average loss Recognize     : 0.781972
Valid average accuracy drums     : 34.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 39.500000 %

== Valid average loss all : 0.150009

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.542563438415527 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.540025234222412 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.544153451919556 sec. =
Valid knn accuracy piano     : 18.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.66796088218689 sec. =
Valid knn accuracy guitar    : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.895497560501099 sec. =
Valid knn accuracy residuals : 50.0%

Valid knn accuracy average   : 44.27823676367461%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.827, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443]Epoch 0: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.827, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188465, 0.188762, 0.187654, 0.193963
Train average loss UNet                 (all)                : 0.758843

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.041730, 0.449044, 0.897478
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207772, 0.151249, 0.145040
Train average loss piano    (Triplet, dist_p, dist_n) : 0.198044, 0.175148, 0.180604
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.170398, 0.198444, 0.250227
Train average loss residuals(Triplet, dist_p, dist_n) : 0.158979, 0.220681, 0.287811
Train average loss all      (Triplet)                 : 0.157462

== Recognize ==
Train average loss Recognize     : 0.926359
Train average accuracy drums     : 51.410000 %
Train average accuracy bass      : 50.515003 %
Train average accuracy piano     : 50.639999 %
Train average accuracy guitar    : 49.649998 %
Train average accuracy residuals : 49.254997 %

== Train average loss all : 0.157462

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.827, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.827, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.827, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.778, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.778, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.791, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.791, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.740, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.740, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.762, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.762, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0943, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.735, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0943, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.735, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.702, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]  Epoch 1: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.702, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.762, Valid/loss_all_step=0.136, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.136, Valid/loss_recog_step=0.823, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.43it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.53it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184680, 0.187817, 0.190469, 0.195220
Valid average loss UNet                 (all)                : 0.758186

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.039586, 0.430798, 0.943959
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173632, 0.212184, 0.244911
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.202140, 0.205828, 0.211964
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.143791, 0.242821, 0.355463
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.118629, 0.280586, 0.415356
Valid average loss all      (Triplet)                 : 0.142324

== Recognize ==
Valid average loss Recognize     : 0.725980
Valid average accuracy drums     : 75.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.142324

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.636527061462402 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.692404747009277 sec. =
Valid knn accuracy bass      : 22.58064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.257700681686401 sec. =
Valid knn accuracy piano     : 22.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.865906238555908 sec. =
Valid knn accuracy guitar    : 41.294642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.845010757446289 sec. =
Valid knn accuracy residuals : 52.72727272727272%

Valid knn accuracy average   : 44.28654475783683%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.762, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=0.926]Epoch 1: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.762, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188643, 0.188945, 0.187850, 0.194339
Train average loss UNet                 (all)                : 0.759777

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.031885, 0.443781, 0.948292
Train average loss bass     (Triplet, dist_p, dist_n) : 0.177651, 0.208946, 0.251399
Train average loss piano    (Triplet, dist_p, dist_n) : 0.183811, 0.227406, 0.254402
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.141059, 0.255678, 0.372550
Train average loss residuals(Triplet, dist_p, dist_n) : 0.132833, 0.299400, 0.422989
Train average loss all      (Triplet)                 : 0.134831

== Recognize ==
Train average loss Recognize     : 0.758093
Train average accuracy drums     : 58.619999 %
Train average accuracy bass      : 49.524998 %
Train average accuracy piano     : 49.349998 %
Train average accuracy guitar    : 50.484997 %
Train average accuracy residuals : 50.070000 %

== Train average loss all : 0.134831

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.762, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.762, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.762, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.751, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.751, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.721, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.721, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.713, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.713, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.704, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.704, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0815, Train/loss_recog_step=0.704, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0815, Train/loss_recog_step=0.704, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.714, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]  Epoch 2: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.714, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.717, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=0.751, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=0.726, Valid/knn_avr=0.443, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184661, 0.187853, 0.190387, 0.204175
Valid average loss UNet                 (all)                : 0.767076

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059684, 0.537587, 1.073146
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.170470, 0.308375, 0.360479
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.172575, 0.284865, 0.326377
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.135045, 0.330708, 0.503625
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.110501, 0.363074, 0.578146
Valid average loss all      (Triplet)                 : 0.136993

== Recognize ==
Valid average loss Recognize     : 0.674864
Valid average accuracy drums     : 58.499996 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 57.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.136993

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.486078500747681 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.348159313201904 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.49461579322815 sec. =
Valid knn accuracy piano     : 34.1796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.316731929779053 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.045095920562744 sec. =
Valid knn accuracy residuals : 54.77272727272727%

Valid knn accuracy average   : 50.147625811688314%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.717, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.135, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.135, Train/loss_recog_epoch=0.758]Epoch 2: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.717, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188669, 0.188933, 0.187843, 0.194384
Train average loss UNet                 (all)                : 0.759828

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.021664, 0.503775, 1.086552
Train average loss bass     (Triplet, dist_p, dist_n) : 0.164402, 0.254816, 0.323231
Train average loss piano    (Triplet, dist_p, dist_n) : 0.165254, 0.282101, 0.336665
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.125285, 0.312106, 0.473701
Train average loss residuals(Triplet, dist_p, dist_n) : 0.117103, 0.351261, 0.507689
Train average loss all      (Triplet)                 : 0.120125

== Recognize ==
Train average loss Recognize     : 0.717691
Train average accuracy drums     : 72.119995 %
Train average accuracy bass      : 50.199997 %
Train average accuracy piano     : 50.349998 %
Train average accuracy guitar    : 51.880001 %
Train average accuracy residuals : 50.660004 %

== Train average loss all : 0.120125

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.717, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.717, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.0731, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0731, Train/loss_recog_step=0.717, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.681, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]  Epoch 3:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.681, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=0.706, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=0.706, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.700, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]  Epoch 3:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=0.700, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=0.685, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=0.685, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0724, Train/loss_recog_step=0.709, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0724, Train/loss_recog_step=0.709, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.690, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]  Epoch 3: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.690, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.709, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.116, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.137, Valid/loss_recog_epoch=0.675, Valid/knn_avr=0.501, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184181, 0.187376, 0.189874, 0.201499
Valid average loss UNet                 (all)                : 0.762930

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.043266, 0.626740, 1.229281
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.162775, 0.345965, 0.406615
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.152118, 0.330759, 0.412446
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.152882, 0.395177, 0.571347
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.132904, 0.437961, 0.657832
Valid average loss all      (Triplet)                 : 0.136297

== Recognize ==
Valid average loss Recognize     : 0.701933
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 35.000000 %
Valid average accuracy piano     : 42.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 36.500000 %

== Valid average loss all : 0.136297

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.110978364944458 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.679627656936646 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.289787292480469 sec. =
Valid knn accuracy piano     : 34.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.627291440963745 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3177807331085205 sec. =
Valid knn accuracy residuals : 57.27272727272727%

Valid knn accuracy average   : 50.278779075062396%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.709, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.718]Epoch 3: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.709, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188547, 0.188850, 0.187766, 0.194673
Train average loss UNet                 (all)                : 0.759835

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.017738, 0.581021, 1.211537
Train average loss bass     (Triplet, dist_p, dist_n) : 0.152563, 0.315396, 0.410773
Train average loss piano    (Triplet, dist_p, dist_n) : 0.146249, 0.351133, 0.440712
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.108351, 0.373561, 0.580825
Train average loss residuals(Triplet, dist_p, dist_n) : 0.104239, 0.417314, 0.611533
Train average loss all      (Triplet)                 : 0.107215

== Recognize ==
Train average loss Recognize     : 0.698255
Train average accuracy drums     : 67.909996 %
Train average accuracy bass      : 48.840000 %
Train average accuracy piano     : 50.325001 %
Train average accuracy guitar    : 53.775002 %
Train average accuracy residuals : 52.815002 %

== Train average loss all : 0.107215

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.709, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.709, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.709, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.688, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]  Epoch 4:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.688, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.0844, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0844, Train/loss_recog_step=0.697, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.0844, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0844, Train/loss_recog_step=0.697, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.682, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]  Epoch 4:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.682, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=0.679, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=0.679, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=0.692, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=0.692, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.691, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]  Epoch 4: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.691, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.692, Valid/loss_all_step=0.104, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.104, Valid/loss_recog_step=0.684, Valid/loss_all_epoch=0.136, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.503, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183830, 0.186988, 0.189424, 0.197646
Valid average loss UNet                 (all)                : 0.757887

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068981, 0.715414, 1.292434
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.201813, 0.453970, 0.483367
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.162491, 0.422679, 0.493964
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.185194, 0.485893, 0.643282
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.142434, 0.465802, 0.714827
Valid average loss all      (Triplet)                 : 0.165157

== Recognize ==
Valid average loss Recognize     : 0.694403
Valid average accuracy drums     : 57.500000 %
Valid average accuracy bass      : 31.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 65.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.165157

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.775509357452393 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.152331113815308 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.284830808639526 sec. =
Valid knn accuracy piano     : 34.1796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.723007678985596 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.026739835739136 sec. =
Valid knn accuracy residuals : 57.72727272727273%

Valid knn accuracy average   : 50.580738368836634%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.692, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.107, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.107, Train/loss_recog_epoch=0.698]Epoch 4: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.692, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188483, 0.188776, 0.187693, 0.194372
Train average loss UNet                 (all)                : 0.759324

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012952, 0.672364, 1.369177
Train average loss bass     (Triplet, dist_p, dist_n) : 0.138472, 0.379946, 0.506392
Train average loss piano    (Triplet, dist_p, dist_n) : 0.130275, 0.419561, 0.542504
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.097872, 0.451816, 0.703408
Train average loss residuals(Triplet, dist_p, dist_n) : 0.092172, 0.487297, 0.725246
Train average loss all      (Triplet)                 : 0.095335

== Recognize ==
Train average loss Recognize     : 0.689372
Train average accuracy drums     : 55.035000 %
Train average accuracy bass      : 47.325001 %
Train average accuracy piano     : 52.604996 %
Train average accuracy guitar    : 58.044998 %
Train average accuracy residuals : 57.755001 %

== Train average loss all : 0.095335

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.692, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.692, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0601, Train/loss_recog_step=0.692, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.677, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]  Epoch 5:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.677, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0703, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0703, Train/loss_recog_step=0.693, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.0703, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0703, Train/loss_recog_step=0.693, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.670, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]  Epoch 5:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.670, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.0711, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0711, Train/loss_recog_step=0.657, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0711, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0711, Train/loss_recog_step=0.657, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0552, Train/loss_recog_step=0.677, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0552, Train/loss_recog_step=0.677, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=0.696, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=0.696, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.686, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=0.687, Valid/loss_all_epoch=0.165, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.165, Valid/loss_recog_epoch=0.694, Valid/knn_avr=0.506, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184229, 0.187355, 0.189873, 0.191830
Valid average loss UNet                 (all)                : 0.753287

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064131, 0.776787, 1.418461
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.187912, 0.503831, 0.542380
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.182110, 0.527346, 0.590154
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.183251, 0.568219, 0.724736
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.137909, 0.592317, 0.873496
Valid average loss all      (Triplet)                 : 0.161758

== Recognize ==
Valid average loss Recognize     : 0.713646
Valid average accuracy drums     : 71.500000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 57.500000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.161758

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.098191261291504 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.240634441375732 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.23223066329956 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.369167804718018 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.55575442314148 sec. =
Valid knn accuracy residuals : 57.27272727272727%

Valid knn accuracy average   : 49.42822463957851%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.686, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0953, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0953, Train/loss_recog_epoch=0.689]Epoch 5: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.686, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188498, 0.188801, 0.187719, 0.194500
Train average loss UNet                 (all)                : 0.759517

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010068, 0.774919, 1.531931
Train average loss bass     (Triplet, dist_p, dist_n) : 0.127066, 0.447554, 0.606859
Train average loss piano    (Triplet, dist_p, dist_n) : 0.109851, 0.502854, 0.676053
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.084112, 0.527206, 0.829426
Train average loss residuals(Triplet, dist_p, dist_n) : 0.076836, 0.562201, 0.852545
Train average loss all      (Triplet)                 : 0.082748

== Recognize ==
Train average loss Recognize     : 0.684619
Train average accuracy drums     : 64.034996 %
Train average accuracy bass      : 46.755001 %
Train average accuracy piano     : 53.899998 %
Train average accuracy guitar    : 60.114998 %
Train average accuracy residuals : 59.525002 %

== Train average loss all : 0.082748

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.686, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.686, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.0394, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.686, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0752, Train/loss_recog_step=0.696, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0752, Train/loss_recog_step=0.696, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0718, Train/loss_recog_step=0.682, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0718, Train/loss_recog_step=0.682, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.0935, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.687, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.0935, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.687, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=0.692, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0519, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=0.692, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0513, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0513, Train/loss_recog_step=0.685, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0513, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0513, Train/loss_recog_step=0.685, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=0.691, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=0.691, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.685, Valid/loss_all_step=0.164, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.714, Valid/knn_avr=0.494, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184537, 0.187572, 0.190472, 0.195177
Valid average loss UNet                 (all)                : 0.757758

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066821, 0.899933, 1.640862
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.211347, 0.555062, 0.588673
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.176392, 0.580409, 0.656914
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220237, 0.626813, 0.769857
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.123751, 0.621095, 0.982962
Valid average loss all      (Triplet)                 : 0.173103

== Recognize ==
Valid average loss Recognize     : 0.702102
Valid average accuracy drums     : 81.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 60.000004 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.173103

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.276348352432251 sec. =
Valid knn accuracy drums     : 78.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.571383476257324 sec. =
Valid knn accuracy bass      : 19.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.419819355010986 sec. =
Valid knn accuracy piano     : 32.03125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.597329139709473 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.936453342437744 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 47.17750644341633%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.685, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0827, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0827, Train/loss_recog_epoch=0.685]Epoch 6: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.685, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188547, 0.188860, 0.187773, 0.194278
Train average loss UNet                 (all)                : 0.759458

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008247, 0.905325, 1.742752
Train average loss bass     (Triplet, dist_p, dist_n) : 0.115775, 0.523800, 0.715024
Train average loss piano    (Triplet, dist_p, dist_n) : 0.097075, 0.596182, 0.815362
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.070947, 0.618357, 0.973904
Train average loss residuals(Triplet, dist_p, dist_n) : 0.065855, 0.665425, 1.017508
Train average loss all      (Triplet)                 : 0.072593

== Recognize ==
Train average loss Recognize     : 0.689488
Train average accuracy drums     : 66.080002 %
Train average accuracy bass      : 45.279999 %
Train average accuracy piano     : 50.320000 %
Train average accuracy guitar    : 59.560001 %
Train average accuracy residuals : 59.899998 %

== Train average loss all : 0.072593

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.685, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.685, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.685, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0808, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0808, Train/loss_recog_step=0.705, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0808, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0808, Train/loss_recog_step=0.705, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0542, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0542, Train/loss_recog_step=0.683, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.0542, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0542, Train/loss_recog_step=0.683, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0776, Train/loss_recog_step=0.689, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0776, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0776, Train/loss_recog_step=0.689, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=0.675, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=0.675, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0335, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=0.677, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.0335, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=0.677, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.0435, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0435, Train/loss_recog_step=0.686, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.0435, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0435, Train/loss_recog_step=0.686, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.674, Valid/loss_all_step=0.213, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.712, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.702, Valid/knn_avr=0.472, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.96it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184325, 0.187547, 0.189889, 0.199497
Valid average loss UNet                 (all)                : 0.761258

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060312, 1.061589, 1.936360
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.224281, 0.746329, 0.814386
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.139207, 0.722809, 0.842417
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.213027, 0.800256, 1.091451
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.112892, 0.884271, 1.137364
Valid average loss all      (Triplet)                 : 0.162780

== Recognize ==
Valid average loss Recognize     : 0.685462
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 40.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.162780

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.843838930130005 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.555186986923218 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.830161809921265 sec. =
Valid knn accuracy piano     : 38.0859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.615268707275391 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3652942180633545 sec. =
Valid knn accuracy residuals : 58.409090909090914%

Valid knn accuracy average   : 50.46957520696345%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.674, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0726, Train/loss_unet_all_epoch=0.759, Train/loss_triplet_all_epoch=0.0726, Train/loss_recog_epoch=0.689]Epoch 7: 100%|██████████| 313/313 [05:49<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.674, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188733, 0.189037, 0.187936, 0.194767
Train average loss UNet                 (all)                : 0.760473

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007201, 1.013440, 1.952239
Train average loss bass     (Triplet, dist_p, dist_n) : 0.101571, 0.589087, 0.812067
Train average loss piano    (Triplet, dist_p, dist_n) : 0.081154, 0.673926, 0.945906
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.063594, 0.708349, 1.114547
Train average loss residuals(Triplet, dist_p, dist_n) : 0.058921, 0.745020, 1.144119
Train average loss all      (Triplet)                 : 0.063673

== Recognize ==
Train average loss Recognize     : 0.690117
Train average accuracy drums     : 59.034996 %
Train average accuracy bass      : 48.139999 %
Train average accuracy piano     : 48.709999 %
Train average accuracy guitar    : 55.844997 %
Train average accuracy residuals : 63.395000 %

== Train average loss all : 0.063673

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.674, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.674, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=0.674, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.0786, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0786, Train/loss_recog_step=0.684, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.0786, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0786, Train/loss_recog_step=0.684, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.0326, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0326, Train/loss_recog_step=0.672, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.0326, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0326, Train/loss_recog_step=0.672, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.0613, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0613, Train/loss_recog_step=0.674, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0613, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0613, Train/loss_recog_step=0.674, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.687, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.687, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0393, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0393, Train/loss_recog_step=0.692, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0393, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0393, Train/loss_recog_step=0.692, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.052, Train/loss_recog_step=0.698, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]  Epoch 8: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.052, Train/loss_recog_step=0.698, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.703, Valid/loss_all_step=0.166, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.166, Valid/loss_recog_step=0.615, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.685, Valid/knn_avr=0.505, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184845, 0.188040, 0.190438, 0.206668
Valid average loss UNet                 (all)                : 0.769991

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062455, 1.174920, 2.165702
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.227559, 0.825609, 0.886875
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.148425, 0.771087, 0.933329
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187672, 0.881974, 1.211527
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.128926, 0.941151, 1.331396
Valid average loss all      (Triplet)                 : 0.163362

== Recognize ==
Valid average loss Recognize     : 0.720225
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 40.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 56.500000 %

== Valid average loss all : 0.163362

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.265625953674316 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.48113226890564 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42331600189209 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.903748989105225 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.18400502204895 sec. =
Valid knn accuracy residuals : 57.27272727272727%

Valid knn accuracy average   : 52.58202961353163%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.703, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0637, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0637, Train/loss_recog_epoch=0.690]Epoch 8: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.703, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188549, 0.188845, 0.187771, 0.195009
Train average loss UNet                 (all)                : 0.760174

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006314, 1.143240, 2.163842
Train average loss bass     (Triplet, dist_p, dist_n) : 0.089731, 0.683715, 0.953850
Train average loss piano    (Triplet, dist_p, dist_n) : 0.068124, 0.766845, 1.096318
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.054195, 0.806475, 1.258782
Train average loss residuals(Triplet, dist_p, dist_n) : 0.046208, 0.846255, 1.318972
Train average loss all      (Triplet)                 : 0.054036

== Recognize ==
Train average loss Recognize     : 0.692935
Train average accuracy drums     : 54.420002 %
Train average accuracy bass      : 51.845001 %
Train average accuracy piano     : 48.564999 %
Train average accuracy guitar    : 53.710003 %
Train average accuracy residuals : 64.784996 %

== Train average loss all : 0.054036

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.703, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.703, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.703, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.0511, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=0.681, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0511, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=0.681, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0426, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0426, Train/loss_recog_step=0.683, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0426, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0426, Train/loss_recog_step=0.683, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0446, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0446, Train/loss_recog_step=0.706, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0446, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0446, Train/loss_recog_step=0.706, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=0.703, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0547, Train/loss_recog_step=0.703, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0334, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.699, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0334, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.699, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.048, Train/loss_recog_step=0.715, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]  Epoch 9: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.048, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.048, Train/loss_recog_step=0.715, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.720, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.692, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.720, Valid/knn_avr=0.526, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184752, 0.187877, 0.190356, 0.195613
Valid average loss UNet                 (all)                : 0.758599

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070019, 1.302673, 2.441013
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.208940, 0.899424, 0.979954
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.203980, 0.927571, 1.044260
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.239176, 1.006398, 1.263217
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.154799, 0.957960, 1.432497
Valid average loss all      (Triplet)                 : 0.183494

== Recognize ==
Valid average loss Recognize     : 0.698640
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.183494

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.389799356460571 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.358061790466309 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.909384965896606 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6484198570251465 sec. =
Valid knn accuracy guitar    : 50.89285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.486725091934204 sec. =
Valid knn accuracy residuals : 50.0%

Valid knn accuracy average   : 48.211158209777594%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.720, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.054, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.054, Train/loss_recog_epoch=0.693]Epoch 9: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.720, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188798, 0.189119, 0.187994, 0.194393
Train average loss UNet                 (all)                : 0.760303

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005651, 1.264815, 2.381467
Train average loss bass     (Triplet, dist_p, dist_n) : 0.075268, 0.775637, 1.098323
Train average loss piano    (Triplet, dist_p, dist_n) : 0.059478, 0.865332, 1.245613
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.045504, 0.910567, 1.430225
Train average loss residuals(Triplet, dist_p, dist_n) : 0.040229, 0.959849, 1.508059
Train average loss all      (Triplet)                 : 0.046067

== Recognize ==
Train average loss Recognize     : 0.698596
Train average accuracy drums     : 51.510002 %
Train average accuracy bass      : 52.244995 %
Train average accuracy piano     : 48.439999 %
Train average accuracy guitar    : 52.329998 %
Train average accuracy residuals : 61.785000 %

== Train average loss all : 0.046067

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.720, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.720, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0361, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.720, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0349, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0349, Train/loss_recog_step=0.706, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0349, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0349, Train/loss_recog_step=0.706, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0334, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.694, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0334, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=0.694, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0469, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0469, Train/loss_recog_step=0.677, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0469, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0469, Train/loss_recog_step=0.677, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=0.732, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=0.732, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.676, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0239, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=0.676, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=0.721, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=0.721, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.686, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.782, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=0.578, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.183, Valid/loss_recog_epoch=0.699, Valid/knn_avr=0.482, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183573, 0.186796, 0.188931, 0.201890
Valid average loss UNet                 (all)                : 0.761191

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050572, 1.398333, 2.548171
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.215582, 1.060488, 1.197303
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.222663, 1.074966, 1.175783
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159034, 1.127023, 1.491587
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.161985, 1.236374, 1.618315
Valid average loss all      (Triplet)                 : 0.163834

== Recognize ==
Valid average loss Recognize     : 0.729356
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 41.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.163834

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8702075481414795 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42551326751709 sec. =
Valid knn accuracy bass      : 12.298387096774194%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.54064655303955 sec. =
Valid knn accuracy piano     : 41.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.468884706497192 sec. =
Valid knn accuracy guitar    : 60.26785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.827148199081421 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 52.174408679942076%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.686, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0461, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0461, Train/loss_recog_epoch=0.699]Epoch 10: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.686, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188915, 0.189240, 0.188127, 0.194468
Train average loss UNet                 (all)                : 0.760750

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003947, 1.394959, 2.592994
Train average loss bass     (Triplet, dist_p, dist_n) : 0.066818, 0.887982, 1.260957
Train average loss piano    (Triplet, dist_p, dist_n) : 0.052209, 0.970685, 1.409728
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.038027, 1.030975, 1.626990
Train average loss residuals(Triplet, dist_p, dist_n) : 0.032789, 1.075462, 1.690387
Train average loss all      (Triplet)                 : 0.039570

== Recognize ==
Train average loss Recognize     : 0.700597
Train average accuracy drums     : 50.830002 %
Train average accuracy bass      : 50.715000 %
Train average accuracy piano     : 49.424999 %
Train average accuracy guitar    : 52.565002 %
Train average accuracy residuals : 58.464996 %

== Train average loss all : 0.039570

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.686, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.686, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.0297, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.686, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.0461, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.706, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0461, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=0.706, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0268, Train/loss_recog_step=0.693, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=0.717, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=0.717, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.694, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.694, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0403, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0403, Train/loss_recog_step=0.726, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0403, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0403, Train/loss_recog_step=0.726, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0242, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.699, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]Epoch 11: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.682, Valid/loss_all_step=0.0811, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.0811, Valid/loss_recog_step=0.621, Valid/loss_all_epoch=0.164, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.75it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.86it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184756, 0.188105, 0.190249, 0.191548
Valid average loss UNet                 (all)                : 0.754659

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058615, 1.510046, 2.659086
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.268647, 1.218941, 1.305046
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.317194, 1.229372, 1.247367
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.186545, 1.256597, 1.653316
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.132090, 1.358268, 1.768409
Valid average loss all      (Triplet)                 : 0.202423

== Recognize ==
Valid average loss Recognize     : 0.704391
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 68.000000 %

== Valid average loss all : 0.202423

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8339033126831055 sec. =
Valid knn accuracy drums     : 79.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.250790119171143 sec. =
Valid knn accuracy bass      : 11.29032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.447058200836182 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.410345315933228 sec. =
Valid knn accuracy guitar    : 62.72321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.228370904922485 sec. =
Valid knn accuracy residuals : 60.45454545454545%

Valid knn accuracy average   : 51.20951320331141%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.682, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0396, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0396, Train/loss_recog_epoch=0.701]  Epoch 11: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.682, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189109, 0.189405, 0.188309, 0.194981
Train average loss UNet                 (all)                : 0.761804

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004242, 1.507725, 2.792652
Train average loss bass     (Triplet, dist_p, dist_n) : 0.055877, 0.976198, 1.409139
Train average loss piano    (Triplet, dist_p, dist_n) : 0.043226, 1.051970, 1.558301
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.030362, 1.114295, 1.779711
Train average loss residuals(Triplet, dist_p, dist_n) : 0.029669, 1.180752, 1.869260
Train average loss all      (Triplet)                 : 0.033406

== Recognize ==
Train average loss Recognize     : 0.710992
Train average accuracy drums     : 50.265003 %
Train average accuracy bass      : 50.344997 %
Train average accuracy piano     : 47.420002 %
Train average accuracy guitar    : 52.375000 %
Train average accuracy residuals : 53.864998 %

== Train average loss all : 0.033406

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.682, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.682, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.682, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.0517, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0517, Train/loss_recog_step=0.723, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.0517, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0517, Train/loss_recog_step=0.723, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.723, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.723, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0379, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0379, Train/loss_recog_step=0.732, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.0379, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0379, Train/loss_recog_step=0.732, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0294, Train/loss_recog_step=0.716, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0294, Train/loss_recog_step=0.716, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.736, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.736, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.0306, Train/loss_recog_step=0.729, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.0306, Train/loss_recog_step=0.729, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.706, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.614, Valid/loss_all_epoch=0.202, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.704, Valid/knn_avr=0.512, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.74it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184221, 0.187510, 0.189871, 0.185090
Valid average loss UNet                 (all)                : 0.746692

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070609, 1.706268, 3.154816
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.296195, 1.322024, 1.387370
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.337616, 1.308892, 1.384890
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.189068, 1.384078, 1.834476
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.191722, 1.504954, 1.916569
Valid average loss all      (Triplet)                 : 0.220317

== Recognize ==
Valid average loss Recognize     : 0.779782
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 63.000000 %

== Valid average loss all : 0.220317

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.72600245475769 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.32635760307312 sec. =
Valid knn accuracy bass      : 15.120967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.605271816253662 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.47423529624939 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.341426849365234 sec. =
Valid knn accuracy residuals : 57.27272727272727%

Valid knn accuracy average   : 50.40405926690771%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.706, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0334, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0334, Train/loss_recog_epoch=0.711]Epoch 12: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.706, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189024, 0.189343, 0.188224, 0.194328
Train average loss UNet                 (all)                : 0.760919

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003937, 1.596660, 2.949311
Train average loss bass     (Triplet, dist_p, dist_n) : 0.046869, 1.042651, 1.515957
Train average loss piano    (Triplet, dist_p, dist_n) : 0.035672, 1.133889, 1.693826
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.027505, 1.196338, 1.935245
Train average loss residuals(Triplet, dist_p, dist_n) : 0.024493, 1.253833, 1.994108
Train average loss all      (Triplet)                 : 0.028198

== Recognize ==
Train average loss Recognize     : 0.718336
Train average accuracy drums     : 50.389999 %
Train average accuracy bass      : 51.639999 %
Train average accuracy piano     : 47.730000 %
Train average accuracy guitar    : 51.055000 %
Train average accuracy residuals : 53.324997 %

== Train average loss all : 0.028198

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.706, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.706, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  16%|█▌        | 50/313 [00:57<05:02,  0.87it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.706, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  16%|█▌        | 50/313 [00:57<05:02,  0.87it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.741, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.741, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0249, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=0.714, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0249, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=0.714, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.719, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.719, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0337, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0337, Train/loss_recog_step=0.717, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0337, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0337, Train/loss_recog_step=0.717, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00831, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00831, Train/loss_recog_step=0.695, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00831, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00831, Train/loss_recog_step=0.695, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.707, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]  Epoch 13: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.707, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.778, Valid/loss_all_step=0.154, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.154, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.220, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.504, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.52it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.70it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183795, 0.187072, 0.189340, 0.205547
Valid average loss UNet                 (all)                : 0.765753

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046281, 1.740145, 3.174934
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.335266, 1.458952, 1.526101
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.308042, 1.464913, 1.547127
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.212760, 1.457783, 1.994323
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.207823, 1.627095, 1.965232
Valid average loss all      (Triplet)                 : 0.237227

== Recognize ==
Valid average loss Recognize     : 0.729870
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.237227

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.548774003982544 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.558509588241577 sec. =
Valid knn accuracy bass      : 15.32258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.06545352935791 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.47229290008545 sec. =
Valid knn accuracy guitar    : 59.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.459824800491333 sec. =
Valid knn accuracy residuals : 57.72727272727273%

Valid knn accuracy average   : 50.98429132666071%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.778, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0282, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0282, Train/loss_recog_epoch=0.718]Epoch 13: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.778, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188989, 0.189291, 0.188195, 0.194501
Train average loss UNet                 (all)                : 0.760975

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004678, 1.754410, 3.203695
Train average loss bass     (Triplet, dist_p, dist_n) : 0.039932, 1.148639, 1.701254
Train average loss piano    (Triplet, dist_p, dist_n) : 0.029680, 1.237863, 1.852833
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.023664, 1.315257, 2.137705
Train average loss residuals(Triplet, dist_p, dist_n) : 0.021359, 1.374496, 2.202484
Train average loss all      (Triplet)                 : 0.024160

== Recognize ==
Train average loss Recognize     : 0.722279
Train average accuracy drums     : 50.505001 %
Train average accuracy bass      : 54.240002 %
Train average accuracy piano     : 49.910000 %
Train average accuracy guitar    : 51.225002 %
Train average accuracy residuals : 52.670002 %

== Train average loss all : 0.024160

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.778, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.778, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=0.778, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  16%|█▌        | 50/313 [00:50<04:24,  1.00it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=0.748, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]  Epoch 14:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=0.748, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.689, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.689, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.701, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.701, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.754, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.754, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0404, Train/loss_recog_step=0.716, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  96%|█████████▌| 300/313 [04:35<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0404, Train/loss_recog_step=0.716, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14:  96%|█████████▌| 300/313 [04:35<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.0393, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0393, Train/loss_recog_step=0.722, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14: 100%|██████████| 313/313 [04:43<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0393, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0393, Train/loss_recog_step=0.722, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14: 100%|██████████| 313/313 [04:43<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=0.686, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.718, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.237, Valid/loss_recog_epoch=0.730, Valid/knn_avr=0.510, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.72it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183775, 0.187133, 0.189361, 0.185315
Valid average loss UNet                 (all)                : 0.745584

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065295, 1.845255, 3.189459
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.315619, 1.530318, 1.651492
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.369366, 1.486009, 1.633780
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.175509, 1.491948, 2.170848
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.212256, 1.792394, 2.062212
Valid average loss all      (Triplet)                 : 0.235820

== Recognize ==
Valid average loss Recognize     : 0.788657
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.235820

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.322818040847778 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.670734405517578 sec. =
Valid knn accuracy bass      : 17.137096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.393747329711914 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5087926387786865 sec. =
Valid knn accuracy guitar    : 61.83035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.26125431060791 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 53.51041889605834%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=0.686, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0242, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0242, Train/loss_recog_epoch=0.722]Epoch 14: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=0.686, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188936, 0.189253, 0.188158, 0.194454
Train average loss UNet                 (all)                : 0.760801

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003487, 1.813588, 3.332360
Train average loss bass     (Triplet, dist_p, dist_n) : 0.034428, 1.226678, 1.818873
Train average loss piano    (Triplet, dist_p, dist_n) : 0.028356, 1.319941, 1.991061
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.024023, 1.402815, 2.268249
Train average loss residuals(Triplet, dist_p, dist_n) : 0.019574, 1.476586, 2.380715
Train average loss all      (Triplet)                 : 0.022323

== Recognize ==
Train average loss Recognize     : 0.729675
Train average accuracy drums     : 49.614998 %
Train average accuracy bass      : 51.715000 %
Train average accuracy piano     : 49.680000 %
Train average accuracy guitar    : 50.515003 %
Train average accuracy residuals : 51.964996 %

== Train average loss all : 0.022323

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=0.686, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=0.686, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  16%|█▌        | 50/313 [00:56<04:55,  0.89it/s, v_num=0, Train/loss_all_step=0.0359, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.0359, Train/loss_recog_step=0.686, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  16%|█▌        | 50/313 [00:56<04:55,  0.89it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.724, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  32%|███▏      | 100/313 [01:46<03:46,  0.94it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.724, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  32%|███▏      | 100/313 [01:46<03:46,  0.94it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0301, Train/loss_recog_step=0.790, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0301, Train/loss_recog_step=0.790, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.729, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  64%|██████▍   | 200/313 [03:23<01:54,  0.98it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.729, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  64%|██████▍   | 200/313 [03:23<01:54,  0.98it/s, v_num=0, Train/loss_all_step=0.0221, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=0.782, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  80%|███████▉  | 250/313 [04:12<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.0221, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=0.782, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  80%|███████▉  | 250/313 [04:12<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.706, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  96%|█████████▌| 300/313 [05:02<00:13,  0.99it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.706, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15:  96%|█████████▌| 300/313 [05:02<00:13,  0.99it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.746, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.746, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.699, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.710, Valid/loss_triplet_all_step=0.169, Valid/loss_recog_step=0.858, Valid/loss_all_epoch=0.236, Valid/loss_unet_all_epoch=0.746, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.55it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184524, 0.187863, 0.190193, 0.204300
Valid average loss UNet                 (all)                : 0.766880

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045356, 1.929355, 3.342887
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.372327, 1.724767, 1.858926
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.411007, 1.712456, 1.724348
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.201103, 1.575573, 2.173768
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.176966, 1.660747, 2.224851
Valid average loss all      (Triplet)                 : 0.258558

== Recognize ==
Valid average loss Recognize     : 0.729387
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.258558

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.223958015441895 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.380115032196045 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.64446759223938 sec. =
Valid knn accuracy piano     : 38.0859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.709983587265015 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.22243356704712 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 52.57092012782098%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.699, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0223, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.730]Epoch 15: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.699, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188892, 0.189202, 0.188104, 0.194120
Train average loss UNet                 (all)                : 0.760317

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003344, 1.852296, 3.460642
Train average loss bass     (Triplet, dist_p, dist_n) : 0.029979, 1.302814, 1.947891
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020922, 1.345898, 2.061098
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.019835, 1.449821, 2.369894
Train average loss residuals(Triplet, dist_p, dist_n) : 0.017984, 1.543559, 2.499703
Train average loss all      (Triplet)                 : 0.018741

== Recognize ==
Train average loss Recognize     : 0.739809
Train average accuracy drums     : 50.029999 %
Train average accuracy bass      : 51.590000 %
Train average accuracy piano     : 49.254997 %
Train average accuracy guitar    : 50.010002 %
Train average accuracy residuals : 50.639999 %

== Train average loss all : 0.018741

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.699, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.699, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  16%|█▌        | 50/313 [00:52<04:35,  0.96it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.699, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  16%|█▌        | 50/313 [00:52<04:35,  0.96it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0371, Train/loss_recog_step=0.715, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]  Epoch 16:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.0371, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0371, Train/loss_recog_step=0.715, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.009, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.009, Train/loss_recog_step=0.736, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]  Epoch 16:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.009, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.009, Train/loss_recog_step=0.736, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.733, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  64%|██████▍   | 200/313 [03:15<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.733, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  64%|██████▍   | 200/313 [03:15<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=0.744, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00426, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=0.744, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.731, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]  Epoch 16:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=0.731, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.770, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.770, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.765, Valid/loss_all_step=0.268, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=0.681, Valid/loss_all_epoch=0.259, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.259, Valid/loss_recog_epoch=0.729, Valid/knn_avr=0.526, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184273, 0.187659, 0.189792, 0.193863
Valid average loss UNet                 (all)                : 0.755587

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.052046, 2.028367, 3.432580
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.366972, 1.826230, 1.913134
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.326592, 1.643342, 1.790257
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.189052, 1.701805, 2.321240
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.216556, 1.924638, 2.499062
Valid average loss all      (Triplet)                 : 0.242212

== Recognize ==
Valid average loss Recognize     : 0.767111
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.242212

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.636704683303833 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.247955799102783 sec. =
Valid knn accuracy bass      : 20.967741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.939143419265747 sec. =
Valid knn accuracy piano     : 37.109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.997007846832275 sec. =
Valid knn accuracy guitar    : 58.03571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.920401573181152 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 52.06051090827126%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.765, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0187, Train/loss_unet_all_epoch=0.760, Train/loss_triplet_all_epoch=0.0187, Train/loss_recog_epoch=0.740]Epoch 16: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.765, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189170, 0.189458, 0.188358, 0.193988
Train average loss UNet                 (all)                : 0.760973

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003093, 1.961015, 3.622637
Train average loss bass     (Triplet, dist_p, dist_n) : 0.026436, 1.379651, 2.090298
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020994, 1.474526, 2.248374
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.016962, 1.528332, 2.527645
Train average loss residuals(Triplet, dist_p, dist_n) : 0.017823, 1.628245, 2.640242
Train average loss all      (Triplet)                 : 0.017292

== Recognize ==
Train average loss Recognize     : 0.745845
Train average accuracy drums     : 49.715000 %
Train average accuracy bass      : 50.865002 %
Train average accuracy piano     : 50.105000 %
Train average accuracy guitar    : 50.849998 %
Train average accuracy residuals : 50.075001 %

== Train average loss all : 0.017292

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.765, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.765, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.765, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.00863, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00863, Train/loss_recog_step=0.757, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.00863, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00863, Train/loss_recog_step=0.757, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.712, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]  Epoch 17:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.712, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00999, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.761, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.00999, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.761, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0076, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0076, Train/loss_recog_step=0.719, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]  Epoch 17:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0076, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0076, Train/loss_recog_step=0.719, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.704, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.704, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.772, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.772, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.762, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.157, Valid/loss_recog_step=0.800, Valid/loss_all_epoch=0.242, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.521, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182938, 0.186338, 0.188219, 0.193267
Valid average loss UNet                 (all)                : 0.750761

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065657, 2.010606, 3.537750
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.380082, 1.757977, 1.797497
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.340878, 1.654531, 1.738230
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242558, 1.752071, 2.241569
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.145452, 1.897034, 2.415262
Valid average loss all      (Triplet)                 : 0.246073

== Recognize ==
Valid average loss Recognize     : 0.771040
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.246073

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.350252151489258 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.493606328964233 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.39124584197998 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.076631546020508 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.369439363479614 sec. =
Valid knn accuracy residuals : 74.0909090909091%

Valid knn accuracy average   : 53.31994436576748%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.762, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0173, Train/loss_recog_epoch=0.746]Epoch 17: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.762, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188960, 0.189266, 0.188166, 0.194886
Train average loss UNet                 (all)                : 0.761279

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002695, 2.007441, 3.683023
Train average loss bass     (Triplet, dist_p, dist_n) : 0.022983, 1.441900, 2.194129
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019175, 1.525366, 2.343518
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015950, 1.590565, 2.619749
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014512, 1.702109, 2.767939
Train average loss all      (Triplet)                 : 0.015289

== Recognize ==
Train average loss Recognize     : 0.748151
Train average accuracy drums     : 49.875000 %
Train average accuracy bass      : 49.930000 %
Train average accuracy piano     : 50.650002 %
Train average accuracy guitar    : 50.125004 %
Train average accuracy residuals : 50.980003 %

== Train average loss all : 0.015289

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.762, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.762, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.762, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.795, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.795, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.00274, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00274, Train/loss_recog_step=0.780, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00274, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00274, Train/loss_recog_step=0.780, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.758, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]  Epoch 18:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.758, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.790, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.790, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0046, Train/loss_recog_step=0.730, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0046, Train/loss_recog_step=0.730, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.752, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.752, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.763, Valid/loss_all_step=0.161, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.749, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.246, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.533, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183861, 0.187258, 0.189181, 0.198370
Valid average loss UNet                 (all)                : 0.758671

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065315, 2.017553, 3.648306
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.351297, 1.720083, 1.777489
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.297306, 1.569625, 1.643038
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.206923, 1.719828, 2.338101
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.184544, 1.726936, 2.364868
Valid average loss all      (Triplet)                 : 0.230789

== Recognize ==
Valid average loss Recognize     : 0.756846
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.230789

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.15069842338562 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.738201141357422 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.299596071243286 sec. =
Valid knn accuracy piano     : 37.109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.375092029571533 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.598990440368652 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 52.1546007244859%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.763, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0153, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0153, Train/loss_recog_epoch=0.748]Epoch 18: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.763, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189151, 0.189449, 0.188354, 0.194632
Train average loss UNet                 (all)                : 0.761586

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001526, 2.035805, 3.850458
Train average loss bass     (Triplet, dist_p, dist_n) : 0.020660, 1.493632, 2.298923
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020015, 1.582571, 2.430931
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015762, 1.665801, 2.766603
Train average loss residuals(Triplet, dist_p, dist_n) : 0.012459, 1.740819, 2.862981
Train average loss all      (Triplet)                 : 0.014323

== Recognize ==
Train average loss Recognize     : 0.754423
Train average accuracy drums     : 50.134998 %
Train average accuracy bass      : 50.419998 %
Train average accuracy piano     : 49.869999 %
Train average accuracy guitar    : 49.219997 %
Train average accuracy residuals : 50.524998 %

== Train average loss all : 0.014323

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.763, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.763, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  16%|█▌        | 50/313 [00:56<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.763, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  16%|█▌        | 50/313 [00:56<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.763, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]  Epoch 19:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.763, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.752, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.752, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.746, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.746, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=0.738, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.000845, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000845, Train/loss_recog_step=0.738, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0021, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.775, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]    Epoch 19:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0021, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.775, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00914, Train/loss_recog_step=0.746, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00914, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00914, Train/loss_recog_step=0.746, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.702, Valid/loss_all_step=0.145, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=0.709, Valid/loss_all_epoch=0.231, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.231, Valid/loss_recog_epoch=0.757, Valid/knn_avr=0.522, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.71it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.55it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184061, 0.187393, 0.189484, 0.201991
Valid average loss UNet                 (all)                : 0.762930

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.038267, 2.096467, 3.769191
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.346227, 1.874359, 1.973377
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.424082, 1.889974, 1.905617
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210072, 1.868759, 2.588802
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.217791, 2.033977, 2.468578
Valid average loss all      (Triplet)                 : 0.249421

== Recognize ==
Valid average loss Recognize     : 0.747671
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.249421

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.141488552093506 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.362468719482422 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.19835114479065 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.802433967590332 sec. =
Valid knn accuracy guitar    : 57.14285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.415841579437256 sec. =
Valid knn accuracy residuals : 63.86363636363637%

Valid knn accuracy average   : 54.02773628895648%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.702, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0143, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=0.754]Epoch 19: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.702, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189384, 0.189672, 0.188571, 0.195094
Train average loss UNet                 (all)                : 0.762721

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002520, 2.040459, 3.802017
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019667, 1.518577, 2.337803
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014206, 1.588832, 2.465111
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015547, 1.701751, 2.829616
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011856, 1.779657, 2.919991
Train average loss all      (Triplet)                 : 0.012933

== Recognize ==
Train average loss Recognize     : 0.756661
Train average accuracy drums     : 49.685001 %
Train average accuracy bass      : 49.895000 %
Train average accuracy piano     : 50.340004 %
Train average accuracy guitar    : 50.320000 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.012933

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.702, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.702, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  16%|█▌        | 50/313 [00:53<04:41,  0.94it/s, v_num=0, Train/loss_all_step=0.0246, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0246, Train/loss_recog_step=0.702, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  16%|█▌        | 50/313 [00:53<04:41,  0.94it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0278, Train/loss_recog_step=0.766, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0278, Train/loss_recog_step=0.766, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=0.736, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]  Epoch 20:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=0.736, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.744, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.744, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00192, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=0.772, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00192, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=0.772, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00155, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00155, Train/loss_recog_step=0.763, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  96%|█████████▌| 300/313 [04:57<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00155, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00155, Train/loss_recog_step=0.763, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20:  96%|█████████▌| 300/313 [04:57<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00941, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00941, Train/loss_recog_step=0.795, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00941, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00941, Train/loss_recog_step=0.795, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.739, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.249, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.249, Valid/loss_recog_epoch=0.748, Valid/knn_avr=0.540, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.20it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.65it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184726, 0.188089, 0.190201, 0.191301
Valid average loss UNet                 (all)                : 0.754316

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060705, 2.152434, 3.858359
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.327455, 1.903775, 2.053792
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.520642, 2.090831, 2.028985
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.176777, 1.888674, 2.614208
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.209466, 2.154336, 2.803590
Valid average loss all      (Triplet)                 : 0.261323

== Recognize ==
Valid average loss Recognize     : 0.794810
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.261323

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.957709550857544 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.520280838012695 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.795112133026123 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.271675825119019 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.622612953186035 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 54.596635876395695%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.739, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0129, Train/loss_recog_epoch=0.757]Epoch 20: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.739, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189347, 0.189644, 0.188536, 0.194674
Train average loss UNet                 (all)                : 0.762201

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002138, 2.087085, 3.918297
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018269, 1.544927, 2.407101
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014339, 1.657538, 2.575611
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011655, 1.725286, 2.911066
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010877, 1.829391, 3.031873
Train average loss all      (Triplet)                 : 0.011613

== Recognize ==
Train average loss Recognize     : 0.756479
Train average accuracy drums     : 50.080002 %
Train average accuracy bass      : 50.305004 %
Train average accuracy piano     : 50.024998 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 50.250000 %

== Train average loss all : 0.011613

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.739, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.739, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  16%|█▌        | 50/313 [00:57<05:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.739, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  16%|█▌        | 50/313 [00:57<05:00,  0.87it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.769, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]  Epoch 21:  32%|███▏      | 100/313 [01:46<03:47,  0.93it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.769, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  32%|███▏      | 100/313 [01:46<03:47,  0.93it/s, v_num=0, Train/loss_all_step=0.00278, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.751, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  48%|████▊     | 150/313 [02:34<02:48,  0.97it/s, v_num=0, Train/loss_all_step=0.00278, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.751, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  48%|████▊     | 150/313 [02:34<02:48,  0.97it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=0.788, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]  Epoch 21:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.0097, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0097, Train/loss_recog_step=0.788, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.781, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.781, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]    Epoch 21:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.759, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21: 100%|██████████| 313/313 [05:08<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.759, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21: 100%|██████████| 313/313 [05:08<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.818, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184693, 0.188112, 0.190060, 0.203967
Valid average loss UNet                 (all)                : 0.766832

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045255, 2.131365, 3.975175
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.287301, 1.934219, 2.156545
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.426555, 2.026323, 2.007343
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.228428, 1.923671, 2.546221
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.217644, 2.099710, 2.556628
Valid average loss all      (Triplet)                 : 0.243804

== Recognize ==
Valid average loss Recognize     : 0.745976
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.243804

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.524690628051758 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.118602275848389 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.195165634155273 sec. =
Valid knn accuracy piano     : 31.8359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.200342416763306 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.673811912536621 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 50.8552694566128%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [06:35<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.756]Epoch 21: 100%|██████████| 313/313 [06:35<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189362, 0.189661, 0.188554, 0.193886
Train average loss UNet                 (all)                : 0.761462

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002225, 2.135372, 4.027794
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018642, 1.626504, 2.541234
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014340, 1.747863, 2.736481
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011518, 1.780024, 3.011734
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010887, 1.882352, 3.126991
Train average loss all      (Triplet)                 : 0.011556

== Recognize ==
Train average loss Recognize     : 0.765128
Train average accuracy drums     : 49.700001 %
Train average accuracy bass      : 49.889999 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 50.164997 %
Train average accuracy residuals : 50.269997 %

== Train average loss all : 0.011556

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.749, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  32%|███▏      | 100/313 [01:37<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.749, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  32%|███▏      | 100/313 [01:37<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.783, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=0.783, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.00776, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00776, Train/loss_recog_step=0.774, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.00776, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00776, Train/loss_recog_step=0.774, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0024, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=0.816, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]  Epoch 22:  80%|███████▉  | 250/313 [03:59<01:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0024, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=0.816, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  80%|███████▉  | 250/313 [03:59<01:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.744, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.744, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.00712, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00712, Train/loss_recog_step=0.720, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.00712, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00712, Train/loss_recog_step=0.720, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.730, Valid/loss_all_step=0.142, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=0.632, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.509, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183751, 0.187149, 0.189106, 0.199529
Valid average loss UNet                 (all)                : 0.759535

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056151, 2.232392, 3.906299
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.381316, 2.069369, 2.247955
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.396795, 2.131810, 2.351657
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.218984, 2.079463, 2.883548
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.211987, 2.353752, 2.986736
Valid average loss all      (Triplet)                 : 0.267525

== Recognize ==
Valid average loss Recognize     : 0.782205
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.267525

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.952521800994873 sec. =
Valid knn accuracy drums     : 79.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.281591415405273 sec. =
Valid knn accuracy bass      : 28.42741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.853455543518066 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.180224418640137 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.086836338043213 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 52.84558056774922%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.730, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=0.765]Epoch 22: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.730, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189453, 0.189758, 0.188642, 0.194542
Train average loss UNet                 (all)                : 0.762395

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001466, 2.130213, 3.952029
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015951, 1.659035, 2.601832
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013579, 1.774928, 2.773414
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012643, 1.846925, 3.113737
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011037, 1.906970, 3.158652
Train average loss all      (Triplet)                 : 0.011146

== Recognize ==
Train average loss Recognize     : 0.766021
Train average accuracy drums     : 50.155003 %
Train average accuracy bass      : 49.549999 %
Train average accuracy piano     : 50.094997 %
Train average accuracy guitar    : 49.454998 %
Train average accuracy residuals : 49.634998 %

== Train average loss all : 0.011146

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.730, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.730, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  16%|█▌        | 50/313 [00:56<04:55,  0.89it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.730, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  16%|█▌        | 50/313 [00:56<04:55,  0.89it/s, v_num=0, Train/loss_all_step=0.00546, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=0.761, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00546, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=0.761, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.755, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.755, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00795, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00795, Train/loss_recog_step=0.772, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  64%|██████▍   | 200/313 [03:23<01:54,  0.98it/s, v_num=0, Train/loss_all_step=0.00795, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00795, Train/loss_recog_step=0.772, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  64%|██████▍   | 200/313 [03:23<01:54,  0.98it/s, v_num=0, Train/loss_all_step=0.00406, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.754, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.00406, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.754, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.00735, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.758, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.00735, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.758, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=0.765, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]  Epoch 23: 100%|██████████| 313/313 [05:08<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=0.765, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23: 100%|██████████| 313/313 [05:08<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.751, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.700, Valid/loss_all_epoch=0.268, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.268, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.46it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183438, 0.186784, 0.188665, 0.199523
Valid average loss UNet                 (all)                : 0.758409

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.043269, 2.187311, 3.987897
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.319616, 2.044710, 2.282536
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.357021, 2.066339, 2.207887
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.223953, 1.980617, 2.767385
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.160778, 2.304138, 2.689163
Valid average loss all      (Triplet)                 : 0.220670

== Recognize ==
Valid average loss Recognize     : 0.798224
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.220670

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.219010591506958 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.998268842697144 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.128777742385864 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.515949249267578 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.321137189865112 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 54.24953780441159%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.751, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0111, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=0.766]Epoch 23: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.751, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189282, 0.189565, 0.188452, 0.194947
Train average loss UNet                 (all)                : 0.762246

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001725, 2.129276, 3.990223
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015484, 1.665814, 2.612984
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014471, 1.779863, 2.810829
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011699, 1.858333, 3.125914
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009499, 1.919912, 3.189559
Train average loss all      (Triplet)                 : 0.010793

== Recognize ==
Train average loss Recognize     : 0.763382
Train average accuracy drums     : 49.855000 %
Train average accuracy bass      : 50.064999 %
Train average accuracy piano     : 50.300003 %
Train average accuracy guitar    : 50.255001 %
Train average accuracy residuals : 50.064999 %

== Train average loss all : 0.010793

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.751, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.751, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.751, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.793, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  32%|███▏      | 100/313 [01:42<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.793, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  32%|███▏      | 100/313 [01:42<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.00518, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.785, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00518, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.785, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.786, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.786, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.797, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]  Epoch 24:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.797, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.764, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0198, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.764, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.776, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.776, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]Epoch 24: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.785, Valid/loss_all_step=0.0479, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.0479, Valid/loss_recog_step=0.745, Valid/loss_all_epoch=0.221, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=0.798, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.61it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.23it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183685, 0.186987, 0.189012, 0.190977
Valid average loss UNet                 (all)                : 0.750661

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.045778, 2.321966, 4.270397
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.350376, 2.164344, 2.346575
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.378294, 2.160454, 2.209544
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.157626, 1.985892, 2.808624
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.222113, 2.171909, 2.797887
Valid average loss all      (Triplet)                 : 0.240698

== Recognize ==
Valid average loss Recognize     : 0.851043
Valid average accuracy drums     : 41.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 42.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.240698

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.30319881439209 sec. =
Valid knn accuracy drums     : 79.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.162108182907104 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.952561855316162 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.861900329589844 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.674214363098145 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 53.6594170643522%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.785, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=0.763]  Epoch 24: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.785, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189406, 0.189708, 0.188590, 0.194214
Train average loss UNet                 (all)                : 0.761918

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001239, 2.183452, 4.174174
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016892, 1.748324, 2.726007
Train average loss piano    (Triplet, dist_p, dist_n) : 0.017393, 1.847345, 2.888049
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010394, 1.886636, 3.183435
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009210, 2.007986, 3.352993
Train average loss all      (Triplet)                 : 0.011202

== Recognize ==
Train average loss Recognize     : 0.778955
Train average accuracy drums     : 49.489998 %
Train average accuracy bass      : 50.015003 %
Train average accuracy piano     : 49.579998 %
Train average accuracy guitar    : 49.110001 %
Train average accuracy residuals : 50.779999 %

== Train average loss all : 0.011202

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.785, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.785, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.00924, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.00924, Train/loss_recog_step=0.785, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.00549, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00549, Train/loss_recog_step=0.751, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.00549, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00549, Train/loss_recog_step=0.751, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.767, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]  Epoch 25:  48%|████▊     | 150/313 [02:29<02:42,  1.01it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.767, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  48%|████▊     | 150/313 [02:29<02:42,  1.01it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=0.793, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  64%|██████▍   | 200/313 [03:13<01:49,  1.04it/s, v_num=0, Train/loss_all_step=0.0189, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=0.793, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  64%|██████▍   | 200/313 [03:13<01:49,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]  Epoch 25:  80%|███████▉  | 250/313 [04:01<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  80%|███████▉  | 250/313 [04:01<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.021, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.021, Train/loss_recog_step=0.784, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.021, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.021, Train/loss_recog_step=0.784, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.773, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25: 100%|██████████| 313/313 [04:53<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.773, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25: 100%|██████████| 313/313 [04:53<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.241, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184716, 0.188033, 0.190134, 0.201483
Valid average loss UNet                 (all)                : 0.764366

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.031176, 2.215426, 4.220224
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.436500, 2.167195, 2.267626
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.407521, 2.052222, 2.319907
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.189148, 2.118869, 2.851812
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.223587, 2.494972, 3.137372
Valid average loss all      (Triplet)                 : 0.270929

== Recognize ==
Valid average loss Recognize     : 0.830656
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.270929

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.481975793838501 sec. =
Valid knn accuracy drums     : 77.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.296352624893188 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.373806238174438 sec. =
Valid knn accuracy piano     : 36.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.115065336227417 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.96415662765503 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 54.144519510118215%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=0.779]Epoch 25: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189262, 0.189550, 0.188433, 0.194670
Train average loss UNet                 (all)                : 0.761915

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001702, 2.177591, 4.164475
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014512, 1.719915, 2.714662
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010183, 1.831407, 2.903034
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008488, 1.864629, 3.151500
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009782, 2.006460, 3.317971
Train average loss all      (Triplet)                 : 0.009026

== Recognize ==
Train average loss Recognize     : 0.778539
Train average accuracy drums     : 49.845001 %
Train average accuracy bass      : 49.965000 %
Train average accuracy piano     : 50.215000 %
Train average accuracy guitar    : 49.669998 %
Train average accuracy residuals : 49.915001 %

== Train average loss all : 0.009026

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  16%|█▌        | 50/313 [00:56<04:58,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  16%|█▌        | 50/313 [00:56<04:58,  0.88it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.790, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.790, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=0.753, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  48%|████▊     | 150/313 [02:31<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=0.753, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  48%|████▊     | 150/313 [02:31<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.000338, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.747, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.000338, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.747, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.798, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]    Epoch 26:  80%|███████▉  | 250/313 [04:03<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.798, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  80%|███████▉  | 250/313 [04:03<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.773, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.773, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=0.807, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=0.807, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.756, Valid/loss_all_step=0.184, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.184, Valid/loss_recog_step=0.774, Valid/loss_all_epoch=0.271, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.271, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.75it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.83it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.84it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185914, 0.189317, 0.191512, 0.204164
Valid average loss UNet                 (all)                : 0.770907

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.030900, 2.227637, 4.208173
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.386687, 2.248641, 2.487451
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.381401, 2.311036, 2.521646
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.173254, 2.132679, 3.037199
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.214142, 2.336404, 3.292544
Valid average loss all      (Triplet)                 : 0.243340

== Recognize ==
Valid average loss Recognize     : 0.766942
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.243340

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.520061016082764 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.692168712615967 sec. =
Valid knn accuracy bass      : 16.532258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.554491996765137 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.855340003967285 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.241855382919312 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 53.07221777608786%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.756, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00903, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00903, Train/loss_recog_epoch=0.779]Epoch 26: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.756, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189493, 0.189791, 0.188693, 0.194343
Train average loss UNet                 (all)                : 0.762319

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002370, 2.263264, 4.255196
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014738, 1.819249, 2.852335
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013616, 1.920364, 3.030650
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009702, 1.977811, 3.362979
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009503, 2.119381, 3.534690
Train average loss all      (Triplet)                 : 0.010080

== Recognize ==
Train average loss Recognize     : 0.782022
Train average accuracy drums     : 49.450001 %
Train average accuracy bass      : 50.174999 %
Train average accuracy piano     : 50.064999 %
Train average accuracy guitar    : 50.089996 %
Train average accuracy residuals : 49.704998 %

== Train average loss all : 0.010080

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.756, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.756, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  16%|█▌        | 50/313 [00:56<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.756, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  16%|█▌        | 50/313 [00:56<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.00719, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00719, Train/loss_recog_step=0.817, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.00719, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00719, Train/loss_recog_step=0.817, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.793, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]    Epoch 27:  48%|████▊     | 150/313 [02:32<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.793, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  48%|████▊     | 150/313 [02:32<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.754, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.754, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.749, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.749, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]    Epoch 27:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.775, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.775, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.131, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.673, Valid/loss_all_epoch=0.243, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.531, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185013, 0.188320, 0.190537, 0.205628
Valid average loss UNet                 (all)                : 0.769498

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.018033, 2.170500, 3.985562
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.402778, 2.307314, 2.458322
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.416429, 2.201798, 2.272516
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.172375, 2.159019, 2.814927
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.212021, 2.477562, 2.937551
Valid average loss all      (Triplet)                 : 0.255416

== Recognize ==
Valid average loss Recognize     : 0.776202
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.255416

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.33447527885437 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.892702579498291 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.965265274047852 sec. =
Valid knn accuracy piano     : 41.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.931348323822021 sec. =
Valid knn accuracy guitar    : 56.47321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.684089660644531 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 54.63350693179541%

                                                                      [AEpoch 27: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=0.782]Epoch 27: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189520, 0.189821, 0.188726, 0.194670
Train average loss UNet                 (all)                : 0.762738

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002617, 2.253620, 4.228850
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014977, 1.831384, 2.881097
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009836, 1.905775, 3.039703
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008274, 1.979855, 3.384811
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011574, 2.108530, 3.522430
Train average loss all      (Triplet)                 : 0.009709

== Recognize ==
Train average loss Recognize     : 0.780369
Train average accuracy drums     : 50.320000 %
Train average accuracy bass      : 49.544998 %
Train average accuracy piano     : 50.375004 %
Train average accuracy guitar    : 50.024998 %
Train average accuracy residuals : 49.915001 %

== Train average loss all : 0.009709

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.757, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.757, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.785, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00572, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.785, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00989, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00989, Train/loss_recog_step=0.761, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00989, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00989, Train/loss_recog_step=0.761, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00536, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00536, Train/loss_recog_step=0.772, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00536, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00536, Train/loss_recog_step=0.772, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00313, Train/loss_recog_step=0.788, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00313, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.00313, Train/loss_recog_step=0.788, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.784, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]    Epoch 28: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.784, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.171, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=0.689, Valid/loss_all_epoch=0.255, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.255, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.90it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184389, 0.187777, 0.189853, 0.203764
Valid average loss UNet                 (all)                : 0.765783

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.025099, 2.355672, 4.274289
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.445299, 2.379252, 2.586022
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.396213, 2.198270, 2.513823
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184597, 2.282601, 3.109216
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.281141, 2.676185, 3.277444
Valid average loss all      (Triplet)                 : 0.278731

== Recognize ==
Valid average loss Recognize     : 0.820112
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.278731

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.481698751449585 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.102613925933838 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.996088027954102 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.389375448226929 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.946473836898804 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 52.09539884860931%

                                                                      [AEpoch 28: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.780]Epoch 28: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189543, 0.189849, 0.188711, 0.195228
Train average loss UNet                 (all)                : 0.763331

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001540, 2.285977, 4.285978
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013898, 1.872188, 2.964303
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012572, 1.960940, 3.105619
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008777, 2.054584, 3.456350
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008535, 2.185103, 3.697018
Train average loss all      (Triplet)                 : 0.009220

== Recognize ==
Train average loss Recognize     : 0.782099
Train average accuracy drums     : 49.919998 %
Train average accuracy bass      : 49.875000 %
Train average accuracy piano     : 50.005001 %
Train average accuracy guitar    : 50.300003 %
Train average accuracy residuals : 50.005001 %

== Train average loss all : 0.009220

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  16%|█▌        | 50/313 [00:56<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  16%|█▌        | 50/313 [00:56<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.818, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  32%|███▏      | 100/313 [01:46<03:45,  0.94it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.818, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  32%|███▏      | 100/313 [01:46<03:45,  0.94it/s, v_num=0, Train/loss_all_step=0.00222, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.790, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  48%|████▊     | 150/313 [02:32<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00222, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.790, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  48%|████▊     | 150/313 [02:32<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.767, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.00402, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.767, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.00897, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=0.800, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=0.00897, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=0.800, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00624, Train/loss_recog_step=0.776, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00624, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00624, Train/loss_recog_step=0.776, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.757, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]    Epoch 29: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.757, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.139, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.279, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.87it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183790, 0.187151, 0.189061, 0.195246
Valid average loss UNet                 (all)                : 0.755248

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.037110, 2.352567, 4.382046
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.445920, 2.502880, 2.710495
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.442276, 2.233340, 2.474112
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.260902, 2.247353, 3.062413
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.191987, 2.608877, 3.254529
Valid average loss all      (Triplet)                 : 0.289688

== Recognize ==
Valid average loss Recognize     : 0.762740
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.289688

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.472455263137817 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.884098052978516 sec. =
Valid knn accuracy bass      : 19.758064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.620837926864624 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.487815618515015 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.973033905029297 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 52.38546912852225%

                                                                      [AEpoch 29: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00922, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00922, Train/loss_recog_epoch=0.782]Epoch 29: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189611, 0.189898, 0.188774, 0.194177
Train average loss UNet                 (all)                : 0.762460

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002086, 2.342249, 4.416701
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013559, 1.895162, 3.000459
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011209, 1.981912, 3.143885
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011522, 2.109579, 3.549832
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009124, 2.216302, 3.690518
Train average loss all      (Triplet)                 : 0.009711

== Recognize ==
Train average loss Recognize     : 0.788374
Train average accuracy drums     : 49.415001 %
Train average accuracy bass      : 49.680000 %
Train average accuracy piano     : 50.330002 %
Train average accuracy guitar    : 49.160000 %
Train average accuracy residuals : 50.150002 %

== Train average loss all : 0.009711

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  16%|█▌        | 50/313 [00:56<04:57,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  16%|█▌        | 50/313 [00:56<04:57,  0.88it/s, v_num=0, Train/loss_all_step=0.00489, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.761, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00489, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.761, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00254, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00254, Train/loss_recog_step=0.794, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  48%|████▊     | 150/313 [02:30<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00254, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00254, Train/loss_recog_step=0.794, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  48%|████▊     | 150/313 [02:30<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]    Epoch 30:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=4.41e-5, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=4.41e-5, Train/loss_recog_step=0.776, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=4.41e-5, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=4.41e-5, Train/loss_recog_step=0.776, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.787, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]  Epoch 30:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.787, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.780, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]  Epoch 30: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.006, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.780, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00821, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.749, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.717, Valid/loss_all_epoch=0.290, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183591, 0.187029, 0.188963, 0.198414
Valid average loss UNet                 (all)                : 0.757996

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.023457, 2.465716, 4.372646
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.490540, 2.681728, 2.917079
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.498949, 2.537292, 2.781414
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.262088, 2.500133, 3.234522
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.245605, 2.715587, 3.563086
Valid average loss all      (Triplet)                 : 0.328367

== Recognize ==
Valid average loss Recognize     : 0.812637
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.328367

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.63008451461792 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.966574907302856 sec. =
Valid knn accuracy bass      : 23.18548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.41421890258789 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.305961847305298 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.697781801223755 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 51.59499926572375%

                                                                      [AEpoch 30: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00821, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.749, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00971, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00971, Train/loss_recog_epoch=0.788]Epoch 30: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00821, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.749, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.188952, 0.189254, 0.188150, 0.194601
Train average loss UNet                 (all)                : 0.760956

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003112, 2.344151, 4.385789
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014911, 1.934396, 3.050923
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009348, 2.025715, 3.226758
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008830, 2.162668, 3.627049
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008138, 2.237996, 3.731307
Train average loss all      (Triplet)                 : 0.008988

== Recognize ==
Train average loss Recognize     : 0.786122
Train average accuracy drums     : 49.634998 %
Train average accuracy bass      : 50.269997 %
Train average accuracy piano     : 50.309998 %
Train average accuracy guitar    : 50.094997 %
Train average accuracy residuals : 50.125004 %

== Train average loss all : 0.008988

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00821, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.749, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00821, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.749, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.00821, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.749, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=0.833, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]    Epoch 31:  32%|███▏      | 100/313 [01:45<03:45,  0.94it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=0.833, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  32%|███▏      | 100/313 [01:45<03:45,  0.94it/s, v_num=0, Train/loss_all_step=0.00524, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00524, Train/loss_recog_step=0.793, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  48%|████▊     | 150/313 [02:35<02:48,  0.97it/s, v_num=0, Train/loss_all_step=0.00524, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00524, Train/loss_recog_step=0.793, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  48%|████▊     | 150/313 [02:35<02:48,  0.97it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.758, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]  Epoch 31:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.758, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.795, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]  Epoch 31:  80%|███████▉  | 250/313 [04:10<01:03,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.795, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  80%|███████▉  | 250/313 [04:10<01:03,  1.00it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.770, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  96%|█████████▌| 300/313 [04:57<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.770, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31:  96%|█████████▌| 300/313 [04:57<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.811, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.811, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=9.78e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=9.78e-5, Train/loss_recog_step=0.745, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.746, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.516, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.74it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.97it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.21it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184048, 0.187384, 0.189642, 0.197123
Valid average loss UNet                 (all)                : 0.758197

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.013781, 2.331537, 4.323149
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.523724, 2.551092, 2.682848
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.430452, 2.276203, 2.483718
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.277919, 2.364407, 3.029138
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.196669, 2.668458, 3.695150
Valid average loss all      (Triplet)                 : 0.324488

== Recognize ==
Valid average loss Recognize     : 0.763144
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.324488

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.685129880905151 sec. =
Valid knn accuracy drums     : 81.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.854902505874634 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.19186782836914 sec. =
Valid knn accuracy piano     : 38.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.996916770935059 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.19449758529663 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 53.08134628126082%

                                                                      [AEpoch 31: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=9.78e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=9.78e-5, Train/loss_recog_step=0.745, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00899, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00899, Train/loss_recog_epoch=0.786]Epoch 31: 100%|██████████| 313/313 [06:33<00:00,  0.80it/s, v_num=0, Train/loss_all_step=9.78e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=9.78e-5, Train/loss_recog_step=0.745, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189288, 0.189586, 0.188465, 0.194459
Train average loss UNet                 (all)                : 0.761799

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002245, 2.396102, 4.469745
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010950, 1.981482, 3.166026
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013223, 2.070508, 3.265577
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009143, 2.163757, 3.707194
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007484, 2.253971, 3.768594
Train average loss all      (Triplet)                 : 0.008712

== Recognize ==
Train average loss Recognize     : 0.790917
Train average accuracy drums     : 49.654999 %
Train average accuracy bass      : 50.424999 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 49.720001 %
Train average accuracy residuals : 50.129997 %

== Train average loss all : 0.008712

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=9.78e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=9.78e-5, Train/loss_recog_step=0.745, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=9.78e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=9.78e-5, Train/loss_recog_step=0.745, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s, v_num=0, Train/loss_all_step=9.78e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=9.78e-5, Train/loss_recog_step=0.745, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.784, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00928, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.784, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.769, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.769, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.00029, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00029, Train/loss_recog_step=0.798, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00029, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00029, Train/loss_recog_step=0.798, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.860, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]  Epoch 32:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.860, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00768, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=0.813, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00768, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00768, Train/loss_recog_step=0.813, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.809, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]  Epoch 32: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=0.809, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.787, Valid/loss_all_step=0.376, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=0.730, Valid/loss_all_epoch=0.324, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.324, Valid/loss_recog_epoch=0.763, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183389, 0.186756, 0.188703, 0.203691
Valid average loss UNet                 (all)                : 0.762539

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061830, 2.474480, 4.739853
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.529903, 2.726312, 2.800156
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.416955, 2.366870, 2.643701
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.186154, 2.290321, 3.154967
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243076, 2.736184, 3.483001
Valid average loss all      (Triplet)                 : 0.312975

== Recognize ==
Valid average loss Recognize     : 0.816173
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.312975

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.976124286651611 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.554835557937622 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.739196300506592 sec. =
Valid knn accuracy piano     : 33.203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.704776763916016 sec. =
Valid knn accuracy guitar    : 58.25892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.833751678466797 sec. =
Valid knn accuracy residuals : 60.68181818181818%

Valid knn accuracy average   : 51.98207028332818%

                                                                      [AEpoch 32: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.787, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00871, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00871, Train/loss_recog_epoch=0.791]Epoch 32: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.787, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189675, 0.189976, 0.188843, 0.194686
Train average loss UNet                 (all)                : 0.763179

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001826, 2.407406, 4.598101
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012158, 2.011074, 3.218946
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008890, 2.072627, 3.328840
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007493, 2.153523, 3.676219
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009207, 2.308919, 3.859130
Train average loss all      (Triplet)                 : 0.007950

== Recognize ==
Train average loss Recognize     : 0.795922
Train average accuracy drums     : 50.174999 %
Train average accuracy bass      : 50.105000 %
Train average accuracy piano     : 49.230000 %
Train average accuracy guitar    : 49.514999 %
Train average accuracy residuals : 50.050003 %

== Train average loss all : 0.007950

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.787, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.787, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  16%|█▌        | 50/313 [00:56<04:57,  0.88it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.787, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  16%|█▌        | 50/313 [00:56<04:57,  0.88it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.831, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  32%|███▏      | 100/313 [01:45<03:43,  0.95it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.831, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  32%|███▏      | 100/313 [01:45<03:43,  0.95it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.784, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.784, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00298, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=0.778, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.00298, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=0.778, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.821, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.821, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.772, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]  Epoch 33:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.772, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.783, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00613, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00613, Train/loss_recog_step=0.783, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.758, Valid/loss_all_step=0.317, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=0.816, Valid/loss_all_epoch=0.313, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.15it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183487, 0.186909, 0.188611, 0.200549
Valid average loss UNet                 (all)                : 0.759556

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.034574, 2.417874, 4.470712
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.529012, 2.634502, 2.776542
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.347038, 2.332831, 2.588799
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.282302, 2.254466, 3.049556
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.227100, 2.515142, 3.292095
Valid average loss all      (Triplet)                 : 0.313776

== Recognize ==
Valid average loss Recognize     : 0.735448
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.313776

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.203715085983276 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.560601234436035 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.482487440109253 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.408767700195312 sec. =
Valid knn accuracy guitar    : 47.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.630510091781616 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 53.03518535067667%

                                                                      [AEpoch 33: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.758, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00795, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00795, Train/loss_recog_epoch=0.796]Epoch 33: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.758, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189506, 0.189811, 0.188699, 0.194485
Train average loss UNet                 (all)                : 0.762502

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001848, 2.434339, 4.701865
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013428, 2.054453, 3.284353
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008893, 2.112471, 3.389009
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008826, 2.201750, 3.732065
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009045, 2.340251, 3.894707
Train average loss all      (Triplet)                 : 0.008787

== Recognize ==
Train average loss Recognize     : 0.802517
Train average accuracy drums     : 49.955002 %
Train average accuracy bass      : 49.505001 %
Train average accuracy piano     : 50.985001 %
Train average accuracy guitar    : 49.520000 %
Train average accuracy residuals : 49.474998 %

== Train average loss all : 0.008787

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.758, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.758, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  16%|█▌        | 50/313 [00:49<04:19,  1.02it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.0258, Train/loss_recog_step=0.758, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  16%|█▌        | 50/313 [00:49<04:19,  1.02it/s, v_num=0, Train/loss_all_step=0.00886, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.772, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.00886, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.772, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=1.12e-5, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=1.12e-5, Train/loss_recog_step=0.854, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=1.12e-5, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=1.12e-5, Train/loss_recog_step=0.854, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.833, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]  Epoch 34:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.833, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.853, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.853, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00513, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00513, Train/loss_recog_step=0.838, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00513, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00513, Train/loss_recog_step=0.838, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.766, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.766, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.781, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.465, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.314, Valid/loss_recog_epoch=0.735, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183641, 0.187001, 0.188881, 0.196150
Valid average loss UNet                 (all)                : 0.755673

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062351, 2.526702, 4.706773
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.513237, 2.731219, 2.860115
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.428237, 2.574388, 2.754569
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.158684, 2.398383, 3.514049
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.210646, 2.595378, 3.370710
Valid average loss all      (Triplet)                 : 0.295130

== Recognize ==
Valid average loss Recognize     : 0.841380
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.295130

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.927319288253784 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.915354490280151 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.164696216583252 sec. =
Valid knn accuracy piano     : 35.15625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.275134801864624 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.7064950466156 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 53.3658682218903%

                                                                      [AEpoch 34: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.781, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00879, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00879, Train/loss_recog_epoch=0.803]Epoch 34: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.781, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189234, 0.189535, 0.188412, 0.194265
Train average loss UNet                 (all)                : 0.761445

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001866, 2.449394, 4.619538
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007927, 2.056336, 3.318781
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009922, 2.136661, 3.418275
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011085, 2.245217, 3.791647
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007479, 2.339231, 3.934154
Train average loss all      (Triplet)                 : 0.007637

== Recognize ==
Train average loss Recognize     : 0.807402
Train average accuracy drums     : 50.314999 %
Train average accuracy bass      : 50.305004 %
Train average accuracy piano     : 50.075001 %
Train average accuracy guitar    : 48.750000 %
Train average accuracy residuals : 49.579998 %

== Train average loss all : 0.007637

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.781, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.781, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=0.781, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=0.787, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]  Epoch 35:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=0.787, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.00875, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=0.847, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00875, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=0.847, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=0.818, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]  Epoch 35:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=0.818, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.000726, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000726, Train/loss_recog_step=0.793, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.000726, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000726, Train/loss_recog_step=0.793, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.799, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]    Epoch 35:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.799, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.842, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.842, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.271, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.271, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.295, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.63it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.61it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183682, 0.187074, 0.189048, 0.198260
Valid average loss UNet                 (all)                : 0.758064

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056842, 2.571469, 4.619783
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.475162, 2.836751, 2.935748
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.580487, 2.734456, 2.833243
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.216439, 2.475420, 3.462848
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.265995, 2.856357, 3.665361
Valid average loss all      (Triplet)                 : 0.338058

== Recognize ==
Valid average loss Recognize     : 0.822437
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.338058

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.485728025436401 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.722030639648438 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.815221786499023 sec. =
Valid knn accuracy piano     : 33.59375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.289994239807129 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.134958267211914 sec. =
Valid knn accuracy residuals : 59.77272727272728%

Valid knn accuracy average   : 49.86182230287245%

                                                                      [AEpoch 35: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00764, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00764, Train/loss_recog_epoch=0.807]Epoch 35: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189460, 0.189745, 0.188637, 0.195280
Train average loss UNet                 (all)                : 0.763122

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002387, 2.521219, 4.736835
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010358, 2.103867, 3.363186
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011580, 2.180884, 3.468870
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008526, 2.313683, 3.938634
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008730, 2.405824, 4.029804
Train average loss all      (Triplet)                 : 0.008406

== Recognize ==
Train average loss Recognize     : 0.811949
Train average accuracy drums     : 49.980000 %
Train average accuracy bass      : 49.959999 %
Train average accuracy piano     : 50.054996 %
Train average accuracy guitar    : 50.120003 %
Train average accuracy residuals : 50.985001 %

== Train average loss all : 0.008406

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.000269, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000269, Train/loss_recog_step=0.835, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  32%|███▏      | 100/313 [01:37<03:27,  1.02it/s, v_num=0, Train/loss_all_step=0.000269, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000269, Train/loss_recog_step=0.835, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  32%|███▏      | 100/313 [01:37<03:27,  1.02it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.772, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]    Epoch 36:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.772, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.884, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.00902, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00902, Train/loss_recog_step=0.884, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.818, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]    Epoch 36:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.818, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00523, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00523, Train/loss_recog_step=0.786, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00523, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00523, Train/loss_recog_step=0.786, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.791, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]  Epoch 36: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0187, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.791, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.325, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.325, Valid/loss_recog_step=0.698, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.822, Valid/knn_avr=0.499, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184203, 0.187587, 0.189630, 0.199547
Valid average loss UNet                 (all)                : 0.760967

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079629, 2.464404, 4.530110
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.475869, 2.840417, 2.997545
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.472438, 2.577694, 2.710397
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.229206, 2.493709, 3.265804
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.238544, 2.741603, 3.717137
Valid average loss all      (Triplet)                 : 0.320219

== Recognize ==
Valid average loss Recognize     : 0.796885
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.320219

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.282806873321533 sec. =
Valid knn accuracy drums     : 79.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.068866729736328 sec. =
Valid knn accuracy bass      : 23.18548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.541562795639038 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.129968166351318 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.370252847671509 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 52.807343986220644%

                                                                      [AEpoch 36: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00841, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00841, Train/loss_recog_epoch=0.812]Epoch 36: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189540, 0.189831, 0.188713, 0.194117
Train average loss UNet                 (all)                : 0.762201

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001300, 2.535227, 4.782278
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009191, 2.096959, 3.373938
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008290, 2.182441, 3.523948
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007780, 2.331360, 3.978270
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008330, 2.439654, 4.101962
Train average loss all      (Triplet)                 : 0.007044

== Recognize ==
Train average loss Recognize     : 0.819457
Train average accuracy drums     : 49.814999 %
Train average accuracy bass      : 50.215000 %
Train average accuracy piano     : 49.139999 %
Train average accuracy guitar    : 49.805000 %
Train average accuracy residuals : 50.260002 %

== Train average loss all : 0.007044

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=0.784, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=0.784, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00932, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00932, Train/loss_recog_step=0.795, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00932, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00932, Train/loss_recog_step=0.795, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.000973, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000973, Train/loss_recog_step=0.822, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.000973, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000973, Train/loss_recog_step=0.822, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]      Epoch 37:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.000438, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000438, Train/loss_recog_step=0.810, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.000438, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000438, Train/loss_recog_step=0.810, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00546, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=0.804, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]  Epoch 37: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00546, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=0.804, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.828, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.699, Valid/loss_all_epoch=0.320, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=0.797, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.63it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183091, 0.186445, 0.188508, 0.201115
Valid average loss UNet                 (all)                : 0.759159

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068717, 2.448795, 4.535345
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.437055, 2.715424, 2.943648
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.418380, 2.474928, 2.753241
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.239782, 2.373413, 3.394304
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.140424, 2.448308, 3.622636
Valid average loss all      (Triplet)                 : 0.277284

== Recognize ==
Valid average loss Recognize     : 0.859897
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.277284

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.190446853637695 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.745406866073608 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.219459056854248 sec. =
Valid knn accuracy piano     : 34.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.692754030227661 sec. =
Valid knn accuracy guitar    : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.36052131652832 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 52.58855826851969%

                                                                      [AEpoch 37: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.828, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00704, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=0.819]Epoch 37: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.828, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189364, 0.189677, 0.188540, 0.194854
Train average loss UNet                 (all)                : 0.762435

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001355, 2.457020, 4.625850
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011002, 2.096020, 3.357366
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008552, 2.148093, 3.462037
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007768, 2.291036, 3.915443
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008188, 2.400485, 4.025867
Train average loss all      (Triplet)                 : 0.007361

== Recognize ==
Train average loss Recognize     : 0.816602
Train average accuracy drums     : 50.340004 %
Train average accuracy bass      : 50.435001 %
Train average accuracy piano     : 50.185001 %
Train average accuracy guitar    : 49.634998 %
Train average accuracy residuals : 49.739998 %

== Train average loss all : 0.007361

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.828, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.828, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  16%|█▌        | 50/313 [00:56<04:55,  0.89it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.828, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  16%|█▌        | 50/313 [00:56<04:55,  0.89it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.799, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.799, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=0.769, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  48%|████▊     | 150/313 [02:32<02:45,  0.98it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00673, Train/loss_recog_step=0.769, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  48%|████▊     | 150/313 [02:32<02:45,  0.98it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00472, Train/loss_recog_step=0.840, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00472, Train/loss_recog_step=0.840, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.790, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]    Epoch 38:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.790, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.771, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.938, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.277, Valid/loss_recog_epoch=0.860, Valid/knn_avr=0.526, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182041, 0.185483, 0.186974, 0.184360
Valid average loss UNet                 (all)                : 0.738857

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101644, 2.473983, 4.491691
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.536233, 2.940764, 2.979295
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.542691, 2.671111, 2.797864
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.232276, 2.451839, 3.429970
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243566, 2.791900, 3.422467
Valid average loss all      (Triplet)                 : 0.338060

== Recognize ==
Valid average loss Recognize     : 0.844887
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.338060

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.072755336761475 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.775852680206299 sec. =
Valid knn accuracy bass      : 20.161290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.182938575744629 sec. =
Valid knn accuracy piano     : 35.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.107877016067505 sec. =
Valid knn accuracy guitar    : 58.03571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.514126777648926 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 54.18460843154042%

                                                                      [AEpoch 38: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00736, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00736, Train/loss_recog_epoch=0.817]Epoch 38: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189164, 0.189470, 0.188352, 0.194442
Train average loss UNet                 (all)                : 0.761428

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001844, 2.549939, 4.770269
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009263, 2.179663, 3.525989
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008709, 2.257941, 3.610837
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008301, 2.379750, 4.065944
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006125, 2.482504, 4.190347
Train average loss all      (Triplet)                 : 0.006963

== Recognize ==
Train average loss Recognize     : 0.825761
Train average accuracy drums     : 49.509998 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 50.704998 %
Train average accuracy guitar    : 49.614998 %
Train average accuracy residuals : 49.924999 %

== Train average loss all : 0.006963

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  16%|█▌        | 50/313 [00:57<05:02,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  16%|█▌        | 50/313 [00:57<05:02,  0.87it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.829, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.829, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.876, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.876, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0183, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.800, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]  Epoch 39:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0183, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=0.800, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00553, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.818, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00553, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.818, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.824, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]  Epoch 39:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.824, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=3.97e-5, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=3.97e-5, Train/loss_recog_step=0.805, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=3.97e-5, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=3.97e-5, Train/loss_recog_step=0.805, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.178, Valid/loss_unet_all_step=0.720, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.954, Valid/loss_all_epoch=0.338, Valid/loss_unet_all_epoch=0.739, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=0.845, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.92it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.82it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183867, 0.187275, 0.188966, 0.199527
Valid average loss UNet                 (all)                : 0.759635

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113887, 2.487785, 4.557243
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.508197, 2.805692, 2.946427
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.377240, 2.494783, 2.773384
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.197125, 2.404670, 3.432874
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.257209, 2.751571, 3.513547
Valid average loss all      (Triplet)                 : 0.305237

== Recognize ==
Valid average loss Recognize     : 0.865411
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.305237

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.39586615562439 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.596624374389648 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.258658170700073 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.641855239868164 sec. =
Valid knn accuracy guitar    : 58.70535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.40411901473999 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 54.67340260764831%

                                                                      [AEpoch 39: 100%|██████████| 313/313 [06:24<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00696, Train/loss_unet_all_epoch=0.761, Train/loss_triplet_all_epoch=0.00696, Train/loss_recog_epoch=0.826]Epoch 39: 100%|██████████| 313/313 [06:24<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189497, 0.189796, 0.188707, 0.194861
Train average loss UNet                 (all)                : 0.762860

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001693, 2.490814, 4.700249
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009134, 2.176444, 3.482304
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007824, 2.212788, 3.561739
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009584, 2.364916, 4.014957
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008338, 2.446962, 4.118916
Train average loss all      (Triplet)                 : 0.007562

== Recognize ==
Train average loss Recognize     : 0.825661
Train average accuracy drums     : 50.314999 %
Train average accuracy bass      : 49.730000 %
Train average accuracy piano     : 49.584999 %
Train average accuracy guitar    : 49.919998 %
Train average accuracy residuals : 50.900002 %

== Train average loss all : 0.007562

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  16%|█▌        | 50/313 [00:50<04:27,  0.98it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=0.849, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.0079, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=0.849, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]  Epoch 40:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.00252, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.880, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00252, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.880, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.000726, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000726, Train/loss_recog_step=0.865, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.000726, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000726, Train/loss_recog_step=0.865, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.838, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]    Epoch 40:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0251, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.838, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.000437, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000437, Train/loss_recog_step=0.899, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.000437, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000437, Train/loss_recog_step=0.899, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.173, Valid/loss_recog_step=0.846, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.865, Valid/knn_avr=0.547, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.45it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.89it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183970, 0.187367, 0.189418, 0.200570
Valid average loss UNet                 (all)                : 0.761325

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104747, 2.467701, 4.577162
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.512474, 2.808487, 2.950735
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.463159, 2.487676, 2.702527
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.214616, 2.497492, 3.350590
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.222608, 2.714653, 3.594508
Valid average loss all      (Triplet)                 : 0.317597

== Recognize ==
Valid average loss Recognize     : 0.809188
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.317597

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.510375738143921 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.08722734451294 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.331776142120361 sec. =
Valid knn accuracy piano     : 40.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.458946704864502 sec. =
Valid knn accuracy guitar    : 64.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.791219711303711 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 56.62113935766197%

                                                                      [AEpoch 40: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00756, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=0.826]Epoch 40: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189309, 0.189594, 0.188489, 0.194435
Train average loss UNet                 (all)                : 0.761827

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001357, 2.528585, 4.770948
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009902, 2.197269, 3.511255
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007276, 2.236627, 3.602694
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009619, 2.414004, 4.059571
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007604, 2.476593, 4.188930
Train average loss all      (Triplet)                 : 0.007126

== Recognize ==
Train average loss Recognize     : 0.837205
Train average accuracy drums     : 50.000000 %
Train average accuracy bass      : 49.794998 %
Train average accuracy piano     : 49.799999 %
Train average accuracy guitar    : 50.360001 %
Train average accuracy residuals : 49.410000 %

== Train average loss all : 0.007126

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  32%|███▏      | 100/313 [01:43<03:40,  0.97it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  32%|███▏      | 100/313 [01:43<03:40,  0.97it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=0.802, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=0.802, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00508, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00508, Train/loss_recog_step=0.896, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00508, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00508, Train/loss_recog_step=0.896, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.000201, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000201, Train/loss_recog_step=0.825, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.000201, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000201, Train/loss_recog_step=0.825, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.869, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]  Epoch 41:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.869, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0025, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.878, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]  Epoch 41: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0025, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.878, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.865, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.685, Valid/loss_all_epoch=0.318, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.318, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.73it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183687, 0.187113, 0.188972, 0.207023
Valid average loss UNet                 (all)                : 0.766794

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076687, 2.586694, 4.805523
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460130, 3.019977, 3.130785
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.574883, 2.715621, 2.812215
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.208098, 2.550732, 3.609468
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.265298, 3.043615, 3.824939
Valid average loss all      (Triplet)                 : 0.340542

== Recognize ==
Valid average loss Recognize     : 0.870374
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.340542

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.975609302520752 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.596502304077148 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.259249687194824 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.064703226089478 sec. =
Valid knn accuracy guitar    : 62.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.070881843566895 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 54.92978583040381%

                                                                      [AEpoch 41: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.865, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00713, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00713, Train/loss_recog_epoch=0.837]Epoch 41: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.865, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189511, 0.189815, 0.188704, 0.194273
Train average loss UNet                 (all)                : 0.762302

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000866, 2.498768, 4.805987
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010513, 2.189888, 3.535090
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008995, 2.246682, 3.610263
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006905, 2.397609, 4.086408
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006712, 2.491738, 4.207716
Train average loss all      (Triplet)                 : 0.006883

== Recognize ==
Train average loss Recognize     : 0.841426
Train average accuracy drums     : 49.634998 %
Train average accuracy bass      : 50.325001 %
Train average accuracy piano     : 50.150002 %
Train average accuracy guitar    : 49.599998 %
Train average accuracy residuals : 49.639999 %

== Train average loss all : 0.006883

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.865, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.865, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  16%|█▌        | 50/313 [00:56<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.865, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  16%|█▌        | 50/313 [00:56<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]  Epoch 42:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00261, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=0.796, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00261, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=0.796, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]    Epoch 42:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00262, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.854, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00262, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.854, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.810, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]    Epoch 42:  96%|█████████▌| 300/313 [04:49<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.810, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42:  96%|█████████▌| 300/313 [04:49<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0241, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=0.870, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0241, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=0.870, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.788, Valid/loss_all_step=0.336, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.96it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183208, 0.186649, 0.188298, 0.186699
Valid average loss UNet                 (all)                : 0.744854

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059322, 2.686690, 4.926322
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.529833, 3.070931, 3.114125
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.515131, 2.799013, 3.003199
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.269751, 2.620374, 3.442924
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.299773, 3.010241, 3.635925
Valid average loss all      (Triplet)                 : 0.351322

== Recognize ==
Valid average loss Recognize     : 0.877761
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.351322

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.12790822982788 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.372681856155396 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.993140459060669 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.271228790283203 sec. =
Valid knn accuracy guitar    : 59.15178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.160307168960571 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 55.01892597015537%

                                                                      [AEpoch 42: 100%|██████████| 313/313 [06:29<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.788, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00688, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00688, Train/loss_recog_epoch=0.841]Epoch 42: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.788, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189572, 0.189884, 0.188772, 0.194637
Train average loss UNet                 (all)                : 0.762865

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002044, 2.663923, 5.059713
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008603, 2.293542, 3.714006
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008364, 2.375057, 3.855617
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006560, 2.506156, 4.293215
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006103, 2.605624, 4.404720
Train average loss all      (Triplet)                 : 0.006370

== Recognize ==
Train average loss Recognize     : 0.846585
Train average accuracy drums     : 49.779999 %
Train average accuracy bass      : 49.739998 %
Train average accuracy piano     : 49.500000 %
Train average accuracy guitar    : 49.915001 %
Train average accuracy residuals : 50.480003 %

== Train average loss all : 0.006370

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.788, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.788, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.00923, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.00923, Train/loss_recog_step=0.788, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]    Epoch 43:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.884, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  48%|████▊     | 150/313 [02:29<02:42,  1.01it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.884, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  48%|████▊     | 150/313 [02:29<02:42,  1.01it/s, v_num=0, Train/loss_all_step=0.00278, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.806, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.00278, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00278, Train/loss_recog_step=0.806, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.833, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]    Epoch 43:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.833, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00806, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00806, Train/loss_recog_step=0.873, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00806, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00806, Train/loss_recog_step=0.873, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.239, Valid/loss_unet_all_step=0.719, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.351, Valid/loss_unet_all_epoch=0.745, Valid/loss_triplet_all_epoch=0.351, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184065, 0.187545, 0.189326, 0.195834
Valid average loss UNet                 (all)                : 0.756770

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.059111, 2.640498, 4.950090
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.569534, 3.137949, 3.209069
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.527346, 2.769897, 3.045843
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.278089, 2.966804, 3.751281
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.230710, 3.323026, 4.334934
Valid average loss all      (Triplet)                 : 0.349231

== Recognize ==
Valid average loss Recognize     : 0.892303
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.349231

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.338759422302246 sec. =
Valid knn accuracy drums     : 82.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.512028932571411 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.691948175430298 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.90355920791626 sec. =
Valid knn accuracy guitar    : 58.03571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.941276550292969 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 55.19318096437223%

                                                                      [AEpoch 43: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00637, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00637, Train/loss_recog_epoch=0.847]Epoch 43: 100%|██████████| 313/313 [06:28<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189502, 0.189798, 0.188694, 0.194738
Train average loss UNet                 (all)                : 0.762731

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001071, 2.614678, 4.998538
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010074, 2.345155, 3.774563
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009649, 2.368597, 3.829422
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005347, 2.553903, 4.351606
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006208, 2.602218, 4.410034
Train average loss all      (Triplet)                 : 0.006556

== Recognize ==
Train average loss Recognize     : 0.851644
Train average accuracy drums     : 49.669998 %
Train average accuracy bass      : 49.855000 %
Train average accuracy piano     : 49.810001 %
Train average accuracy guitar    : 50.234997 %
Train average accuracy residuals : 50.255001 %

== Train average loss all : 0.006556

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  16%|█▌        | 50/313 [00:56<04:56,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  16%|█▌        | 50/313 [00:56<04:56,  0.89it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.848, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  32%|███▏      | 100/313 [01:43<03:40,  0.97it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.848, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  32%|███▏      | 100/313 [01:43<03:40,  0.97it/s, v_num=0, Train/loss_all_step=0.00456, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00456, Train/loss_recog_step=0.894, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00456, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00456, Train/loss_recog_step=0.894, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00916, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00916, Train/loss_recog_step=0.827, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00916, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00916, Train/loss_recog_step=0.827, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.000106, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000106, Train/loss_recog_step=0.819, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.000106, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000106, Train/loss_recog_step=0.819, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]      Epoch 44:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.903, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00895, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=0.903, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44: 100%|██████████| 313/313 [05:06<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.250, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.250, Valid/loss_recog_step=0.907, Valid/loss_all_epoch=0.349, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.892, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.52it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  2.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.62it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  3.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183113, 0.186519, 0.188400, 0.194708
Valid average loss UNet                 (all)                : 0.752741

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097403, 2.816612, 4.974372
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.677059, 3.328355, 3.392782
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.686329, 3.181977, 3.237737
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.318998, 2.883623, 3.732288
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.308106, 3.414974, 4.388516
Valid average loss all      (Triplet)                 : 0.457987

== Recognize ==
Valid average loss Recognize     : 0.850210
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.457987

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.57982349395752 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.181911706924438 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.450898885726929 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.519073963165283 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.360676288604736 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 53.9685571813355%

                                                                      [AEpoch 44: 100%|██████████| 313/313 [06:48<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00656, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00656, Train/loss_recog_epoch=0.852]Epoch 44: 100%|██████████| 313/313 [06:48<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189574, 0.189882, 0.188755, 0.195063
Train average loss UNet                 (all)                : 0.763274

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000964, 2.668863, 5.064676
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008406, 2.422248, 3.903315
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009093, 2.477539, 4.006979
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005562, 2.570525, 4.395460
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004601, 2.698111, 4.599399
Train average loss all      (Triplet)                 : 0.005848

== Recognize ==
Train average loss Recognize     : 0.855198
Train average accuracy drums     : 50.050003 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 50.169998 %
Train average accuracy guitar    : 50.620003 %
Train average accuracy residuals : 50.500000 %

== Train average loss all : 0.005848

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  16%|█▌        | 50/313 [00:57<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  16%|█▌        | 50/313 [00:57<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.867, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.867, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  48%|████▊     | 150/313 [02:33<02:47,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  48%|████▊     | 150/313 [02:33<02:47,  0.98it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00704, Train/loss_recog_step=0.914, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00704, Train/loss_recog_step=0.914, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=0.833, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]    Epoch 45:  80%|███████▉  | 250/313 [04:10<01:03,  1.00it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=0.833, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  80%|███████▉  | 250/313 [04:10<01:03,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.769, Valid/loss_all_step=0.524, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.524, Valid/loss_recog_step=0.780, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.55it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182647, 0.185967, 0.188045, 0.194921
Valid average loss UNet                 (all)                : 0.751579

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098026, 2.683984, 4.710611
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.470907, 3.173249, 3.284731
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.666213, 3.002048, 3.050966
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.290226, 2.639903, 3.497711
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.317339, 3.178135, 4.189487
Valid average loss all      (Triplet)                 : 0.377805

== Recognize ==
Valid average loss Recognize     : 0.871487
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.377805

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3565285205841064 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.89169955253601 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.080888509750366 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.347262620925903 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.488914489746094 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 53.7111303186645%

                                                                      [AEpoch 45: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.769, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00585, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=0.855]Epoch 45: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.769, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189894, 0.190200, 0.189072, 0.194388
Train average loss UNet                 (all)                : 0.763554

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001466, 2.678601, 5.036237
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010953, 2.422545, 3.928707
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010761, 2.485842, 3.968468
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005873, 2.579890, 4.418489
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004865, 2.732762, 4.636410
Train average loss all      (Triplet)                 : 0.006804

== Recognize ==
Train average loss Recognize     : 0.862700
Train average accuracy drums     : 50.085003 %
Train average accuracy bass      : 49.845001 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 49.755001 %
Train average accuracy residuals : 49.695000 %

== Train average loss all : 0.006804

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.769, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.769, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.769, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.882, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.882, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00276, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.835, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00276, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.835, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00201, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.902, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00201, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.902, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00703, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00703, Train/loss_recog_step=0.879, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00703, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00703, Train/loss_recog_step=0.879, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.868, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]  Epoch 46:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0011, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=0.868, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.00733, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00733, Train/loss_recog_step=0.854, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00733, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00733, Train/loss_recog_step=0.854, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.753, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.900, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.378, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.537, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183288, 0.186732, 0.188521, 0.201622
Valid average loss UNet                 (all)                : 0.760163

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058419, 2.645289, 5.074108
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.524700, 3.220974, 3.503460
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.465402, 2.795442, 3.012204
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.295713, 2.964152, 3.818364
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.294901, 3.419300, 4.089335
Valid average loss all      (Triplet)                 : 0.325969

== Recognize ==
Valid average loss Recognize     : 0.874654
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 42.500000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.325969

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.741082429885864 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.385085105895996 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.251934289932251 sec. =
Valid knn accuracy piano     : 44.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.277113437652588 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9092936515808105 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 55.3051679101929%

                                                                      [AEpoch 46: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.753, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0068, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=0.863]Epoch 46: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.753, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189559, 0.189852, 0.188748, 0.194363
Train average loss UNet                 (all)                : 0.762523

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001221, 2.620375, 4.877250
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008351, 2.364354, 3.851869
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007510, 2.418096, 3.890513
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006634, 2.564292, 4.392539
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007168, 2.652222, 4.485368
Train average loss all      (Triplet)                 : 0.006150

== Recognize ==
Train average loss Recognize     : 0.862633
Train average accuracy drums     : 49.924999 %
Train average accuracy bass      : 49.799999 %
Train average accuracy piano     : 50.645000 %
Train average accuracy guitar    : 50.435001 %
Train average accuracy residuals : 49.195000 %

== Train average loss all : 0.006150

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.753, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.753, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.753, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.854, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00618, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=0.854, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]    Epoch 47:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.886, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.886, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00433, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.877, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00433, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.877, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]    Epoch 47:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.833, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00644, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00644, Train/loss_recog_step=0.833, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.105, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.105, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.326, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183603, 0.187019, 0.188911, 0.196791
Valid average loss UNet                 (all)                : 0.756325

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113383, 2.884306, 5.286319
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.600445, 3.346832, 3.468751
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.496271, 3.124960, 3.438249
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.323280, 3.041382, 3.961201
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.275453, 3.486320, 4.324834
Valid average loss all      (Triplet)                 : 0.384114

== Recognize ==
Valid average loss Recognize     : 0.893214
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.384114

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.35724925994873 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.336393594741821 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.59889841079712 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.060929536819458 sec. =
Valid knn accuracy guitar    : 60.26785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6028523445129395 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 55.115716812990655%

                                                                      [AEpoch 47: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00615, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00615, Train/loss_recog_epoch=0.863]Epoch 47: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189770, 0.190086, 0.188945, 0.194050
Train average loss UNet                 (all)                : 0.762852

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001526, 2.714383, 5.128141
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007994, 2.452273, 3.970288
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005591, 2.487287, 4.053658
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004344, 2.655881, 4.584503
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005585, 2.718242, 4.646692
Train average loss all      (Triplet)                 : 0.005180

== Recognize ==
Train average loss Recognize     : 0.868090
Train average accuracy drums     : 49.764999 %
Train average accuracy bass      : 50.045002 %
Train average accuracy piano     : 50.700005 %
Train average accuracy guitar    : 49.840000 %
Train average accuracy residuals : 49.489998 %

== Train average loss all : 0.005180

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.872, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00414, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00414, Train/loss_recog_step=0.872, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.836, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]  Epoch 48:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.836, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00853, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00853, Train/loss_recog_step=0.913, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00853, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00853, Train/loss_recog_step=0.913, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.940, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]  Epoch 48:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.940, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=0.856, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=0.856, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00552, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00552, Train/loss_recog_step=0.814, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00552, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00552, Train/loss_recog_step=0.814, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000754, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=0.901, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=0.883, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.893, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185275, 0.188670, 0.190694, 0.193592
Valid average loss UNet                 (all)                : 0.758231

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092137, 3.011400, 5.588900
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.611211, 3.477481, 3.475268
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.540189, 2.952626, 3.213165
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310458, 3.143726, 4.127792
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.162404, 3.538741, 4.485360
Valid average loss all      (Triplet)                 : 0.367194

== Recognize ==
Valid average loss Recognize     : 0.872434
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.367194

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3758862018585205 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.183877944946289 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.758519649505615 sec. =
Valid knn accuracy piano     : 38.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.528632164001465 sec. =
Valid knn accuracy guitar    : 60.26785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.532544136047363 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 55.88792311956977%

                                                                      [AEpoch 48: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000754, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=0.901, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00518, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00518, Train/loss_recog_epoch=0.868]Epoch 48: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000754, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=0.901, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189744, 0.190049, 0.188900, 0.194394
Train average loss UNet                 (all)                : 0.763086

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000954, 2.721761, 5.261885
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009377, 2.445101, 3.985142
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008714, 2.543815, 4.116791
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007787, 2.705717, 4.578189
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005990, 2.704841, 4.592596
Train average loss all      (Triplet)                 : 0.006683

== Recognize ==
Train average loss Recognize     : 0.871112
Train average accuracy drums     : 49.575001 %
Train average accuracy bass      : 49.700001 %
Train average accuracy piano     : 50.094997 %
Train average accuracy guitar    : 50.594997 %
Train average accuracy residuals : 50.265003 %

== Train average loss all : 0.006683

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000754, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=0.901, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000754, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=0.901, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000754, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000754, Train/loss_recog_step=0.901, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00526, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00526, Train/loss_recog_step=0.922, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]  Epoch 49:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00526, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00526, Train/loss_recog_step=0.922, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]    Epoch 49:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00904, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.981, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00904, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.981, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0095, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0095, Train/loss_recog_step=0.862, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]  Epoch 49:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0095, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0095, Train/loss_recog_step=0.862, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.823, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00356, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=0.823, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00984, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00984, Train/loss_recog_step=0.778, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00984, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.00984, Train/loss_recog_step=0.778, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=0.961, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.872, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182464, 0.185782, 0.187722, 0.195840
Valid average loss UNet                 (all)                : 0.751808

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058511, 2.910500, 5.351958
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.578117, 3.370268, 3.423433
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.542942, 2.992932, 3.047378
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.246916, 2.765654, 3.838238
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.234993, 3.370281, 4.345579
Valid average loss all      (Triplet)                 : 0.352756

== Recognize ==
Valid average loss Recognize     : 0.874095
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.352756

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.778022289276123 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.647897481918335 sec. =
Valid knn accuracy bass      : 21.975806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.66176962852478 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.337291240692139 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.256779670715332 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 52.024105036793515%

                                                                      [AEpoch 49: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00668, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00668, Train/loss_recog_epoch=0.871]Epoch 49: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189716, 0.190009, 0.188896, 0.194554
Train average loss UNet                 (all)                : 0.763174

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001370, 2.754673, 5.290903
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007297, 2.469803, 4.007133
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008946, 2.546476, 4.096257
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006512, 2.715082, 4.603312
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006459, 2.739507, 4.622234
Train average loss all      (Triplet)                 : 0.006170

== Recognize ==
Train average loss Recognize     : 0.869026
Train average accuracy drums     : 49.779999 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 50.555004 %
Train average accuracy guitar    : 50.045002 %
Train average accuracy residuals : 50.145000 %

== Train average loss all : 0.006170

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.834, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.834, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=0.875, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=0.875, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]    Epoch 50:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00412, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00412, Train/loss_recog_step=0.840, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00412, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00412, Train/loss_recog_step=0.840, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.819, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.874, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183373, 0.186774, 0.188646, 0.188505
Valid average loss UNet                 (all)                : 0.747297

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086056, 2.794276, 5.014370
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.618080, 3.414654, 3.499217
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.550639, 3.170716, 3.141686
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.181732, 2.678173, 3.855395
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.298825, 3.358368, 4.244586
Valid average loss all      (Triplet)                 : 0.380169

== Recognize ==
Valid average loss Recognize     : 0.851654
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.380169

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9206860065460205 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.36918306350708 sec. =
Valid knn accuracy bass      : 17.540322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.280196905136108 sec. =
Valid knn accuracy piano     : 44.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.353862285614014 sec. =
Valid knn accuracy guitar    : 60.49107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.313812732696533 sec. =
Valid knn accuracy residuals : 59.77272727272728%

Valid knn accuracy average   : 53.819316104214856%

                                                                      [AEpoch 50: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.819, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00617, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00617, Train/loss_recog_epoch=0.869]Epoch 50: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.819, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189243, 0.189534, 0.188418, 0.194705
Train average loss UNet                 (all)                : 0.761901

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001084, 2.756530, 5.277579
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006731, 2.516478, 4.113045
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007921, 2.598642, 4.227320
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004688, 2.730603, 4.657508
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006511, 2.833909, 4.780015
Train average loss all      (Triplet)                 : 0.005434

== Recognize ==
Train average loss Recognize     : 0.872056
Train average accuracy drums     : 50.335003 %
Train average accuracy bass      : 49.654999 %
Train average accuracy piano     : 50.115002 %
Train average accuracy guitar    : 50.395000 %
Train average accuracy residuals : 50.115002 %

== Train average loss all : 0.005434

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.819, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.819, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00987, Train/loss_recog_step=0.819, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.907, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]  Epoch 51:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.907, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=0.925, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=0.925, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00433, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.843, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00433, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=0.843, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00378, Train/loss_recog_step=0.896, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00378, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00378, Train/loss_recog_step=0.896, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]    Epoch 51:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=0.879, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=0.879, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.418, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=0.652, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.747, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183018, 0.186330, 0.188471, 0.203541
Valid average loss UNet                 (all)                : 0.761360

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086015, 2.816302, 5.097038
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.513887, 3.269352, 3.436797
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.502347, 3.176902, 3.343811
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.292501, 2.937482, 4.042180
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.208185, 3.336323, 4.301136
Valid average loss all      (Triplet)                 : 0.340706

== Recognize ==
Valid average loss Recognize     : 0.874918
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.340706

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.310402154922485 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42979383468628 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.70940375328064 sec. =
Valid knn accuracy piano     : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.42127251625061 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4366350173950195 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 54.821748465419574%

                                                                      [AEpoch 51: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00543, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=0.872]Epoch 51: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189439, 0.189747, 0.188652, 0.194928
Train average loss UNet                 (all)                : 0.762765

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001113, 2.760861, 5.305006
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006816, 2.511913, 4.142033
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006595, 2.581136, 4.220105
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005574, 2.701784, 4.619076
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005125, 2.834723, 4.831491
Train average loss all      (Triplet)                 : 0.005022

== Recognize ==
Train average loss Recognize     : 0.875335
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 49.735001 %
Train average accuracy piano     : 50.610001 %
Train average accuracy guitar    : 49.855000 %
Train average accuracy residuals : 50.529999 %

== Train average loss all : 0.005022

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=0.883, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00565, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=0.883, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=7.17e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=7.17e-5, Train/loss_recog_step=0.853, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=7.17e-5, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=7.17e-5, Train/loss_recog_step=0.853, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.873, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]  Epoch 52:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=0.873, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000661, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000661, Train/loss_recog_step=0.867, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000661, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000661, Train/loss_recog_step=0.867, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00265, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.900, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]  Epoch 52: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00265, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.900, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.222, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.341, Valid/loss_recog_epoch=0.875, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183774, 0.187021, 0.189230, 0.206039
Valid average loss UNet                 (all)                : 0.766064

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063983, 2.815711, 5.277165
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.661758, 3.639739, 3.675464
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.423349, 3.103077, 3.451500
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.296970, 2.882341, 3.925371
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.222092, 3.126209, 4.562323
Valid average loss all      (Triplet)                 : 0.367287

== Recognize ==
Valid average loss Recognize     : 0.897738
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.367287

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.497553110122681 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.086554050445557 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.802752017974854 sec. =
Valid knn accuracy piano     : 47.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.447367906570435 sec. =
Valid knn accuracy guitar    : 47.544642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.393883228302002 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 54.22088110872296%

                                                                      [AEpoch 52: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.875]Epoch 52: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189645, 0.189960, 0.188837, 0.194396
Train average loss UNet                 (all)                : 0.762838

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001746, 2.815511, 5.303005
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008322, 2.605742, 4.226463
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007745, 2.737306, 4.408597
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007887, 2.805450, 4.722891
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005647, 2.855492, 4.852129
Train average loss all      (Triplet)                 : 0.006349

== Recognize ==
Train average loss Recognize     : 0.884096
Train average accuracy drums     : 50.250000 %
Train average accuracy bass      : 49.959999 %
Train average accuracy piano     : 49.974998 %
Train average accuracy guitar    : 49.244999 %
Train average accuracy residuals : 49.505001 %

== Train average loss all : 0.006349

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00286, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.853, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00286, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.853, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000338, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.890, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000338, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.890, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.923, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]      Epoch 53:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.923, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00185, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.874, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00185, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=0.874, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]    Epoch 53: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.329, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.329, Valid/loss_recog_step=0.927, Valid/loss_all_epoch=0.367, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184860, 0.188186, 0.190423, 0.195938
Valid average loss UNet                 (all)                : 0.759407

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077700, 2.906583, 5.085099
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.459653, 3.519812, 3.821680
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.537844, 3.371008, 3.578458
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274630, 3.202947, 4.275393
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.246897, 3.616222, 4.848885
Valid average loss all      (Triplet)                 : 0.322221

== Recognize ==
Valid average loss Recognize     : 0.889805
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.322221

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.631141901016235 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.163022518157959 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.720070123672485 sec. =
Valid knn accuracy piano     : 41.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.489769220352173 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6328675746917725 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 53.42164916736489%

                                                                      [AEpoch 53: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00635, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00635, Train/loss_recog_epoch=0.884]Epoch 53: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189817, 0.190094, 0.188984, 0.194679
Train average loss UNet                 (all)                : 0.763574

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000611, 2.767864, 5.258452
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007726, 2.596135, 4.222314
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007772, 2.662747, 4.356871
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004849, 2.789711, 4.753583
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005835, 2.808701, 4.779630
Train average loss all      (Triplet)                 : 0.005325

== Recognize ==
Train average loss Recognize     : 0.881201
Train average accuracy drums     : 49.974998 %
Train average accuracy bass      : 50.935001 %
Train average accuracy piano     : 49.939999 %
Train average accuracy guitar    : 50.295002 %
Train average accuracy residuals : 49.869999 %

== Train average loss all : 0.005325

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0197, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=0.908, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0197, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=0.908, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=0.972, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0072, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=0.972, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]  Epoch 54:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.126, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.126, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.322, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184478, 0.187800, 0.189959, 0.202095
Valid average loss UNet                 (all)                : 0.764332

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093567, 2.939861, 5.279886
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.493051, 3.430624, 3.667582
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.577702, 3.270078, 3.405507
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263603, 3.163678, 4.251000
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.261748, 3.586727, 4.917120
Valid average loss all      (Triplet)                 : 0.345683

== Recognize ==
Valid average loss Recognize     : 0.869463
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.345683

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.640091896057129 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.658290147781372 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.854004859924316 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.640092611312866 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.905141830444336 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 53.313865099224046%

                                                                      [AEpoch 54: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00533, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=0.881]Epoch 54: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189845, 0.190143, 0.189013, 0.194104
Train average loss UNet                 (all)                : 0.763105

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000867, 2.877394, 5.348289
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007285, 2.655704, 4.347129
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006156, 2.697329, 4.439375
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006602, 2.894386, 4.951447
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003809, 2.921268, 5.032523
Train average loss all      (Triplet)                 : 0.005128

== Recognize ==
Train average loss Recognize     : 0.888797
Train average accuracy drums     : 50.000000 %
Train average accuracy bass      : 50.059998 %
Train average accuracy piano     : 49.595001 %
Train average accuracy guitar    : 50.305004 %
Train average accuracy residuals : 49.105000 %

== Train average loss all : 0.005128

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.857, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.857, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00124, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00124, Train/loss_recog_step=0.870, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.00124, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00124, Train/loss_recog_step=0.870, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.00305, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=0.872, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00305, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=0.872, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]    Epoch 55:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.844, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.844, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000453, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000453, Train/loss_recog_step=0.846, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000453, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000453, Train/loss_recog_step=0.846, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=0.783, Valid/loss_all_epoch=0.346, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.346, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185377, 0.188818, 0.190707, 0.186654
Valid average loss UNet                 (all)                : 0.751556

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075339, 2.934804, 5.230226
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.628070, 3.733582, 3.813713
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.538971, 3.305538, 3.516846
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310203, 3.178376, 4.350566
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.195882, 3.631570, 4.667329
Valid average loss all      (Triplet)                 : 0.383973

== Recognize ==
Valid average loss Recognize     : 0.925188
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 57.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.383973

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.465658903121948 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.380335807800293 sec. =
Valid knn accuracy bass      : 31.451612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.755378484725952 sec. =
Valid knn accuracy piano     : 36.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.308243989944458 sec. =
Valid knn accuracy guitar    : 57.14285714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.059393644332886 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 55.44696960210196%

                                                                      [AEpoch 55: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00513, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00513, Train/loss_recog_epoch=0.889]Epoch 55: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190035, 0.190305, 0.189191, 0.194175
Train average loss UNet                 (all)                : 0.763706

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000924, 2.828065, 5.369618
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006288, 2.602619, 4.309278
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008199, 2.684411, 4.364024
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004592, 2.843393, 4.890990
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005009, 2.872765, 4.895678
Train average loss all      (Triplet)                 : 0.005021

== Recognize ==
Train average loss Recognize     : 0.893221
Train average accuracy drums     : 49.410000 %
Train average accuracy bass      : 50.145000 %
Train average accuracy piano     : 50.160004 %
Train average accuracy guitar    : 49.500000 %
Train average accuracy residuals : 49.215000 %

== Train average loss all : 0.005021

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00374, Train/loss_recog_step=0.892, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00374, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00374, Train/loss_recog_step=0.892, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.893, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=0.893, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]    Epoch 56:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.851, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0262, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.851, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.944, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.944, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=0.976, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=0.976, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.834, Valid/loss_all_step=0.399, Valid/loss_unet_all_step=0.737, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.925, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185329, 0.188707, 0.190878, 0.201457
Valid average loss UNet                 (all)                : 0.766371

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075829, 2.981976, 5.205108
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.728481, 3.701306, 3.734942
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.454194, 3.432337, 3.625748
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.230133, 3.135350, 4.339539
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.242151, 3.621431, 4.637377
Valid average loss all      (Triplet)                 : 0.380763

== Recognize ==
Valid average loss Recognize     : 0.896161
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.380763

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.345979452133179 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.049198865890503 sec. =
Valid knn accuracy bass      : 35.28225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.065866231918335 sec. =
Valid knn accuracy piano     : 34.5703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.357385873794556 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.354614496231079 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 55.61319480177958%

                                                                      [AEpoch 56: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.834, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00502, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00502, Train/loss_recog_epoch=0.893]Epoch 56: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.834, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190178, 0.190471, 0.189357, 0.194781
Train average loss UNet                 (all)                : 0.764787

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000463, 2.862405, 5.328777
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007802, 2.714509, 4.448398
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007196, 2.768862, 4.501083
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003053, 2.877535, 4.998974
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006117, 2.956769, 5.024659
Train average loss all      (Triplet)                 : 0.005073

== Recognize ==
Train average loss Recognize     : 0.893681
Train average accuracy drums     : 49.945000 %
Train average accuracy bass      : 50.220001 %
Train average accuracy piano     : 49.544998 %
Train average accuracy guitar    : 50.115002 %
Train average accuracy residuals : 50.185001 %

== Train average loss all : 0.005073

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.834, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.834, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.0468, Train/loss_recog_step=0.834, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.867, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]  Epoch 57:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.867, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00158, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.951, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00158, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.951, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00102, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00102, Train/loss_recog_step=0.876, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00102, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00102, Train/loss_recog_step=0.876, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00723, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.00723, Train/loss_recog_step=0.932, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00723, Train/loss_unet_all_step=0.737, Train/loss_triplet_all_step=0.00723, Train/loss_recog_step=0.932, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00739, Train/loss_recog_step=0.935, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.00739, Train/loss_recog_step=0.935, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.896, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183772, 0.187161, 0.189174, 0.200756
Valid average loss UNet                 (all)                : 0.760863

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097261, 2.929821, 5.108829
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.557392, 3.528087, 3.644948
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.452941, 3.177401, 3.576814
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.297513, 3.152144, 4.271809
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.254349, 3.757729, 4.971776
Valid average loss all      (Triplet)                 : 0.352863

== Recognize ==
Valid average loss Recognize     : 0.940877
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.352863

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.30159854888916 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.582126379013062 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.183952808380127 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.790658712387085 sec. =
Valid knn accuracy guitar    : 52.00892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.271785497665405 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 54.463016668639916%

                                                                      [AEpoch 57: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00507, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=0.894]Epoch 57: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189814, 0.190115, 0.188994, 0.194420
Train average loss UNet                 (all)                : 0.763343

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001162, 2.817082, 5.228620
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006268, 2.616122, 4.307795
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007656, 2.696971, 4.393577
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005133, 2.826355, 4.893863
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006887, 2.945792, 4.970103
Train average loss all      (Triplet)                 : 0.005373

== Recognize ==
Train average loss Recognize     : 0.893572
Train average accuracy drums     : 50.120003 %
Train average accuracy bass      : 50.529999 %
Train average accuracy piano     : 49.579998 %
Train average accuracy guitar    : 50.274998 %
Train average accuracy residuals : 50.050003 %

== Train average loss all : 0.005373

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.922, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.922, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.941, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]  Epoch 58:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.0174, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=0.941, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=0.923, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00958, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=0.923, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]    Epoch 58:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.880, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0169, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.880, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]  Epoch 58: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.975, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.54it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183908, 0.187268, 0.189208, 0.191425
Valid average loss UNet                 (all)                : 0.751809

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137018, 3.070421, 5.327432
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.502936, 3.380246, 3.691111
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.463531, 3.100410, 3.516705
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.271645, 3.121541, 3.977819
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.244336, 3.758102, 5.089706
Valid average loss all      (Triplet)                 : 0.328352

== Recognize ==
Valid average loss Recognize     : 0.959765
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.328352

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.352785348892212 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.224843263626099 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.626002550125122 sec. =
Valid knn accuracy piano     : 31.0546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6160500049591064 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.07349157333374 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 53.093974694222325%

                                                                      [AEpoch 58: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00537, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00537, Train/loss_recog_epoch=0.894]Epoch 58: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189705, 0.189987, 0.188885, 0.195449
Train average loss UNet                 (all)                : 0.764025

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001336, 2.876536, 5.380890
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008602, 2.668263, 4.351074
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005549, 2.715014, 4.465923
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005283, 2.880006, 4.950060
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004817, 3.020927, 5.185936
Train average loss all      (Triplet)                 : 0.005264

== Recognize ==
Train average loss Recognize     : 0.900708
Train average accuracy drums     : 50.239998 %
Train average accuracy bass      : 49.860001 %
Train average accuracy piano     : 49.704998 %
Train average accuracy guitar    : 50.309998 %
Train average accuracy residuals : 50.220001 %

== Train average loss all : 0.005264

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00519, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00519, Train/loss_recog_step=0.869, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00519, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00519, Train/loss_recog_step=0.869, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.882, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]  Epoch 59:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.882, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000402, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000402, Train/loss_recog_step=0.939, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000402, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000402, Train/loss_recog_step=0.939, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000971, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000971, Train/loss_recog_step=0.905, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000971, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000971, Train/loss_recog_step=0.905, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00507, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00507, Train/loss_recog_step=0.876, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]  Epoch 59: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00507, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00507, Train/loss_recog_step=0.876, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.747, Valid/loss_triplet_all_step=0.149, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.328, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184045, 0.187378, 0.189538, 0.200684
Valid average loss UNet                 (all)                : 0.761644

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065068, 3.034246, 5.601244
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.445403, 3.333682, 3.678416
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.466441, 3.270985, 3.391444
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.301183, 3.231549, 4.431766
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.276840, 3.489117, 4.576154
Valid average loss all      (Triplet)                 : 0.323027

== Recognize ==
Valid average loss Recognize     : 0.907145
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.323027

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.815380811691284 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.259092569351196 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.318852424621582 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.871471166610718 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.278360605239868 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 54.59346539680515%

                                                                      [AEpoch 59: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00526, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00526, Train/loss_recog_epoch=0.901]Epoch 59: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189533, 0.189810, 0.188696, 0.194297
Train average loss UNet                 (all)                : 0.762336

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001518, 2.950903, 5.626075
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005969, 2.686610, 4.450605
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006798, 2.742683, 4.495694
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007169, 2.891803, 4.982474
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003015, 2.983521, 5.102941
Train average loss all      (Triplet)                 : 0.004881

== Recognize ==
Train average loss Recognize     : 0.896203
Train average accuracy drums     : 49.915001 %
Train average accuracy bass      : 49.895000 %
Train average accuracy piano     : 50.010002 %
Train average accuracy guitar    : 49.980000 %
Train average accuracy residuals : 49.895000 %

== Train average loss all : 0.004881

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.912, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=0.912, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]  Epoch 60:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.940, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.940, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.845, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00825, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=0.845, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.952, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.952, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.891, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.891, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.863, Valid/loss_all_step=0.205, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.947, Valid/loss_all_epoch=0.323, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183438, 0.186837, 0.188756, 0.195244
Valid average loss UNet                 (all)                : 0.754275

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071494, 3.215745, 5.901112
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.559738, 3.538002, 3.658369
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.486948, 3.257972, 3.502792
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.283927, 3.357344, 4.349353
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269575, 3.538094, 4.703755
Valid average loss all      (Triplet)                 : 0.350207

== Recognize ==
Valid average loss Recognize     : 0.921146
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.350207

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.82586145401001 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.502407789230347 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.8795485496521 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.143019914627075 sec. =
Valid knn accuracy guitar    : 59.59821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.540617942810059 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 55.5225102627912%

                                                                      [AEpoch 60: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.863, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.896]Epoch 60: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.863, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189168, 0.189467, 0.188376, 0.195273
Train average loss UNet                 (all)                : 0.762284

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002106, 3.035123, 5.855927
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006653, 2.709104, 4.434608
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007798, 2.834560, 4.617592
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005394, 2.919208, 5.050735
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005838, 3.016455, 5.101597
Train average loss all      (Triplet)                 : 0.005667

== Recognize ==
Train average loss Recognize     : 0.899893
Train average accuracy drums     : 50.260002 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.155003 %
Train average accuracy guitar    : 49.939999 %
Train average accuracy residuals : 50.250000 %

== Train average loss all : 0.005667

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.863, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.863, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.863, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=0.909, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.00351, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=0.909, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.00145, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.863, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00145, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.863, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00133, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.964, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00133, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.964, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.955, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.955, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00299, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00299, Train/loss_recog_step=0.921, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00299, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00299, Train/loss_recog_step=0.921, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.964, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.964, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=0.890, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.896, Valid/loss_all_epoch=0.350, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.921, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.03it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184220, 0.187652, 0.189528, 0.193514
Valid average loss UNet                 (all)                : 0.754914

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097821, 3.185519, 5.840294
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.525545, 3.802675, 3.928120
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.504432, 3.277621, 3.721083
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337323, 3.508467, 4.251130
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.303555, 3.656432, 5.021372
Valid average loss all      (Triplet)                 : 0.363349

== Recognize ==
Valid average loss Recognize     : 0.973336
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.363349

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.519944667816162 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.162404775619507 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.067726135253906 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.474963426589966 sec. =
Valid knn accuracy guitar    : 51.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.119162082672119 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 52.83185728629716%

                                                                      [AEpoch 61: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=0.890, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00567, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=0.900]Epoch 61: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=0.890, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189594, 0.189891, 0.188762, 0.194391
Train average loss UNet                 (all)                : 0.762637

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001273, 3.099388, 5.969998
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007948, 2.789775, 4.545700
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007219, 2.879839, 4.681687
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005108, 3.038019, 5.235492
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006106, 3.103766, 5.256867
Train average loss all      (Triplet)                 : 0.005683

== Recognize ==
Train average loss Recognize     : 0.906676
Train average accuracy drums     : 50.099998 %
Train average accuracy bass      : 49.834999 %
Train average accuracy piano     : 50.400002 %
Train average accuracy guitar    : 49.985001 %
Train average accuracy residuals : 49.825001 %

== Train average loss all : 0.005683

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=0.890, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=0.890, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=0.890, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.910, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.910, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.920, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.920, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]    Epoch 62:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=0.991, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=0.991, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]  Epoch 62:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000343, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000343, Train/loss_recog_step=0.942, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000343, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000343, Train/loss_recog_step=0.942, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.912, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183972, 0.187404, 0.189260, 0.205610
Valid average loss UNet                 (all)                : 0.766246

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086675, 3.150972, 5.648482
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.592924, 3.736803, 3.806248
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.455903, 3.268806, 3.573377
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.254693, 3.202723, 4.276363
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.329729, 3.771286, 4.657201
Valid average loss all      (Triplet)                 : 0.366162

== Recognize ==
Valid average loss Recognize     : 0.967030
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 41.500000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.366162

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.561246633529663 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.038486957550049 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.650423765182495 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.371686935424805 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.362394571304321 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 54.445101751334214%

                                                                      [AEpoch 62: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.912, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00568, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=0.907]Epoch 62: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.912, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189852, 0.190149, 0.189013, 0.194288
Train average loss UNet                 (all)                : 0.763303

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000903, 3.099104, 5.941490
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006757, 2.829430, 4.642762
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007864, 2.920270, 4.768937
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004772, 3.027772, 5.225031
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005959, 3.213151, 5.469985
Train average loss all      (Triplet)                 : 0.005096

== Recognize ==
Train average loss Recognize     : 0.918487
Train average accuracy drums     : 49.875000 %
Train average accuracy bass      : 49.090000 %
Train average accuracy piano     : 49.575001 %
Train average accuracy guitar    : 50.230003 %
Train average accuracy residuals : 49.500000 %

== Train average loss all : 0.005096

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.912, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.912, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.912, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.898, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.898, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00759, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.918, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00759, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.918, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00996, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=0.867, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00996, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=0.867, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00381, Train/loss_recog_step=0.898, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00381, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00381, Train/loss_recog_step=0.898, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000655, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000655, Train/loss_recog_step=0.918, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000655, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000655, Train/loss_recog_step=0.918, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]      Epoch 63: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.941, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.544, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.182826, 0.186233, 0.188014, 0.200285
Valid average loss UNet                 (all)                : 0.757357

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103216, 3.135656, 5.486790
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.832183, 3.782602, 3.684189
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.490634, 3.289628, 3.433286
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.293748, 3.326057, 4.429434
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305620, 3.754009, 4.616205
Valid average loss all      (Triplet)                 : 0.463378

== Recognize ==
Valid average loss Recognize     : 0.934084
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 58.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.463378

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.41214656829834 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.54139757156372 sec. =
Valid knn accuracy bass      : 16.532258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.526163101196289 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.809002161026001 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.266123056411743 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 53.639261466093515%

                                                                      [AEpoch 63: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.941, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.0051, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0051, Train/loss_recog_epoch=0.918]Epoch 63: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.941, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189463, 0.189773, 0.188653, 0.194986
Train average loss UNet                 (all)                : 0.762875

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001033, 3.074863, 5.778491
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006860, 2.820780, 4.593212
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005947, 2.894511, 4.773916
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005733, 3.023017, 5.222169
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004179, 3.159913, 5.392649
Train average loss all      (Triplet)                 : 0.004923

== Recognize ==
Train average loss Recognize     : 0.917625
Train average accuracy drums     : 50.164997 %
Train average accuracy bass      : 50.230003 %
Train average accuracy piano     : 50.265003 %
Train average accuracy guitar    : 50.220001 %
Train average accuracy residuals : 50.615002 %

== Train average loss all : 0.004923

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.941, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.941, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00372, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.941, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00167, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.949, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.00167, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00167, Train/loss_recog_step=0.949, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=0.883, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=0.883, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00522, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00522, Train/loss_recog_step=0.888, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00522, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00522, Train/loss_recog_step=0.888, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.023, Train/loss_recog_step=0.905, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]    Epoch 64:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.023, Train/loss_recog_step=0.905, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.880, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.880, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00207, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00207, Train/loss_recog_step=0.960, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00207, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00207, Train/loss_recog_step=0.960, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.770, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.463, Valid/loss_unet_all_epoch=0.757, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.56it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184375, 0.187835, 0.189452, 0.202001
Valid average loss UNet                 (all)                : 0.763663

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065347, 3.047129, 5.282529
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.666897, 3.771111, 3.832617
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.453517, 3.486370, 3.627568
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.327248, 3.477150, 4.340405
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.262842, 3.362702, 4.896096
Valid average loss all      (Triplet)                 : 0.398772

== Recognize ==
Valid average loss Recognize     : 0.969724
Valid average accuracy drums     : 58.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.398772

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.548666954040527 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.335762023925781 sec. =
Valid knn accuracy bass      : 19.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.448375225067139 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.443304538726807 sec. =
Valid knn accuracy guitar    : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.315824747085571 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 55.27634714076246%

                                                                      [AEpoch 64: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00492, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00492, Train/loss_recog_epoch=0.918]Epoch 64: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189480, 0.189774, 0.188658, 0.194496
Train average loss UNet                 (all)                : 0.762408

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000638, 2.998706, 5.614183
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006144, 2.783105, 4.580093
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006604, 2.885402, 4.707127
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006655, 2.994249, 5.142230
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005078, 3.151014, 5.360336
Train average loss all      (Triplet)                 : 0.005008

== Recognize ==
Train average loss Recognize     : 0.927219
Train average accuracy drums     : 49.744999 %
Train average accuracy bass      : 49.500000 %
Train average accuracy piano     : 50.160004 %
Train average accuracy guitar    : 49.730000 %
Train average accuracy residuals : 50.054996 %

== Train average loss all : 0.005008

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00027, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00027, Train/loss_recog_step=0.958, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.00027, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00027, Train/loss_recog_step=0.958, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.00273, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00273, Train/loss_recog_step=0.922, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00273, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00273, Train/loss_recog_step=0.922, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]    Epoch 65:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000459, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000459, Train/loss_recog_step=1.020, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000459, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000459, Train/loss_recog_step=1.020, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]      Epoch 65: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.382, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.382, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.399, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.65it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184301, 0.187697, 0.189621, 0.202295
Valid average loss UNet                 (all)                : 0.763914

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.082372, 3.111087, 5.524124
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.671982, 4.044495, 4.110941
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.531326, 3.627014, 4.001467
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.339622, 3.517181, 4.655883
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.349213, 3.712898, 5.141574
Valid average loss all      (Triplet)                 : 0.419544

== Recognize ==
Valid average loss Recognize     : 0.933533
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.419544

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.787126541137695 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.798926591873169 sec. =
Valid knn accuracy bass      : 22.58064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.809310674667358 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.286492824554443 sec. =
Valid knn accuracy guitar    : 56.91964285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.370702505111694 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 54.093671734121415%

                                                                      [AEpoch 65: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00501, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00501, Train/loss_recog_epoch=0.927]Epoch 65: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189555, 0.189851, 0.188740, 0.194474
Train average loss UNet                 (all)                : 0.762620

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000652, 3.069536, 5.706359
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005769, 2.894426, 4.749733
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008034, 3.020845, 4.915119
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004487, 3.102223, 5.362981
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004658, 3.267020, 5.536815
Train average loss all      (Triplet)                 : 0.004628

== Recognize ==
Train average loss Recognize     : 0.920058
Train average accuracy drums     : 50.250000 %
Train average accuracy bass      : 50.174999 %
Train average accuracy piano     : 50.054996 %
Train average accuracy guitar    : 50.269997 %
Train average accuracy residuals : 49.340000 %

== Train average loss all : 0.004628

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.938, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.938, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.895, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.895, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]    Epoch 66:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=3.85e-5, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=3.85e-5, Train/loss_recog_step=0.973, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=3.85e-5, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=3.85e-5, Train/loss_recog_step=0.973, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.030, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]  Epoch 66: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.030, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.255, Valid/loss_unet_all_step=0.776, Valid/loss_triplet_all_step=0.255, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.934, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.60it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184183, 0.187610, 0.189281, 0.204458
Valid average loss UNet                 (all)                : 0.765532

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069072, 3.150411, 5.585941
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.700253, 3.774878, 3.758080
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.384244, 3.478626, 3.755378
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.338036, 3.516975, 4.501256
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292718, 3.724950, 5.319976
Valid average loss all      (Triplet)                 : 0.402773

== Recognize ==
Valid average loss Recognize     : 0.902898
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.402773

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.375288248062134 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.243908405303955 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.415344476699829 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.668561220169067 sec. =
Valid knn accuracy guitar    : 56.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9671149253845215 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 54.910367923626154%

                                                                      [AEpoch 66: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.920]Epoch 66: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189787, 0.190083, 0.188965, 0.194066
Train average loss UNet                 (all)                : 0.762900

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000761, 3.033959, 5.607825
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006030, 2.895459, 4.718729
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007395, 2.972185, 4.872011
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004419, 3.043228, 5.238469
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006000, 3.216372, 5.444174
Train average loss all      (Triplet)                 : 0.004895

== Recognize ==
Train average loss Recognize     : 0.921413
Train average accuracy drums     : 49.595001 %
Train average accuracy bass      : 50.290001 %
Train average accuracy piano     : 50.625004 %
Train average accuracy guitar    : 49.860001 %
Train average accuracy residuals : 50.344997 %

== Train average loss all : 0.004895

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.903, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.903, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.901, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.901, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.935, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00459, Train/loss_recog_step=0.935, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.915, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]  Epoch 67:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.915, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]  Epoch 67:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.884, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.884, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.991, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=0.727, Valid/loss_all_epoch=0.403, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.903, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.60it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183729, 0.187112, 0.189009, 0.199240
Valid average loss UNet                 (all)                : 0.759090

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053445, 3.224952, 5.738358
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.594148, 3.922025, 4.330666
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.464095, 3.528315, 3.793174
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.331082, 3.488649, 4.344130
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333147, 4.054978, 5.211110
Valid average loss all      (Triplet)                 : 0.390158

== Recognize ==
Valid average loss Recognize     : 0.967517
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.390158

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.780894041061401 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.225357294082642 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.457040309906006 sec. =
Valid knn accuracy piano     : 44.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.699351787567139 sec. =
Valid knn accuracy guitar    : 56.69642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.867958068847656 sec. =
Valid knn accuracy residuals : 63.86363636363637%

Valid knn accuracy average   : 55.46622713497933%

                                                                      [AEpoch 67: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.991, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00489, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00489, Train/loss_recog_epoch=0.921]Epoch 67: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.991, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189620, 0.189925, 0.188834, 0.194325
Train average loss UNet                 (all)                : 0.762703

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000791, 3.011079, 5.691213
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005747, 2.896515, 4.811138
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006242, 2.963291, 4.866869
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004065, 3.023833, 5.226359
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006030, 3.207429, 5.463584
Train average loss all      (Triplet)                 : 0.004633

== Recognize ==
Train average loss Recognize     : 0.928817
Train average accuracy drums     : 49.514999 %
Train average accuracy bass      : 50.199997 %
Train average accuracy piano     : 49.680000 %
Train average accuracy guitar    : 49.915001 %
Train average accuracy residuals : 50.410004 %

== Train average loss all : 0.004633

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.991, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.991, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.991, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00158, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.932, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00158, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=0.932, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00738, Train/loss_recog_step=0.881, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00738, Train/loss_recog_step=0.881, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=0.918, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]  Epoch 68:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=0.918, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]  Epoch 68:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183995, 0.187338, 0.189328, 0.207738
Valid average loss UNet                 (all)                : 0.768398

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041960, 3.250118, 5.676581
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.653645, 3.886836, 3.999038
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.584182, 3.670940, 3.813199
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.385007, 3.525362, 4.467292
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348138, 3.903008, 5.223157
Valid average loss all      (Triplet)                 : 0.423775

== Recognize ==
Valid average loss Recognize     : 0.922048
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.423775

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.451920986175537 sec. =
Valid knn accuracy drums     : 90.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.426313638687134 sec. =
Valid knn accuracy bass      : 22.177419354838708%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.29327130317688 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.339682340621948 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.327040433883667 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 53.3197168255132%

                                                                      [AEpoch 68: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00463, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=0.929]Epoch 68: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189506, 0.189815, 0.188694, 0.194112
Train average loss UNet                 (all)                : 0.762128

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000993, 3.095154, 5.809798
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006274, 2.976044, 4.872270
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003839, 2.968284, 4.931553
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002715, 3.099322, 5.379160
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005450, 3.305300, 5.624772
Train average loss all      (Triplet)                 : 0.003985

== Recognize ==
Train average loss Recognize     : 0.933378
Train average accuracy drums     : 49.500000 %
Train average accuracy bass      : 49.880001 %
Train average accuracy piano     : 49.720001 %
Train average accuracy guitar    : 49.465000 %
Train average accuracy residuals : 50.120003 %

== Train average loss all : 0.003985

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00415, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00415, Train/loss_recog_step=0.844, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00415, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00415, Train/loss_recog_step=0.844, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]    Epoch 69:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00464, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00464, Train/loss_recog_step=0.971, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00464, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00464, Train/loss_recog_step=0.971, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.953, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.22it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184048, 0.187435, 0.189478, 0.203740
Valid average loss UNet                 (all)                : 0.764700

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061834, 3.181213, 5.683856
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.796962, 4.110969, 4.139832
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.512043, 3.678186, 4.013669
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.267959, 3.413818, 4.328215
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.357179, 3.852895, 4.917888
Valid average loss all      (Triplet)                 : 0.445589

== Recognize ==
Valid average loss Recognize     : 0.913121
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.445589

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.375023365020752 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.395555019378662 sec. =
Valid knn accuracy bass      : 31.451612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.318374633789062 sec. =
Valid knn accuracy piano     : 38.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.719308853149414 sec. =
Valid knn accuracy guitar    : 44.86607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.368799924850464 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 52.77017594738711%

                                                                      [AEpoch 69: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00398, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=0.933]Epoch 69: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189249, 0.189531, 0.188445, 0.194649
Train average loss UNet                 (all)                : 0.761874

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001459, 3.121306, 5.735094
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006686, 3.034412, 4.985064
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004723, 3.035714, 5.012731
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003572, 3.158042, 5.408835
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005850, 3.358506, 5.718475
Train average loss all      (Triplet)                 : 0.004600

== Recognize ==
Train average loss Recognize     : 0.931218
Train average accuracy drums     : 49.584999 %
Train average accuracy bass      : 49.884998 %
Train average accuracy piano     : 49.224998 %
Train average accuracy guitar    : 50.134998 %
Train average accuracy residuals : 51.115002 %

== Train average loss all : 0.004600

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.933, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.933, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]    Epoch 70:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=0.909, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=0.909, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.909, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.909, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.440, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.446, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.14it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183741, 0.187152, 0.188942, 0.199913
Valid average loss UNet                 (all)                : 0.759747

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.046361, 3.147178, 5.893913
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.682797, 3.738617, 3.719017
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.487383, 3.454826, 3.597685
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.273758, 3.294790, 4.349710
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270799, 3.456071, 5.017367
Valid average loss all      (Triplet)                 : 0.383643

== Recognize ==
Valid average loss Recognize     : 0.918499
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.383643

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.472701549530029 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.148448467254639 sec. =
Valid knn accuracy bass      : 32.25806451612903%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.807395935058594 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.248300790786743 sec. =
Valid knn accuracy guitar    : 58.03571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.088340044021606 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 56.440549238629536%

                                                                      [AEpoch 70: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0046, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0046, Train/loss_recog_epoch=0.931]Epoch 70: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189410, 0.189710, 0.188607, 0.195048
Train average loss UNet                 (all)                : 0.762776

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000867, 3.054849, 5.765739
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009140, 2.952259, 4.823589
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005118, 2.944067, 4.872413
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003600, 3.083766, 5.313180
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005491, 3.286527, 5.569146
Train average loss all      (Triplet)                 : 0.004907

== Recognize ==
Train average loss Recognize     : 0.936567
Train average accuracy drums     : 50.230003 %
Train average accuracy bass      : 50.015003 %
Train average accuracy piano     : 49.764999 %
Train average accuracy guitar    : 49.555000 %
Train average accuracy residuals : 49.775002 %

== Train average loss all : 0.004907

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=0.924, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=0.924, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0081, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.939, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0081, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.939, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]  Epoch 71:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=0.975, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=0.975, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.355, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=0.825, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.97it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184408, 0.187794, 0.189768, 0.192145
Valid average loss UNet                 (all)                : 0.754114

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086385, 3.138384, 5.793218
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.678421, 3.787310, 3.859832
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.414329, 3.535648, 3.878014
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291727, 3.524694, 4.441451
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.415942, 3.605628, 5.102173
Valid average loss all      (Triplet)                 : 0.412063

== Recognize ==
Valid average loss Recognize     : 0.940128
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.412063

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.830307245254517 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.406644821166992 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.790024995803833 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.345747709274292 sec. =
Valid knn accuracy guitar    : 55.80357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.343100547790527 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 55.06817256857798%

                                                                      [AEpoch 71: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00491, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00491, Train/loss_recog_epoch=0.937]Epoch 71: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189271, 0.189576, 0.188462, 0.194727
Train average loss UNet                 (all)                : 0.762037

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000718, 3.029297, 5.834256
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005354, 2.823670, 4.640613
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004553, 2.957260, 4.878001
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002755, 3.049630, 5.298693
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003458, 3.256596, 5.571239
Train average loss all      (Triplet)                 : 0.003517

== Recognize ==
Train average loss Recognize     : 0.927201
Train average accuracy drums     : 50.664997 %
Train average accuracy bass      : 50.045002 %
Train average accuracy piano     : 50.959999 %
Train average accuracy guitar    : 49.980000 %
Train average accuracy residuals : 50.330002 %

== Train average loss all : 0.003517

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00648, Train/loss_recog_step=0.966, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  32%|███▏      | 100/313 [01:29<03:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00648, Train/loss_recog_step=0.966, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  32%|███▏      | 100/313 [01:29<03:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00147, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00147, Train/loss_recog_step=0.951, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00147, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00147, Train/loss_recog_step=0.951, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.947, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.00585, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.947, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]    Epoch 72:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.977, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=0.977, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.908, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.908, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.888, Valid/loss_all_step=0.385, Valid/loss_unet_all_step=0.749, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=0.899, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183854, 0.187266, 0.189033, 0.195901
Valid average loss UNet                 (all)                : 0.756054

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084065, 3.226422, 5.696037
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.617257, 4.044291, 4.189285
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.468570, 3.593458, 4.027091
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.254570, 3.606859, 4.558939
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.488899, 4.011833, 4.960299
Valid average loss all      (Triplet)                 : 0.402465

== Recognize ==
Valid average loss Recognize     : 1.033799
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.402465

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.492774248123169 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.321861743927002 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 27.603732585906982 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.426296949386597 sec. =
Valid knn accuracy guitar    : 59.15178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4011335372924805 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 54.823684194049285%

                                                                      [AEpoch 72: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.888, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.927]Epoch 72: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.888, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189609, 0.189907, 0.188789, 0.194585
Train average loss UNet                 (all)                : 0.762889

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000997, 3.119676, 5.845911
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006720, 3.018853, 4.932963
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005903, 3.100699, 5.098514
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005242, 3.202260, 5.427971
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002928, 3.362953, 5.776683
Train average loss all      (Triplet)                 : 0.004426

== Recognize ==
Train average loss Recognize     : 0.941580
Train average accuracy drums     : 49.930000 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 49.965000 %
Train average accuracy guitar    : 49.399998 %
Train average accuracy residuals : 49.965000 %

== Train average loss all : 0.004426

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.888, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.888, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.888, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=1.040, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=1.040, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]    Epoch 73:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184111, 0.187458, 0.189361, 0.201995
Valid average loss UNet                 (all)                : 0.762926

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091220, 3.277742, 5.881730
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.640971, 3.903033, 4.078820
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.602456, 3.636240, 3.773612
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263035, 3.491737, 4.694342
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.358858, 3.956551, 5.156611
Valid average loss all      (Triplet)                 : 0.414504

== Recognize ==
Valid average loss Recognize     : 0.973874
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.414504

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.360707759857178 sec. =
Valid knn accuracy drums     : 87.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.52693796157837 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.601367235183716 sec. =
Valid knn accuracy piano     : 35.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6329686641693115 sec. =
Valid knn accuracy guitar    : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.576202154159546 sec. =
Valid knn accuracy residuals : 62.727272727272734%

Valid knn accuracy average   : 53.65274767308429%

                                                                      [AEpoch 73: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00443, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00443, Train/loss_recog_epoch=0.942]Epoch 73: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189256, 0.189554, 0.188447, 0.194415
Train average loss UNet                 (all)                : 0.761672

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001094, 3.146004, 5.874816
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005186, 3.010729, 4.973984
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005212, 3.057972, 5.011182
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006648, 3.194785, 5.418197
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002188, 3.336483, 5.736037
Train average loss all      (Triplet)                 : 0.004059

== Recognize ==
Train average loss Recognize     : 0.947245
Train average accuracy drums     : 49.720001 %
Train average accuracy bass      : 50.395000 %
Train average accuracy piano     : 49.279999 %
Train average accuracy guitar    : 49.970001 %
Train average accuracy residuals : 50.320000 %

== Train average loss all : 0.004059

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  32%|███▏      | 100/313 [01:26<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00298, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=0.902, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00298, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=0.902, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000704, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000704, Train/loss_recog_step=0.926, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000704, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000704, Train/loss_recog_step=0.926, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]      Epoch 74:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00968, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00968, Train/loss_recog_step=0.854, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00968, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00968, Train/loss_recog_step=0.854, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.326, Valid/loss_unet_all_step=0.772, Valid/loss_triplet_all_step=0.326, Valid/loss_recog_step=0.956, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184322, 0.187753, 0.189644, 0.196281
Valid average loss UNet                 (all)                : 0.758001

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060706, 3.233176, 5.876959
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.714601, 4.063988, 4.213636
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.444854, 3.397414, 3.908173
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.381560, 3.566784, 4.751826
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348018, 3.833365, 5.141592
Valid average loss all      (Triplet)                 : 0.423504

== Recognize ==
Valid average loss Recognize     : 0.991089
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.423504

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.492889165878296 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.17301082611084 sec. =
Valid knn accuracy bass      : 31.048387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.50236201286316 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3311076164245605 sec. =
Valid knn accuracy guitar    : 58.25892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.391061782836914 sec. =
Valid knn accuracy residuals : 60.22727272727273%

Valid knn accuracy average   : 55.26255626605161%

                                                                      [AEpoch 74: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00406, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=0.947]Epoch 74: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189555, 0.189844, 0.188730, 0.195103
Train average loss UNet                 (all)                : 0.763232

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001638, 3.178552, 5.906166
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005799, 3.074694, 5.000106
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005287, 3.102881, 5.089145
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003575, 3.216482, 5.561652
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004405, 3.383233, 5.734920
Train average loss all      (Triplet)                 : 0.004203

== Recognize ==
Train average loss Recognize     : 0.948297
Train average accuracy drums     : 50.195004 %
Train average accuracy bass      : 50.285000 %
Train average accuracy piano     : 50.615002 %
Train average accuracy guitar    : 49.750000 %
Train average accuracy residuals : 49.820000 %

== Train average loss all : 0.004203

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=0.994, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=0.994, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.946, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00454, Train/loss_recog_step=0.946, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.553, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185767, 0.189205, 0.191294, 0.204336
Valid average loss UNet                 (all)                : 0.770602

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142225, 3.342355, 5.780493
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.702838, 4.066498, 4.328213
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.491968, 3.729160, 4.017530
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287313, 3.740171, 5.139216
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.378810, 4.359469, 5.288155
Valid average loss all      (Triplet)                 : 0.433560

== Recognize ==
Valid average loss Recognize     : 0.977387
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.433560

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.511777400970459 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.935128450393677 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.311698913574219 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.198995351791382 sec. =
Valid knn accuracy guitar    : 51.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.399139642715454 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 53.52199897315166%

                                                                      [AEpoch 75: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.0042, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.0042, Train/loss_recog_epoch=0.948]Epoch 75: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189749, 0.190044, 0.188934, 0.194896
Train average loss UNet                 (all)                : 0.763622

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001123, 3.184753, 5.971471
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005416, 3.015133, 4.953831
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005053, 3.074613, 5.053398
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003885, 3.188536, 5.538483
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004690, 3.394725, 5.727638
Train average loss all      (Triplet)                 : 0.004019

== Recognize ==
Train average loss Recognize     : 0.953193
Train average accuracy drums     : 49.750000 %
Train average accuracy bass      : 50.375004 %
Train average accuracy piano     : 49.860001 %
Train average accuracy guitar    : 50.000000 %
Train average accuracy residuals : 50.430000 %

== Train average loss all : 0.004019

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.00862, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00862, Train/loss_recog_step=0.954, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00862, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00862, Train/loss_recog_step=0.954, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00101, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.995, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00101, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00101, Train/loss_recog_step=0.995, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00319, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=0.959, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00319, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=0.959, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00761, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00761, Train/loss_recog_step=0.995, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00761, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00761, Train/loss_recog_step=0.995, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.969, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=0.969, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]    Epoch 76: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.920, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.344, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.344, Valid/loss_recog_step=0.972, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.535, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.92it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183758, 0.187160, 0.188975, 0.200008
Valid average loss UNet                 (all)                : 0.759900

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085487, 3.121494, 5.527069
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.634468, 4.044320, 4.190322
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.472496, 3.433107, 3.956537
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.286669, 3.525975, 4.545307
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.345783, 4.101562, 5.407008
Valid average loss all      (Triplet)                 : 0.389031

== Recognize ==
Valid average loss Recognize     : 0.982475
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.389031

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.270740509033203 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.467079877853394 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.47556185722351 sec. =
Valid knn accuracy piano     : 47.265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.482407808303833 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.353197813034058 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 55.89272650999071%

                                                                      [AEpoch 76: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00402, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00402, Train/loss_recog_epoch=0.953]Epoch 76: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189802, 0.190100, 0.188968, 0.194269
Train average loss UNet                 (all)                : 0.763140

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001431, 3.148241, 5.885413
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006876, 3.097818, 5.057341
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007631, 3.115508, 5.066124
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003671, 3.206746, 5.546815
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005292, 3.440706, 5.851889
Train average loss all      (Triplet)                 : 0.004950

== Recognize ==
Train average loss Recognize     : 0.959904
Train average accuracy drums     : 49.590000 %
Train average accuracy bass      : 49.980000 %
Train average accuracy piano     : 49.985001 %
Train average accuracy guitar    : 49.285000 %
Train average accuracy residuals : 49.829998 %

== Train average loss all : 0.004950

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.953, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.953, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.982, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0043, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.982, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]  Epoch 77:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.954, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.0151, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=0.954, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]  Epoch 77:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77: 100%|██████████| 313/313 [04:24<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77: 100%|██████████| 313/313 [04:24<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.217, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184152, 0.187547, 0.189289, 0.197772
Valid average loss UNet                 (all)                : 0.758760

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.105697, 3.265576, 5.928215
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.853368, 4.419706, 4.449146
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.471190, 3.579651, 3.850737
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.258530, 3.626740, 4.800610
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.328287, 4.239260, 5.304550
Valid average loss all      (Triplet)                 : 0.451905

== Recognize ==
Valid average loss Recognize     : 1.021802
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.451905

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.41306209564209 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.08413815498352 sec. =
Valid knn accuracy bass      : 24.596774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.69701623916626 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5035319328308105 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.716163396835327 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 54.39745689969217%

                                                                      [AEpoch 77: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00495, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00495, Train/loss_recog_epoch=0.960]Epoch 77: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189516, 0.189805, 0.188705, 0.194914
Train average loss UNet                 (all)                : 0.762941

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000903, 3.165101, 6.016330
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005537, 3.103029, 5.105525
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006299, 3.087604, 5.080039
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003816, 3.222740, 5.561759
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003093, 3.384277, 5.770479
Train average loss all      (Triplet)                 : 0.003930

== Recognize ==
Train average loss Recognize     : 0.959307
Train average accuracy drums     : 50.150002 %
Train average accuracy bass      : 50.064999 %
Train average accuracy piano     : 50.054996 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 49.900002 %

== Train average loss all : 0.003930

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.000727, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000727, Train/loss_recog_step=0.994, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000727, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000727, Train/loss_recog_step=0.994, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.956, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]  Epoch 78:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.956, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.929, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]  Epoch 78:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.929, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]  Epoch 78:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=1.010, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00461, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=1.010, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00296, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=1.060, Valid/loss_all_step=0.461, Valid/loss_unet_all_step=0.761, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.452, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.76it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.77it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183470, 0.186881, 0.188466, 0.199303
Valid average loss UNet                 (all)                : 0.758120

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083045, 3.348842, 5.968702
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.810404, 4.226591, 4.156445
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.429019, 3.593512, 3.946358
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319373, 3.754375, 4.855247
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.457223, 4.331293, 5.326805
Valid average loss all      (Triplet)                 : 0.460180

== Recognize ==
Valid average loss Recognize     : 0.939433
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.460180

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.398526906967163 sec. =
Valid knn accuracy drums     : 83.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.028018951416016 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.53056526184082 sec. =
Valid knn accuracy piano     : 44.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.912787914276123 sec. =
Valid knn accuracy guitar    : 62.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.847257852554321 sec. =
Valid knn accuracy residuals : 59.54545454545455%

Valid knn accuracy average   : 54.635658105043625%

                                                                      [AEpoch 78: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00296, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=1.060, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00393, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=0.959]Epoch 78: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00296, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=1.060, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189407, 0.189721, 0.188614, 0.195049
Train average loss UNet                 (all)                : 0.762791

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000705, 3.264314, 6.163859
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004802, 3.172539, 5.209590
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004636, 3.235197, 5.303916
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004825, 3.422915, 5.865693
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005092, 3.565893, 6.085777
Train average loss all      (Triplet)                 : 0.004081

== Recognize ==
Train average loss Recognize     : 0.964331
Train average accuracy drums     : 50.244999 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.160004 %
Train average accuracy guitar    : 50.410004 %
Train average accuracy residuals : 49.704998 %

== Train average loss all : 0.004081

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00296, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=1.060, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00296, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=1.060, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  16%|█▌        | 50/313 [00:46<04:06,  1.06it/s, v_num=0, Train/loss_all_step=0.00296, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.00296, Train/loss_recog_step=1.060, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  16%|█▌        | 50/313 [00:46<04:06,  1.06it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.973, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.973, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=0.900, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00492, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=0.900, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.964, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00385, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.964, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0366, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0366, Train/loss_recog_step=0.963, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]  Epoch 79:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0366, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0366, Train/loss_recog_step=0.963, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]  Epoch 79:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00615, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00615, Train/loss_recog_step=0.991, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00615, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00615, Train/loss_recog_step=0.991, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.434, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.460, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.460, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.46it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185274, 0.188696, 0.190578, 0.201044
Valid average loss UNet                 (all)                : 0.765592

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127853, 3.573607, 6.411423
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.660458, 4.366003, 4.758551
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.410031, 3.801628, 4.377189
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.414703, 4.078482, 5.127964
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.380248, 4.599946, 5.857351
Valid average loss all      (Triplet)                 : 0.417743

== Recognize ==
Valid average loss Recognize     : 1.008536
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 42.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.417743

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.82549786567688 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.837040662765503 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.412844896316528 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.825440406799316 sec. =
Valid knn accuracy guitar    : 56.02678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.268990993499756 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 55.6842395857999%

                                                                      [AEpoch 79: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00408, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00408, Train/loss_recog_epoch=0.964]Epoch 79: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189731, 0.190041, 0.188896, 0.194723
Train average loss UNet                 (all)                : 0.763391

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001143, 3.252262, 6.165702
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006387, 3.137571, 5.215706
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005655, 3.228581, 5.272463
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005165, 3.412708, 5.861481
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005438, 3.547747, 6.043304
Train average loss all      (Triplet)                 : 0.004884

== Recognize ==
Train average loss Recognize     : 0.971860
Train average accuracy drums     : 49.264999 %
Train average accuracy bass      : 50.089996 %
Train average accuracy piano     : 50.730003 %
Train average accuracy guitar    : 49.965000 %
Train average accuracy residuals : 49.389999 %

== Train average loss all : 0.004884

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.992, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.992, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.949, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00352, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.949, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.925, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]  Epoch 80:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.925, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]  Epoch 80:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0296, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=0.980, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0296, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=0.980, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.976, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.418, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184801, 0.188228, 0.190209, 0.203661
Valid average loss UNet                 (all)                : 0.766898

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109384, 3.289028, 5.963272
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.528220, 4.079885, 4.447621
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.402800, 3.677338, 4.187171
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.316516, 3.880282, 4.998999
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.352554, 4.248891, 5.222694
Valid average loss all      (Triplet)                 : 0.341905

== Recognize ==
Valid average loss Recognize     : 0.959046
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.341905

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.562918186187744 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.640612125396729 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.722911596298218 sec. =
Valid knn accuracy piano     : 38.4765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.107665538787842 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.448292255401611 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 54.26813221184496%

                                                                      [AEpoch 80: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00488, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00488, Train/loss_recog_epoch=0.972]Epoch 80: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189884, 0.190182, 0.189067, 0.194518
Train average loss UNet                 (all)                : 0.763651

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000713, 3.280778, 6.392477
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007179, 3.219314, 5.296233
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004780, 3.268252, 5.377933
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005594, 3.479470, 5.949329
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004389, 3.537984, 6.030207
Train average loss all      (Triplet)                 : 0.004553

== Recognize ==
Train average loss Recognize     : 0.972436
Train average accuracy drums     : 50.690002 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 48.974998 %
Train average accuracy guitar    : 50.139999 %
Train average accuracy residuals : 50.010002 %

== Train average loss all : 0.004553

Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]          Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=0.970, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.00396, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=0.970, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=0.999, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00581, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=0.999, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]    Epoch 81:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.991, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.991, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.950, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]  Epoch 81:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.950, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]Epoch 81: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.0707, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.0707, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.342, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.342, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.14it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185000, 0.188390, 0.190395, 0.187069
Valid average loss UNet                 (all)                : 0.750853

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095466, 3.459738, 5.963208
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.640670, 4.524577, 4.664124
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.403106, 3.541308, 4.161931
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.342320, 3.919339, 4.997306
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.285757, 4.344996, 5.319008
Valid average loss all      (Triplet)                 : 0.372728

== Recognize ==
Valid average loss Recognize     : 1.050356
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.372728

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.419108629226685 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.56773042678833 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.577175855636597 sec. =
Valid knn accuracy piano     : 44.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.403288125991821 sec. =
Valid knn accuracy guitar    : 56.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.28055477142334 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 56.47474858153767%

                                                                      [AEpoch 81: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00455, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00455, Train/loss_recog_epoch=0.972]  Epoch 81: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189667, 0.189962, 0.188851, 0.194718
Train average loss UNet                 (all)                : 0.763199

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000520, 3.208483, 6.083255
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005829, 3.183648, 5.249034
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004305, 3.228188, 5.327516
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004559, 3.415380, 5.846591
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004877, 3.546936, 6.056109
Train average loss all      (Triplet)                 : 0.004112

== Recognize ==
Train average loss Recognize     : 0.971908
Train average accuracy drums     : 50.580002 %
Train average accuracy bass      : 49.775002 %
Train average accuracy piano     : 50.720001 %
Train average accuracy guitar    : 49.959999 %
Train average accuracy residuals : 49.869999 %

== Train average loss all : 0.004112

Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]          Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00481, Train/loss_recog_step=0.998, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.00481, Train/loss_recog_step=0.998, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]    Epoch 82:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.986, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.986, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.0247, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0247, Train/loss_recog_step=0.940, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0247, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0247, Train/loss_recog_step=0.940, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]  Epoch 82: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82: 100%|██████████| 313/313 [04:19<00:00,  1.21it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.732, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.87it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185325, 0.188682, 0.190734, 0.202346
Valid average loss UNet                 (all)                : 0.767087

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098012, 3.487119, 6.108529
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.737048, 4.407689, 4.632349
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.635897, 3.749342, 3.837532
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337884, 3.751693, 4.912910
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.352238, 4.379938, 5.471958
Valid average loss all      (Triplet)                 : 0.451189

== Recognize ==
Valid average loss Recognize     : 0.916403
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.451189

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.402440309524536 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.399480819702148 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.65865683555603 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.565766096115112 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.213721036911011 sec. =
Valid knn accuracy residuals : 63.18181818181819%

Valid knn accuracy average   : 53.05792713816688%

                                                                      [AEpoch 82: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00411, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00411, Train/loss_recog_epoch=0.972]Epoch 82: 100%|██████████| 313/313 [05:30<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189786, 0.190080, 0.188955, 0.195453
Train average loss UNet                 (all)                : 0.764275

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000658, 3.259299, 6.173952
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003993, 3.247262, 5.381336
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006245, 3.285324, 5.408296
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005232, 3.433993, 5.932874
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002795, 3.515845, 6.027155
Train average loss all      (Triplet)                 : 0.003762

== Recognize ==
Train average loss Recognize     : 0.977255
Train average accuracy drums     : 49.965000 %
Train average accuracy bass      : 50.075001 %
Train average accuracy piano     : 49.895000 %
Train average accuracy guitar    : 50.484997 %
Train average accuracy residuals : 50.110001 %

== Train average loss all : 0.003762

Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]          Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=0.921, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=0.921, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.979, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]  Epoch 83:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.979, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]  Epoch 83:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.316, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=0.705, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.916, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185888, 0.189270, 0.191362, 0.203699
Valid average loss UNet                 (all)                : 0.770220

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098671, 3.522587, 5.967297
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.671295, 4.566053, 4.812734
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.563572, 3.778854, 4.140210
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.370877, 3.904794, 4.896566
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.281782, 4.308074, 5.510232
Valid average loss all      (Triplet)                 : 0.411436

== Recognize ==
Valid average loss Recognize     : 0.943105
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 57.500000 %

== Valid average loss all : 0.411436

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.577800035476685 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.06301212310791 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.123217582702637 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.540402889251709 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.266457557678223 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 54.520510783045836%

                                                                      [AEpoch 83: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.977]Epoch 83: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190021, 0.190320, 0.189206, 0.194847
Train average loss UNet                 (all)                : 0.764394

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000820, 3.292961, 6.296482
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004083, 3.213966, 5.316088
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003946, 3.250654, 5.409541
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004055, 3.419806, 5.964033
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003083, 3.542171, 6.076264
Train average loss all      (Triplet)                 : 0.003270

== Recognize ==
Train average loss Recognize     : 0.971517
Train average accuracy drums     : 50.384998 %
Train average accuracy bass      : 50.355000 %
Train average accuracy piano     : 50.314999 %
Train average accuracy guitar    : 50.515003 %
Train average accuracy residuals : 49.599998 %

== Train average loss all : 0.003270

Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]          Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.841, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.841, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]    Epoch 84:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000828, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000828, Train/loss_recog_step=1.020, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000828, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000828, Train/loss_recog_step=1.020, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0183, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.100, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]    Epoch 84: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0183, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.100, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.943, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.08it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184432, 0.187834, 0.189512, 0.187009
Valid average loss UNet                 (all)                : 0.748787

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066199, 3.521199, 6.185600
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.607350, 4.336903, 4.469593
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.526319, 3.599369, 4.168275
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.348997, 3.932620, 5.231799
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.361753, 4.285790, 5.570033
Valid average loss all      (Triplet)                 : 0.388008

== Recognize ==
Valid average loss Recognize     : 1.058094
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.388008

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.295724391937256 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.532231092453003 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.868491649627686 sec. =
Valid knn accuracy piano     : 34.765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.39953875541687 sec. =
Valid knn accuracy guitar    : 56.69642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.938180208206177 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 53.21017177510428%

                                                                      [AEpoch 84: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=0.972]Epoch 84: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189698, 0.189988, 0.188878, 0.193931
Train average loss UNet                 (all)                : 0.762496

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000843, 3.320189, 6.279431
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004023, 3.189503, 5.274533
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005763, 3.275075, 5.391044
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005482, 3.453489, 5.937628
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003672, 3.509713, 5.992809
Train average loss all      (Triplet)                 : 0.003818

== Recognize ==
Train average loss Recognize     : 0.984841
Train average accuracy drums     : 49.419998 %
Train average accuracy bass      : 49.889999 %
Train average accuracy piano     : 50.155003 %
Train average accuracy guitar    : 49.559998 %
Train average accuracy residuals : 49.955002 %

== Train average loss all : 0.003818

Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]          Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.999, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00355, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.999, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000496, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000496, Train/loss_recog_step=0.995, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000496, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000496, Train/loss_recog_step=0.995, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=0.973, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]    Epoch 85: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=0.973, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.135, Valid/loss_unet_all_step=0.727, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.749, Valid/loss_triplet_all_epoch=0.388, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184179, 0.187585, 0.189302, 0.200494
Valid average loss UNet                 (all)                : 0.761560

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078036, 3.319939, 5.759007
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.705040, 4.348811, 4.598093
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.527653, 3.983156, 4.161142
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.419661, 3.809173, 5.037577
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.441058, 4.195289, 5.196008
Valid average loss all      (Triplet)                 : 0.459019

== Recognize ==
Valid average loss Recognize     : 0.929150
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.459019

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.464812278747559 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.334468126296997 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.255434513092041 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5342772006988525 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.440199136734009 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 52.46576237796214%

                                                                      [AEpoch 85: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00382, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=0.985]Epoch 85: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189792, 0.190099, 0.188967, 0.195008
Train average loss UNet                 (all)                : 0.763867

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000496, 3.295805, 6.313893
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002725, 3.178163, 5.286664
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007096, 3.298659, 5.365780
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003730, 3.465721, 6.021702
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005835, 3.624296, 6.179233
Train average loss all      (Triplet)                 : 0.003841

== Recognize ==
Train average loss Recognize     : 0.981967
Train average accuracy drums     : 49.744999 %
Train average accuracy bass      : 50.054996 %
Train average accuracy piano     : 50.204998 %
Train average accuracy guitar    : 50.300003 %
Train average accuracy residuals : 49.505001 %

== Train average loss all : 0.003841

Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]          Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.040, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.040, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]  Epoch 86:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.739, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=1.100, Valid/loss_all_step=0.313, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=0.801, Valid/loss_all_epoch=0.459, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.929, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.183687, 0.186968, 0.188799, 0.210117
Valid average loss UNet                 (all)                : 0.769571

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120172, 3.398610, 5.941073
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.682757, 4.249341, 4.451481
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.580700, 3.596291, 3.867384
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298564, 3.623419, 4.927298
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.427518, 4.043455, 5.355547
Valid average loss all      (Triplet)                 : 0.433992

== Recognize ==
Valid average loss Recognize     : 0.938876
Valid average accuracy drums     : 60.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.433992

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.511677026748657 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.301685571670532 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.197933435440063 sec. =
Valid knn accuracy piano     : 36.71875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.395838737487793 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.588131666183472 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 53.07610915557094%

                                                                      [AEpoch 86: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=1.100, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00384, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00384, Train/loss_recog_epoch=0.982]Epoch 86: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=1.100, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189882, 0.190194, 0.189086, 0.194474
Train average loss UNet                 (all)                : 0.763637

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000840, 3.315417, 6.312182
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007517, 3.241764, 5.355636
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004938, 3.269535, 5.453129
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003920, 3.478713, 6.040144
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004567, 3.579667, 6.098985
Train average loss all      (Triplet)                 : 0.004407

== Recognize ==
Train average loss Recognize     : 0.982723
Train average accuracy drums     : 50.019997 %
Train average accuracy bass      : 50.570000 %
Train average accuracy piano     : 49.485001 %
Train average accuracy guitar    : 50.099998 %
Train average accuracy residuals : 50.209999 %

== Train average loss all : 0.004407

Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=1.100, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]          Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=1.100, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000697, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000697, Train/loss_recog_step=1.100, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00387, Train/loss_recog_step=0.970, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]  Epoch 87:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00387, Train/loss_recog_step=0.970, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00091, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00091, Train/loss_recog_step=0.928, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.00091, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00091, Train/loss_recog_step=0.928, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.060, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]  Epoch 87:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.060, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00475, Train/loss_recog_step=0.983, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00475, Train/loss_recog_step=0.983, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]    Epoch 87:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00957, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00957, Train/loss_recog_step=1.100, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00957, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.00957, Train/loss_recog_step=1.100, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.172, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.172, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.434, Valid/loss_recog_epoch=0.939, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.66it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184082, 0.187447, 0.189330, 0.190621
Valid average loss UNet                 (all)                : 0.751480

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144116, 3.441500, 5.939837
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.811835, 4.392325, 4.369693
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.526666, 3.529810, 4.051104
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.322996, 3.722632, 4.992719
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.480458, 4.265264, 5.587946
Valid average loss all      (Triplet)                 : 0.489312

== Recognize ==
Valid average loss Recognize     : 0.956350
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.489312

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.547894477844238 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.29605507850647 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.454236030578613 sec. =
Valid knn accuracy piano     : 38.0859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.508631467819214 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.152160167694092 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 52.942647191080304%

                                                                      [AEpoch 87: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00441, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=0.983]Epoch 87: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189612, 0.189889, 0.188782, 0.194271
Train average loss UNet                 (all)                : 0.762554

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000344, 3.328742, 6.346252
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006265, 3.249075, 5.373365
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002794, 3.248127, 5.394836
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004901, 3.453014, 5.990301
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003013, 3.502549, 5.941332
Train average loss all      (Triplet)                 : 0.003532

== Recognize ==
Train average loss Recognize     : 0.987960
Train average accuracy drums     : 49.559998 %
Train average accuracy bass      : 50.185001 %
Train average accuracy piano     : 50.139999 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 49.395000 %

== Train average loss all : 0.003532

Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]          Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=0.980, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=0.980, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0172, Train/loss_recog_step=1.030, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0172, Train/loss_recog_step=1.030, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.425, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.425, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.489, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186178, 0.189612, 0.191560, 0.200039
Valid average loss UNet                 (all)                : 0.767389

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.160085, 3.602962, 6.215039
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.643303, 4.532265, 4.679983
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.623732, 3.871528, 4.190904
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.373230, 3.935407, 5.121325
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.372007, 4.367607, 5.883115
Valid average loss all      (Triplet)                 : 0.453308

== Recognize ==
Valid average loss Recognize     : 0.942373
Valid average accuracy drums     : 58.499996 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.453308

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.412221431732178 sec. =
Valid knn accuracy drums     : 90.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.335101842880249 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.616471529006958 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.229528903961182 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.258793354034424 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 55.09923871491412%

                                                                      [AEpoch 88: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00353, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=0.988]Epoch 88: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189311, 0.189595, 0.188500, 0.194422
Train average loss UNet                 (all)                : 0.761829

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001514, 3.324536, 6.235538
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006227, 3.231271, 5.345421
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005837, 3.305918, 5.450711
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004639, 3.448819, 5.897881
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003343, 3.557205, 6.083271
Train average loss all      (Triplet)                 : 0.004403

== Recognize ==
Train average loss Recognize     : 0.992844
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 49.419998 %
Train average accuracy piano     : 50.290001 %
Train average accuracy guitar    : 49.985001 %
Train average accuracy residuals : 50.024998 %

== Train average loss all : 0.004403

Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]          Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=1.050, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=1.050, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]  Epoch 89:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.863, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.453, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.551, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185059, 0.188486, 0.190236, 0.199349
Valid average loss UNet                 (all)                : 0.763129

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095635, 3.454111, 6.020531
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.779590, 4.519936, 4.622330
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.562423, 3.734510, 4.130122
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.373346, 3.906854, 5.131184
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.369032, 4.150135, 5.373667
Valid average loss all      (Triplet)                 : 0.467452

== Recognize ==
Valid average loss Recognize     : 0.963089
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.467452

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.507776975631714 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9858667850494385 sec. =
Valid knn accuracy bass      : 31.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.720723628997803 sec. =
Valid knn accuracy piano     : 34.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.291525363922119 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.216270923614502 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 52.51489271597968%

                                                                      [AEpoch 89: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.0044, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.0044, Train/loss_recog_epoch=0.993]Epoch 89: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189851, 0.190125, 0.188998, 0.194965
Train average loss UNet                 (all)                : 0.763940

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000758, 3.295649, 6.227051
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006325, 3.297562, 5.467587
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003423, 3.289370, 5.452019
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003381, 3.447597, 5.943412
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003293, 3.529823, 5.998495
Train average loss all      (Triplet)                 : 0.003483

== Recognize ==
Train average loss Recognize     : 0.995889
Train average accuracy drums     : 49.840000 %
Train average accuracy bass      : 49.630001 %
Train average accuracy piano     : 49.695000 %
Train average accuracy guitar    : 50.314999 %
Train average accuracy residuals : 50.035000 %

== Train average loss all : 0.003483

Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]          Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.960, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.00334, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.960, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]    Epoch 90:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.994, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.994, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=1.020, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=1.020, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.909, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.959, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185377, 0.188881, 0.190608, 0.188474
Valid average loss UNet                 (all)                : 0.753339

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.167628, 3.693956, 6.450918
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.840325, 5.056033, 5.093506
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.615792, 4.055861, 4.626650
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310674, 4.368648, 5.704340
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.437787, 4.755194, 5.999653
Valid average loss all      (Triplet)                 : 0.510456

== Recognize ==
Valid average loss Recognize     : 1.067178
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.510456

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6005165576934814 sec. =
Valid knn accuracy drums     : 89.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.167229413986206 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.30271053314209 sec. =
Valid knn accuracy piano     : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7021684646606445 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.1607582569122314 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 57.46827698949018%

                                                                      [AEpoch 90: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.909, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00348, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00348, Train/loss_recog_epoch=0.996]Epoch 90: 100%|██████████| 313/313 [05:31<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.909, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189647, 0.189931, 0.188795, 0.193978
Train average loss UNet                 (all)                : 0.762351

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001672, 3.433779, 6.497129
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006772, 3.433733, 5.670797
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003690, 3.377341, 5.611576
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003013, 3.623191, 6.280914
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003375, 3.650537, 6.199300
Train average loss all      (Triplet)                 : 0.003764

== Recognize ==
Train average loss Recognize     : 1.001053
Train average accuracy drums     : 49.704998 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 50.540001 %
Train average accuracy guitar    : 49.695000 %
Train average accuracy residuals : 49.875000 %

== Train average loss all : 0.003764

Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.909, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]          Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.909, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.0233, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.909, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.951, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.951, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=1.040, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]  Epoch 91:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0497, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=1.040, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]  Epoch 91:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.993, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.993, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000248, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000248, Train/loss_recog_step=1.090, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000248, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000248, Train/loss_recog_step=1.090, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.742, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184755, 0.188168, 0.189911, 0.188901
Valid average loss UNet                 (all)                : 0.751734

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121733, 3.516510, 6.298084
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.694529, 4.564048, 4.739516
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.495275, 3.830866, 4.291685
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.311909, 3.952390, 5.365375
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.474710, 4.416481, 5.711971
Valid average loss all      (Triplet)                 : 0.436221

== Recognize ==
Valid average loss Recognize     : 1.028579
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.436221

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.870438814163208 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.561517477035522 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.577375650405884 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.703382253646851 sec. =
Valid knn accuracy guitar    : 58.03571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.196231365203857 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 54.83163145366204%

                                                                      [AEpoch 91: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=1.000]Epoch 91: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189890, 0.190180, 0.189044, 0.194551
Train average loss UNet                 (all)                : 0.763664

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000563, 3.459431, 6.512746
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006770, 3.436195, 5.716603
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005929, 3.444370, 5.682037
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004865, 3.626034, 6.240857
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004580, 3.739891, 6.367888
Train average loss all      (Triplet)                 : 0.004774

== Recognize ==
Train average loss Recognize     : 1.008924
Train average accuracy drums     : 49.470001 %
Train average accuracy bass      : 49.935001 %
Train average accuracy piano     : 50.330002 %
Train average accuracy guitar    : 49.654999 %
Train average accuracy residuals : 50.045002 %

== Train average loss all : 0.004774

Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]          Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0244, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0244, Train/loss_recog_step=1.010, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0244, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0244, Train/loss_recog_step=1.010, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]  Epoch 92:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00951, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00951, Train/loss_recog_step=1.000, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00951, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00951, Train/loss_recog_step=1.000, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]    Epoch 92:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.020, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.020, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]  Epoch 92: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.010, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184484, 0.187829, 0.189756, 0.205351
Valid average loss UNet                 (all)                : 0.767420

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120755, 3.555074, 6.531744
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.820971, 4.721173, 4.952819
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.480315, 3.909423, 4.408525
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.267235, 4.016524, 5.501560
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.435283, 4.512327, 5.814384
Valid average loss all      (Triplet)                 : 0.477605

== Recognize ==
Valid average loss Recognize     : 1.084235
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 44.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.477605

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.360334634780884 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.524315595626831 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.437828302383423 sec. =
Valid knn accuracy piano     : 40.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.217403411865234 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3687639236450195 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 54.3050897866159%

                                                                      [AEpoch 92: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.010, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00477, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00477, Train/loss_recog_epoch=1.010]Epoch 92: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.010, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189995, 0.190289, 0.189148, 0.194360
Train average loss UNet                 (all)                : 0.763792

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000675, 3.430161, 6.527300
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003925, 3.376269, 5.692205
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002873, 3.395632, 5.681598
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003864, 3.587818, 6.222418
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002319, 3.730197, 6.414784
Train average loss all      (Triplet)                 : 0.002724

== Recognize ==
Train average loss Recognize     : 1.014844
Train average accuracy drums     : 49.454998 %
Train average accuracy bass      : 50.305004 %
Train average accuracy piano     : 49.509998 %
Train average accuracy guitar    : 50.064999 %
Train average accuracy residuals : 49.689999 %

== Train average loss all : 0.002724

Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.010, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]          Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.010, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.010, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]    Epoch 93:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=1.080, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=1.080, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]  Epoch 93:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0015, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=1.060, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.0015, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=1.060, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=1.030, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00333, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=1.030, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.946, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.478, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185371, 0.188793, 0.190788, 0.206388
Valid average loss UNet                 (all)                : 0.771340

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152975, 3.617698, 6.525193
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.719509, 4.692086, 5.001667
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.455085, 4.067996, 4.417206
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.303089, 4.059611, 5.530361
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396019, 4.487981, 5.590969
Valid average loss all      (Triplet)                 : 0.450646

== Recognize ==
Valid average loss Recognize     : 1.006341
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.450646

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.539799928665161 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.759763717651367 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.473742961883545 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.284016847610474 sec. =
Valid knn accuracy guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.444210767745972 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 52.35529649391631%

                                                                      [AEpoch 93: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00272, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00272, Train/loss_recog_epoch=1.010]Epoch 93: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190225, 0.190511, 0.189377, 0.194244
Train average loss UNet                 (all)                : 0.764357

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000922, 3.455003, 6.600852
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004659, 3.441878, 5.734108
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003881, 3.458912, 5.759093
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004912, 3.705669, 6.384833
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003881, 3.662199, 6.229042
Train average loss all      (Triplet)                 : 0.003647

== Recognize ==
Train average loss Recognize     : 1.016263
Train average accuracy drums     : 49.834999 %
Train average accuracy bass      : 49.599998 %
Train average accuracy piano     : 49.739998 %
Train average accuracy guitar    : 49.814999 %
Train average accuracy residuals : 49.900002 %

== Train average loss all : 0.003647

Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]          Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00284, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]    Epoch 94:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00521, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00521, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.946, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.963, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]  Epoch 94:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0181, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.963, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]  Epoch 94:  96%|█████████▌| 300/313 [04:13<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94:  96%|█████████▌| 300/313 [04:13<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00145, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.997, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00145, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=0.997, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.451, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.12it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184187, 0.187491, 0.189597, 0.204477
Valid average loss UNet                 (all)                : 0.765752

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064933, 3.569194, 6.664020
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.775020, 4.731385, 4.966247
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.621185, 4.380580, 4.619656
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.441420, 4.030370, 5.600087
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.437210, 4.567228, 5.453822
Valid average loss all      (Triplet)                 : 0.501971

== Recognize ==
Valid average loss Recognize     : 1.020854
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.501971

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5335609912872314 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.228925704956055 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.856349468231201 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.632750988006592 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.284918546676636 sec. =
Valid knn accuracy residuals : 61.36363636363637%

Valid knn accuracy average   : 52.048736589497466%

                                                                      [AEpoch 94: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.020]Epoch 94: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190351, 0.190646, 0.189508, 0.194523
Train average loss UNet                 (all)                : 0.765028

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001133, 3.530248, 6.682054
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004631, 3.499036, 5.841454
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003865, 3.489200, 5.801658
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004058, 3.780612, 6.590561
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003132, 3.772125, 6.407403
Train average loss all      (Triplet)                 : 0.003553

== Recognize ==
Train average loss Recognize     : 1.015478
Train average accuracy drums     : 49.805000 %
Train average accuracy bass      : 50.115002 %
Train average accuracy piano     : 50.870003 %
Train average accuracy guitar    : 50.045002 %
Train average accuracy residuals : 49.980000 %

== Train average loss all : 0.003553

Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]          Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.00437, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=1.040, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.00437, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=1.040, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]    Epoch 95:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0053, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=1.000, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0053, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=1.000, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]  Epoch 95:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00136, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00136, Train/loss_recog_step=1.070, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00136, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00136, Train/loss_recog_step=1.070, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]    Epoch 95: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.783, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.502, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.520, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184695, 0.188055, 0.190244, 0.198371
Valid average loss UNet                 (all)                : 0.761366

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101189, 3.460734, 6.169799
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.595920, 4.353846, 4.589892
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.539090, 4.125925, 4.499133
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.409881, 4.018239, 5.059783
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.451216, 4.832433, 5.405676
Valid average loss all      (Triplet)                 : 0.435676

== Recognize ==
Valid average loss Recognize     : 0.971251
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 58.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.435676

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.277941942214966 sec. =
Valid knn accuracy drums     : 81.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.00729513168335 sec. =
Valid knn accuracy bass      : 27.016129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.507477521896362 sec. =
Valid knn accuracy piano     : 38.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.695287466049194 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.298365354537964 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 53.97684681859165%

                                                                      [AEpoch 95: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00355, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00355, Train/loss_recog_epoch=1.020]Epoch 95: 100%|██████████| 313/313 [05:33<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190009, 0.190308, 0.189184, 0.194636
Train average loss UNet                 (all)                : 0.764138

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001240, 3.497366, 6.515472
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005224, 3.482786, 5.780569
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004960, 3.516974, 5.863448
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003406, 3.734859, 6.427007
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004927, 3.824137, 6.531383
Train average loss all      (Triplet)                 : 0.003908

== Recognize ==
Train average loss Recognize     : 1.022940
Train average accuracy drums     : 49.849998 %
Train average accuracy bass      : 49.889999 %
Train average accuracy piano     : 49.965000 %
Train average accuracy guitar    : 50.290001 %
Train average accuracy residuals : 49.235001 %

== Train average loss all : 0.003908

Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]          Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00107, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.030, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00107, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.030, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]    Epoch 96: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.935, Valid/loss_all_step=0.282, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.436, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186164, 0.189581, 0.191629, 0.205580
Valid average loss UNet                 (all)                : 0.772952

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.094083, 3.555805, 6.469256
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.750566, 4.687938, 4.809319
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.735494, 4.332813, 4.510262
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.276244, 4.250123, 5.316068
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.384730, 4.637478, 5.405320
Valid average loss all      (Triplet)                 : 0.486463

== Recognize ==
Valid average loss Recognize     : 1.026847
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 57.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.486463

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.717310428619385 sec. =
Valid knn accuracy drums     : 81.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.165017366409302 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.468580722808838 sec. =
Valid knn accuracy piano     : 36.9140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2516093254089355 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.644441843032837 sec. =
Valid knn accuracy residuals : 71.5909090909091%

Valid knn accuracy average   : 54.36938492126737%

                                                                      [AEpoch 96: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.935, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00391, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00391, Train/loss_recog_epoch=1.020]Epoch 96: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.935, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190183, 0.190503, 0.189357, 0.194971
Train average loss UNet                 (all)                : 0.765014

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001578, 3.502410, 6.713363
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002762, 3.413676, 5.689903
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004911, 3.506314, 5.789495
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004051, 3.693453, 6.360605
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006114, 3.781950, 6.456460
Train average loss all      (Triplet)                 : 0.003772

== Recognize ==
Train average loss Recognize     : 1.014351
Train average accuracy drums     : 49.990002 %
Train average accuracy bass      : 50.185001 %
Train average accuracy piano     : 50.139999 %
Train average accuracy guitar    : 50.029999 %
Train average accuracy residuals : 50.480003 %

== Train average loss all : 0.003772

Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.935, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]          Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.935, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00368, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.935, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.998, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]  Epoch 97:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.998, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]  Epoch 97:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.030, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00783, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.030, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.486, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184031, 0.187329, 0.189482, 0.183063
Valid average loss UNet                 (all)                : 0.743905

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069049, 3.427042, 6.308235
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.769571, 4.571878, 4.643180
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.589088, 4.014775, 4.610526
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.212680, 3.989376, 5.379805
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.320555, 4.297956, 5.256222
Valid average loss all      (Triplet)                 : 0.432823

== Recognize ==
Valid average loss Recognize     : 1.072999
Valid average accuracy drums     : 41.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.432823

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.265580654144287 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.585596323013306 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.273079633712769 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.1291539669036865 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6214375495910645 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 55.38665748916232%

                                                                      [AEpoch 97: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00377, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.010]Epoch 97: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190407, 0.190696, 0.189549, 0.194593
Train average loss UNet                 (all)                : 0.765244

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001025, 3.441477, 6.471223
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003608, 3.369729, 5.660423
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005295, 3.548502, 5.893001
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006021, 3.703923, 6.331212
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002962, 3.755614, 6.442517
Train average loss all      (Triplet)                 : 0.003714

== Recognize ==
Train average loss Recognize     : 1.017082
Train average accuracy drums     : 49.529999 %
Train average accuracy bass      : 50.220001 %
Train average accuracy piano     : 50.005001 %
Train average accuracy guitar    : 50.320000 %
Train average accuracy residuals : 50.265003 %

== Train average loss all : 0.003714

Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]          Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00156, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00156, Train/loss_recog_step=1.080, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  96%|█████████▌| 300/313 [04:13<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00156, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00156, Train/loss_recog_step=1.080, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98:  96%|█████████▌| 300/313 [04:13<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=1.020, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=1.020, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.455, Valid/loss_unet_all_step=0.713, Valid/loss_triplet_all_step=0.455, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.744, Valid/loss_triplet_all_epoch=0.433, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185466, 0.188881, 0.190875, 0.196349
Valid average loss UNet                 (all)                : 0.761571

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104075, 3.444983, 5.983998
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.706022, 4.688296, 4.893745
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.556559, 3.961179, 4.573039
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.271310, 3.998317, 5.258790
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.521785, 4.554126, 5.043106
Valid average loss all      (Triplet)                 : 0.457164

== Recognize ==
Valid average loss Recognize     : 1.052666
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.457164

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.832935094833374 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.554567575454712 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.815755367279053 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.278521299362183 sec. =
Valid knn accuracy guitar    : 53.34821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.303142786026001 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 54.81685015983315%

                                                                      [AEpoch 98: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00371, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.020]Epoch 98: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190054, 0.190358, 0.189228, 0.194349
Train average loss UNet                 (all)                : 0.763990

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000099, 3.342354, 6.292030
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006128, 3.421021, 5.657501
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003467, 3.513941, 5.869665
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002513, 3.601771, 6.191053
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002283, 3.681020, 6.379644
Train average loss all      (Triplet)                 : 0.003014

== Recognize ==
Train average loss Recognize     : 1.013155
Train average accuracy drums     : 50.059998 %
Train average accuracy bass      : 49.564999 %
Train average accuracy piano     : 50.395000 %
Train average accuracy guitar    : 49.700001 %
Train average accuracy residuals : 49.700001 %

== Train average loss all : 0.003014

Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]          Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.010, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.010, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]  Epoch 99:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.992, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.766, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185886, 0.189292, 0.191281, 0.200282
Valid average loss UNet                 (all)                : 0.766741

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.052391, 3.435446, 6.311218
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.623096, 4.712171, 4.869759
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.571501, 4.071548, 4.520063
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.375138, 4.153185, 5.296401
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.364839, 4.525325, 5.394505
Valid average loss all      (Triplet)                 : 0.426013

== Recognize ==
Valid average loss Recognize     : 1.109769
Valid average accuracy drums     : 41.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.426013

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.461706638336182 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.566057205200195 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.887414932250977 sec. =
Valid knn accuracy piano     : 35.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.326546907424927 sec. =
Valid knn accuracy guitar    : 57.58928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.388530969619751 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 53.827778211007086%

                                                                      [AEpoch 99: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.992, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.010]Epoch 99: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.992, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190149, 0.190457, 0.189340, 0.194659
Train average loss UNet                 (all)                : 0.764605

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000427, 3.397062, 6.392579
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003752, 3.492869, 5.887224
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004164, 3.534567, 5.917802
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003124, 3.629337, 6.281211
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002282, 3.665164, 6.363544
Train average loss all      (Triplet)                 : 0.002789

== Recognize ==
Train average loss Recognize     : 1.020408
Train average accuracy drums     : 49.985001 %
Train average accuracy bass      : 49.685001 %
Train average accuracy piano     : 49.639999 %
Train average accuracy guitar    : 49.919998 %
Train average accuracy residuals : 50.220001 %

== Train average loss all : 0.002789

Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.992, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]          Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.992, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.992, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=1.040, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=1.040, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]    Epoch 100:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.010, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.010, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]  Epoch 100:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.00521, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.965, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00521, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=0.965, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=1.010, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00667, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=1.010, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.346, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.426, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.538, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184996, 0.188347, 0.190458, 0.202888
Valid average loss UNet                 (all)                : 0.766690

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113100, 3.540220, 6.363682
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.645254, 4.669833, 4.815013
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.520042, 4.087752, 4.489587
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.344882, 4.233112, 5.646478
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314468, 4.586234, 5.541605
Valid average loss all      (Triplet)                 : 0.410181

== Recognize ==
Valid average loss Recognize     : 1.036332
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.410181

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.56184458732605 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.242628574371338 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.707741975784302 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6751933097839355 sec. =
Valid knn accuracy guitar    : 59.82142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.48105001449585 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 56.73248267335749%

                                                                      [AEpoch 100: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.020]Epoch 100: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190380, 0.190660, 0.189528, 0.194816
Train average loss UNet                 (all)                : 0.765384

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000789, 3.488607, 6.569558
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002970, 3.491277, 5.872388
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004497, 3.621559, 6.049793
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003518, 3.827232, 6.597492
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002724, 3.776032, 6.559042
Train average loss all      (Triplet)                 : 0.002931

== Recognize ==
Train average loss Recognize     : 1.022027
Train average accuracy drums     : 50.064999 %
Train average accuracy bass      : 49.700001 %
Train average accuracy piano     : 49.889999 %
Train average accuracy guitar    : 50.160004 %
Train average accuracy residuals : 50.290001 %

== Train average loss all : 0.002931

Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]          Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.815, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=1.100, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=1.100, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]    Epoch 101:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.0028, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=1.020, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0028, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=1.020, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]  Epoch 101:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00926, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00926, Train/loss_recog_step=1.020, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00926, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00926, Train/loss_recog_step=1.020, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.060, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00506, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00506, Train/loss_recog_step=1.060, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.269, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.410, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.67it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185761, 0.189114, 0.191415, 0.203017
Valid average loss UNet                 (all)                : 0.769307

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.139408, 3.723346, 6.600199
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.913282, 4.914459, 4.820090
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.676389, 4.056752, 4.460102
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.324570, 4.143212, 5.592052
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.458957, 5.114943, 5.772531
Valid average loss all      (Triplet)                 : 0.554074

== Recognize ==
Valid average loss Recognize     : 1.004754
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.554074

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3127851486206055 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.472620964050293 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.382224321365356 sec. =
Valid knn accuracy piano     : 43.1640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.724765777587891 sec. =
Valid knn accuracy guitar    : 56.02678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.138856410980225 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 56.31442235227955%

                                                                      [AEpoch 101: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00293, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.020]Epoch 101: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190151, 0.190453, 0.189328, 0.194376
Train average loss UNet                 (all)                : 0.764308

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000719, 3.558805, 6.793968
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005375, 3.591110, 5.988244
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006375, 3.727168, 6.165242
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002848, 3.865196, 6.707119
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003536, 3.941943, 6.764894
Train average loss all      (Triplet)                 : 0.003723

== Recognize ==
Train average loss Recognize     : 1.032369
Train average accuracy drums     : 49.980000 %
Train average accuracy bass      : 50.120003 %
Train average accuracy piano     : 49.474998 %
Train average accuracy guitar    : 50.340004 %
Train average accuracy residuals : 49.895000 %

== Train average loss all : 0.003723

Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]          Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.0014, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0014, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.00535, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=1.120, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00535, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=1.120, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]    Epoch 102:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.040, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=0.622, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.563, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186135, 0.189505, 0.191459, 0.201658
Valid average loss UNet                 (all)                : 0.768756

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109992, 3.451953, 6.174643
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.679626, 4.716493, 4.963062
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.557256, 4.011954, 4.324224
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.303246, 4.092519, 5.404706
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334885, 4.617393, 5.597976
Valid average loss all      (Triplet)                 : 0.415552

== Recognize ==
Valid average loss Recognize     : 1.027803
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.415552

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.299437522888184 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.548232316970825 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.63706660270691 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.098727464675903 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.66141152381897 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 55.94179437760697%

                                                                      [AEpoch 102: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00372, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00372, Train/loss_recog_epoch=1.030]Epoch 102: 100%|██████████| 313/313 [05:35<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.191054, 0.191342, 0.190204, 0.193973
Train average loss UNet                 (all)                : 0.766572

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000930, 3.455713, 6.635632
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005128, 3.534453, 5.923204
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004032, 3.608166, 6.013511
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002451, 3.731992, 6.495909
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003458, 3.857266, 6.637765
Train average loss all      (Triplet)                 : 0.003367

== Recognize ==
Train average loss Recognize     : 1.028156
Train average accuracy drums     : 49.869999 %
Train average accuracy bass      : 50.419998 %
Train average accuracy piano     : 50.005001 %
Train average accuracy guitar    : 50.085003 %
Train average accuracy residuals : 49.474998 %

== Train average loss all : 0.003367

Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]          Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=1.080, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]  Epoch 103:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=1.080, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]  Epoch 103:  48%|████▊     | 150/313 [02:07<02:18,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  48%|████▊     | 150/313 [02:07<02:18,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  64%|██████▍   | 200/313 [02:48<01:35,  1.19it/s, v_num=0, Train/loss_all_step=0.00137, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.040, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.00137, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.040, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  80%|███████▉  | 250/313 [03:28<00:52,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]    Epoch 103:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103:  96%|█████████▌| 300/313 [04:09<00:10,  1.20it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=1.070, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103: 100%|██████████| 313/313 [04:17<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=1.070, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103: 100%|██████████| 313/313 [04:17<00:00,  1.22it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.970, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186550, 0.189963, 0.192029, 0.191065
Valid average loss UNet                 (all)                : 0.759607

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114270, 3.643456, 6.486787
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.824373, 4.858355, 4.896077
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.833216, 4.270057, 4.533262
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310512, 4.231440, 5.634480
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.440905, 4.858794, 5.698507
Valid average loss all      (Triplet)                 : 0.535776

== Recognize ==
Valid average loss Recognize     : 1.042821
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 58.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.535776

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.296427965164185 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.04500150680542 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.597917556762695 sec. =
Valid knn accuracy piano     : 37.109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7010157108306885 sec. =
Valid knn accuracy guitar    : 61.16071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7438342571258545 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 55.82276706025391%

                                                                      [AEpoch 103: 100%|██████████| 313/313 [05:28<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00337, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00337, Train/loss_recog_epoch=1.030]Epoch 103: 100%|██████████| 313/313 [05:28<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190496, 0.190791, 0.189653, 0.194546
Train average loss UNet                 (all)                : 0.765486

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000854, 3.513299, 6.754530
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003957, 3.589287, 6.012038
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007416, 3.651567, 6.073809
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001734, 3.817249, 6.613858
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003872, 3.923917, 6.693675
Train average loss all      (Triplet)                 : 0.003654

== Recognize ==
Train average loss Recognize     : 1.029264
Train average accuracy drums     : 49.794998 %
Train average accuracy bass      : 49.884998 %
Train average accuracy piano     : 50.274998 %
Train average accuracy guitar    : 50.720001 %
Train average accuracy residuals : 49.759998 %

== Train average loss all : 0.003654

Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]          Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.984, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.019, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=0.984, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000211, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000211, Train/loss_recog_step=0.944, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104: 100%|██████████| 313/313 [04:24<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000211, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000211, Train/loss_recog_step=0.944, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104: 100%|██████████| 313/313 [04:24<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.759, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.536, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.72it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.66it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185738, 0.189065, 0.191434, 0.205461
Valid average loss UNet                 (all)                : 0.771697

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115545, 3.533267, 6.120760
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.783400, 4.669525, 4.731653
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.708712, 4.096822, 4.418779
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.262609, 4.178105, 5.604250
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.378597, 4.760683, 5.712318
Valid average loss all      (Triplet)                 : 0.472468

== Recognize ==
Valid average loss Recognize     : 1.004951
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.472468

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.664316892623901 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.301520347595215 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.981138229370117 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.605243921279907 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.216270685195923 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 54.21373927615162%

                                                                      [AEpoch 104: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00365, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00365, Train/loss_recog_epoch=1.030]Epoch 104: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190318, 0.190621, 0.189483, 0.194774
Train average loss UNet                 (all)                : 0.765197

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000875, 3.499631, 6.493050
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004539, 3.540665, 5.909461
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004704, 3.587359, 6.015133
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003943, 3.830484, 6.578227
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003175, 3.926171, 6.782500
Train average loss all      (Triplet)                 : 0.003467

== Recognize ==
Train average loss Recognize     : 1.023853
Train average accuracy drums     : 49.994999 %
Train average accuracy bass      : 50.435001 %
Train average accuracy piano     : 50.134998 %
Train average accuracy guitar    : 50.209999 %
Train average accuracy residuals : 50.445004 %

== Train average loss all : 0.003467

Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]          Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  80%|███████▉  | 250/313 [03:30<00:53,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105:  96%|█████████▌| 300/313 [04:11<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105: 100%|██████████| 313/313 [04:19<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.364, Valid/loss_unet_all_step=0.790, Valid/loss_triplet_all_step=0.364, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184379, 0.187670, 0.189866, 0.200709
Valid average loss UNet                 (all)                : 0.762624

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.136876, 3.788601, 6.624250
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.803660, 4.791411, 4.926954
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.786057, 4.367169, 4.470722
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.496859, 4.479979, 5.797239
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.520880, 5.207703, 5.786669
Valid average loss all      (Triplet)                 : 0.581777

== Recognize ==
Valid average loss Recognize     : 1.022478
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.581777

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.671117305755615 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.267412900924683 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.575333595275879 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.893433094024658 sec. =
Valid knn accuracy guitar    : 54.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3929443359375 sec. =
Valid knn accuracy residuals : 70.68181818181817%

Valid knn accuracy average   : 56.4469680367844%

                                                                      [AEpoch 105: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=1.020]Epoch 105: 100%|██████████| 313/313 [05:32<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190585, 0.190889, 0.189745, 0.194432
Train average loss UNet                 (all)                : 0.765651

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000900, 3.506680, 6.647358
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004200, 3.510516, 5.837377
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003339, 3.572006, 6.020493
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004205, 3.845262, 6.654182
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002739, 3.862960, 6.621354
Train average loss all      (Triplet)                 : 0.003187

== Recognize ==
Train average loss Recognize     : 1.028605
Train average accuracy drums     : 50.120003 %
Train average accuracy bass      : 50.384998 %
Train average accuracy piano     : 49.634998 %
Train average accuracy guitar    : 49.750000 %
Train average accuracy residuals : 49.994999 %

== Train average loss all : 0.003187

Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]          Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=1.160, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=1.160, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00884, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00884, Train/loss_recog_step=0.993, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00884, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00884, Train/loss_recog_step=0.993, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00241, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=1.030, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00241, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=1.030, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]    Epoch 106:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.855, Valid/loss_all_epoch=0.582, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184476, 0.187806, 0.189937, 0.204680
Valid average loss UNet                 (all)                : 0.766899

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152629, 3.693976, 6.577569
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.807570, 4.754149, 4.842587
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.640732, 4.171411, 4.441377
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.390373, 4.495005, 5.935325
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.445519, 4.606814, 5.591414
Valid average loss all      (Triplet)                 : 0.520462

== Recognize ==
Valid average loss Recognize     : 1.042796
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.520462

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9195473194122314 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.927919149398804 sec. =
Valid knn accuracy bass      : 33.46774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.66544508934021 sec. =
Valid knn accuracy piano     : 40.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.372889995574951 sec. =
Valid knn accuracy guitar    : 59.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.653310537338257 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 57.69645105508096%

                                                                      [AEpoch 106: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.00319, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00319, Train/loss_recog_epoch=1.030]Epoch 106: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189987, 0.190274, 0.189145, 0.194822
Train average loss UNet                 (all)                : 0.764229

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001208, 3.596256, 6.810503
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002747, 3.582653, 5.985882
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003285, 3.625700, 6.059143
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003742, 3.872858, 6.732436
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004814, 3.914621, 6.678824
Train average loss all      (Triplet)                 : 0.003104

== Recognize ==
Train average loss Recognize     : 1.034842
Train average accuracy drums     : 50.215000 %
Train average accuracy bass      : 49.939999 %
Train average accuracy piano     : 49.779999 %
Train average accuracy guitar    : 49.985001 %
Train average accuracy residuals : 49.645000 %

== Train average loss all : 0.003104

Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]          Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.000338, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.966, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000338, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.966, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]      Epoch 107:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0463, Train/loss_recog_step=1.070, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.784, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.577, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186580, 0.190018, 0.192101, 0.201077
Valid average loss UNet                 (all)                : 0.769777

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142528, 3.732279, 6.694332
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.708887, 4.796821, 4.891727
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.660358, 4.366332, 4.621244
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.316778, 4.339355, 5.817812
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.410452, 4.811443, 5.855396
Valid average loss all      (Triplet)                 : 0.467060

== Recognize ==
Valid average loss Recognize     : 1.050870
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.467060

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.986780881881714 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.636413097381592 sec. =
Valid knn accuracy bass      : 27.82258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.478922605514526 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.466176986694336 sec. =
Valid knn accuracy guitar    : 54.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.262798309326172 sec. =
Valid knn accuracy residuals : 74.54545454545455%

Valid knn accuracy average   : 56.93997932073187%

                                                                      [AEpoch 107: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0463, Train/loss_recog_step=1.070, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.030]Epoch 107: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0463, Train/loss_recog_step=1.070, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190570, 0.190869, 0.189714, 0.194609
Train average loss UNet                 (all)                : 0.765761

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001804, 3.568696, 6.825448
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005033, 3.532447, 5.858046
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004143, 3.560879, 5.951631
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004643, 3.807738, 6.629349
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004799, 3.873526, 6.605972
Train average loss all      (Triplet)                 : 0.004180

== Recognize ==
Train average loss Recognize     : 1.033133
Train average accuracy drums     : 50.010002 %
Train average accuracy bass      : 50.484997 %
Train average accuracy piano     : 49.270000 %
Train average accuracy guitar    : 49.990002 %
Train average accuracy residuals : 50.015003 %

== Train average loss all : 0.004180

Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0463, Train/loss_recog_step=1.070, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]          Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0463, Train/loss_recog_step=1.070, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.0463, Train/loss_recog_step=1.070, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.943, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.943, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.040, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.00538, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.040, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]    Epoch 108:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.000624, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000624, Train/loss_recog_step=1.100, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000624, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000624, Train/loss_recog_step=1.100, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00266, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=1.010, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]  Epoch 108: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.00266, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=1.010, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.340, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.467, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.569, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185460, 0.188821, 0.190990, 0.197495
Valid average loss UNet                 (all)                : 0.762765

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.135217, 3.782957, 6.567180
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.901207, 5.115951, 5.268201
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.643567, 4.362209, 4.818176
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.416529, 4.387923, 5.699392
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.499491, 4.983789, 5.917173
Valid average loss all      (Triplet)                 : 0.561981

== Recognize ==
Valid average loss Recognize     : 1.093274
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 42.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.561981

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.567001581192017 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.585808515548706 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.19571828842163 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.233608722686768 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.953054428100586 sec. =
Valid knn accuracy residuals : 73.4090909090909%

Valid knn accuracy average   : 56.58097885853628%

                                                                      [AEpoch 108: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00418, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00418, Train/loss_recog_epoch=1.030]Epoch 108: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190594, 0.190886, 0.189757, 0.194513
Train average loss UNet                 (all)                : 0.765750

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000868, 3.621753, 6.854438
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004992, 3.648086, 6.035227
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003301, 3.640326, 6.089921
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003999, 3.889134, 6.752138
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003853, 3.976865, 6.790891
Train average loss all      (Triplet)                 : 0.003389

== Recognize ==
Train average loss Recognize     : 1.034000
Train average accuracy drums     : 50.180000 %
Train average accuracy bass      : 50.045002 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 50.314999 %
Train average accuracy residuals : 49.540001 %

== Train average loss all : 0.003389

Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]          Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  32%|███▏      | 100/313 [01:35<03:23,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  32%|███▏      | 100/313 [01:35<03:23,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=1.130, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=1.130, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00125, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=1.020, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00125, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=1.020, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000703, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000703, Train/loss_recog_step=1.080, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000703, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000703, Train/loss_recog_step=1.080, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.501, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.501, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185869, 0.189241, 0.191550, 0.203564
Valid average loss UNet                 (all)                : 0.770223

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.167193, 3.559504, 6.156398
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.861765, 4.780816, 4.800972
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.671853, 4.141841, 4.446538
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274827, 4.107590, 5.342375
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.513031, 4.799593, 5.977755
Valid average loss all      (Triplet)                 : 0.541156

== Recognize ==
Valid average loss Recognize     : 1.030808
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.541156

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.497941017150879 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.453883171081543 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.060834646224976 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.849250793457031 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.736592054367065 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 56.052867320267396%

                                                                      [AEpoch 109: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.030]Epoch 109: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190403, 0.190680, 0.189558, 0.194023
Train average loss UNet                 (all)                : 0.764665

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000732, 3.623835, 6.871570
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005524, 3.638139, 6.067029
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004436, 3.660427, 6.158579
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002239, 3.867805, 6.774578
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001521, 3.983622, 6.892333
Train average loss all      (Triplet)                 : 0.002938

== Recognize ==
Train average loss Recognize     : 1.041097
Train average accuracy drums     : 49.785000 %
Train average accuracy bass      : 50.115002 %
Train average accuracy piano     : 49.794998 %
Train average accuracy guitar    : 49.625000 %
Train average accuracy residuals : 49.529999 %

== Train average loss all : 0.002938

Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]          Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.998, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.998, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]  Epoch 110:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.00168, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=1.050, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.00168, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=1.050, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]    Epoch 110:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00681, Train/loss_recog_step=0.997, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.00681, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00681, Train/loss_recog_step=0.997, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.170, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]  Epoch 110: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.170, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=0.996, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.561, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.83it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185617, 0.188949, 0.191213, 0.195100
Valid average loss UNet                 (all)                : 0.760880

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106248, 3.551584, 6.269461
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.826096, 4.842740, 4.954196
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.704836, 4.362331, 4.531848
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.355228, 4.243386, 5.405579
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.419896, 4.778471, 5.839995
Valid average loss all      (Triplet)                 : 0.523885

== Recognize ==
Valid average loss Recognize     : 1.151617
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.523885

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.844088077545166 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.148841142654419 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.496787309646606 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.847604274749756 sec. =
Valid knn accuracy guitar    : 61.16071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.479744911193848 sec. =
Valid knn accuracy residuals : 72.5%

Valid knn accuracy average   : 56.20256931226207%

                                                                      [AEpoch 110: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00294, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00294, Train/loss_recog_epoch=1.040]Epoch 110: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190208, 0.190494, 0.189358, 0.194686
Train average loss UNet                 (all)                : 0.764746

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000570, 3.482193, 6.574542
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005533, 3.577822, 5.954050
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003615, 3.544516, 5.947814
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001883, 3.691495, 6.449489
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002711, 3.886390, 6.666737
Train average loss all      (Triplet)                 : 0.003014

== Recognize ==
Train average loss Recognize     : 1.040540
Train average accuracy drums     : 49.799999 %
Train average accuracy bass      : 49.825001 %
Train average accuracy piano     : 49.665001 %
Train average accuracy guitar    : 50.050003 %
Train average accuracy residuals : 50.290001 %

== Train average loss all : 0.003014

Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]          Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.000717, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000717, Train/loss_recog_step=1.010, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.000717, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000717, Train/loss_recog_step=1.010, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.060, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]    Epoch 111:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.060, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.997, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.997, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]    Epoch 111:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=1.110, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=1.110, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]    Epoch 111: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.519, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.562, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184936, 0.188375, 0.190304, 0.209110
Valid average loss UNet                 (all)                : 0.772726

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087916, 3.520501, 6.259691
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.770112, 4.853008, 4.989598
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.510986, 4.352193, 4.753224
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.362290, 4.267908, 5.508077
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.451519, 4.669261, 5.705938
Valid average loss all      (Triplet)                 : 0.469832

== Recognize ==
Valid average loss Recognize     : 1.007262
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.469832

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.398585557937622 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.227715969085693 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.241884469985962 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.318746566772461 sec. =
Valid knn accuracy guitar    : 60.04464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.337727069854736 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 57.13077687564889%

                                                                      [AEpoch 111: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.040]Epoch 111: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190325, 0.190617, 0.189491, 0.194456
Train average loss UNet                 (all)                : 0.764889

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000645, 3.527092, 6.691916
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003678, 3.600291, 6.105012
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002413, 3.587459, 6.044303
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004499, 3.699340, 6.473948
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001834, 3.863093, 6.641680
Train average loss all      (Triplet)                 : 0.002636

== Recognize ==
Train average loss Recognize     : 1.042631
Train average accuracy drums     : 49.985001 %
Train average accuracy bass      : 50.370003 %
Train average accuracy piano     : 49.639999 %
Train average accuracy guitar    : 49.695000 %
Train average accuracy residuals : 50.760002 %

== Train average loss all : 0.002636

Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]          Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000366, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000366, Train/loss_recog_step=1.070, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000366, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000366, Train/loss_recog_step=1.070, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.998, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]  Epoch 112:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.998, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]    Epoch 112:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.040, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.040, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00766, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=1.110, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00766, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=1.110, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=1.070, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]  Epoch 112: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0186, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=1.070, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.403, Valid/loss_recog_step=0.904, Valid/loss_all_epoch=0.470, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.571, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.187079, 0.190422, 0.192916, 0.204914
Valid average loss UNet                 (all)                : 0.775330

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098902, 3.942292, 7.045265
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.797329, 5.394295, 5.611938
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.619442, 4.556616, 5.044463
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.318707, 4.769259, 6.104236
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.537371, 4.956153, 6.169904
Valid average loss all      (Triplet)                 : 0.490607

== Recognize ==
Valid average loss Recognize     : 0.979912
Valid average accuracy drums     : 58.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.490607

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.780164957046509 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.596367120742798 sec. =
Valid knn accuracy bass      : 31.85483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.534143686294556 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.65834903717041 sec. =
Valid knn accuracy guitar    : 58.70535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.00797986984253 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 56.67250112702865%

                                                                      [AEpoch 112: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.040]Epoch 112: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190235, 0.190529, 0.189409, 0.194546
Train average loss UNet                 (all)                : 0.764719

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001441, 3.712408, 6.866070
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004873, 3.798699, 6.423611
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002599, 3.843526, 6.439761
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003037, 3.914438, 6.793200
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001261, 4.056502, 6.964855
Train average loss all      (Triplet)                 : 0.002631

== Recognize ==
Train average loss Recognize     : 1.049816
Train average accuracy drums     : 49.559998 %
Train average accuracy bass      : 50.050003 %
Train average accuracy piano     : 49.744999 %
Train average accuracy guitar    : 50.505001 %
Train average accuracy residuals : 50.950005 %

== Train average loss all : 0.002631

Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]          Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.070, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.130, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.0136, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.130, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]  Epoch 113:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.020, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.020, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=1.090, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=1.090, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0004, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0004, Train/loss_recog_step=1.110, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]  Epoch 113:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0004, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0004, Train/loss_recog_step=1.110, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]  Epoch 113: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=1.100, Valid/loss_all_step=0.308, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.308, Valid/loss_recog_step=0.744, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.567, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.62it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.54it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185595, 0.188988, 0.191183, 0.193283
Valid average loss UNet                 (all)                : 0.759050

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130030, 3.773570, 6.810538
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.055261, 5.413032, 5.370602
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.612033, 4.513169, 5.009826
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.410073, 4.608937, 5.658207
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.565289, 5.206501, 6.000853
Valid average loss all      (Triplet)                 : 0.627631

== Recognize ==
Valid average loss Recognize     : 1.125193
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.627631

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.746100664138794 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.02118182182312 sec. =
Valid knn accuracy bass      : 36.895161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.660104990005493 sec. =
Valid knn accuracy piano     : 35.546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.867599248886108 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.486162424087524 sec. =
Valid knn accuracy residuals : 70.22727272727273%

Valid knn accuracy average   : 55.67710714513397%

                                                                      [AEpoch 113: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=1.100, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00263, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00263, Train/loss_recog_epoch=1.050]Epoch 113: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=1.100, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190619, 0.190914, 0.189777, 0.194435
Train average loss UNet                 (all)                : 0.765745

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001351, 3.877895, 7.352962
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004384, 3.895877, 6.493328
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002247, 3.901402, 6.522506
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001958, 4.024410, 7.015598
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003154, 4.170135, 7.154007
Train average loss all      (Triplet)                 : 0.002648

== Recognize ==
Train average loss Recognize     : 1.053081
Train average accuracy drums     : 50.150002 %
Train average accuracy bass      : 50.419998 %
Train average accuracy piano     : 50.325001 %
Train average accuracy guitar    : 49.695000 %
Train average accuracy residuals : 50.475002 %

== Train average loss all : 0.002648

Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=1.100, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]          Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=1.100, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.00358, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=1.100, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]    Epoch 114:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=1.100, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=1.100, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.000, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.000, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.0367, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=1.150, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0367, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=1.150, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]  Epoch 114:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.783, Valid/loss_unet_all_step=0.750, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.10it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185188, 0.188552, 0.190747, 0.201903
Valid average loss UNet                 (all)                : 0.766390

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117363, 3.779088, 6.849665
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.904519, 5.107833, 5.169699
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.474484, 4.386430, 5.216060
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329234, 4.463753, 5.880955
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.366735, 4.748192, 5.605886
Valid average loss all      (Triplet)                 : 0.504372

== Recognize ==
Valid average loss Recognize     : 1.059416
Valid average accuracy drums     : 43.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.504372

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.688601732254028 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.869645357131958 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.66386079788208 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.303711175918579 sec. =
Valid knn accuracy guitar    : 56.47321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.77188515663147 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 53.957806864856735%

                                                                      [AEpoch 114: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=1.050]Epoch 114: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190580, 0.190851, 0.189713, 0.194701
Train average loss UNet                 (all)                : 0.765845

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000249, 3.847707, 7.366072
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004882, 3.849044, 6.430821
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005242, 3.925445, 6.514063
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003490, 4.026696, 6.984242
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004752, 4.233784, 7.279233
Train average loss all      (Triplet)                 : 0.003875

== Recognize ==
Train average loss Recognize     : 1.058001
Train average accuracy drums     : 49.599998 %
Train average accuracy bass      : 49.884998 %
Train average accuracy piano     : 50.070000 %
Train average accuracy guitar    : 50.599998 %
Train average accuracy residuals : 49.805000 %

== Train average loss all : 0.003875

Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]          Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00188, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=1.030, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.00188, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=1.030, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]    Epoch 115: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.574, Valid/loss_unet_all_step=0.787, Valid/loss_triplet_all_step=0.574, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186201, 0.189604, 0.191834, 0.197540
Valid average loss UNet                 (all)                : 0.765179

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143175, 3.685637, 6.448015
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.840573, 5.348075, 5.371532
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.654939, 4.462735, 4.881119
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334628, 4.574029, 5.964731
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.488197, 4.967400, 6.188382
Valid average loss all      (Triplet)                 : 0.519526

== Recognize ==
Valid average loss Recognize     : 1.088525
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 57.000000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.519526

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.04173731803894 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.782946825027466 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.549512386322021 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.250574588775635 sec. =
Valid knn accuracy guitar    : 62.27678571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.932723522186279 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 56.57379775072403%

                                                                      [AEpoch 115: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00388, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00388, Train/loss_recog_epoch=1.060]Epoch 115: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189878, 0.190171, 0.189064, 0.194658
Train average loss UNet                 (all)                : 0.763771

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000518, 3.730124, 7.110356
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002538, 3.780471, 6.341436
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005594, 3.913810, 6.469176
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005509, 3.992645, 6.914643
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003217, 4.114354, 7.070155
Train average loss all      (Triplet)                 : 0.003488

== Recognize ==
Train average loss Recognize     : 1.055928
Train average accuracy drums     : 49.424999 %
Train average accuracy bass      : 50.475002 %
Train average accuracy piano     : 49.985001 %
Train average accuracy guitar    : 50.080002 %
Train average accuracy residuals : 50.500000 %

== Train average loss all : 0.003488

Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]          Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00236, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=1.070, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00236, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=1.070, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00418, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=1.040, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00418, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=1.040, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]    Epoch 116:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00757, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00757, Train/loss_recog_step=1.040, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00757, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00757, Train/loss_recog_step=1.040, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]    Epoch 116:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00808, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=1.020, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00808, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=1.020, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.324, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.520, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.566, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184940, 0.188311, 0.190756, 0.203961
Valid average loss UNet                 (all)                : 0.767968

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165788, 3.977162, 6.851397
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.991451, 5.297497, 5.226672
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.666000, 4.663210, 5.126029
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.357651, 4.446570, 6.116132
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.586811, 5.107794, 6.127967
Valid average loss all      (Triplet)                 : 0.612829

== Recognize ==
Valid average loss Recognize     : 1.069348
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.612829

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.83286452293396 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.579522132873535 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.091703176498413 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.557820558547974 sec. =
Valid knn accuracy guitar    : 57.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.411193609237671 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 56.51810503223984%

                                                                      [AEpoch 116: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00349, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00349, Train/loss_recog_epoch=1.060]Epoch 116: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190109, 0.190403, 0.189300, 0.194456
Train average loss UNet                 (all)                : 0.764268

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001300, 3.694287, 7.034915
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005818, 3.751431, 6.228368
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003815, 3.868979, 6.494489
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003258, 3.997072, 6.913644
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002380, 4.095434, 7.032088
Train average loss all      (Triplet)                 : 0.003332

== Recognize ==
Train average loss Recognize     : 1.059827
Train average accuracy drums     : 49.439999 %
Train average accuracy bass      : 49.674999 %
Train average accuracy piano     : 50.024998 %
Train average accuracy guitar    : 49.559998 %
Train average accuracy residuals : 50.344997 %

== Train average loss all : 0.003332

Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]          Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.00034, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00034, Train/loss_recog_step=1.090, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00034, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00034, Train/loss_recog_step=1.090, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=1.120, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00445, Train/loss_recog_step=1.120, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]    Epoch 117:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.010, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.010, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]    Epoch 117:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.700, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185397, 0.188783, 0.191020, 0.197474
Valid average loss UNet                 (all)                : 0.762675

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102139, 3.947401, 7.397875
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.925238, 5.217174, 5.148529
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.707714, 4.531412, 4.843776
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.286039, 4.508943, 6.235067
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.529157, 4.768016, 5.874950
Valid average loss all      (Triplet)                 : 0.577878

== Recognize ==
Valid average loss Recognize     : 1.117541
Valid average accuracy drums     : 39.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 43.500000 %
Valid average accuracy residuals : 57.500000 %

== Valid average loss all : 0.577878

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.449479341506958 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.61214017868042 sec. =
Valid knn accuracy bass      : 21.572580645161292%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.707729816436768 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.356441020965576 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.127032518386841 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 53.565579264266596%

                                                                      [AEpoch 117: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00333, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00333, Train/loss_recog_epoch=1.060]Epoch 117: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189876, 0.190170, 0.189053, 0.194058
Train average loss UNet                 (all)                : 0.763156

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000532, 3.831630, 7.387888
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003409, 3.830693, 6.422431
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004581, 3.948279, 6.598985
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003563, 4.063491, 7.051820
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001863, 4.145648, 7.176591
Train average loss all      (Triplet)                 : 0.002790

== Recognize ==
Train average loss Recognize     : 1.064794
Train average accuracy drums     : 49.230000 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 49.485001 %
Train average accuracy guitar    : 49.945000 %
Train average accuracy residuals : 49.535000 %

== Train average loss all : 0.002790

Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]          Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=1.000, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=1.000, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00586, Train/loss_recog_step=1.050, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00586, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00586, Train/loss_recog_step=1.050, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]    Epoch 118:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.699, Valid/loss_unet_all_step=0.764, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.66it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184938, 0.188397, 0.190532, 0.200676
Valid average loss UNet                 (all)                : 0.764543

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.170204, 3.904206, 6.691413
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.001890, 5.345908, 5.308570
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.645456, 4.625128, 4.949349
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.281898, 4.332347, 6.360922
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.407126, 4.941924, 6.117445
Valid average loss all      (Triplet)                 : 0.558658

== Recognize ==
Valid average loss Recognize     : 1.033642
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.558658

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.66684627532959 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.634566307067871 sec. =
Valid knn accuracy bass      : 25.806451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.605219841003418 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2260026931762695 sec. =
Valid knn accuracy guitar    : 54.91071428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.32514500617981 sec. =
Valid knn accuracy residuals : 61.13636363636363%

Valid knn accuracy average   : 52.783749385257096%

                                                                      [AEpoch 118: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00279, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00279, Train/loss_recog_epoch=1.060]Epoch 118: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189885, 0.190193, 0.189074, 0.194448
Train average loss UNet                 (all)                : 0.763600

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000664, 3.886023, 7.382219
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004340, 3.914468, 6.558011
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004762, 4.020971, 6.721399
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004486, 4.149974, 7.237502
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002712, 4.304701, 7.381536
Train average loss all      (Triplet)                 : 0.003455

== Recognize ==
Train average loss Recognize     : 1.060694
Train average accuracy drums     : 50.040001 %
Train average accuracy bass      : 50.110001 %
Train average accuracy piano     : 50.454998 %
Train average accuracy guitar    : 50.250000 %
Train average accuracy residuals : 50.040001 %

== Train average loss all : 0.003455

Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]          Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=1.140, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.00626, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=1.140, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]    Epoch 119:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=1.010, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00348, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=1.010, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]    Epoch 119:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=1.060, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=1.060, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]    Epoch 119: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.602, Valid/loss_unet_all_step=0.780, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185173, 0.188540, 0.190914, 0.205214
Valid average loss UNet                 (all)                : 0.769841

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085623, 3.965646, 6.983540
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.713545, 5.109352, 5.471233
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.686376, 4.634809, 4.815681
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.374039, 4.478464, 6.244881
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.514752, 4.941801, 6.487718
Valid average loss all      (Triplet)                 : 0.490498

== Recognize ==
Valid average loss Recognize     : 1.047720
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.490498

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.355133056640625 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.18250584602356 sec. =
Valid knn accuracy bass      : 34.274193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.666630268096924 sec. =
Valid knn accuracy piano     : 35.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.591961145401001 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.198832035064697 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 54.121637128649745%

                                                                      [AEpoch 119: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00346, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00346, Train/loss_recog_epoch=1.060]Epoch 119: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189685, 0.189986, 0.188860, 0.194371
Train average loss UNet                 (all)                : 0.762902

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000698, 3.764742, 7.068656
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002326, 3.841116, 6.565549
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005355, 3.877661, 6.468008
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002271, 4.000299, 7.029015
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001844, 4.216397, 7.301736
Train average loss all      (Triplet)                 : 0.002384

== Recognize ==
Train average loss Recognize     : 1.066411
Train average accuracy drums     : 50.139999 %
Train average accuracy bass      : 49.935001 %
Train average accuracy piano     : 49.869999 %
Train average accuracy guitar    : 50.134998 %
Train average accuracy residuals : 49.564999 %

== Train average loss all : 0.002384

Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]          Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.060, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.060, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]  Epoch 120:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.040, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.040, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.278, Valid/loss_recog_step=0.958, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184803, 0.188212, 0.190233, 0.184428
Valid average loss UNet                 (all)                : 0.747676

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077426, 3.871944, 6.902003
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.749051, 5.218163, 5.331312
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.650311, 4.506856, 4.838340
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.402167, 4.485180, 6.212987
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.463014, 4.897852, 6.131288
Valid average loss all      (Triplet)                 : 0.504642

== Recognize ==
Valid average loss Recognize     : 1.127088
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.504642

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.366886854171753 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.675690174102783 sec. =
Valid knn accuracy bass      : 33.87096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.528035879135132 sec. =
Valid knn accuracy piano     : 41.015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.787322521209717 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.216126918792725 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 56.36378805713921%

                                                                      [AEpoch 120: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.070]Epoch 120: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190004, 0.190310, 0.189179, 0.194605
Train average loss UNet                 (all)                : 0.764098

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000870, 3.881436, 7.519425
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003246, 3.867624, 6.593264
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002530, 3.932558, 6.592365
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003105, 4.096339, 7.177328
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003041, 4.277210, 7.372836
Train average loss all      (Triplet)                 : 0.002603

== Recognize ==
Train average loss Recognize     : 1.065137
Train average accuracy drums     : 50.120003 %
Train average accuracy bass      : 50.940002 %
Train average accuracy piano     : 50.379997 %
Train average accuracy guitar    : 49.924999 %
Train average accuracy residuals : 50.215000 %

== Train average loss all : 0.002603

Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]          Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=3.99e-5, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=3.99e-5, Train/loss_recog_step=1.030, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=3.99e-5, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=3.99e-5, Train/loss_recog_step=1.030, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=0.981, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=0.981, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]    Epoch 121:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00767, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00767, Train/loss_recog_step=0.939, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00767, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00767, Train/loss_recog_step=0.939, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]    Epoch 121: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.414, Valid/loss_unet_all_step=0.724, Valid/loss_triplet_all_step=0.414, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.505, Valid/loss_unet_all_epoch=0.748, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.564, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.71it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.83it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184537, 0.187888, 0.189820, 0.202987
Valid average loss UNet                 (all)                : 0.765232

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074331, 3.603026, 6.459796
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.849270, 4.872591, 4.876173
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.664387, 4.144252, 4.459981
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.382340, 4.170726, 5.696274
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.512724, 4.677979, 5.952733
Valid average loss all      (Triplet)                 : 0.540082

== Recognize ==
Valid average loss Recognize     : 1.062153
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.540082

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.660513401031494 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.800299167633057 sec. =
Valid knn accuracy bass      : 33.266129032258064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.52244520187378 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.933311223983765 sec. =
Valid knn accuracy guitar    : 59.59821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.430542707443237 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 57.38595537308064%

                                                                      [AEpoch 121: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.0026, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.070]Epoch 121: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190168, 0.190469, 0.189329, 0.195136
Train average loss UNet                 (all)                : 0.765102

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000545, 3.713438, 7.116667
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004565, 3.837409, 6.495571
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003855, 3.851203, 6.485663
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004298, 4.052508, 7.068374
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001766, 4.201955, 7.301887
Train average loss all      (Triplet)                 : 0.003005

== Recognize ==
Train average loss Recognize     : 1.073087
Train average accuracy drums     : 50.164997 %
Train average accuracy bass      : 49.505001 %
Train average accuracy piano     : 50.080002 %
Train average accuracy guitar    : 49.825001 %
Train average accuracy residuals : 50.215000 %

== Train average loss all : 0.003005

Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]          Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.00847, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00847, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00847, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00847, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]    Epoch 122:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00156, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00156, Train/loss_recog_step=1.100, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00156, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00156, Train/loss_recog_step=1.100, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]    Epoch 122:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=0.910, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.574, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186066, 0.189462, 0.191756, 0.200650
Valid average loss UNet                 (all)                : 0.767933

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076375, 3.990147, 7.157494
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.704204, 5.432314, 5.849455
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.561576, 4.344802, 4.996678
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.428834, 4.747568, 6.530156
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.521449, 5.348790, 6.625246
Valid average loss all      (Triplet)                 : 0.476579

== Recognize ==
Valid average loss Recognize     : 1.174510
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.476579

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.56056547164917 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.388804912567139 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.663443565368652 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.718619346618652 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.194548606872559 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 55.38697624474054%

                                                                      [AEpoch 122: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.003, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.003, Train/loss_recog_epoch=1.070]Epoch 122: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189332, 0.189617, 0.188523, 0.194804
Train average loss UNet                 (all)                : 0.762276

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000819, 3.769258, 7.333541
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003709, 3.824818, 6.403809
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002615, 3.844041, 6.437584
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002573, 4.040923, 7.169075
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002410, 4.249119, 7.332556
Train average loss all      (Triplet)                 : 0.002462

== Recognize ==
Train average loss Recognize     : 1.076503
Train average accuracy drums     : 49.759998 %
Train average accuracy bass      : 50.089996 %
Train average accuracy piano     : 49.994999 %
Train average accuracy guitar    : 50.190002 %
Train average accuracy residuals : 50.024998 %

== Train average loss all : 0.002462

Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]          Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=1.020, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.0031, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=1.020, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]  Epoch 123:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=1.090, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.734, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=1.090, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00715, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=1.110, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00715, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=1.110, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.230, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.477, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.554, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.20it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185601, 0.189007, 0.190992, 0.205245
Valid average loss UNet                 (all)                : 0.770845

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102405, 4.087236, 7.200291
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.748380, 5.254207, 5.632995
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.668482, 4.409220, 4.911310
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.367989, 4.871823, 6.340976
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.596613, 5.324937, 6.170678
Valid average loss all      (Triplet)                 : 0.519467

== Recognize ==
Valid average loss Recognize     : 1.027708
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 57.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.519467

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.424304008483887 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.986502170562744 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.52033519744873 sec. =
Valid knn accuracy piano     : 30.6640625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.399563550949097 sec. =
Valid knn accuracy guitar    : 47.098214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.305540323257446 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 52.36525020605271%

                                                                      [AEpoch 123: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.762, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.080]Epoch 123: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189765, 0.190060, 0.188948, 0.194435
Train average loss UNet                 (all)                : 0.763208

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000961, 4.006173, 7.607961
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005486, 4.141868, 6.916286
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002269, 4.058526, 6.871034
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002971, 4.323959, 7.659957
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002582, 4.511397, 7.776905
Train average loss all      (Triplet)                 : 0.002869

== Recognize ==
Train average loss Recognize     : 1.079329
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 50.059998 %
Train average accuracy piano     : 50.475002 %
Train average accuracy guitar    : 50.555004 %
Train average accuracy residuals : 50.075001 %

== Train average loss all : 0.002869

Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]          Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=1.100, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=1.100, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=1.140, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]  Epoch 124:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=1.140, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.010, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.010, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.993, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]  Epoch 124:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.993, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124: 100%|██████████| 313/313 [04:24<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124: 100%|██████████| 313/313 [04:24<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.367, Valid/loss_unet_all_step=0.795, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=0.884, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.519, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185979, 0.189440, 0.191168, 0.196649
Valid average loss UNet                 (all)                : 0.763237

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089228, 4.082986, 7.310797
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.042249, 5.628169, 5.524507
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.665801, 4.610480, 4.856373
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.422815, 4.828581, 6.340251
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.527780, 5.436378, 6.384583
Valid average loss all      (Triplet)                 : 0.623818

== Recognize ==
Valid average loss Recognize     : 1.091541
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.623818

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.620288610458374 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.191370487213135 sec. =
Valid knn accuracy bass      : 21.975806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.236155986785889 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.431351900100708 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2985405921936035 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 51.37283986175115%

                                                                      [AEpoch 124: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00287, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.080]Epoch 124: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189618, 0.189925, 0.188818, 0.194622
Train average loss UNet                 (all)                : 0.762984

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000537, 3.958253, 7.659301
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004270, 4.069588, 6.758852
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003251, 3.998029, 6.690113
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005063, 4.233954, 7.403299
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002044, 4.407169, 7.598399
Train average loss all      (Triplet)                 : 0.003092

== Recognize ==
Train average loss Recognize     : 1.083945
Train average accuracy drums     : 49.735001 %
Train average accuracy bass      : 50.190002 %
Train average accuracy piano     : 50.180000 %
Train average accuracy guitar    : 50.094997 %
Train average accuracy residuals : 50.239998 %

== Train average loss all : 0.003092

Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]          Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=1.110, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=1.110, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]  Epoch 125:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00199, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.090, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.00199, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.090, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]    Epoch 125:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.020, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00272, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.020, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=1.120, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.00676, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=1.120, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.784, Valid/loss_unet_all_step=0.778, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.514, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.16it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185087, 0.188518, 0.190365, 0.202632
Valid average loss UNet                 (all)                : 0.766602

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062875, 4.019609, 7.231719
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.760795, 5.412390, 5.663393
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.652558, 4.708158, 4.766120
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.316814, 4.709290, 6.414366
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.607654, 5.495740, 6.606364
Valid average loss all      (Triplet)                 : 0.503565

== Recognize ==
Valid average loss Recognize     : 1.113149
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.503565

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.454967975616455 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.622129917144775 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.851715564727783 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.685016393661499 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.675003290176392 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 52.752160992058435%

                                                                      [AEpoch 125: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.080]Epoch 125: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190071, 0.190380, 0.189266, 0.194988
Train average loss UNet                 (all)                : 0.764705

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001067, 4.042477, 7.804934
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004521, 4.229201, 7.067731
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004585, 4.147025, 6.938354
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003710, 4.390890, 7.599912
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002629, 4.540161, 7.782261
Train average loss all      (Triplet)                 : 0.003397

== Recognize ==
Train average loss Recognize     : 1.095899
Train average accuracy drums     : 49.540001 %
Train average accuracy bass      : 49.790001 %
Train average accuracy piano     : 50.085003 %
Train average accuracy guitar    : 50.260002 %
Train average accuracy residuals : 50.209999 %

== Train average loss all : 0.003397

Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]          Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00625, Train/loss_recog_step=1.020, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00625, Train/loss_recog_step=1.020, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=1.050, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]  Epoch 126:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.0173, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=1.050, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]  Epoch 126:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.140, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.140, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.249, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.504, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.504, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.528, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185397, 0.188732, 0.190910, 0.189966
Valid average loss UNet                 (all)                : 0.755006

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119899, 4.097888, 7.080130
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.037323, 5.978868, 6.018642
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.631911, 5.133538, 5.292181
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371075, 5.000993, 6.787602
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.386762, 5.401905, 7.003078
Valid average loss all      (Triplet)                 : 0.578299

== Recognize ==
Valid average loss Recognize     : 1.105025
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.578299

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.382867574691772 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.804234981536865 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.677689790725708 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.914885759353638 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.941673994064331 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 54.267968849611115%

                                                                      [AEpoch 126: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.0034, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0034, Train/loss_recog_epoch=1.100]Epoch 126: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190081, 0.190396, 0.189275, 0.194757
Train average loss UNet                 (all)                : 0.764509

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000658, 4.096899, 7.956711
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004203, 4.257993, 7.132518
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004684, 4.248727, 7.034227
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005465, 4.492758, 7.807595
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001367, 4.614897, 7.933100
Train average loss all      (Triplet)                 : 0.003139

== Recognize ==
Train average loss Recognize     : 1.090999
Train average accuracy drums     : 49.915001 %
Train average accuracy bass      : 49.645000 %
Train average accuracy piano     : 49.715000 %
Train average accuracy guitar    : 50.540001 %
Train average accuracy residuals : 50.204998 %

== Train average loss all : 0.003139

Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]          Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00975, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=1.110, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00975, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=1.110, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000472, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000472, Train/loss_recog_step=1.040, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000472, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000472, Train/loss_recog_step=1.040, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=1.050, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]    Epoch 127:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0243, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=1.050, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]  Epoch 127: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.740, Valid/loss_triplet_all_step=0.683, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.578, Valid/loss_unet_all_epoch=0.755, Valid/loss_triplet_all_epoch=0.578, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184788, 0.188198, 0.190192, 0.199211
Valid average loss UNet                 (all)                : 0.762389

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056647, 4.037675, 7.314829
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.926498, 5.634261, 5.615354
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.625091, 4.688972, 4.979836
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.327533, 4.663603, 6.455039
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.318549, 5.319800, 6.946017
Valid average loss all      (Triplet)                 : 0.507877

== Recognize ==
Valid average loss Recognize     : 1.066262
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.507877

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.979838848114014 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.048161506652832 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.929721355438232 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.998104810714722 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.225361824035645 sec. =
Valid knn accuracy residuals : 65.0%

Valid knn accuracy average   : 52.80078516329393%

                                                                      [AEpoch 127: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00314, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00314, Train/loss_recog_epoch=1.090]Epoch 127: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190127, 0.190409, 0.189277, 0.195019
Train average loss UNet                 (all)                : 0.764832

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000883, 3.981206, 7.754137
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003668, 4.153973, 6.927548
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004203, 4.168263, 6.911263
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005462, 4.415409, 7.623308
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003931, 4.441209, 7.597747
Train average loss all      (Triplet)                 : 0.003626

== Recognize ==
Train average loss Recognize     : 1.095557
Train average accuracy drums     : 50.230003 %
Train average accuracy bass      : 49.465000 %
Train average accuracy piano     : 49.334999 %
Train average accuracy guitar    : 49.380001 %
Train average accuracy residuals : 50.225002 %

== Train average loss all : 0.003626

Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]          Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000786, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000786, Train/loss_recog_step=1.060, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000786, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000786, Train/loss_recog_step=1.060, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.120, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]    Epoch 128:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.120, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]  Epoch 128:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00552, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00552, Train/loss_recog_step=1.160, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00552, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00552, Train/loss_recog_step=1.160, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.548, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.548, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.528, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186090, 0.189441, 0.191801, 0.206541
Valid average loss UNet                 (all)                : 0.773873

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063688, 4.008994, 7.116769
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.847337, 5.533258, 5.588711
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.708734, 4.808412, 5.032812
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.262064, 4.511236, 6.270721
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405779, 5.256979, 6.065784
Valid average loss all      (Triplet)                 : 0.515433

== Recognize ==
Valid average loss Recognize     : 1.161079
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 41.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.515433

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.74104642868042 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.243993520736694 sec. =
Valid knn accuracy bass      : 33.064516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.281973361968994 sec. =
Valid knn accuracy piano     : 37.109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.789103746414185 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.825395107269287 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 55.299070998251395%

                                                                      [AEpoch 128: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00363, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00363, Train/loss_recog_epoch=1.100]Epoch 128: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189954, 0.190239, 0.189099, 0.194175
Train average loss UNet                 (all)                : 0.763468

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000024, 3.904979, 7.546583
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005198, 4.077054, 6.795188
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004574, 4.108862, 6.837029
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005049, 4.230540, 7.334666
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002206, 4.396561, 7.530116
Train average loss all      (Triplet)                 : 0.003313

== Recognize ==
Train average loss Recognize     : 1.097200
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 49.840000 %
Train average accuracy piano     : 49.829998 %
Train average accuracy guitar    : 49.875000 %
Train average accuracy residuals : 49.680000 %

== Train average loss all : 0.003313

Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]          Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.797, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00253, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.150, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00253, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.150, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]    Epoch 129:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00904, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=1.030, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00904, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=1.030, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.070, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]  Epoch 129:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.070, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]  Epoch 129: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.640, Valid/loss_unet_all_step=0.797, Valid/loss_triplet_all_step=0.640, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.515, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185601, 0.189010, 0.190925, 0.199054
Valid average loss UNet                 (all)                : 0.764591

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101483, 4.013511, 7.409938
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.693231, 5.369385, 5.680794
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.664724, 5.047239, 5.196509
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.273087, 4.618261, 6.527615
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.297253, 5.493792, 7.166856
Valid average loss all      (Triplet)                 : 0.424364

== Recognize ==
Valid average loss Recognize     : 1.019991
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.424364

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.394813776016235 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.244065999984741 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.346164464950562 sec. =
Valid knn accuracy piano     : 38.0859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.427246332168579 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6909894943237305 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 53.56285561169194%

                                                                      [AEpoch 129: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00331, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.100]Epoch 129: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190470, 0.190767, 0.189623, 0.194734
Train average loss UNet                 (all)                : 0.765594

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000808, 3.907902, 7.522908
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003183, 4.099149, 6.927085
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003964, 4.162716, 6.978614
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002557, 4.284894, 7.517968
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002841, 4.431840, 7.585925
Train average loss all      (Triplet)                 : 0.002663

== Recognize ==
Train average loss Recognize     : 1.095341
Train average accuracy drums     : 50.349998 %
Train average accuracy bass      : 50.379997 %
Train average accuracy piano     : 50.070000 %
Train average accuracy guitar    : 49.814999 %
Train average accuracy residuals : 49.470001 %

== Train average loss all : 0.002663

Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]          Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.00741, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=1.100, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.00741, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=1.100, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]    Epoch 130:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=1.160, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00346, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.00346, Train/loss_recog_step=1.160, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]    Epoch 130:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.185, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.776, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.75it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.58it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.73it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185232, 0.188690, 0.190608, 0.191391
Valid average loss UNet                 (all)                : 0.755921

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099073, 4.145146, 7.253512
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.860426, 5.605662, 5.653271
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.560940, 5.092174, 5.290455
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.377488, 4.767627, 6.580262
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.425605, 5.476044, 6.651506
Valid average loss all      (Triplet)                 : 0.515771

== Recognize ==
Valid average loss Recognize     : 1.155020
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.515771

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.727328300476074 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.82679009437561 sec. =
Valid knn accuracy bass      : 29.233870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.56282639503479 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.897551536560059 sec. =
Valid knn accuracy guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.31065320968628 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 52.35418084939254%

                                                                      [AEpoch 130: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.100]Epoch 130: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190175, 0.190486, 0.189339, 0.195204
Train average loss UNet                 (all)                : 0.765203

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000399, 4.030801, 7.637212
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002536, 4.128912, 6.951469
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003646, 4.213185, 7.054258
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001758, 4.308044, 7.582193
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001761, 4.533822, 7.759345
Train average loss all      (Triplet)                 : 0.002076

== Recognize ==
Train average loss Recognize     : 1.096220
Train average accuracy drums     : 50.344997 %
Train average accuracy bass      : 50.510002 %
Train average accuracy piano     : 50.085003 %
Train average accuracy guitar    : 49.730000 %
Train average accuracy residuals : 50.279999 %

== Train average loss all : 0.002076

Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]          Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00542, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=1.120, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00542, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=1.120, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]    Epoch 131:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.538, Valid/loss_unet_all_step=0.741, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184310, 0.187678, 0.189812, 0.194585
Valid average loss UNet                 (all)                : 0.756385

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077975, 4.157342, 7.674849
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.743249, 5.364616, 5.486691
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.653596, 4.955629, 5.175315
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.351577, 4.803767, 6.301175
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.462091, 5.519500, 6.737708
Valid average loss all      (Triplet)                 : 0.489704

== Recognize ==
Valid average loss Recognize     : 1.093804
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.489704

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.585117816925049 sec. =
Valid knn accuracy drums     : 82.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.330704689025879 sec. =
Valid knn accuracy bass      : 26.209677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.78865909576416 sec. =
Valid knn accuracy piano     : 35.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.428138971328735 sec. =
Valid knn accuracy guitar    : 44.19642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.122994422912598 sec. =
Valid knn accuracy residuals : 62.04545454545455%

Valid knn accuracy average   : 50.08236373768238%

                                                                      [AEpoch 131: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.100]Epoch 131: 100%|██████████| 313/313 [05:34<00:00,  0.94it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189894, 0.190172, 0.189070, 0.194992
Train average loss UNet                 (all)                : 0.764129

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001356, 4.085420, 7.732331
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002009, 4.155053, 7.020325
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003967, 4.251699, 7.153564
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001088, 4.352767, 7.644217
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003844, 4.614875, 7.881429
Train average loss all      (Triplet)                 : 0.002440

== Recognize ==
Train average loss Recognize     : 1.099058
Train average accuracy drums     : 50.225002 %
Train average accuracy bass      : 50.115002 %
Train average accuracy piano     : 50.910004 %
Train average accuracy guitar    : 49.849998 %
Train average accuracy residuals : 50.244999 %

== Train average loss all : 0.002440

Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]          Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.080, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=1.080, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00847, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00847, Train/loss_recog_step=1.080, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00847, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00847, Train/loss_recog_step=1.080, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00786, Train/loss_recog_step=1.150, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00786, Train/loss_recog_step=1.150, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00738, Train/loss_recog_step=1.080, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00738, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00738, Train/loss_recog_step=1.080, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00543, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00543, Train/loss_recog_step=1.130, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00543, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00543, Train/loss_recog_step=1.130, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=1.180, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00321, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=1.180, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.351, Valid/loss_unet_all_step=0.775, Valid/loss_triplet_all_step=0.351, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.490, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.501, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.66it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185418, 0.188845, 0.190832, 0.192435
Valid average loss UNet                 (all)                : 0.757531

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072459, 4.327182, 7.775599
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.760280, 5.760438, 5.973788
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.762150, 5.249629, 5.538652
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.315353, 5.098512, 6.889582
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.621945, 5.953434, 7.164836
Valid average loss all      (Triplet)                 : 0.525792

== Recognize ==
Valid average loss Recognize     : 1.159189
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.525792

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.392181158065796 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.424529790878296 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.648285388946533 sec. =
Valid knn accuracy piano     : 36.9140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5241498947143555 sec. =
Valid knn accuracy guitar    : 58.48214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.323834180831909 sec. =
Valid knn accuracy residuals : 63.40909090909091%

Valid knn accuracy average   : 53.9935276964445%

                                                                      [AEpoch 132: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00244, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.100]Epoch 132: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189852, 0.190167, 0.189046, 0.194666
Train average loss UNet                 (all)                : 0.763732

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000655, 4.202576, 8.026594
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002933, 4.191453, 7.037616
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004496, 4.419353, 7.369446
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001438, 4.404149, 7.659403
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005019, 4.654851, 7.970034
Train average loss all      (Triplet)                 : 0.002969

== Recognize ==
Train average loss Recognize     : 1.105199
Train average accuracy drums     : 49.674999 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 50.295002 %
Train average accuracy guitar    : 50.410004 %
Train average accuracy residuals : 50.405003 %

== Train average loss all : 0.002969

Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]          Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.160, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.160, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]    Epoch 133:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00479, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00479, Train/loss_recog_step=1.160, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00479, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00479, Train/loss_recog_step=1.160, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=1.110, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00304, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=1.110, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]    Epoch 133: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.338, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.526, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186281, 0.189663, 0.191918, 0.207574
Valid average loss UNet                 (all)                : 0.775435

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090145, 4.221365, 7.573023
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.826899, 5.583097, 5.662912
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.475086, 5.065649, 5.457005
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.373880, 4.941815, 6.481182
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.658617, 5.702326, 7.145308
Valid average loss all      (Triplet)                 : 0.523863

== Recognize ==
Valid average loss Recognize     : 1.055076
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.523863

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.663269519805908 sec. =
Valid knn accuracy drums     : 88.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.568680047988892 sec. =
Valid knn accuracy bass      : 29.63709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.643390417098999 sec. =
Valid knn accuracy piano     : 33.59375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.516718149185181 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.224036931991577 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 53.96555106008998%

                                                                      [AEpoch 133: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 133: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190581, 0.190883, 0.189731, 0.195075
Train average loss UNet                 (all)                : 0.766270

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001539, 4.177055, 8.094436
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003156, 4.131831, 6.943933
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004598, 4.300397, 7.173151
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002314, 4.357898, 7.475792
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003664, 4.604749, 7.833273
Train average loss all      (Triplet)                 : 0.002966

== Recognize ==
Train average loss Recognize     : 1.104975
Train average accuracy drums     : 49.855000 %
Train average accuracy bass      : 50.305004 %
Train average accuracy piano     : 50.285000 %
Train average accuracy guitar    : 49.660000 %
Train average accuracy residuals : 50.164997 %

== Train average loss all : 0.002966

Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]          Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  48%|████▊     | 150/313 [02:08<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.00109, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=1.060, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00109, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=1.060, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]    Epoch 134:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00141, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=1.230, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00141, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=1.230, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]    Epoch 134: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.363, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.524, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.52it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186078, 0.189475, 0.191829, 0.199216
Valid average loss UNet                 (all)                : 0.766597

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101290, 4.237948, 7.563447
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.876150, 5.851346, 5.903127
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.713126, 5.184245, 5.534266
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.363692, 4.902825, 6.572870
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.616087, 6.287152, 7.855559
Valid average loss all      (Triplet)                 : 0.561824

== Recognize ==
Valid average loss Recognize     : 1.124125
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.561824

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.992643356323242 sec. =
Valid knn accuracy drums     : 88.91304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.437395572662354 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.581802606582642 sec. =
Valid knn accuracy piano     : 36.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.313196182250977 sec. =
Valid knn accuracy guitar    : 58.25892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9177093505859375 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 55.688289204659306%

                                                                      [AEpoch 134: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00297, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 134: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190540, 0.190842, 0.189697, 0.194940
Train average loss UNet                 (all)                : 0.766020

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000775, 4.186040, 8.127007
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004731, 4.203222, 7.043864
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004368, 4.349421, 7.219341
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001994, 4.365158, 7.547085
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003335, 4.714378, 8.058427
Train average loss all      (Triplet)                 : 0.003100

== Recognize ==
Train average loss Recognize     : 1.103404
Train average accuracy drums     : 49.910000 %
Train average accuracy bass      : 50.465000 %
Train average accuracy piano     : 49.605000 %
Train average accuracy guitar    : 50.615002 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.003100

Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]          Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00752, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00752, Train/loss_recog_step=1.240, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00752, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.00752, Train/loss_recog_step=1.240, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0272, Train/loss_recog_step=1.120, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]  Epoch 135:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0272, Train/loss_recog_step=1.120, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00571, Train/loss_recog_step=1.070, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00571, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.00571, Train/loss_recog_step=1.070, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]    Epoch 135:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.428, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.428, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.36it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185422, 0.188773, 0.191050, 0.194900
Valid average loss UNet                 (all)                : 0.760146

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066795, 4.059399, 7.296806
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.020691, 5.925160, 5.647679
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.650365, 5.165452, 5.308770
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.415585, 4.952838, 6.627223
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.561582, 5.946934, 6.838349
Valid average loss all      (Triplet)                 : 0.617851

== Recognize ==
Valid average loss Recognize     : 1.147711
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.617851

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.375842809677124 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.355311870574951 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.450440645217896 sec. =
Valid knn accuracy piano     : 34.765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.281911611557007 sec. =
Valid knn accuracy guitar    : 58.70535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.967767953872681 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 55.19550332644213%

                                                                      [AEpoch 135: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.100]Epoch 135: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190474, 0.190759, 0.189618, 0.194705
Train average loss UNet                 (all)                : 0.765555

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000454, 4.103988, 7.873080
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005856, 4.218306, 7.089009
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004346, 4.391610, 7.351094
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002180, 4.431132, 7.735754
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002749, 4.674563, 8.019602
Train average loss all      (Triplet)                 : 0.003091

== Recognize ==
Train average loss Recognize     : 1.115425
Train average accuracy drums     : 49.494999 %
Train average accuracy bass      : 49.169998 %
Train average accuracy piano     : 50.305004 %
Train average accuracy guitar    : 50.199997 %
Train average accuracy residuals : 50.160004 %

== Train average loss all : 0.003091

Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]          Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.813, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=1.200, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.00528, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=1.200, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]    Epoch 136:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.717, Valid/loss_unet_all_step=0.762, Valid/loss_triplet_all_step=0.717, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.618, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.40it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185916, 0.189218, 0.191619, 0.204639
Valid average loss UNet                 (all)                : 0.771392

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088915, 4.007298, 7.084976
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.993280, 5.578392, 5.291385
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.577272, 4.749024, 5.108027
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371233, 4.803081, 6.571445
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.481661, 5.776989, 6.851567
Valid average loss all      (Triplet)                 : 0.556762

== Recognize ==
Valid average loss Recognize     : 1.060912
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 58.999996 %

== Valid average loss all : 0.556762

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.36465048789978 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.211949348449707 sec. =
Valid knn accuracy bass      : 22.379032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.42659068107605 sec. =
Valid knn accuracy piano     : 34.765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.360417127609253 sec. =
Valid knn accuracy guitar    : 57.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.500706195831299 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 53.58036425793702%

                                                                      [AEpoch 136: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.120]Epoch 136: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190073, 0.190364, 0.189251, 0.194379
Train average loss UNet                 (all)                : 0.764066

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000983, 4.054504, 7.716511
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003388, 4.150840, 6.992177
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003080, 4.272697, 7.172059
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002014, 4.356091, 7.569746
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002329, 4.527530, 7.828927
Train average loss all      (Triplet)                 : 0.002395

== Recognize ==
Train average loss Recognize     : 1.113495
Train average accuracy drums     : 50.059998 %
Train average accuracy bass      : 50.024998 %
Train average accuracy piano     : 49.955002 %
Train average accuracy guitar    : 49.689999 %
Train average accuracy residuals : 49.739998 %

== Train average loss all : 0.002395

Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]          Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.140, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.140, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]    Epoch 137:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00409, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00409, Train/loss_recog_step=1.010, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00409, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00409, Train/loss_recog_step=1.010, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.000186, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000186, Train/loss_recog_step=1.140, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000186, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000186, Train/loss_recog_step=1.140, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=1.020, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]  Epoch 137:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=1.020, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]    Epoch 137: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.565, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.557, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.536, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184163, 0.187569, 0.189508, 0.198798
Valid average loss UNet                 (all)                : 0.760038

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.136151, 4.264724, 7.619585
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.918904, 5.960822, 5.930782
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.444511, 4.979929, 5.692844
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.358044, 4.965380, 7.020767
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.447650, 5.595247, 6.729969
Valid average loss all      (Triplet)                 : 0.509913

== Recognize ==
Valid average loss Recognize     : 1.113139
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 58.000000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.509913

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.833000183105469 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.227895259857178 sec. =
Valid knn accuracy bass      : 23.588709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.779112815856934 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4987406730651855 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.721747159957886 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 54.18478915456914%

                                                                      [AEpoch 137: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.110]Epoch 137: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190068, 0.190367, 0.189249, 0.194162
Train average loss UNet                 (all)                : 0.763845

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000510, 4.044160, 7.815937
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005715, 4.141793, 6.925358
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002530, 4.285802, 7.188380
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001983, 4.380912, 7.682013
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002169, 4.498921, 7.832135
Train average loss all      (Triplet)                 : 0.002703

== Recognize ==
Train average loss Recognize     : 1.118049
Train average accuracy drums     : 49.540001 %
Train average accuracy bass      : 50.234997 %
Train average accuracy piano     : 49.845001 %
Train average accuracy guitar    : 49.935001 %
Train average accuracy residuals : 49.654999 %

== Train average loss all : 0.002703

Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]          Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=1.120, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=1.120, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00522, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00522, Train/loss_recog_step=1.130, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00522, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.00522, Train/loss_recog_step=1.130, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00223, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=1.030, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00223, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=1.030, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.473, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.473, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.542, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186390, 0.189740, 0.191942, 0.191044
Valid average loss UNet                 (all)                : 0.759115

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087484, 4.292839, 7.493559
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.788501, 5.949802, 6.386950
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.584314, 5.136032, 5.676705
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.490226, 5.490283, 7.180619
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.608995, 5.620272, 6.642497
Valid average loss all      (Triplet)                 : 0.532493

== Recognize ==
Valid average loss Recognize     : 1.199892
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.532493

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.029803991317749 sec. =
Valid knn accuracy drums     : 88.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.07583236694336 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.221172571182251 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.418917655944824 sec. =
Valid knn accuracy guitar    : 58.03571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.326628923416138 sec. =
Valid knn accuracy residuals : 71.81818181818181%

Valid knn accuracy average   : 56.498468123303766%

                                                                      [AEpoch 138: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.0027, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.0027, Train/loss_recog_epoch=1.120]Epoch 138: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190405, 0.190694, 0.189560, 0.194811
Train average loss UNet                 (all)                : 0.765469

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001092, 4.218668, 7.956493
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004192, 4.326254, 7.317961
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004161, 4.464899, 7.508035
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001805, 4.601753, 8.058379
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001848, 4.606031, 7.971391
Train average loss all      (Triplet)                 : 0.002612

== Recognize ==
Train average loss Recognize     : 1.117429
Train average accuracy drums     : 50.475002 %
Train average accuracy bass      : 49.419998 %
Train average accuracy piano     : 50.190002 %
Train average accuracy guitar    : 50.494999 %
Train average accuracy residuals : 50.529999 %

== Train average loss all : 0.002612

Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]          Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=1.200, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00687, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00687, Train/loss_recog_step=1.200, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]    Epoch 139:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00286, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=1.230, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00286, Train/loss_unet_all_step=0.736, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=1.230, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]    Epoch 139: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.261, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.261, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.532, Valid/loss_unet_all_epoch=0.759, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.565, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.03it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185454, 0.188926, 0.190861, 0.185661
Valid average loss UNet                 (all)                : 0.750902

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127089, 4.351590, 7.979529
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.920255, 5.860986, 5.874355
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.609309, 5.072004, 5.544019
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.289293, 5.245025, 7.410646
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.417801, 5.833464, 7.120456
Valid average loss all      (Triplet)                 : 0.518309

== Recognize ==
Valid average loss Recognize     : 1.248497
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.518309

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.541015148162842 sec. =
Valid knn accuracy drums     : 87.17391304347825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.097194910049438 sec. =
Valid knn accuracy bass      : 22.58064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.690111637115479 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.543546438217163 sec. =
Valid knn accuracy guitar    : 58.92857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.387448072433472 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 55.28847251757709%

                                                                      [AEpoch 139: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.120]Epoch 139: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190142, 0.190432, 0.189306, 0.194655
Train average loss UNet                 (all)                : 0.764534

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000620, 4.219306, 8.128862
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004092, 4.266477, 7.173467
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002596, 4.321869, 7.301506
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004328, 4.604335, 8.038280
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003425, 4.630166, 8.043436
Train average loss all      (Triplet)                 : 0.002878

== Recognize ==
Train average loss Recognize     : 1.123106
Train average accuracy drums     : 50.300003 %
Train average accuracy bass      : 49.935001 %
Train average accuracy piano     : 50.330002 %
Train average accuracy guitar    : 50.510002 %
Train average accuracy residuals : 49.965000 %

== Train average loss all : 0.002878

Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]          Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.010, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.010, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]  Epoch 140:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00879, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00879, Train/loss_recog_step=1.160, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00879, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00879, Train/loss_recog_step=1.160, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]    Epoch 140:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.712, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.62it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.02it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185133, 0.188535, 0.190492, 0.206041
Valid average loss UNet                 (all)                : 0.770201

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097735, 4.285336, 7.394409
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.946815, 6.147918, 6.280869
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.678506, 5.371375, 5.707476
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.433226, 5.246702, 7.105026
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.542164, 6.218582, 7.537833
Valid average loss all      (Triplet)                 : 0.597839

== Recognize ==
Valid average loss Recognize     : 1.062963
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.597839

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.554254055023193 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.976304769515991 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.686957597732544 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.347819805145264 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.893582820892334 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 53.089386036911904%

                                                                      [AEpoch 140: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00288, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00288, Train/loss_recog_epoch=1.120]Epoch 140: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190268, 0.190566, 0.189443, 0.194596
Train average loss UNet                 (all)                : 0.764873

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000742, 4.213410, 7.940075
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002421, 4.297860, 7.276227
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002223, 4.405712, 7.448720
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002447, 4.643692, 8.093178
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002537, 4.682400, 8.126870
Train average loss all      (Triplet)                 : 0.002056

== Recognize ==
Train average loss Recognize     : 1.131073
Train average accuracy drums     : 49.755001 %
Train average accuracy bass      : 50.155003 %
Train average accuracy piano     : 49.865002 %
Train average accuracy guitar    : 50.110001 %
Train average accuracy residuals : 49.955002 %

== Train average loss all : 0.002056

Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]          Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  32%|███▏      | 100/313 [01:33<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  32%|███▏      | 100/313 [01:33<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.656, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.656, Valid/loss_recog_step=0.985, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185865, 0.189309, 0.191361, 0.185637
Valid average loss UNet                 (all)                : 0.752172

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063620, 4.208170, 7.362376
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.895186, 6.049791, 6.205836
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.548632, 5.296393, 5.791655
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.451177, 5.391725, 6.862377
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.472306, 5.775707, 6.846444
Valid average loss all      (Triplet)                 : 0.533366

== Recognize ==
Valid average loss Recognize     : 1.189488
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 42.500000 %

== Valid average loss all : 0.533366

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.052501201629639 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.41086721420288 sec. =
Valid knn accuracy bass      : 26.008064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.168587446212769 sec. =
Valid knn accuracy piano     : 33.3984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.641867399215698 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.141206502914429 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 53.95597572790113%

                                                                      [AEpoch 141: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00206, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00206, Train/loss_recog_epoch=1.130]Epoch 141: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189889, 0.190202, 0.189088, 0.194252
Train average loss UNet                 (all)                : 0.763431

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000647, 4.210201, 7.864442
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004674, 4.394442, 7.468791
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003348, 4.457724, 7.442161
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002576, 4.618810, 8.012435
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004185, 4.774916, 8.173993
Train average loss all      (Triplet)                 : 0.003092

== Recognize ==
Train average loss Recognize     : 1.129514
Train average accuracy drums     : 50.445004 %
Train average accuracy bass      : 49.910000 %
Train average accuracy piano     : 49.915001 %
Train average accuracy guitar    : 49.470001 %
Train average accuracy residuals : 49.689999 %

== Train average loss all : 0.003092

Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]          Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=1.070, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]  Epoch 142:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.00177, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=1.100, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00177, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=1.100, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]    Epoch 142:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.964, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.738, Valid/loss_triplet_all_step=0.521, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.752, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184801, 0.188171, 0.190318, 0.200265
Valid average loss UNet                 (all)                : 0.763555

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064320, 4.312967, 7.515019
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.790266, 5.616016, 5.920553
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.612877, 5.093631, 5.484653
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.507897, 5.418455, 6.782897
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.482970, 5.621232, 6.947286
Valid average loss all      (Triplet)                 : 0.523021

== Recognize ==
Valid average loss Recognize     : 1.128766
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.523021

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.427330732345581 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.360797643661499 sec. =
Valid knn accuracy bass      : 22.782258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.77716064453125 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.632174968719482 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.233683109283447 sec. =
Valid knn accuracy residuals : 68.86363636363636%

Valid knn accuracy average   : 54.00454767445038%

                                                                      [AEpoch 142: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.964, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00309, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 142: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.964, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190158, 0.190469, 0.189347, 0.194300
Train average loss UNet                 (all)                : 0.764274

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000302, 4.196999, 7.951589
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002303, 4.274378, 7.304547
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003344, 4.406642, 7.384047
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003535, 4.596780, 8.019686
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002908, 4.811088, 8.307955
Train average loss all      (Triplet)                 : 0.002489

== Recognize ==
Train average loss Recognize     : 1.125313
Train average accuracy drums     : 49.945000 %
Train average accuracy bass      : 50.414997 %
Train average accuracy piano     : 50.314999 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 50.209999 %

== Train average loss all : 0.002489

Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.964, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]          Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.964, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.964, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]    Epoch 143:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=1.200, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=1.200, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.00194, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00194, Train/loss_recog_step=1.210, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00194, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.00194, Train/loss_recog_step=1.210, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]    Epoch 143:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.523, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.73it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.20it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184215, 0.187736, 0.189456, 0.207844
Valid average loss UNet                 (all)                : 0.769252

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050680, 4.056071, 7.353025
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.794798, 5.678041, 6.029393
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.557264, 4.795914, 5.095341
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.429648, 5.264043, 6.640477
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.438189, 5.375664, 6.583957
Valid average loss all      (Triplet)                 : 0.503317

== Recognize ==
Valid average loss Recognize     : 1.136242
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.503317

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.283029079437256 sec. =
Valid knn accuracy drums     : 87.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.2705397605896 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.268821001052856 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.315943717956543 sec. =
Valid knn accuracy guitar    : 50.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.448897838592529 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 55.091900506138316%

                                                                      [AEpoch 143: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00249, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.130]Epoch 143: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190036, 0.190314, 0.189189, 0.194605
Train average loss UNet                 (all)                : 0.764144

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000397, 4.077064, 7.738527
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002694, 4.167898, 7.165812
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004388, 4.321949, 7.270012
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004903, 4.592117, 7.865392
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001090, 4.770116, 8.263461
Train average loss all      (Triplet)                 : 0.002713

== Recognize ==
Train average loss Recognize     : 1.132252
Train average accuracy drums     : 49.724998 %
Train average accuracy bass      : 50.190002 %
Train average accuracy piano     : 50.305004 %
Train average accuracy guitar    : 49.895000 %
Train average accuracy residuals : 49.535000 %

== Train average loss all : 0.002713

Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]          Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00985, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00985, Train/loss_recog_step=1.170, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00985, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00985, Train/loss_recog_step=1.170, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]    Epoch 144: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.459, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.459, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.503, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.80it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185496, 0.188954, 0.190804, 0.199521
Valid average loss UNet                 (all)                : 0.764775

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061191, 4.224852, 7.387022
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.835306, 6.120993, 6.327444
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.699052, 5.002138, 5.420097
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.406576, 5.361533, 6.868844
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.500698, 5.542298, 6.883914
Valid average loss all      (Triplet)                 : 0.533013

== Recognize ==
Valid average loss Recognize     : 1.130693
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.533013

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.398197412490845 sec. =
Valid knn accuracy drums     : 89.56521739130436%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.73011302947998 sec. =
Valid knn accuracy bass      : 34.07258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.959319114685059 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.947906970977783 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4912049770355225 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 55.85103769170872%

                                                                      [AEpoch 144: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00271, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00271, Train/loss_recog_epoch=1.130]Epoch 144: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189989, 0.190283, 0.189169, 0.194582
Train average loss UNet                 (all)                : 0.764023

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000508, 4.087057, 7.791051
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004102, 4.328064, 7.356499
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003362, 4.358221, 7.310212
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004410, 4.509351, 7.804058
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003372, 4.698593, 8.081369
Train average loss all      (Triplet)                 : 0.003270

== Recognize ==
Train average loss Recognize     : 1.130798
Train average accuracy drums     : 49.875000 %
Train average accuracy bass      : 49.610001 %
Train average accuracy piano     : 50.384998 %
Train average accuracy guitar    : 49.880001 %
Train average accuracy residuals : 49.759998 %

== Train average loss all : 0.003270

Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]          Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00397, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=1.160, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]    Epoch 145:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=1.170, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=1.170, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.413, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.413, Valid/loss_recog_step=0.986, Valid/loss_all_epoch=0.533, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184272, 0.187703, 0.189512, 0.191718
Valid average loss UNet                 (all)                : 0.753205

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080088, 4.295341, 7.485115
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.930386, 6.096417, 6.144336
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.643385, 5.164646, 5.524649
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.417734, 5.323153, 6.847881
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.500796, 5.559425, 6.994459
Valid average loss all      (Triplet)                 : 0.571343

== Recognize ==
Valid average loss Recognize     : 1.241851
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.571343

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7176430225372314 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.384652614593506 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.651146650314331 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.997995615005493 sec. =
Valid knn accuracy guitar    : 45.75892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.420042276382446 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 55.0207452960784%

                                                                      [AEpoch 145: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00327, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.130]Epoch 145: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189950, 0.190257, 0.189130, 0.194536
Train average loss UNet                 (all)                : 0.763873

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000909, 4.115672, 7.710261
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002689, 4.351939, 7.327318
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003578, 4.380661, 7.294090
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002551, 4.484644, 7.748196
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003688, 4.709547, 8.121794
Train average loss all      (Triplet)                 : 0.002667

== Recognize ==
Train average loss Recognize     : 1.134122
Train average accuracy drums     : 49.939999 %
Train average accuracy bass      : 50.379997 %
Train average accuracy piano     : 49.900002 %
Train average accuracy guitar    : 50.365002 %
Train average accuracy residuals : 50.475002 %

== Train average loss all : 0.002667

Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]          Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00433, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=1.100, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00433, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00433, Train/loss_recog_step=1.100, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]    Epoch 146: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.573, Valid/loss_unet_all_step=0.768, Valid/loss_triplet_all_step=0.573, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185761, 0.189222, 0.191066, 0.204633
Valid average loss UNet                 (all)                : 0.770682

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078494, 4.176092, 7.612056
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.938920, 5.883070, 5.878461
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.550511, 4.951110, 5.533047
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.374531, 5.196158, 6.821566
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.577630, 5.579295, 6.998892
Valid average loss all      (Triplet)                 : 0.568199

== Recognize ==
Valid average loss Recognize     : 1.120938
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.568199

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.328390121459961 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.974685192108154 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.481842756271362 sec. =
Valid knn accuracy piano     : 35.3515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.185062885284424 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.280099391937256 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 55.00109131095062%

                                                                      [AEpoch 146: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.130]Epoch 146: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189943, 0.190223, 0.189115, 0.195224
Train average loss UNet                 (all)                : 0.764504

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001378, 4.181503, 8.031571
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002950, 4.336086, 7.400999
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003353, 4.395975, 7.384223
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001352, 4.558622, 7.933862
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002629, 4.740730, 8.188367
Train average loss all      (Triplet)                 : 0.002277

== Recognize ==
Train average loss Recognize     : 1.140627
Train average accuracy drums     : 49.935001 %
Train average accuracy bass      : 50.010002 %
Train average accuracy piano     : 49.709999 %
Train average accuracy guitar    : 49.959999 %
Train average accuracy residuals : 49.630001 %

== Train average loss all : 0.002277

Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]          Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=1.100, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=1.100, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]    Epoch 147:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00598, Train/loss_recog_step=1.050, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00598, Train/loss_recog_step=1.050, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]    Epoch 147:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=1.200, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0084, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=1.200, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.718, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185702, 0.189115, 0.191189, 0.201622
Valid average loss UNet                 (all)                : 0.767628

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128028, 4.256617, 7.465694
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.944089, 6.004797, 6.053982
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.525728, 5.034860, 5.694678
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.378806, 5.435947, 6.951621
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.595147, 6.061447, 7.157061
Valid average loss all      (Triplet)                 : 0.567462

== Recognize ==
Valid average loss Recognize     : 1.171843
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.567462

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.836968183517456 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.212932586669922 sec. =
Valid knn accuracy bass      : 25.806451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.02534294128418 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3290863037109375 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.432750463485718 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 53.24231799056485%

                                                                      [AEpoch 147: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.140]Epoch 147: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190166, 0.190459, 0.189346, 0.194563
Train average loss UNet                 (all)                : 0.764535

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000325, 4.215541, 8.152651
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003267, 4.335551, 7.332445
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002278, 4.396771, 7.356292
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002777, 4.547950, 7.926434
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001717, 4.743424, 8.209621
Train average loss all      (Triplet)                 : 0.002164

== Recognize ==
Train average loss Recognize     : 1.134258
Train average accuracy drums     : 50.279999 %
Train average accuracy bass      : 49.955002 %
Train average accuracy piano     : 50.000000 %
Train average accuracy guitar    : 50.215000 %
Train average accuracy residuals : 50.089996 %

== Train average loss all : 0.002164

Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]          Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.807, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  80%|███████▉  | 250/313 [03:29<00:52,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.00308, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.180, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.00308, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.180, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148: 100%|██████████| 313/313 [04:20<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.539, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.532, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.22it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185568, 0.188932, 0.191106, 0.197901
Valid average loss UNet                 (all)                : 0.763507

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087967, 4.324049, 7.966845
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.788163, 5.997637, 6.013792
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.600157, 5.088341, 5.999177
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.384887, 5.464100, 7.128816
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.777143, 6.538270, 7.837091
Valid average loss all      (Triplet)                 : 0.548496

== Recognize ==
Valid average loss Recognize     : 1.149280
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.548496

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.164918422698975 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.962554693222046 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.986426830291748 sec. =
Valid knn accuracy piano     : 41.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.809216737747192 sec. =
Valid knn accuracy guitar    : 49.776785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.259858131408691 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 54.921132754867855%

                                                                      [AEpoch 148: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00216, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.130]Epoch 148: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190579, 0.190858, 0.189717, 0.194757
Train average loss UNet                 (all)                : 0.765912

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000854, 4.279641, 8.246531
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003037, 4.436515, 7.541811
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003829, 4.524981, 7.629624
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001642, 4.659626, 8.134145
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001158, 4.892498, 8.566150
Train average loss all      (Triplet)                 : 0.002077

== Recognize ==
Train average loss Recognize     : 1.132995
Train average accuracy drums     : 49.720001 %
Train average accuracy bass      : 50.470001 %
Train average accuracy piano     : 50.410004 %
Train average accuracy guitar    : 50.215000 %
Train average accuracy residuals : 50.620003 %

== Train average loss all : 0.002077

Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]          Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.798, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]  Epoch 149:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00192, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=1.210, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00192, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.00192, Train/loss_recog_step=1.210, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.00574, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=1.080, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00574, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.00574, Train/loss_recog_step=1.080, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]    Epoch 149:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.060, Valid/loss_all_step=0.314, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186040, 0.189436, 0.191471, 0.201758
Valid average loss UNet                 (all)                : 0.768706

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073872, 4.219968, 7.789366
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.946078, 6.044518, 5.869225
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.696844, 5.099788, 5.629358
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.370989, 5.305937, 7.321611
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.694972, 5.846500, 6.864897
Valid average loss all      (Triplet)                 : 0.590542

== Recognize ==
Valid average loss Recognize     : 1.200456
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.590542

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.729266881942749 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.68286919593811 sec. =
Valid knn accuracy bass      : 28.42741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.749373197555542 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.547439098358154 sec. =
Valid knn accuracy guitar    : 47.32142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.51004672050476 sec. =
Valid knn accuracy residuals : 68.86363636363636%

Valid knn accuracy average   : 53.73126044493725%

                                                                      [AEpoch 149: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.060, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.130]Epoch 149: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.060, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190525, 0.190809, 0.189677, 0.195136
Train average loss UNet                 (all)                : 0.766147

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000411, 4.295746, 8.351865
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003768, 4.458598, 7.567814
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004918, 4.475609, 7.483224
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003153, 4.698541, 8.116040
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001715, 4.825708, 8.312290
Train average loss all      (Triplet)                 : 0.002827

== Recognize ==
Train average loss Recognize     : 1.138369
Train average accuracy drums     : 49.814999 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 50.199997 %
Train average accuracy guitar    : 50.379997 %
Train average accuracy residuals : 50.139999 %

== Train average loss all : 0.002827

Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.060, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]          Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.060, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00696, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.060, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00598, Train/loss_recog_step=1.210, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00598, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00598, Train/loss_recog_step=1.210, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.00479, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00479, Train/loss_recog_step=1.220, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00479, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00479, Train/loss_recog_step=1.220, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]    Epoch 150:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.200, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.200, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.537, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185071, 0.188383, 0.190703, 0.202589
Valid average loss UNet                 (all)                : 0.766747

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108254, 4.196881, 7.810761
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.916263, 5.745966, 5.722433
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.568217, 4.971744, 5.405498
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.366015, 5.386651, 7.096094
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.632654, 5.783535, 6.805829
Valid average loss all      (Triplet)                 : 0.567431

== Recognize ==
Valid average loss Recognize     : 1.092555
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.567431

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.253504514694214 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.623165369033813 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.73012924194336 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.834317922592163 sec. =
Valid knn accuracy guitar    : 56.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.176255464553833 sec. =
Valid knn accuracy residuals : 71.36363636363636%

Valid knn accuracy average   : 55.576516280441155%

                                                                      [AEpoch 150: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00283, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.140]Epoch 150: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190130, 0.190406, 0.189282, 0.194708
Train average loss UNet                 (all)                : 0.764526

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000401, 4.262517, 8.206238
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003518, 4.305623, 7.341207
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003578, 4.394314, 7.421211
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002471, 4.634301, 8.165449
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002260, 4.760461, 8.218735
Train average loss all      (Triplet)                 : 0.002461

== Recognize ==
Train average loss Recognize     : 1.146550
Train average accuracy drums     : 49.570000 %
Train average accuracy bass      : 50.105000 %
Train average accuracy piano     : 49.810001 %
Train average accuracy guitar    : 50.054996 %
Train average accuracy residuals : 49.389999 %

== Train average loss all : 0.002461

Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]          Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000201, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000201, Train/loss_recog_step=1.100, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000201, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000201, Train/loss_recog_step=1.100, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]      Epoch 151:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.735, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.543, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.543, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.556, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185630, 0.189007, 0.191391, 0.206030
Valid average loss UNet                 (all)                : 0.772059

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.094584, 4.316594, 8.120084
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.891006, 5.728211, 5.815220
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.737076, 5.311377, 5.750212
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.468541, 5.343654, 6.794408
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.625010, 5.990865, 7.156353
Valid average loss all      (Triplet)                 : 0.602058

== Recognize ==
Valid average loss Recognize     : 1.196909
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.602058

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.817600250244141 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42903208732605 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.50172758102417 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.216877460479736 sec. =
Valid knn accuracy guitar    : 52.90178571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.735733509063721 sec. =
Valid knn accuracy residuals : 68.86363636363636%

Valid knn accuracy average   : 54.604717041811625%

                                                                      [AEpoch 151: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00246, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00246, Train/loss_recog_epoch=1.150]Epoch 151: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190215, 0.190499, 0.189395, 0.194512
Train average loss UNet                 (all)                : 0.764621

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001144, 4.364278, 8.323905
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003349, 4.441345, 7.543905
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002691, 4.524744, 7.627168
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002259, 4.804203, 8.412591
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002098, 4.914961, 8.488863
Train average loss all      (Triplet)                 : 0.002217

== Recognize ==
Train average loss Recognize     : 1.151679
Train average accuracy drums     : 49.520000 %
Train average accuracy bass      : 49.860001 %
Train average accuracy piano     : 49.910000 %
Train average accuracy guitar    : 50.400002 %
Train average accuracy residuals : 49.950001 %

== Train average loss all : 0.002217

Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]          Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.00502, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00502, Train/loss_recog_step=1.160, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00502, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00502, Train/loss_recog_step=1.160, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=1.170, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]  Epoch 152:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0158, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=1.170, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]  Epoch 152:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.510, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185634, 0.188976, 0.191016, 0.198841
Valid average loss UNet                 (all)                : 0.764467

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120669, 4.335001, 7.943250
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.918846, 6.359272, 6.361942
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.597349, 5.277883, 5.749134
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.405330, 5.659733, 6.999785
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.610433, 6.154378, 7.274749
Valid average loss all      (Triplet)                 : 0.567679

== Recognize ==
Valid average loss Recognize     : 1.155011
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.567679

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.984644174575806 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.320692539215088 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.816105127334595 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.646292209625244 sec. =
Valid knn accuracy guitar    : 53.79464285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.282308340072632 sec. =
Valid knn accuracy residuals : 69.0909090909091%

Valid knn accuracy average   : 55.473323573341105%

                                                                      [AEpoch 152: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00222, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00222, Train/loss_recog_epoch=1.150]Epoch 152: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190203, 0.190495, 0.189394, 0.194782
Train average loss UNet                 (all)                : 0.764874

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000175, 4.422493, 8.559500
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003577, 4.642950, 7.779941
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001585, 4.544310, 7.728276
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001431, 4.769570, 8.394788
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003733, 5.111964, 8.806118
Train average loss all      (Triplet)                 : 0.002175

== Recognize ==
Train average loss Recognize     : 1.146657
Train average accuracy drums     : 50.660004 %
Train average accuracy bass      : 49.785000 %
Train average accuracy piano     : 50.029999 %
Train average accuracy guitar    : 50.430000 %
Train average accuracy residuals : 49.985001 %

== Train average loss all : 0.002175

Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]          Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=1.170, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=1.170, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]  Epoch 153:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.467, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.09it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184884, 0.188317, 0.190206, 0.192216
Valid average loss UNet                 (all)                : 0.755623

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130641, 4.122698, 7.494968
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.754757, 5.878987, 6.116190
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.524416, 5.037806, 5.536131
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.374077, 5.596606, 6.803432
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.625631, 6.016967, 6.885636
Valid average loss all      (Triplet)                 : 0.507877

== Recognize ==
Valid average loss Recognize     : 1.216183
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.507877

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.154468774795532 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.476658582687378 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.555389881134033 sec. =
Valid knn accuracy piano     : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.660051345825195 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.608932733535767 sec. =
Valid knn accuracy residuals : 59.31818181818181%

Valid knn accuracy average   : 53.079825504089186%

                                                                      [AEpoch 153: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.150]Epoch 153: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189694, 0.189991, 0.188887, 0.195257
Train average loss UNet                 (all)                : 0.763829

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000793, 4.312479, 8.223969
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006029, 4.545850, 7.599298
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002772, 4.452867, 7.525746
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002182, 4.684713, 8.177796
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005875, 5.005726, 8.545883
Train average loss all      (Triplet)                 : 0.003564

== Recognize ==
Train average loss Recognize     : 1.150512
Train average accuracy drums     : 50.054996 %
Train average accuracy bass      : 50.010002 %
Train average accuracy piano     : 49.785000 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 49.884998 %

== Train average loss all : 0.003564

Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]          Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.290, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.290, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  32%|███▏      | 100/313 [01:26<03:04,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]  Epoch 154:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.090, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.090, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  64%|██████▍   | 200/313 [02:49<01:35,  1.18it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=1.190, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00392, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=1.190, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  80%|███████▉  | 250/313 [03:31<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]    Epoch 154:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154:  96%|█████████▌| 300/313 [04:12<00:10,  1.19it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.170, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.170, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154: 100%|██████████| 313/313 [04:21<00:00,  1.20it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.303, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.508, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.10it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185228, 0.188597, 0.190882, 0.205079
Valid average loss UNet                 (all)                : 0.769786

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109227, 4.177143, 7.541292
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.736333, 5.886777, 6.263985
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.705359, 5.253131, 5.660316
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.340480, 5.104246, 6.838859
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.580546, 5.939970, 7.157960
Valid average loss all      (Triplet)                 : 0.520682

== Recognize ==
Valid average loss Recognize     : 1.230937
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.520682

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.733686685562134 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.134751558303833 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.223892450332642 sec. =
Valid knn accuracy piano     : 30.46875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.281745910644531 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.517925262451172 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 52.54023890730588%

                                                                      [AEpoch 154: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.150]Epoch 154: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190069, 0.190363, 0.189233, 0.194676
Train average loss UNet                 (all)                : 0.764340

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000597, 4.248506, 8.045819
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003327, 4.414522, 7.467554
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003979, 4.427783, 7.423025
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003875, 4.659162, 8.096342
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001668, 4.918795, 8.354652
Train average loss all      (Triplet)                 : 0.002669

== Recognize ==
Train average loss Recognize     : 1.156705
Train average accuracy drums     : 49.654999 %
Train average accuracy bass      : 50.220001 %
Train average accuracy piano     : 49.614998 %
Train average accuracy guitar    : 50.150002 %
Train average accuracy residuals : 49.845001 %

== Train average loss all : 0.002669

Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]          Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00323, Train/loss_recog_step=1.190, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00323, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00323, Train/loss_recog_step=1.190, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]    Epoch 155:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00601, Train/loss_recog_step=1.160, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.00601, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00601, Train/loss_recog_step=1.160, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.392, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.521, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.03it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185740, 0.189115, 0.191312, 0.199024
Valid average loss UNet                 (all)                : 0.765190

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.141435, 4.245090, 7.295824
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.726390, 6.147074, 6.401421
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.628310, 5.289579, 5.709303
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.428968, 5.412042, 6.799654
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.543456, 5.866497, 7.221842
Valid average loss all      (Triplet)                 : 0.516660

== Recognize ==
Valid average loss Recognize     : 1.206536
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 41.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.516660

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.487698316574097 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.793654918670654 sec. =
Valid knn accuracy bass      : 22.983870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.385096788406372 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.56692361831665 sec. =
Valid knn accuracy guitar    : 45.089285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.714221477508545 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 52.11194482454782%

                                                                      [AEpoch 155: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00267, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.160]Epoch 155: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190652, 0.190952, 0.189814, 0.194616
Train average loss UNet                 (all)                : 0.766034

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001010, 4.328459, 8.212878
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002712, 4.466349, 7.614296
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003986, 4.523677, 7.574269
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003274, 4.800450, 8.336561
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002095, 4.923949, 8.461896
Train average loss all      (Triplet)                 : 0.002606

== Recognize ==
Train average loss Recognize     : 1.156569
Train average accuracy drums     : 50.059998 %
Train average accuracy bass      : 49.974998 %
Train average accuracy piano     : 49.645000 %
Train average accuracy guitar    : 49.794998 %
Train average accuracy residuals : 50.340004 %

== Train average loss all : 0.002606

Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]          Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.230, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.230, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]  Epoch 156:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=1.160, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00379, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=1.160, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000222, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000222, Train/loss_recog_step=1.270, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000222, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000222, Train/loss_recog_step=1.270, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]      Epoch 156:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.769, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184082, 0.187419, 0.189585, 0.202050
Valid average loss UNet                 (all)                : 0.763137

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140504, 4.403988, 8.131689
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.882644, 6.319773, 6.273521
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.646709, 5.371693, 5.687561
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.414826, 5.283296, 7.041900
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.697033, 5.982664, 7.469391
Valid average loss all      (Triplet)                 : 0.600144

== Recognize ==
Valid average loss Recognize     : 1.170187
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.600144

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.477728843688965 sec. =
Valid knn accuracy drums     : 84.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.460350036621094 sec. =
Valid knn accuracy bass      : 26.61290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.617748975753784 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.489269495010376 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.307910442352295 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 55.09874877051419%

                                                                      [AEpoch 156: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00261, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 156: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190815, 0.191108, 0.189961, 0.194065
Train average loss UNet                 (all)                : 0.765949

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001012, 4.404666, 8.377583
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002105, 4.494095, 7.681304
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005144, 4.653995, 7.818617
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002142, 4.762202, 8.281513
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000995, 4.995201, 8.657605
Train average loss all      (Triplet)                 : 0.002335

== Recognize ==
Train average loss Recognize     : 1.165609
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 50.064999 %
Train average accuracy piano     : 50.125004 %
Train average accuracy guitar    : 50.099998 %
Train average accuracy residuals : 49.375000 %

== Train average loss all : 0.002335

Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]          Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.792, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.120, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.120, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]  Epoch 157:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.551, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186537, 0.189958, 0.192175, 0.196626
Valid average loss UNet                 (all)                : 0.765295

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146087, 4.465804, 7.901717
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.752201, 6.481791, 6.565557
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.796562, 5.400569, 5.541485
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.433109, 5.579626, 7.277096
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.667352, 6.146408, 7.243877
Valid average loss all      (Triplet)                 : 0.583001

== Recognize ==
Valid average loss Recognize     : 1.143402
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.583001

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.899413347244263 sec. =
Valid knn accuracy drums     : 87.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.336991786956787 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.765232563018799 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.57678747177124 sec. =
Valid knn accuracy guitar    : 52.67857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.104081392288208 sec. =
Valid knn accuracy residuals : 64.54545454545455%

Valid knn accuracy average   : 54.79214916394965%

                                                                      [AEpoch 157: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00234, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00234, Train/loss_recog_epoch=1.170]Epoch 157: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190100, 0.190394, 0.189269, 0.194504
Train average loss UNet                 (all)                : 0.764267

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000135, 4.465591, 8.482519
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003019, 4.572603, 7.738792
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003791, 4.724887, 7.906705
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002928, 4.819098, 8.412957
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002550, 5.022203, 8.635093
Train average loss all      (Triplet)                 : 0.002485

== Recognize ==
Train average loss Recognize     : 1.167324
Train average accuracy drums     : 50.320000 %
Train average accuracy bass      : 50.220001 %
Train average accuracy piano     : 49.959999 %
Train average accuracy guitar    : 50.494999 %
Train average accuracy residuals : 50.094997 %

== Train average loss all : 0.002485

Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]          Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.130, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.130, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=1.200, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=1.200, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]  Epoch 158:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=1.310, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=1.310, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]    Epoch 158: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.398, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.398, Valid/loss_recog_step=0.963, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.765, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.90it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186050, 0.189373, 0.191804, 0.203192
Valid average loss UNet                 (all)                : 0.770419

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107171, 4.178290, 7.910273
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.823468, 5.986465, 6.049216
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.667167, 5.122150, 5.387390
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.430818, 5.380546, 6.982283
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.536069, 6.079625, 7.343864
Valid average loss all      (Triplet)                 : 0.563471

== Recognize ==
Valid average loss Recognize     : 1.182926
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.563471

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5681822299957275 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.254937410354614 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.576008796691895 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.460574388504028 sec. =
Valid knn accuracy guitar    : 47.99107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.535660982131958 sec. =
Valid knn accuracy residuals : 62.5%

Valid knn accuracy average   : 52.68251915948707%

                                                                      [AEpoch 158: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00248, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00248, Train/loss_recog_epoch=1.170]Epoch 158: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190336, 0.190630, 0.189508, 0.194441
Train average loss UNet                 (all)                : 0.764914

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001059, 4.309839, 8.390328
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002751, 4.403502, 7.414987
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001617, 4.477866, 7.554641
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002733, 4.652001, 8.123683
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003163, 4.771000, 8.219191
Train average loss all      (Triplet)                 : 0.002294

== Recognize ==
Train average loss Recognize     : 1.164740
Train average accuracy drums     : 50.520004 %
Train average accuracy bass      : 49.614998 %
Train average accuracy piano     : 50.559998 %
Train average accuracy guitar    : 49.720001 %
Train average accuracy residuals : 49.939999 %

== Train average loss all : 0.002294

Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]          Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.220, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]  Epoch 159: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.550, Valid/loss_unet_all_step=0.793, Valid/loss_triplet_all_step=0.550, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.527, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.62it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.20it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185398, 0.188797, 0.190931, 0.197405
Valid average loss UNet                 (all)                : 0.762530

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088016, 4.297904, 7.688440
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.786942, 6.175364, 6.205084
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.665426, 5.083213, 5.505041
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.495738, 5.588482, 7.164139
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.494672, 6.062695, 7.313494
Valid average loss all      (Triplet)                 : 0.551030

== Recognize ==
Valid average loss Recognize     : 1.207289
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.551030

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.711683988571167 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.067503929138184 sec. =
Valid knn accuracy bass      : 24.39516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.493076086044312 sec. =
Valid knn accuracy piano     : 42.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.504159212112427 sec. =
Valid knn accuracy guitar    : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.573917388916016 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 54.026111062412355%

                                                                      [AEpoch 159: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00229, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.160]Epoch 159: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190409, 0.190705, 0.189568, 0.194500
Train average loss UNet                 (all)                : 0.765183

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001124, 4.284331, 8.536611
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002535, 4.324225, 7.285855
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000914, 4.329404, 7.412653
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002923, 4.590908, 8.058130
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002612, 4.753522, 8.197873
Train average loss all      (Triplet)                 : 0.002082

== Recognize ==
Train average loss Recognize     : 1.164100
Train average accuracy drums     : 49.595001 %
Train average accuracy bass      : 50.024998 %
Train average accuracy piano     : 50.645000 %
Train average accuracy guitar    : 49.840000 %
Train average accuracy residuals : 50.524998 %

== Train average loss all : 0.002082

Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]          Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00292, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=1.210, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00292, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.00292, Train/loss_recog_step=1.210, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]    Epoch 160: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.763, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.551, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.551, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185503, 0.188913, 0.190998, 0.203018
Valid average loss UNet                 (all)                : 0.768432

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083129, 4.468979, 7.859468
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.918699, 6.435026, 6.422039
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.839980, 5.326181, 5.644579
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.476804, 5.711982, 7.347839
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.421811, 5.826967, 7.323919
Valid average loss all      (Triplet)                 : 0.597292

== Recognize ==
Valid average loss Recognize     : 1.073848
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.597292

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.949879884719849 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.13280963897705 sec. =
Valid knn accuracy bass      : 22.782258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.765259027481079 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.201506614685059 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.120441198348999 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 53.435210082694304%

                                                                      [AEpoch 160: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.160]Epoch 160: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190182, 0.190484, 0.189347, 0.194542
Train average loss UNet                 (all)                : 0.764554

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000784, 4.386872, 8.472976
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002200, 4.534997, 7.629434
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002728, 4.472945, 7.602748
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002161, 4.798719, 8.320301
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002248, 4.945436, 8.539300
Train average loss all      (Triplet)                 : 0.002092

== Recognize ==
Train average loss Recognize     : 1.176650
Train average accuracy drums     : 49.980000 %
Train average accuracy bass      : 49.575001 %
Train average accuracy piano     : 50.234997 %
Train average accuracy guitar    : 49.845001 %
Train average accuracy residuals : 50.029999 %

== Train average loss all : 0.002092

Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]          Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.160, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00126, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=1.160, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000584, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000584, Train/loss_recog_step=1.150, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000584, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000584, Train/loss_recog_step=1.150, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.786, Valid/loss_triplet_all_step=0.555, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.597, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185909, 0.189255, 0.191597, 0.200545
Valid average loss UNet                 (all)                : 0.767307

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104155, 4.288769, 7.767750
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.969795, 6.417674, 6.435826
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.799245, 5.638174, 5.716479
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368841, 5.675535, 7.250996
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.422661, 5.820320, 6.851664
Valid average loss all      (Triplet)                 : 0.591431

== Recognize ==
Valid average loss Recognize     : 1.181311
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.591431

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2344276905059814 sec. =
Valid knn accuracy drums     : 86.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.13577675819397 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.761951923370361 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.482819318771362 sec. =
Valid knn accuracy guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.489007949829102 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 54.296479116955986%

                                                                      [AEpoch 161: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00209, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.180]Epoch 161: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190115, 0.190426, 0.189273, 0.194316
Train average loss UNet                 (all)                : 0.764129

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000465, 4.342706, 8.343567
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001966, 4.577739, 7.747084
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005870, 4.528956, 7.639093
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001607, 4.748093, 8.228244
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002224, 4.907780, 8.453089
Train average loss all      (Triplet)                 : 0.002384

== Recognize ==
Train average loss Recognize     : 1.182185
Train average accuracy drums     : 49.570000 %
Train average accuracy bass      : 49.845001 %
Train average accuracy piano     : 49.299999 %
Train average accuracy guitar    : 50.260002 %
Train average accuracy residuals : 50.089996 %

== Train average loss all : 0.002384

Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]          Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.809, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00309, Train/loss_recog_step=1.220, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.00309, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00309, Train/loss_recog_step=1.220, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.597, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.187118, 0.190380, 0.192929, 0.203794
Valid average loss UNet                 (all)                : 0.774222

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102784, 4.286804, 7.644506
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.904140, 6.107714, 6.106195
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.775079, 5.507885, 5.695895
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.424104, 5.388711, 7.239860
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.397780, 5.903752, 7.445208
Valid average loss all      (Triplet)                 : 0.561220

== Recognize ==
Valid average loss Recognize     : 1.139990
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.561220

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.882703304290771 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.771127939224243 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.507400274276733 sec. =
Valid knn accuracy piano     : 43.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.417805433273315 sec. =
Valid knn accuracy guitar    : 47.098214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.033803224563599 sec. =
Valid knn accuracy residuals : 68.86363636363636%

Valid knn accuracy average   : 54.35127177783647%

                                                                      [AEpoch 162: 100%|██████████| 313/313 [05:45<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.180]Epoch 162: 100%|██████████| 313/313 [05:45<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190620, 0.190909, 0.189769, 0.194149
Train average loss UNet                 (all)                : 0.765447

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000513, 4.242955, 8.053969
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004087, 4.466502, 7.501256
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002487, 4.511081, 7.695136
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003020, 4.734879, 8.213863
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002345, 4.832117, 8.381499
Train average loss all      (Triplet)                 : 0.002432

== Recognize ==
Train average loss Recognize     : 1.181752
Train average accuracy drums     : 50.029999 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.164997 %
Train average accuracy guitar    : 49.610001 %
Train average accuracy residuals : 49.919998 %

== Train average loss all : 0.002432

Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]          Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=1.100, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=1.100, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0285, Train/loss_recog_step=1.210, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0285, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.0285, Train/loss_recog_step=1.210, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=1.260, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=1.260, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=5.66e-5, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=5.66e-5, Train/loss_recog_step=1.170, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=5.66e-5, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=5.66e-5, Train/loss_recog_step=1.170, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=1.090, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]  Epoch 163:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=1.090, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.210, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.210, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163: 100%|██████████| 313/313 [04:22<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.792, Valid/loss_triplet_all_step=0.449, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.774, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:02<00:00,  3.95it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.64it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184424, 0.187868, 0.189895, 0.204614
Valid average loss UNet                 (all)                : 0.766801

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104074, 4.349301, 7.596443
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.937815, 6.118734, 6.128781
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.952950, 5.786366, 5.721584
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.412888, 5.385657, 6.773576
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.497464, 5.912290, 7.077092
Valid average loss all      (Triplet)                 : 0.627743

== Recognize ==
Valid average loss Recognize     : 1.236569
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 46.000000 %
Valid average accuracy guitar    : 42.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.627743

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.806139945983887 sec. =
Valid knn accuracy drums     : 87.82608695652175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.363318920135498 sec. =
Valid knn accuracy bass      : 25.806451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.61694598197937 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.261873960494995 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.54727029800415 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 54.61094359050838%

                                                                      [AEpoch 163: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 163: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190703, 0.190995, 0.189848, 0.194115
Train average loss UNet                 (all)                : 0.765661

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000426, 4.210928, 8.197716
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002969, 4.348368, 7.357245
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002515, 4.414214, 7.542142
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004508, 4.657526, 8.008256
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001291, 4.746082, 8.214046
Train average loss all      (Triplet)                 : 0.002431

== Recognize ==
Train average loss Recognize     : 1.180753
Train average accuracy drums     : 49.704998 %
Train average accuracy bass      : 49.860001 %
Train average accuracy piano     : 50.355000 %
Train average accuracy guitar    : 50.024998 %
Train average accuracy residuals : 49.829998 %

== Train average loss all : 0.002431

Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]          Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.790, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.00718, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00718, Train/loss_recog_step=1.120, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00718, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.00718, Train/loss_recog_step=1.120, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=1.220, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]  Epoch 164:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0051, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=1.220, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]  Epoch 164:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=1.130, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.00668, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=1.130, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]    Epoch 164:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.791, Valid/loss_triplet_all_step=0.558, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.628, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.67it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.21it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185870, 0.189266, 0.191309, 0.196885
Valid average loss UNet                 (all)                : 0.763329

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133144, 4.547650, 8.112445
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.136065, 6.657894, 6.465778
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.980305, 5.927059, 5.863906
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.380634, 5.643626, 7.345498
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.504240, 6.240359, 7.238609
Valid average loss all      (Triplet)                 : 0.707927

== Recognize ==
Valid average loss Recognize     : 1.175430
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.707927

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.502333164215088 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.229560613632202 sec. =
Valid knn accuracy bass      : 21.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.724169969558716 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.320495367050171 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.270675420761108 sec. =
Valid knn accuracy residuals : 68.4090909090909%

Valid knn accuracy average   : 52.32484594429063%

                                                                      [AEpoch 164: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.180]Epoch 164: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190868, 0.191165, 0.190017, 0.193956
Train average loss UNet                 (all)                : 0.766006

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000427, 4.335167, 8.242709
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003839, 4.544932, 7.583425
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003732, 4.675300, 7.896545
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001991, 4.830267, 8.527614
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003030, 4.915234, 8.509865
Train average loss all      (Triplet)                 : 0.002765

== Recognize ==
Train average loss Recognize     : 1.191677
Train average accuracy drums     : 49.709999 %
Train average accuracy bass      : 49.535000 %
Train average accuracy piano     : 49.770000 %
Train average accuracy guitar    : 50.054996 %
Train average accuracy residuals : 50.005001 %

== Train average loss all : 0.002765

Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]          Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.812, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.00823, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00823, Train/loss_recog_step=1.230, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00823, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00823, Train/loss_recog_step=1.230, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.250, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]  Epoch 165:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.250, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.120, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.120, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]    Epoch 165: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.210, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.779, Valid/loss_triplet_all_step=0.835, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.708, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.523, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.187127, 0.190543, 0.192687, 0.201362
Valid average loss UNet                 (all)                : 0.771720

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.171438, 4.656595, 8.533834
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.117472, 6.366976, 6.393369
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.695156, 5.703109, 6.071033
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.459067, 5.679535, 7.160516
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.497725, 6.313964, 7.298101
Valid average loss all      (Triplet)                 : 0.645347

== Recognize ==
Valid average loss Recognize     : 1.153173
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.645347

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3818230628967285 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.271175384521484 sec. =
Valid knn accuracy bass      : 25.201612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.453476905822754 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4488444328308105 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2089455127716064 sec. =
Valid knn accuracy residuals : 68.63636363636364%

Valid knn accuracy average   : 53.3940510532595%

                                                                      [AEpoch 165: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.210, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.190]Epoch 165: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.210, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190987, 0.191264, 0.190135, 0.194274
Train average loss UNet                 (all)                : 0.766660

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000795, 4.501563, 8.592386
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002395, 4.749811, 7.939651
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003183, 4.746138, 8.002017
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002832, 4.923665, 8.621490
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002416, 5.068428, 8.732587
Train average loss all      (Triplet)                 : 0.002249

== Recognize ==
Train average loss Recognize     : 1.198261
Train average accuracy drums     : 50.024998 %
Train average accuracy bass      : 50.045002 %
Train average accuracy piano     : 49.959999 %
Train average accuracy guitar    : 49.134998 %
Train average accuracy residuals : 49.825001 %

== Train average loss all : 0.002249

Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.210, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]          Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.210, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.210, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.00175, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=1.190, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.00175, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=1.190, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]    Epoch 166:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.576, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=0.908, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.04it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185636, 0.189030, 0.191135, 0.204226
Valid average loss UNet                 (all)                : 0.770027

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088551, 4.530599, 8.394901
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.093937, 6.345430, 6.376380
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.831075, 6.150572, 6.299506
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.373410, 5.801905, 7.681914
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.488689, 6.221746, 7.306976
Valid average loss all      (Triplet)                 : 0.630440

== Recognize ==
Valid average loss Recognize     : 1.230944
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.630440

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.295453548431396 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.23023509979248 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.34907579421997 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.575125455856323 sec. =
Valid knn accuracy guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.051568984985352 sec. =
Valid knn accuracy residuals : 71.36363636363636%

Valid knn accuracy average   : 55.53025645024681%

                                                                      [AEpoch 166: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00225, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.200]Epoch 166: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190892, 0.191194, 0.190045, 0.194680
Train average loss UNet                 (all)                : 0.766810

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000641, 4.547467, 8.748829
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003331, 4.774925, 7.987107
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004783, 4.876970, 8.127316
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002085, 4.988750, 8.660640
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001240, 5.119246, 8.853512
Train average loss all      (Triplet)                 : 0.002430

== Recognize ==
Train average loss Recognize     : 1.195469
Train average accuracy drums     : 50.770004 %
Train average accuracy bass      : 49.759998 %
Train average accuracy piano     : 49.625000 %
Train average accuracy guitar    : 50.220001 %
Train average accuracy residuals : 50.160004 %

== Train average loss all : 0.002430

Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]          Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.210, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=1.210, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]  Epoch 167:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.799, Valid/loss_triplet_all_step=0.557, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.630, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185289, 0.188738, 0.190688, 0.202147
Valid average loss UNet                 (all)                : 0.766863

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071645, 4.467598, 8.083544
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.773215, 6.122796, 6.280375
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.730168, 5.705078, 5.975366
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.361809, 5.768371, 7.723706
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.465020, 6.241788, 7.439627
Valid average loss all      (Triplet)                 : 0.491040

== Recognize ==
Valid average loss Recognize     : 1.213049
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.491040

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.403817176818848 sec. =
Valid knn accuracy drums     : 85.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.873957872390747 sec. =
Valid knn accuracy bass      : 30.846774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.152827024459839 sec. =
Valid knn accuracy piano     : 36.5234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.419459819793701 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.32457971572876 sec. =
Valid knn accuracy residuals : 66.13636363636364%

Valid knn accuracy average   : 54.63532127716253%

                                                                      [AEpoch 167: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=1.200]Epoch 167: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190568, 0.190853, 0.189708, 0.194632
Train average loss UNet                 (all)                : 0.765761

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000906, 4.608788, 8.979040
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001792, 4.733731, 8.000662
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002915, 4.862492, 8.197147
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001777, 5.010801, 8.815486
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003169, 5.170638, 8.897862
Train average loss all      (Triplet)                 : 0.002169

== Recognize ==
Train average loss Recognize     : 1.194822
Train average accuracy drums     : 50.115002 %
Train average accuracy bass      : 49.924999 %
Train average accuracy piano     : 50.690002 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 49.654999 %

== Train average loss all : 0.002169

Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]          Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  16%|█▌        | 50/313 [00:50<04:23,  1.00it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=1.190, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=1.190, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00227, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=1.200, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00227, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=1.200, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]    Epoch 168:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00269, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.230, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00269, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.230, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.78it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186421, 0.189900, 0.191793, 0.208151
Valid average loss UNet                 (all)                : 0.776265

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091035, 4.709275, 8.109099
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.977699, 6.681295, 6.743835
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.812087, 5.939837, 6.408593
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.476786, 5.988792, 7.738488
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.516696, 6.378571, 7.170887
Valid average loss all      (Triplet)                 : 0.626940

== Recognize ==
Valid average loss Recognize     : 1.191126
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.626940

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.711249351501465 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.366729736328125 sec. =
Valid knn accuracy bass      : 33.66935483870967%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.460068464279175 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.949211120605469 sec. =
Valid knn accuracy guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.271934986114502 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 54.46459778168886%

                                                                      [AEpoch 168: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 168: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190273, 0.190562, 0.189425, 0.194234
Train average loss UNet                 (all)                : 0.764494

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000706, 4.491535, 8.586001
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001298, 4.738337, 8.025778
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002121, 4.782166, 8.033402
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004138, 5.062882, 8.831236
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002949, 5.122153, 8.816061
Train average loss all      (Triplet)                 : 0.002276

== Recognize ==
Train average loss Recognize     : 1.200664
Train average accuracy drums     : 50.145000 %
Train average accuracy bass      : 50.445004 %
Train average accuracy piano     : 50.274998 %
Train average accuracy guitar    : 49.674999 %
Train average accuracy residuals : 49.799999 %

== Train average loss all : 0.002276

Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]          Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00607, Train/loss_recog_step=1.230, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.00607, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.00607, Train/loss_recog_step=1.230, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]    Epoch 169:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0294, Train/loss_recog_step=1.280, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.0294, Train/loss_recog_step=1.280, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.776, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.545, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185558, 0.189008, 0.190812, 0.201900
Valid average loss UNet                 (all)                : 0.767279

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140378, 4.421257, 7.610298
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.799009, 6.011562, 6.221261
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.724455, 5.587587, 5.777216
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.545847, 5.618666, 7.005671
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.441063, 6.326823, 7.231077
Valid average loss all      (Triplet)                 : 0.559385

== Recognize ==
Valid average loss Recognize     : 1.078609
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 55.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.559385

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.105783939361572 sec. =
Valid knn accuracy drums     : 88.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.175310850143433 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.238592147827148 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7665205001831055 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.096676349639893 sec. =
Valid knn accuracy residuals : 69.54545454545455%

Valid knn accuracy average   : 54.39915740378135%

                                                                      [AEpoch 169: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.200]Epoch 169: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190601, 0.190892, 0.189769, 0.194852
Train average loss UNet                 (all)                : 0.766114

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000192, 4.401900, 8.391427
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005144, 4.668921, 7.852376
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005190, 4.661067, 7.857251
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003994, 4.950518, 8.551251
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002222, 5.076321, 8.761930
Train average loss all      (Triplet)                 : 0.003346

== Recognize ==
Train average loss Recognize     : 1.195805
Train average accuracy drums     : 50.195004 %
Train average accuracy bass      : 50.349998 %
Train average accuracy piano     : 49.485001 %
Train average accuracy guitar    : 50.195004 %
Train average accuracy residuals : 50.535000 %

== Train average loss all : 0.003346

Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]          Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.312, Valid/loss_unet_all_step=0.774, Valid/loss_triplet_all_step=0.312, Valid/loss_recog_step=0.867, Valid/loss_all_epoch=0.559, Valid/loss_unet_all_epoch=0.767, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.544, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.78it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185590, 0.188970, 0.190976, 0.204392
Valid average loss UNet                 (all)                : 0.769928

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102401, 4.464815, 8.096268
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.832439, 6.199720, 6.232421
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.736736, 5.440077, 5.889688
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.419669, 5.485669, 7.143506
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.566741, 6.250014, 6.972898
Valid average loss all      (Triplet)                 : 0.547755

== Recognize ==
Valid average loss Recognize     : 1.144135
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.547755

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.746837377548218 sec. =
Valid knn accuracy drums     : 89.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.186828374862671 sec. =
Valid knn accuracy bass      : 30.241935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.66850209236145 sec. =
Valid knn accuracy piano     : 39.453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.710863828659058 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.808680057525635 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 54.85519645589334%

                                                                      [AEpoch 170: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00335, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.200]Epoch 170: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190579, 0.190870, 0.189743, 0.194746
Train average loss UNet                 (all)                : 0.765937

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000660, 4.357217, 8.565136
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002376, 4.632578, 7.854513
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001240, 4.615530, 7.880039
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002215, 4.932750, 8.643025
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001916, 5.042968, 8.708040
Train average loss all      (Triplet)                 : 0.001701

== Recognize ==
Train average loss Recognize     : 1.205817
Train average accuracy drums     : 49.235001 %
Train average accuracy bass      : 49.895000 %
Train average accuracy piano     : 49.779999 %
Train average accuracy guitar    : 50.089996 %
Train average accuracy residuals : 50.185001 %

== Train average loss all : 0.001701

Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]          Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.805, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00843, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00843, Train/loss_recog_step=1.230, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00843, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00843, Train/loss_recog_step=1.230, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]    Epoch 171:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.801, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.549, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.61it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184531, 0.187958, 0.189788, 0.195599
Valid average loss UNet                 (all)                : 0.757876

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119557, 4.546469, 8.024514
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.057058, 6.348756, 6.041491
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.767305, 5.700761, 5.943427
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.515489, 5.680394, 7.046867
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.501048, 5.957289, 6.917274
Valid average loss all      (Triplet)                 : 0.653067

== Recognize ==
Valid average loss Recognize     : 1.271277
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.653067

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.131099224090576 sec. =
Valid knn accuracy drums     : 89.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.484273672103882 sec. =
Valid knn accuracy bass      : 31.048387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.827593088150024 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.744201421737671 sec. =
Valid knn accuracy guitar    : 54.01785714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.254095792770386 sec. =
Valid knn accuracy residuals : 68.18181818181817%

Valid knn accuracy average   : 55.6676152016812%

                                                                      [AEpoch 171: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.0017, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.210]Epoch 171: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189933, 0.190217, 0.189098, 0.194605
Train average loss UNet                 (all)                : 0.763853

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000096, 4.399027, 8.617808
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002040, 4.642117, 7.787354
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002208, 4.704655, 7.936652
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001551, 4.927129, 8.604929
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001903, 5.071517, 8.749635
Train average loss all      (Triplet)                 : 0.001514

== Recognize ==
Train average loss Recognize     : 1.201365
Train average accuracy drums     : 50.185001 %
Train average accuracy bass      : 49.935001 %
Train average accuracy piano     : 49.509998 %
Train average accuracy guitar    : 49.689999 %
Train average accuracy residuals : 50.959999 %

== Train average loss all : 0.001514

Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]          Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.796, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=1.220, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00317, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.00317, Train/loss_recog_step=1.220, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]    Epoch 172:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=1.250, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=1.250, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]  Epoch 172: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.590, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.590, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.653, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.653, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.557, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.47it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.187480, 0.190888, 0.193085, 0.203601
Valid average loss UNet                 (all)                : 0.775055

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103450, 4.588074, 7.960842
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.017678, 6.530710, 6.534542
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.827969, 5.664383, 6.056262
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.467142, 5.947837, 7.374610
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.573721, 6.297595, 7.068847
Valid average loss all      (Triplet)                 : 0.640451

== Recognize ==
Valid average loss Recognize     : 1.164979
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.640451

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.96131157875061 sec. =
Valid knn accuracy drums     : 86.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.239301443099976 sec. =
Valid knn accuracy bass      : 31.653225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.555017948150635 sec. =
Valid knn accuracy piano     : 34.765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.088871240615845 sec. =
Valid knn accuracy guitar    : 54.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.784423828125 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 55.023641702792304%

                                                                      [AEpoch 172: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00151, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 172: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190450, 0.190753, 0.189617, 0.194170
Train average loss UNet                 (all)                : 0.764990

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000627, 4.428380, 8.573396
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002254, 4.648052, 7.838612
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004607, 4.813685, 8.044727
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002799, 4.960207, 8.641111
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002937, 5.081205, 8.702725
Train average loss all      (Triplet)                 : 0.002645

== Recognize ==
Train average loss Recognize     : 1.208585
Train average accuracy drums     : 50.024998 %
Train average accuracy bass      : 50.185001 %
Train average accuracy piano     : 49.610001 %
Train average accuracy guitar    : 49.674999 %
Train average accuracy residuals : 49.605000 %

== Train average loss all : 0.002645

Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]          Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.270, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00834, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.270, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.541, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.550, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.63it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185093, 0.188427, 0.190211, 0.199389
Valid average loss UNet                 (all)                : 0.763120

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098915, 4.475476, 8.184116
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.646175, 5.971923, 6.361925
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.921379, 5.686412, 5.982264
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.384734, 5.396405, 6.860089
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.516271, 6.422101, 7.135300
Valid average loss all      (Triplet)                 : 0.518364

== Recognize ==
Valid average loss Recognize     : 1.235530
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.518364

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.565674304962158 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.630857467651367 sec. =
Valid knn accuracy bass      : 27.419354838709676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.878136396408081 sec. =
Valid knn accuracy piano     : 36.1328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.449775218963623 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.251728057861328 sec. =
Valid knn accuracy residuals : 64.31818181818181%

Valid knn accuracy average   : 53.02748598044662%

                                                                      [AEpoch 173: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00264, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.210]Epoch 173: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190703, 0.190998, 0.189847, 0.195351
Train average loss UNet                 (all)                : 0.766899

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000285, 4.360501, 8.502324
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002796, 4.653989, 7.901101
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003612, 4.818469, 8.100938
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003078, 4.925515, 8.528779
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002138, 5.065923, 8.748878
Train average loss all      (Triplet)                 : 0.002385

== Recognize ==
Train average loss Recognize     : 1.198728
Train average accuracy drums     : 50.314999 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.010002 %
Train average accuracy guitar    : 50.035000 %
Train average accuracy residuals : 50.139999 %

== Train average loss all : 0.002385

Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]          Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.00881, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00881, Train/loss_recog_step=1.150, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00881, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00881, Train/loss_recog_step=1.150, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]    Epoch 174:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0014, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=1.180, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0014, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=1.180, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.767, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.518, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.64it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185676, 0.189168, 0.191040, 0.197534
Valid average loss UNet                 (all)                : 0.763418

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137216, 4.744759, 8.124270
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.678272, 6.319775, 6.723040
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.792741, 5.503546, 6.085705
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.457850, 5.596656, 7.145555
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.939769, 6.685254, 6.858070
Valid average loss all      (Triplet)                 : 0.565495

== Recognize ==
Valid average loss Recognize     : 1.242683
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.565495

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.656861066818237 sec. =
Valid knn accuracy drums     : 85.43478260869564%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.90830135345459 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.124130010604858 sec. =
Valid knn accuracy piano     : 34.5703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.800084352493286 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.03492259979248 sec. =
Valid knn accuracy residuals : 64.77272727272727%

Valid knn accuracy average   : 52.38183175739057%

                                                                      [AEpoch 174: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.767, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.200]Epoch 174: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190683, 0.190968, 0.189815, 0.194614
Train average loss UNet                 (all)                : 0.766080

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000403, 4.499327, 8.813481
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001827, 4.693183, 7.985579
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002461, 4.890163, 8.261023
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001625, 5.013923, 8.693169
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004092, 5.117975, 8.852951
Train average loss all      (Triplet)                 : 0.002107

== Recognize ==
Train average loss Recognize     : 1.206725
Train average accuracy drums     : 49.579998 %
Train average accuracy bass      : 49.825001 %
Train average accuracy piano     : 49.689999 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 49.869999 %

== Train average loss all : 0.002107

Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]          Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.810, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=1.230, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=1.230, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]  Epoch 175:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.360, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00193, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.360, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=1.280, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=1.280, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.181, Valid/loss_unet_all_step=0.758, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.763, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.524, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185294, 0.188675, 0.190719, 0.205680
Valid average loss UNet                 (all)                : 0.770368

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.154018, 4.802053, 8.415494
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.709545, 6.638621, 6.941439
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.827034, 5.727937, 6.306597
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.528142, 6.258025, 7.764870
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.542930, 6.673470, 7.521983
Valid average loss all      (Triplet)                 : 0.566861

== Recognize ==
Valid average loss Recognize     : 1.255010
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.566861

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.855583906173706 sec. =
Valid knn accuracy drums     : 81.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.464006185531616 sec. =
Valid knn accuracy bass      : 20.161290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.758886337280273 sec. =
Valid knn accuracy piano     : 37.6953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.683058738708496 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2292869091033936 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 52.05296935051275%

                                                                      [AEpoch 175: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.210]Epoch 175: 100%|██████████| 313/313 [05:36<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190051, 0.190333, 0.189205, 0.194780
Train average loss UNet                 (all)                : 0.764369

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000877, 4.564365, 8.798813
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002934, 4.831844, 8.127492
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001762, 4.917177, 8.304958
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001463, 5.056225, 8.739288
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003054, 5.197221, 8.965047
Train average loss all      (Triplet)                 : 0.002078

== Recognize ==
Train average loss Recognize     : 1.205571
Train average accuracy drums     : 50.000000 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 49.380001 %
Train average accuracy guitar    : 50.269997 %
Train average accuracy residuals : 50.540001 %

== Train average loss all : 0.002078

Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]          Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=1.250, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=1.250, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]  Epoch 176:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00686, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=1.220, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.00686, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=1.220, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]    Epoch 176:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00692, Train/loss_recog_step=1.190, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.00692, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.00692, Train/loss_recog_step=1.190, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.798, Valid/loss_triplet_all_step=0.311, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185012, 0.188407, 0.190505, 0.188758
Valid average loss UNet                 (all)                : 0.752682

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.172204, 4.689138, 7.707800
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.730151, 6.081760, 6.564614
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.868069, 5.623935, 5.860800
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.514101, 5.908268, 7.439342
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.431852, 6.411062, 7.897331
Valid average loss all      (Triplet)                 : 0.537431

== Recognize ==
Valid average loss Recognize     : 1.258691
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.537431

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.150495052337646 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.387352466583252 sec. =
Valid knn accuracy bass      : 25.60483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.087804317474365 sec. =
Valid knn accuracy piano     : 38.4765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.848035335540771 sec. =
Valid knn accuracy guitar    : 50.22321428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.13223934173584 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 53.05657527299138%

                                                                      [AEpoch 176: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00208, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00208, Train/loss_recog_epoch=1.210]Epoch 176: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190029, 0.190353, 0.189205, 0.194548
Train average loss UNet                 (all)                : 0.764134

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001231, 4.549222, 8.610304
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003861, 4.891076, 8.219037
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001886, 4.883213, 8.258876
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002554, 5.146580, 8.966962
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002992, 5.232053, 9.017330
Train average loss all      (Triplet)                 : 0.002472

== Recognize ==
Train average loss Recognize     : 1.207456
Train average accuracy drums     : 49.520000 %
Train average accuracy bass      : 50.279999 %
Train average accuracy piano     : 50.449997 %
Train average accuracy guitar    : 49.900002 %
Train average accuracy residuals : 49.785000 %

== Train average loss all : 0.002472

Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]          Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.814, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.125, Valid/loss_unet_all_step=0.736, Valid/loss_triplet_all_step=0.125, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.537, Valid/loss_unet_all_epoch=0.753, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185427, 0.188881, 0.191034, 0.194956
Valid average loss UNet                 (all)                : 0.760298

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130600, 4.791496, 8.361312
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.774221, 6.147178, 6.529971
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.867910, 5.816491, 6.233766
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.436563, 5.944053, 7.638081
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.532397, 6.608603, 7.487594
Valid average loss all      (Triplet)                 : 0.558429

== Recognize ==
Valid average loss Recognize     : 1.283561
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 44.500000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.558429

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.431031227111816 sec. =
Valid knn accuracy drums     : 85.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.227206230163574 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.05600643157959 sec. =
Valid knn accuracy piano     : 37.890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.588594913482666 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.510205984115601 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 52.10946664222874%

                                                                      [AEpoch 177: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00247, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00247, Train/loss_recog_epoch=1.210]Epoch 177: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189886, 0.190186, 0.189075, 0.194549
Train average loss UNet                 (all)                : 0.763695

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000554, 4.616206, 8.850435
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002001, 4.917355, 8.303679
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004077, 5.021821, 8.450682
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003350, 5.330219, 9.260312
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002127, 5.363567, 9.311885
Train average loss all      (Triplet)                 : 0.002369

== Recognize ==
Train average loss Recognize     : 1.215213
Train average accuracy drums     : 50.125004 %
Train average accuracy bass      : 49.314999 %
Train average accuracy piano     : 49.810001 %
Train average accuracy guitar    : 49.384998 %
Train average accuracy residuals : 49.665001 %

== Train average loss all : 0.002369

Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]          Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00164, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.210, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00164, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.210, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]    Epoch 178:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.789, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00236, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=1.170, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00236, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=1.170, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.160, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]  Epoch 178:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.160, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]  Epoch 178: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.242, Valid/loss_unet_all_step=0.765, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.558, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.521, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.61it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185593, 0.188976, 0.191006, 0.205310
Valid average loss UNet                 (all)                : 0.770884

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072244, 4.975484, 8.643292
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.702993, 6.499753, 7.038013
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.725746, 5.958554, 6.595247
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.347675, 5.989183, 8.034401
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.567938, 6.941671, 7.918961
Valid average loss all      (Triplet)                 : 0.490797

== Recognize ==
Valid average loss Recognize     : 1.215431
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.490797

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.869331359863281 sec. =
Valid knn accuracy drums     : 88.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.163694620132446 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.770182847976685 sec. =
Valid knn accuracy piano     : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.885246753692627 sec. =
Valid knn accuracy guitar    : 54.6875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.715834856033325 sec. =
Valid knn accuracy residuals : 66.81818181818183%

Valid knn accuracy average   : 54.25485305367843%

                                                                      [AEpoch 178: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00237, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.220]Epoch 178: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190077, 0.190365, 0.189235, 0.194667
Train average loss UNet                 (all)                : 0.764344

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000718, 4.689476, 9.320383
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002379, 4.904130, 8.296090
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003428, 5.019573, 8.477015
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001417, 5.279501, 9.269145
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002761, 5.437805, 9.403542
Train average loss all      (Triplet)                 : 0.002121

== Recognize ==
Train average loss Recognize     : 1.207298
Train average accuracy drums     : 49.669998 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 49.919998 %
Train average accuracy guitar    : 49.829998 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.002121

Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]          Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.0392, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.00303, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=1.340, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.00303, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=1.340, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]    Epoch 179:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.747, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=1.280, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=1.280, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]  Epoch 179:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.220, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.0148, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.220, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.802, Valid/loss_triplet_all_step=0.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.76it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185955, 0.189363, 0.191495, 0.207768
Valid average loss UNet                 (all)                : 0.774580

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142596, 4.834403, 8.709351
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.916554, 6.629324, 6.742200
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.892717, 5.817830, 6.259968
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.394907, 6.178071, 7.776539
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.475990, 6.505633, 7.303943
Valid average loss all      (Triplet)                 : 0.600766

== Recognize ==
Valid average loss Recognize     : 1.205044
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.600766

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.963842153549194 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.421520233154297 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.801471710205078 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.435292959213257 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.988020181655884 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 54.84359674117958%

                                                                      [AEpoch 179: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.210]Epoch 179: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190255, 0.190541, 0.189403, 0.193919
Train average loss UNet                 (all)                : 0.764118

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000368, 4.677297, 8.983230
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003622, 5.001504, 8.408520
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005387, 5.076867, 8.444057
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001315, 5.244014, 9.170545
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004325, 5.451730, 9.291659
Train average loss all      (Triplet)                 : 0.002963

== Recognize ==
Train average loss Recognize     : 1.219367
Train average accuracy drums     : 49.520000 %
Train average accuracy bass      : 49.720001 %
Train average accuracy piano     : 49.814999 %
Train average accuracy guitar    : 50.190002 %
Train average accuracy residuals : 49.139999 %

== Train average loss all : 0.002963

Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]          Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.805, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.601, Valid/loss_unet_all_epoch=0.775, Valid/loss_triplet_all_epoch=0.601, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185905, 0.189370, 0.191442, 0.203836
Valid average loss UNet                 (all)                : 0.770554

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143623, 4.682188, 8.353523
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.069662, 6.699796, 6.663525
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.739253, 5.547635, 6.168477
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.539252, 5.929762, 7.511450
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.771578, 6.599583, 7.189800
Valid average loss all      (Triplet)                 : 0.697208

== Recognize ==
Valid average loss Recognize     : 1.252497
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 42.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.697208

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.416642665863037 sec. =
Valid knn accuracy drums     : 82.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.505808353424072 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.055746078491211 sec. =
Valid knn accuracy piano     : 38.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.58069109916687 sec. =
Valid knn accuracy guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.829284191131592 sec. =
Valid knn accuracy residuals : 65.68181818181819%

Valid knn accuracy average   : 52.174748353855115%

                                                                      [AEpoch 180: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00296, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00296, Train/loss_recog_epoch=1.220]Epoch 180: 100%|██████████| 313/313 [05:37<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190370, 0.190666, 0.189510, 0.195115
Train average loss UNet                 (all)                : 0.765661

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000831, 4.617108, 9.086874
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005442, 4.836780, 8.114677
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003539, 4.885157, 8.267238
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002837, 5.149961, 9.044744
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001578, 5.273206, 9.151178
Train average loss all      (Triplet)                 : 0.002765

== Recognize ==
Train average loss Recognize     : 1.209843
Train average accuracy drums     : 50.040001 %
Train average accuracy bass      : 49.239998 %
Train average accuracy piano     : 49.610001 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 50.309998 %

== Train average loss all : 0.002765

Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]          Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.00384, Train/loss_unet_all_step=0.800, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]    Epoch 181:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=1.330, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00758, Train/loss_unet_all_step=0.744, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=1.330, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00216, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00216, Train/loss_recog_step=1.230, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.00216, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.00216, Train/loss_recog_step=1.230, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.820, Valid/loss_unet_all_step=0.803, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.771, Valid/loss_triplet_all_epoch=0.697, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.522, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185943, 0.189321, 0.191365, 0.197665
Valid average loss UNet                 (all)                : 0.764294

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098578, 4.725332, 8.438771
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.943377, 6.944308, 6.999702
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.835235, 5.627930, 6.125014
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.509441, 5.956240, 7.651477
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.608146, 6.873476, 7.683174
Valid average loss all      (Triplet)                 : 0.626782

== Recognize ==
Valid average loss Recognize     : 1.189524
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 58.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.626782

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.243205785751343 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.539497137069702 sec. =
Valid knn accuracy bass      : 31.451612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.304453134536743 sec. =
Valid knn accuracy piano     : 43.9453125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.460790157318115 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.203667640686035 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 56.02394323987723%

                                                                      [AEpoch 181: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.210]Epoch 181: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190188, 0.190489, 0.189355, 0.194478
Train average loss UNet                 (all)                : 0.764511

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000597, 4.625530, 9.124684
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003949, 4.931812, 8.324503
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002347, 4.902179, 8.275874
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003822, 5.210260, 9.153458
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003206, 5.367360, 9.254396
Train average loss all      (Triplet)                 : 0.002822

== Recognize ==
Train average loss Recognize     : 1.199520
Train average accuracy drums     : 49.849998 %
Train average accuracy bass      : 50.255001 %
Train average accuracy piano     : 50.524998 %
Train average accuracy guitar    : 50.160004 %
Train average accuracy residuals : 50.120003 %

== Train average loss all : 0.002822

Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]          Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=1.240, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=1.240, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]  Epoch 182:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.761, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00207, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00207, Train/loss_recog_step=1.210, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00207, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00207, Train/loss_recog_step=1.210, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]    Epoch 182: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.627, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.560, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.20it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185988, 0.189417, 0.191382, 0.200719
Valid average loss UNet                 (all)                : 0.767507

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077239, 4.732973, 8.438315
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.032079, 6.978455, 6.915722
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.931761, 5.882145, 6.355058
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.543160, 6.088757, 8.091829
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.633795, 6.781323, 8.117781
Valid average loss all      (Triplet)                 : 0.683907

== Recognize ==
Valid average loss Recognize     : 1.104019
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.683907

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8166937828063965 sec. =
Valid knn accuracy drums     : 80.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.262614488601685 sec. =
Valid knn accuracy bass      : 29.03225806451613%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.425373077392578 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.433449983596802 sec. =
Valid knn accuracy guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.181672811508179 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 52.92212160866833%

                                                                      [AEpoch 182: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=1.200]Epoch 182: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190040, 0.190340, 0.189205, 0.194117
Train average loss UNet                 (all)                : 0.763702

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000562, 4.702000, 9.156920
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002439, 5.043740, 8.567712
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002676, 4.992283, 8.500887
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001838, 5.295691, 9.379418
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002095, 5.489089, 9.555752
Train average loss all      (Triplet)                 : 0.001947

== Recognize ==
Train average loss Recognize     : 1.210075
Train average accuracy drums     : 50.105000 %
Train average accuracy bass      : 50.255001 %
Train average accuracy piano     : 50.209999 %
Train average accuracy guitar    : 49.715000 %
Train average accuracy residuals : 49.625000 %

== Train average loss all : 0.001947

Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]          Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.811, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0047, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0047, Train/loss_recog_step=1.230, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.0047, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.0047, Train/loss_recog_step=1.230, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]  Epoch 183:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=1.230, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=1.230, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.549, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.549, Valid/loss_recog_step=0.753, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.684, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.529, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.94it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.61it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.92it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185646, 0.189016, 0.191065, 0.190470
Valid average loss UNet                 (all)                : 0.756197

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099400, 4.807283, 8.669010
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.025107, 7.143208, 7.104135
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.829007, 5.875355, 6.596669
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.575600, 6.143312, 8.010715
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.647587, 6.820982, 7.915647
Valid average loss all      (Triplet)                 : 0.678951

== Recognize ==
Valid average loss Recognize     : 1.245150
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.678951

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.368685007095337 sec. =
Valid knn accuracy drums     : 79.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.180172204971313 sec. =
Valid knn accuracy bass      : 32.056451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.644840478897095 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.49945330619812 sec. =
Valid knn accuracy guitar    : 47.098214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.075529098510742 sec. =
Valid knn accuracy residuals : 65.45454545454545%

Valid knn accuracy average   : 53.2679699880239%

                                                                      [AEpoch 183: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.00195, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.210]Epoch 183: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]    

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189886, 0.190170, 0.189051, 0.194864
Train average loss UNet                 (all)                : 0.763970

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000651, 4.844256, 9.305363
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003413, 5.100708, 8.631329
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001392, 5.135479, 8.720230
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002992, 5.446167, 9.646608
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001262, 5.496838, 9.684836
Train average loss all      (Triplet)                 : 0.001999

== Recognize ==
Train average loss Recognize     : 1.213008
Train average accuracy drums     : 50.295002 %
Train average accuracy bass      : 49.904999 %
Train average accuracy piano     : 49.764999 %
Train average accuracy guitar    : 49.875000 %
Train average accuracy residuals : 50.185001 %

== Train average loss all : 0.001999

Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]          Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00763, Train/loss_recog_step=1.140, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.00763, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.00763, Train/loss_recog_step=1.140, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]    Epoch 184:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=1.050, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=1.050, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.584, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.756, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.533, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.62it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185542, 0.188992, 0.190774, 0.192270
Valid average loss UNet                 (all)                : 0.757578

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130580, 4.792231, 8.439933
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.957875, 7.004739, 6.986448
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.854662, 6.028793, 6.620918
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.513380, 6.125562, 8.050268
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.583110, 6.898251, 8.155853
Valid average loss all      (Triplet)                 : 0.638351

== Recognize ==
Valid average loss Recognize     : 1.322621
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.638351

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.330459356307983 sec. =
Valid knn accuracy drums     : 80.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.128812074661255 sec. =
Valid knn accuracy bass      : 26.61290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.585580825805664 sec. =
Valid knn accuracy piano     : 35.7421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.540003061294556 sec. =
Valid knn accuracy guitar    : 54.24107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.755070924758911 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 52.995121758938815%

                                                                      [AEpoch 184: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.002, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.210]Epoch 184: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190149, 0.190451, 0.189333, 0.194916
Train average loss UNet                 (all)                : 0.764849

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000334, 4.720704, 9.035098
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001655, 4.980726, 8.481932
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001944, 5.031682, 8.552981
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002938, 5.326997, 9.358047
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001855, 5.502298, 9.624804
Train average loss all      (Triplet)                 : 0.001801

== Recognize ==
Train average loss Recognize     : 1.207302
Train average accuracy drums     : 50.300003 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 50.419998 %
Train average accuracy guitar    : 49.785000 %
Train average accuracy residuals : 50.190002 %

== Train average loss all : 0.001801

Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]          Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.765, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=1.250, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00411, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=1.250, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]    Epoch 185:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0019, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=1.110, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0019, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=1.110, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.752, Valid/loss_triplet_all_step=0.405, Valid/loss_recog_step=1.540, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.638, Valid/loss_recog_epoch=1.320, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184541, 0.187934, 0.189692, 0.192027
Valid average loss UNet                 (all)                : 0.754194

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110657, 5.030765, 8.926112
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.860719, 7.059813, 7.154046
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.826300, 6.051919, 6.951937
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.636696, 6.246844, 7.944214
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.721306, 7.083829, 7.945339
Valid average loss all      (Triplet)                 : 0.659237

== Recognize ==
Valid average loss Recognize     : 1.295907
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.659237

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.631679773330688 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.89457631111145 sec. =
Valid knn accuracy bass      : 30.443548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.26130747795105 sec. =
Valid knn accuracy piano     : 40.0390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.072364091873169 sec. =
Valid knn accuracy guitar    : 52.23214285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.811977863311768 sec. =
Valid knn accuracy residuals : 66.5909090909091%

Valid knn accuracy average   : 54.55678474094279%

                                                                      [AEpoch 185: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.210]Epoch 185: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189822, 0.190114, 0.189005, 0.194784
Train average loss UNet                 (all)                : 0.763725

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000386, 4.823984, 9.203173
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003558, 5.117219, 8.662133
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000705, 5.106998, 8.653086
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001596, 5.359043, 9.401443
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002489, 5.542799, 9.620501
Train average loss all      (Triplet)                 : 0.001822

== Recognize ==
Train average loss Recognize     : 1.206012
Train average accuracy drums     : 50.550003 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 50.209999 %
Train average accuracy guitar    : 50.050003 %
Train average accuracy residuals : 50.465000 %

== Train average loss all : 0.001822

Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]          Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.140, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.140, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]  Epoch 186:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=1.310, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=1.310, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.751, Valid/loss_triplet_all_step=0.436, Valid/loss_recog_step=1.480, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.659, Valid/loss_recog_epoch=1.300, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185628, 0.188982, 0.191156, 0.198588
Valid average loss UNet                 (all)                : 0.764353

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076311, 4.816206, 8.529667
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.133185, 7.256111, 7.094886
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.877576, 5.770260, 6.458827
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.489198, 6.158221, 8.263395
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.850122, 6.874848, 7.354650
Valid average loss all      (Triplet)                 : 0.746307

== Recognize ==
Valid average loss Recognize     : 1.239728
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.746307

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.345057010650635 sec. =
Valid knn accuracy drums     : 80.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.962951183319092 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.874236106872559 sec. =
Valid knn accuracy piano     : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.26287317276001 sec. =
Valid knn accuracy guitar    : 51.11607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.147052764892578 sec. =
Valid knn accuracy residuals : 67.5%

Valid knn accuracy average   : 53.354788619515126%

                                                                      [AEpoch 186: 100%|██████████| 313/313 [05:39<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00182, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.210]Epoch 186: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189852, 0.190139, 0.189035, 0.195040
Train average loss UNet                 (all)                : 0.764066

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000444, 4.811784, 9.234786
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003116, 5.142757, 8.674168
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005586, 5.087726, 8.677418
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002115, 5.390307, 9.447516
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001846, 5.602861, 9.766060
Train average loss all      (Triplet)                 : 0.002663

== Recognize ==
Train average loss Recognize     : 1.210888
Train average accuracy drums     : 49.950001 %
Train average accuracy bass      : 50.555004 %
Train average accuracy piano     : 49.669998 %
Train average accuracy guitar    : 50.209999 %
Train average accuracy residuals : 50.435001 %

== Train average loss all : 0.002663

Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]          Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.794, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.00184, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=1.230, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.00184, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=1.230, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]    Epoch 187:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.0099, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0099, Train/loss_recog_step=1.200, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0099, Train/loss_unet_all_step=0.741, Train/loss_triplet_all_step=0.0099, Train/loss_recog_step=1.200, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]  Epoch 187: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.669, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.746, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.71it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184898, 0.188298, 0.190190, 0.204644
Valid average loss UNet                 (all)                : 0.768030

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101788, 4.972006, 8.792006
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.837102, 6.938311, 7.195477
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.868573, 5.906163, 6.733896
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.405062, 6.219702, 8.098354
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.837977, 7.060582, 7.655005
Valid average loss all      (Triplet)                 : 0.613329

== Recognize ==
Valid average loss Recognize     : 1.143075
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.613329

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.048451900482178 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.516404151916504 sec. =
Valid knn accuracy bass      : 24.798387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.676276206970215 sec. =
Valid knn accuracy piano     : 31.8359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6541831493377686 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.776790380477905 sec. =
Valid knn accuracy residuals : 67.27272727272727%

Valid knn accuracy average   : 52.46037000122949%

                                                                      [AEpoch 187: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00266, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00266, Train/loss_recog_epoch=1.210]Epoch 187: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190048, 0.190344, 0.189200, 0.194307
Train average loss UNet                 (all)                : 0.763899

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000667, 4.787317, 9.207991
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003795, 5.135396, 8.697242
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001472, 5.081133, 8.663176
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001156, 5.364746, 9.444206
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002619, 5.602144, 9.830766
Train average loss all      (Triplet)                 : 0.001992

== Recognize ==
Train average loss Recognize     : 1.210724
Train average accuracy drums     : 49.485001 %
Train average accuracy bass      : 50.590004 %
Train average accuracy piano     : 50.945004 %
Train average accuracy guitar    : 50.330002 %
Train average accuracy residuals : 49.919998 %

== Train average loss all : 0.001992

Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]          Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.320, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0323, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.0323, Train/loss_recog_step=1.320, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.210, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.755, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=1.210, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.219, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.768, Valid/loss_triplet_all_epoch=0.613, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.525, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.57it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.48it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186360, 0.189699, 0.192071, 0.190028
Valid average loss UNet                 (all)                : 0.758158

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090977, 4.842784, 8.559989
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.922990, 6.864163, 7.164608
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.903746, 5.863742, 6.613096
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.506395, 6.193304, 7.980472
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.738138, 6.812586, 8.049938
Valid average loss all      (Triplet)                 : 0.665319

== Recognize ==
Valid average loss Recognize     : 1.229501
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.665319

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.615362882614136 sec. =
Valid knn accuracy drums     : 85.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.393851280212402 sec. =
Valid knn accuracy bass      : 36.895161290322584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.514183044433594 sec. =
Valid knn accuracy piano     : 38.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.690754175186157 sec. =
Valid knn accuracy guitar    : 55.13392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.326406240463257 sec. =
Valid knn accuracy residuals : 70.9090909090909%

Valid knn accuracy average   : 57.53498669764667%

                                                                      [AEpoch 188: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00199, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.210]Epoch 188: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189765, 0.190087, 0.188959, 0.194806
Train average loss UNet                 (all)                : 0.763617

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000546, 4.783758, 9.094979
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002929, 5.262851, 8.892905
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002189, 5.149472, 8.717703
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001795, 5.371496, 9.396819
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002232, 5.616881, 9.799950
Train average loss all      (Triplet)                 : 0.001961

== Recognize ==
Train average loss Recognize     : 1.213481
Train average accuracy drums     : 50.050003 %
Train average accuracy bass      : 50.129997 %
Train average accuracy piano     : 50.110001 %
Train average accuracy guitar    : 50.180000 %
Train average accuracy residuals : 50.070000 %

== Train average loss all : 0.001961

Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]          Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.781, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00174, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=1.180, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00174, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=1.180, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=1.190, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.00362, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=1.190, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.744, Valid/loss_triplet_all_step=0.554, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.758, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.575, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.49it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185382, 0.188712, 0.190939, 0.194888
Valid average loss UNet                 (all)                : 0.759921

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087150, 4.880246, 8.701192
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.756650, 6.552079, 7.029409
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.831869, 5.772308, 6.440525
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.430272, 6.069367, 8.046970
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.711855, 6.795993, 7.729246
Valid average loss all      (Triplet)                 : 0.562007

== Recognize ==
Valid average loss Recognize     : 1.266785
Valid average accuracy drums     : 41.000000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 58.999996 %

== Valid average loss all : 0.562007

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.841652154922485 sec. =
Valid knn accuracy drums     : 85.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.45877194404602 sec. =
Valid knn accuracy bass      : 32.86290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.291177988052368 sec. =
Valid knn accuracy piano     : 40.8203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.72484040260315 sec. =
Valid knn accuracy guitar    : 53.125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.481296062469482 sec. =
Valid knn accuracy residuals : 67.04545454545455%

Valid knn accuracy average   : 55.81421231512176%

                                                                      [AEpoch 189: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00196, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.210]Epoch 189: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190080, 0.190371, 0.189253, 0.194965
Train average loss UNet                 (all)                : 0.764670

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001163, 4.785050, 8.970040
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003983, 5.194337, 8.672338
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004480, 5.095263, 8.559890
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001813, 5.302156, 9.181953
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000608, 5.484380, 9.551031
Train average loss all      (Triplet)                 : 0.002425

== Recognize ==
Train average loss Recognize     : 1.211427
Train average accuracy drums     : 50.209999 %
Train average accuracy bass      : 50.064999 %
Train average accuracy piano     : 49.980000 %
Train average accuracy guitar    : 49.674999 %
Train average accuracy residuals : 50.300003 %

== Train average loss all : 0.002425

Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]          Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.743, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.060, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.745, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.760, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.558, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185713, 0.189085, 0.191262, 0.197984
Valid average loss UNet                 (all)                : 0.764043

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115832, 5.037085, 9.127425
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.585403, 6.914099, 7.652970
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.849411, 5.879891, 6.651146
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.460261, 6.126935, 8.294443
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.739562, 7.029151, 8.429638
Valid average loss all      (Triplet)                 : 0.530904

== Recognize ==
Valid average loss Recognize     : 1.219815
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.530904

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.155774593353271 sec. =
Valid knn accuracy drums     : 83.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.39464807510376 sec. =
Valid knn accuracy bass      : 35.88709677419355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.416580200195312 sec. =
Valid knn accuracy piano     : 36.328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.998703956604004 sec. =
Valid knn accuracy guitar    : 51.33928571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.438328504562378 sec. =
Valid knn accuracy residuals : 69.31818181818183%

Valid knn accuracy average   : 55.27019003524527%

                                                                      [AEpoch 190: 100%|██████████| 313/313 [05:42<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.060, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00242, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00242, Train/loss_recog_epoch=1.210]Epoch 190: 100%|██████████| 313/313 [05:42<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.060, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189857, 0.190161, 0.189019, 0.195041
Train average loss UNet                 (all)                : 0.764078

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000363, 4.816232, 9.299894
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004041, 5.245606, 8.890054
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002097, 5.116446, 8.718170
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002221, 5.333322, 9.372236
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001147, 5.552624, 9.610683
Train average loss all      (Triplet)                 : 0.002145

== Recognize ==
Train average loss Recognize     : 1.214818
Train average accuracy drums     : 50.035000 %
Train average accuracy bass      : 50.285000 %
Train average accuracy piano     : 50.564999 %
Train average accuracy guitar    : 49.965000 %
Train average accuracy residuals : 49.840000 %

== Train average loss all : 0.002145

Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.060, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]          Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.060, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.0421, Train/loss_unet_all_step=0.803, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=1.060, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]  Epoch 191:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.00287, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=1.250, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00287, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=1.250, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=1.300, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.00628, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=1.300, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]    Epoch 191:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00604, Train/loss_recog_step=1.230, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00604, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00604, Train/loss_recog_step=1.230, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]    Epoch 191: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.109, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.109, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.531, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.553, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.184884, 0.188196, 0.190460, 0.190720
Valid average loss UNet                 (all)                : 0.754260

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123833, 4.995015, 8.904404
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.822626, 6.991097, 7.429072
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.010088, 5.914040, 6.858991
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.619286, 6.236310, 7.976502
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.794075, 6.931934, 7.726553
Valid average loss all      (Triplet)                 : 0.701799

== Recognize ==
Valid average loss Recognize     : 1.335896
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.701799

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.957594633102417 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.858008861541748 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.661184310913086 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.89169979095459 sec. =
Valid knn accuracy guitar    : 55.35714285714286%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.1945161819458 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 55.93535779175242%

                                                                      [AEpoch 191: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00214, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00214, Train/loss_recog_epoch=1.210]Epoch 191: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190047, 0.190335, 0.189214, 0.194277
Train average loss UNet                 (all)                : 0.763871

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000353, 4.813257, 9.323049
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001649, 5.261106, 8.994642
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002830, 5.121372, 8.726690
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002152, 5.501177, 9.612847
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002688, 5.648787, 9.761597
Train average loss all      (Triplet)                 : 0.001917

== Recognize ==
Train average loss Recognize     : 1.220969
Train average accuracy drums     : 49.924999 %
Train average accuracy bass      : 50.185001 %
Train average accuracy piano     : 50.080002 %
Train average accuracy guitar    : 50.335003 %
Train average accuracy residuals : 49.654999 %

== Train average loss all : 0.001917

Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]          Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000323, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000323, Train/loss_recog_step=1.220, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000323, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000323, Train/loss_recog_step=1.220, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]      Epoch 192:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00157, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=1.150, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00157, Train/loss_unet_all_step=0.754, Train/loss_triplet_all_step=0.00157, Train/loss_recog_step=1.150, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]    Epoch 192: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000997, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000997, Train/loss_recog_step=1.190, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.757, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.580, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.702, Valid/loss_recog_epoch=1.340, Valid/knn_avr=0.559, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.55it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185228, 0.188671, 0.190714, 0.197549
Valid average loss UNet                 (all)                : 0.762162

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165927, 5.087646, 9.232854
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.718045, 7.084809, 7.711182
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.142734, 6.009647, 6.527545
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.557737, 6.011479, 8.184223
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.755090, 6.994216, 8.283951
Valid average loss all      (Triplet)                 : 0.661024

== Recognize ==
Valid average loss Recognize     : 1.251796
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.661024

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.170760869979858 sec. =
Valid knn accuracy drums     : 83.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.811286211013794 sec. =
Valid knn accuracy bass      : 23.790322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.309924125671387 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.008317232131958 sec. =
Valid knn accuracy guitar    : 52.45535714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.296456098556519 sec. =
Valid knn accuracy residuals : 72.95454545454545%

Valid knn accuracy average   : 54.90390373126173%

                                                                      [AEpoch 192: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000997, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000997, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00192, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.220]Epoch 192: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000997, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000997, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189683, 0.189990, 0.188873, 0.194200
Train average loss UNet                 (all)                : 0.762746

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000415, 4.948233, 9.696938
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003824, 5.257056, 8.875816
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002385, 5.149520, 8.728282
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002803, 5.496077, 9.573467
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001930, 5.714669, 9.893726
Train average loss all      (Triplet)                 : 0.002308

== Recognize ==
Train average loss Recognize     : 1.221746
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 50.099998 %
Train average accuracy piano     : 49.869999 %
Train average accuracy guitar    : 50.029999 %
Train average accuracy residuals : 49.689999 %

== Train average loss all : 0.002308

Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000997, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000997, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]          Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000997, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000997, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000997, Train/loss_unet_all_step=0.799, Train/loss_triplet_all_step=0.000997, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]    Epoch 193:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.280, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.280, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00747, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=1.250, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00747, Train/loss_unet_all_step=0.782, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=1.250, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]    Epoch 193:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=1.260, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00564, Train/loss_unet_all_step=0.738, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=1.260, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=2.2e-5, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=2.2e-5, Train/loss_recog_step=1.220, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]  Epoch 193: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=2.2e-5, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=2.2e-5, Train/loss_recog_step=1.220, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.755, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.661, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.72it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.64it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185803, 0.189213, 0.191189, 0.205549
Valid average loss UNet                 (all)                : 0.771753

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.094594, 5.113458, 9.353468
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.665936, 7.245625, 7.667471
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.083607, 6.107372, 6.701943
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.581746, 6.361224, 8.048638
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.608350, 6.994371, 8.690315
Valid average loss all      (Triplet)                 : 0.599601

== Recognize ==
Valid average loss Recognize     : 1.125690
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.599601

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.676076412200928 sec. =
Valid knn accuracy drums     : 84.34782608695653%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.052797317504883 sec. =
Valid knn accuracy bass      : 25.806451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.725816011428833 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.449548721313477 sec. =
Valid knn accuracy guitar    : 47.098214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.483652353286743 sec. =
Valid knn accuracy residuals : 71.81818181818181%

Valid knn accuracy average   : 54.32975976075116%

                                                                      [AEpoch 193: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00231, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00231, Train/loss_recog_epoch=1.220]Epoch 193: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190233, 0.190523, 0.189404, 0.194955
Train average loss UNet                 (all)                : 0.765115

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000583, 4.958922, 9.606182
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003374, 5.381227, 9.104361
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002015, 5.202328, 8.851374
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002976, 5.534575, 9.652862
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002559, 5.833450, 10.148677
Train average loss all      (Triplet)                 : 0.002376

== Recognize ==
Train average loss Recognize     : 1.220804
Train average accuracy drums     : 50.309998 %
Train average accuracy bass      : 49.489998 %
Train average accuracy piano     : 49.849998 %
Train average accuracy guitar    : 49.415001 %
Train average accuracy residuals : 49.794998 %

== Train average loss all : 0.002376

Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]          Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.762, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]Epoch 194: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0874, Valid/loss_unet_all_step=0.800, Valid/loss_triplet_all_step=0.0874, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.772, Valid/loss_triplet_all_epoch=0.600, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.543, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.04it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.01it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186512, 0.189930, 0.191748, 0.196273
Valid average loss UNet                 (all)                : 0.764464

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087783, 5.257243, 9.431056
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.854457, 7.405127, 7.711681
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.064026, 6.244327, 6.853545
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.565225, 6.275976, 8.399452
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.571831, 6.926529, 8.572971
Valid average loss all      (Triplet)                 : 0.654503

== Recognize ==
Valid average loss Recognize     : 1.293522
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.654503

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.539190053939819 sec. =
Valid knn accuracy drums     : 83.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.877653121948242 sec. =
Valid knn accuracy bass      : 23.991935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.991807460784912 sec. =
Valid knn accuracy piano     : 44.53125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.47648286819458 sec. =
Valid knn accuracy guitar    : 42.410714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2619469165802 sec. =
Valid knn accuracy residuals : 70.45454545454545%

Valid knn accuracy average   : 53.01681947960874%

                                                                      [AEpoch 194: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.00238, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00238, Train/loss_recog_epoch=1.220]  Epoch 194: 100%|██████████| 313/313 [05:42<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190633, 0.190931, 0.189801, 0.194693
Train average loss UNet                 (all)                : 0.766059

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000698, 4.981785, 9.623220
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001441, 5.248409, 8.934394
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002719, 5.229303, 8.914132
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000936, 5.507220, 9.733221
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001340, 5.763652, 10.015987
Train average loss all      (Triplet)                 : 0.001401

== Recognize ==
Train average loss Recognize     : 1.216736
Train average accuracy drums     : 50.199997 %
Train average accuracy bass      : 50.919998 %
Train average accuracy piano     : 49.424999 %
Train average accuracy guitar    : 50.174999 %
Train average accuracy residuals : 50.115002 %

== Train average loss all : 0.001401

Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]          Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.00147, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00147, Train/loss_recog_step=1.310, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.00147, Train/loss_unet_all_step=0.740, Train/loss_triplet_all_step=0.00147, Train/loss_recog_step=1.310, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]    Epoch 195: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.773, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.764, Valid/loss_triplet_all_epoch=0.655, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.530, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.74it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185774, 0.189167, 0.191277, 0.202539
Valid average loss UNet                 (all)                : 0.768757

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050214, 5.022073, 9.138822
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.051900, 7.209940, 7.399401
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.916413, 6.056987, 6.701460
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.607649, 6.096530, 8.108614
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.772306, 7.374901, 8.126452
Valid average loss all      (Triplet)                 : 0.719813

== Recognize ==
Valid average loss Recognize     : 1.215386
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 43.000000 %
Valid average accuracy guitar    : 57.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.719813

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.020774126052856 sec. =
Valid knn accuracy drums     : 84.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.831803798675537 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.781198501586914 sec. =
Valid knn accuracy piano     : 41.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.296370506286621 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.758357286453247 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 53.44229371391231%

                                                                      [AEpoch 195: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.0014, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.220]Epoch 195: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190132, 0.190430, 0.189303, 0.194916
Train average loss UNet                 (all)                : 0.764782

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000275, 4.957479, 9.457586
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001408, 5.270198, 9.028244
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002159, 5.313504, 9.044008
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002168, 5.557016, 9.764800
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002932, 5.789117, 10.042372
Train average loss all      (Triplet)                 : 0.001683

== Recognize ==
Train average loss Recognize     : 1.230073
Train average accuracy drums     : 49.665001 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.085003 %
Train average accuracy guitar    : 49.980000 %
Train average accuracy residuals : 50.470001 %

== Train average loss all : 0.001683

Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]          Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.804, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.771, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.785, Valid/loss_triplet_all_step=0.499, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.534, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.46it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186477, 0.189882, 0.191996, 0.182164
Valid average loss UNet                 (all)                : 0.750519

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120185, 5.085506, 8.853160
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.195712, 7.420530, 7.344886
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.907197, 5.977534, 6.986181
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.496768, 6.370665, 8.661833
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.819168, 7.253006, 8.246248
Valid average loss all      (Triplet)                 : 0.768581

== Recognize ==
Valid average loss Recognize     : 1.288058
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.768581

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.029591083526611 sec. =
Valid knn accuracy drums     : 80.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.131044149398804 sec. =
Valid knn accuracy bass      : 29.838709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.443038702011108 sec. =
Valid knn accuracy piano     : 46.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.56663966178894 sec. =
Valid knn accuracy guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.118452548980713 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 54.894337079470326%

                                                                      [AEpoch 196: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00168, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00168, Train/loss_recog_epoch=1.230]Epoch 196: 100%|██████████| 313/313 [05:40<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189692, 0.189969, 0.188871, 0.194166
Train average loss UNet                 (all)                : 0.762698

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000698, 4.852013, 9.253292
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002435, 5.217241, 8.840123
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001327, 5.203895, 8.825116
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002326, 5.464722, 9.504611
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002424, 5.731048, 9.920385
Train average loss all      (Triplet)                 : 0.001758

== Recognize ==
Train average loss Recognize     : 1.230660
Train average accuracy drums     : 49.669998 %
Train average accuracy bass      : 49.559998 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 50.500000 %
Train average accuracy residuals : 50.085003 %

== Train average loss all : 0.001758

Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]          Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=1.260, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=1.260, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=1.310, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00689, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.00689, Train/loss_recog_step=1.310, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.00515, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00515, Train/loss_recog_step=1.130, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.00515, Train/loss_unet_all_step=0.746, Train/loss_triplet_all_step=0.00515, Train/loss_recog_step=1.130, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.000237, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000237, Train/loss_recog_step=1.130, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000237, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000237, Train/loss_recog_step=1.130, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.645, Valid/loss_unet_all_step=0.729, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.751, Valid/loss_triplet_all_epoch=0.769, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.549, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185813, 0.189254, 0.190906, 0.203834
Valid average loss UNet                 (all)                : 0.769808

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115477, 4.964198, 8.794032
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.018947, 7.128527, 7.213298
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.007186, 5.831231, 6.404097
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.454832, 5.927877, 8.041888
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.658756, 6.811055, 8.297336
Valid average loss all      (Triplet)                 : 0.696155

== Recognize ==
Valid average loss Recognize     : 1.235207
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.696155

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.842651128768921 sec. =
Valid knn accuracy drums     : 84.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.566435098648071 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.90329623222351 sec. =
Valid knn accuracy piano     : 37.3046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.406888246536255 sec. =
Valid knn accuracy guitar    : 47.098214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.697883367538452 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 53.11936016078942%

                                                                      [AEpoch 197: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=1.230]Epoch 197: 100%|██████████| 313/313 [05:38<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190030, 0.190311, 0.189194, 0.194783
Train average loss UNet                 (all)                : 0.764317

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000637, 4.887443, 9.352223
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002901, 5.273403, 8.992251
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003830, 5.335271, 8.902757
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002487, 5.552166, 9.605438
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002100, 5.761792, 9.980366
Train average loss all      (Triplet)                 : 0.002393

== Recognize ==
Train average loss Recognize     : 1.228788
Train average accuracy drums     : 50.209999 %
Train average accuracy bass      : 50.099998 %
Train average accuracy piano     : 50.709999 %
Train average accuracy guitar    : 50.209999 %
Train average accuracy residuals : 49.935001 %

== Train average loss all : 0.002393

Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]          Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.820, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.764, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00762, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00762, Train/loss_recog_step=1.280, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.00762, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.00762, Train/loss_recog_step=1.280, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]    Epoch 198:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.749, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.523, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.531, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185216, 0.188663, 0.190118, 0.206022
Valid average loss UNet                 (all)                : 0.770018

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069615, 5.108434, 9.395504
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.877017, 6.906064, 7.570774
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.886291, 6.153309, 6.724962
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.419488, 6.545356, 8.914490
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.623613, 7.218172, 8.486664
Valid average loss all      (Triplet)                 : 0.589143

== Recognize ==
Valid average loss Recognize     : 1.122687
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.589143

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.422684669494629 sec. =
Valid knn accuracy drums     : 86.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.302947044372559 sec. =
Valid knn accuracy bass      : 29.435483870967744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.606477737426758 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.503085374832153 sec. =
Valid knn accuracy guitar    : 59.59821428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4969916343688965 sec. =
Valid knn accuracy residuals : 69.77272727272728%

Valid knn accuracy average   : 56.99532041196882%

                                                                      [AEpoch 198: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00239, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.230]Epoch 198: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189669, 0.189987, 0.188883, 0.194904
Train average loss UNet                 (all)                : 0.763443

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000655, 4.878903, 9.411762
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003587, 5.204459, 8.878439
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003528, 5.271700, 8.869816
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002953, 5.468231, 9.495378
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002728, 5.604061, 9.679451
Train average loss all      (Triplet)                 : 0.002740

== Recognize ==
Train average loss Recognize     : 1.232166
Train average accuracy drums     : 50.190002 %
Train average accuracy bass      : 49.974998 %
Train average accuracy piano     : 50.580002 %
Train average accuracy guitar    : 49.994999 %
Train average accuracy residuals : 49.709999 %

== Train average loss all : 0.002740

Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]          Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.808, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=1.220, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=1.220, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.00111, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=1.150, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.00111, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=1.150, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]    Epoch 199:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.00249, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=1.240, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.00249, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=1.240, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]    Epoch 199:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.752, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.190, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.00367, Train/loss_unet_all_step=0.751, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.190, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.788, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.822, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.770, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.87it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:02<00:00,  3.44it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185168, 0.188559, 0.190682, 0.196839
Valid average loss UNet                 (all)                : 0.761248

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153424, 5.011377, 8.766272
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.889493, 7.176033, 7.618894
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.817432, 5.853657, 6.910658
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.526677, 6.499966, 8.321475
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.522191, 7.186707, 8.406180
Valid average loss all      (Triplet)                 : 0.631788

== Recognize ==
Valid average loss Recognize     : 1.256634
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 42.000000 %

== Valid average loss all : 0.631788

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.907780170440674 sec. =
Valid knn accuracy drums     : 82.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.014182567596436 sec. =
Valid knn accuracy bass      : 32.45967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.4790940284729 sec. =
Valid knn accuracy piano     : 39.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.775256156921387 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.920934200286865 sec. =
Valid knn accuracy residuals : 65.9090909090909%

Valid knn accuracy average   : 54.56486391413635%

                                                                      [AEpoch 199: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00274, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.230]Epoch 199: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189625, 0.189904, 0.188823, 0.194537
Train average loss UNet                 (all)                : 0.762890

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000130, 5.040640, 9.720297
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004467, 5.410224, 9.232822
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002295, 5.418533, 9.232221
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002115, 5.684886, 10.036561
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001326, 5.855046, 10.089737
Train average loss all      (Triplet)                 : 0.002108

== Recognize ==
Train average loss Recognize     : 1.240218
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 50.244999 %
Train average accuracy piano     : 50.309998 %
Train average accuracy guitar    : 49.669998 %
Train average accuracy residuals : 50.115002 %

== Train average loss all : 0.002108

Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]          Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.788, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.0095, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0095, Train/loss_recog_step=1.180, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0095, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.0095, Train/loss_recog_step=1.180, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]  Epoch 200:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.770, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=1.220, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.787, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=1.220, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]    Epoch 200:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.00291, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00291, Train/loss_recog_step=1.300, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.00291, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.00291, Train/loss_recog_step=1.300, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]    Epoch 200: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.757, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.781, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.546, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.87it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.96it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185099, 0.188499, 0.190524, 0.198034
Valid average loss UNet                 (all)                : 0.762156

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112509, 5.058233, 9.104148
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.033482, 7.491300, 7.608429
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.881191, 6.095287, 7.050590
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.522899, 6.692854, 8.463638
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.539739, 7.436416, 8.415400
Valid average loss all      (Triplet)                 : 0.689458

== Recognize ==
Valid average loss Recognize     : 1.257128
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 42.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.689458

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.83793044090271 sec. =
Valid knn accuracy drums     : 88.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.046531915664673 sec. =
Valid knn accuracy bass      : 30.040322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.633345365524292 sec. =
Valid knn accuracy piano     : 42.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.325485467910767 sec. =
Valid knn accuracy guitar    : 54.46428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.311041355133057 sec. =
Valid knn accuracy residuals : 70.0%

Valid knn accuracy average   : 56.986179811160085%

                                                                      [AEpoch 200: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.00211, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.240]Epoch 200: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190138, 0.190438, 0.189297, 0.194671
Train average loss UNet                 (all)                : 0.764544

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001220, 5.089113, 9.705243
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001366, 5.395928, 9.269937
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001929, 5.445519, 9.299829
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002492, 5.661335, 9.958617
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001547, 5.966979, 10.306600
Train average loss all      (Triplet)                 : 0.001804

== Recognize ==
Train average loss Recognize     : 1.243027
Train average accuracy drums     : 49.619999 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 49.930000 %
Train average accuracy guitar    : 49.965000 %
Train average accuracy residuals : 50.115002 %

== Train average loss all : 0.001804

Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]          Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.801, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.774, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.785, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.750, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.754, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.762, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=1.260, Valid/knn_avr=0.570, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.90it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185316, 0.188756, 0.190821, 0.207695
Valid average loss UNet                 (all)                : 0.772588

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092149, 5.078330, 9.006202
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.074489, 7.424191, 7.544455
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.009202, 5.966346, 6.707644
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.473700, 6.371876, 8.583342
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.534190, 7.482356, 8.364426
Valid average loss all      (Triplet)                 : 0.679937

== Recognize ==
Valid average loss Recognize     : 1.219354
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.679937

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.031211853027344 sec. =
Valid knn accuracy drums     : 86.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.732292890548706 sec. =
Valid knn accuracy bass      : 28.225806451612907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.276502847671509 sec. =
Valid knn accuracy piano     : 39.6484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.295923471450806 sec. =
Valid knn accuracy guitar    : 49.107142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9598774909973145 sec. =
Valid knn accuracy residuals : 66.36363636363637%

Valid knn accuracy average   : 54.06030898230452%

                                                                      [AEpoch 201: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.0018, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.240]Epoch 201: 100%|██████████| 313/313 [05:44<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190325, 0.190624, 0.189478, 0.194384
Train average loss UNet                 (all)                : 0.764812

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000459, 5.097557, 9.672709
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001652, 5.413823, 9.256996
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003675, 5.536618, 9.402605
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002388, 5.726559, 10.041270
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002676, 6.003834, 10.391810
Train average loss all      (Triplet)                 : 0.002073

== Recognize ==
Train average loss Recognize     : 1.249329
Train average accuracy drums     : 49.660000 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 50.265003 %
Train average accuracy guitar    : 49.259998 %
Train average accuracy residuals : 49.520000 %

== Train average loss all : 0.002073

Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]          Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.783, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.769, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.003, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=1.300, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.003, Train/loss_unet_all_step=0.763, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=1.300, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.778, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=1.230, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=1.230, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.027, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=1.240, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]  Epoch 202:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.027, Train/loss_unet_all_step=0.753, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=1.240, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=1.310, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.00622, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.00622, Train/loss_recog_step=1.310, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.789, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.773, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.220, Valid/knn_avr=0.541, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.42it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.186387, 0.189776, 0.192130, 0.185954
Valid average loss UNet                 (all)                : 0.754248

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050937, 5.204764, 8.997847
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.187119, 7.483426, 7.463630
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.909358, 6.256414, 6.955871
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.373068, 6.526491, 8.612307
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.786845, 7.756948, 8.350528
Valid average loss all      (Triplet)                 : 0.719657

== Recognize ==
Valid average loss Recognize     : 1.312603
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.719657

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.400840997695923 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.46133804321289 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.731037855148315 sec. =
Valid knn accuracy piano     : 39.2578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.192113161087036 sec. =
Valid knn accuracy guitar    : 58.25892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.816807985305786 sec. =
Valid knn accuracy residuals : 65.22727272727272%

Valid knn accuracy average   : 54.84683922537841%

                                                                      [AEpoch 202: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00207, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.250]Epoch 202: 100%|██████████| 313/313 [05:45<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190658, 0.190946, 0.189793, 0.194336
Train average loss UNet                 (all)                : 0.765733

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000986, 5.006872, 9.512454
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003775, 5.349274, 9.070015
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000977, 5.345913, 9.098452
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003129, 5.599459, 9.714934
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002158, 5.890364, 10.158843
Train average loss all      (Triplet)                 : 0.002267

== Recognize ==
Train average loss Recognize     : 1.237064
Train average accuracy drums     : 51.005001 %
Train average accuracy bass      : 50.290001 %
Train average accuracy piano     : 50.400002 %
Train average accuracy guitar    : 49.865002 %
Train average accuracy residuals : 49.235001 %

== Train average loss all : 0.002267

Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]          Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.806, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.767, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.784, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.743, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.720, Valid/loss_unet_all_epoch=0.754, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.310, Valid/knn_avr=0.548, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185994, 0.189425, 0.191475, 0.202166
Valid average loss UNet                 (all)                : 0.769061

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069755, 5.063457, 8.842652
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.147393, 7.413069, 7.672976
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.680858, 6.032548, 6.751173
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.422478, 6.572887, 8.717743
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.719630, 7.662758, 8.157761
Valid average loss all      (Triplet)                 : 0.681697

== Recognize ==
Valid average loss Recognize     : 1.287696
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 43.000000 %

== Valid average loss all : 0.681697

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.994222640991211 sec. =
Valid knn accuracy drums     : 83.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.214474439620972 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.069603443145752 sec. =
Valid knn accuracy piano     : 42.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.323359489440918 sec. =
Valid knn accuracy guitar    : 48.88392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2068562507629395 sec. =
Valid knn accuracy residuals : 67.72727272727272%

Valid knn accuracy average   : 54.01423272117083%

                                                                      [AEpoch 203: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00227, Train/loss_unet_all_epoch=0.766, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.240]Epoch 203: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.189858, 0.190158, 0.189018, 0.194445
Train average loss UNet                 (all)                : 0.763478

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000386, 5.039488, 9.602118
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002024, 5.389966, 9.249610
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002156, 5.370315, 9.152254
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001248, 5.568477, 9.744534
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001552, 5.808005, 10.038124
Train average loss all      (Triplet)                 : 0.001433

== Recognize ==
Train average loss Recognize     : 1.249059
Train average accuracy drums     : 49.544998 %
Train average accuracy bass      : 50.155003 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 49.404999 %
Train average accuracy residuals : 49.805000 %

== Train average loss all : 0.001433

Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]          Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.802, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.00214, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=1.250, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.00214, Train/loss_unet_all_step=0.766, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=1.250, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.150, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]  Epoch 204:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.777, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=1.150, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]  Epoch 204:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.776, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.748, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.758, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.772, Valid/loss_unet_all_step=0.796, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.682, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.682, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185190, 0.188638, 0.190577, 0.204613
Valid average loss UNet                 (all)                : 0.769017

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093274, 5.256448, 9.076966
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.105170, 7.526089, 7.678994
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.663788, 6.071610, 7.228656
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.434033, 6.757053, 9.022360
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.537107, 7.828075, 9.008751
Valid average loss all      (Triplet)                 : 0.610058

== Recognize ==
Valid average loss Recognize     : 1.274253
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 58.999996 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.610058

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.342705488204956 sec. =
Valid knn accuracy drums     : 86.08695652173914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.031220436096191 sec. =
Valid knn accuracy bass      : 28.830645161290324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.991655588150024 sec. =
Valid knn accuracy piano     : 41.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.836397647857666 sec. =
Valid knn accuracy guitar    : 48.660714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.232645750045776 sec. =
Valid knn accuracy residuals : 71.13636363636363%

Valid knn accuracy average   : 55.22418592102147%

                                                                      [AEpoch 204: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00143, Train/loss_unet_all_epoch=0.763, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.250]Epoch 204: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190012, 0.190302, 0.189164, 0.194262
Train average loss UNet                 (all)                : 0.763741

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000329, 5.147991, 9.625734
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002831, 5.636198, 9.636055
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000729, 5.492682, 9.347394
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001517, 5.837598, 10.152662
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003217, 5.945313, 10.305722
Train average loss all      (Triplet)                 : 0.001723

== Recognize ==
Train average loss Recognize     : 1.249243
Train average accuracy drums     : 50.720001 %
Train average accuracy bass      : 50.685001 %
Train average accuracy piano     : 50.379997 %
Train average accuracy guitar    : 49.625000 %
Train average accuracy residuals : 49.494999 %

== Train average loss all : 0.001723

Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]          Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.786, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.760, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.0363, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0363, Train/loss_recog_step=1.270, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.0363, Train/loss_unet_all_step=0.775, Train/loss_triplet_all_step=0.0363, Train/loss_recog_step=1.270, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]  Epoch 205:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.793, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.773, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.745, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.756, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.357, Valid/loss_unet_all_step=0.794, Valid/loss_triplet_all_step=0.357, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.769, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.270, Valid/knn_avr=0.552, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  3.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185125, 0.188472, 0.190676, 0.196475
Valid average loss UNet                 (all)                : 0.760748

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080652, 5.112031, 9.490588
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.834325, 7.062862, 7.352780
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.821909, 5.914712, 6.678005
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.492273, 6.363065, 8.201170
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.550741, 7.915316, 8.972827
Valid average loss all      (Triplet)                 : 0.577128

== Recognize ==
Valid average loss Recognize     : 1.253830
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.577128

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.591310024261475 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.342122077941895 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.92540955543518 sec. =
Valid knn accuracy piano     : 40.4296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.720518350601196 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.898145437240601 sec. =
Valid knn accuracy residuals : 67.95454545454545%

Valid knn accuracy average   : 54.030132505555464%

                                                                      [AEpoch 205: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00172, Train/loss_unet_all_epoch=0.764, Train/loss_triplet_all_epoch=0.00172, Train/loss_recog_epoch=1.250]Epoch 205: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190183, 0.190474, 0.189329, 0.194922
Train average loss UNet                 (all)                : 0.764907

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000285, 5.051888, 9.615438
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001462, 5.440614, 9.297297
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002452, 5.336699, 9.006398
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002409, 5.610362, 9.706174
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003667, 5.855639, 10.134819
Train average loss all      (Triplet)                 : 0.002007

== Recognize ==
Train average loss Recognize     : 1.257245
Train average accuracy drums     : 50.099998 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 49.279999 %
Train average accuracy guitar    : 49.955002 %
Train average accuracy residuals : 49.290001 %

== Train average loss all : 0.002007

Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]          Epoch 206:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.791, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.779, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.768, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.772, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.780, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.742, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.759, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.361, Valid/loss_unet_all_step=0.760, Valid/loss_triplet_all_step=0.361, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.577, Valid/loss_unet_all_epoch=0.761, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.540, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.14it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.185751, 0.189111, 0.191094, 0.199571
Valid average loss UNet                 (all)                : 0.765528

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073451, 5.398996, 9.670441
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.159282, 7.599150, 7.429401
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.826348, 6.101602, 6.915730
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.560578, 6.790452, 8.574005
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.463809, 7.547880, 9.312687
Valid average loss all      (Triplet)                 : 0.679396

== Recognize ==
Valid average loss Recognize     : 1.245691
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.679396

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.892535209655762 sec. =
Valid knn accuracy drums     : 81.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.171215295791626 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.439117670059204 sec. =
Valid knn accuracy piano     : 38.28125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.423702478408813 sec. =
Valid knn accuracy guitar    : 60.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.796330690383911 sec. =
Valid knn accuracy residuals : 68.86363636363636%

Valid knn accuracy average   : 55.45133000765012%

                                                                      [AEpoch 206: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.260]Epoch 206: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00169, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.190230, 0.190523, 0.189392, 0.195083
Train average loss UNet                 (all)                : 0.765227

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000306, 5.149436, 9.915204
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002229, 5.520739, 9.426048
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001607, 5.391346, 9.112176
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001663, 5.615272, 9.729730
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002314, 5.975851, 10.352465
Train average loss all      (Triplet)                 : 0.001689

== Recognize ==
Train average loss Recognize     : 1.238590
Train average accuracy drums     : 50.424999 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 50.050003 %
Train average accuracy guitar    : 50.239998 %
Train average accuracy residuals : 50.000000 %

== Train average loss all : 0.001689

Epoch 206: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.795, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.777, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.766, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.555, Train/loss_all_epoch=0.00169, Train/loss_unet_all_epoch=0.765, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.240]
[2023-11-11 06:53:58,469][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 16/16 [00:08<00:00,  1.78it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:11<00:00,  1.32it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:04<00:00,  3.29it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:03<00:00,  3.49it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:03<00:00,  3.94it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:03<00:00,  4.23it/s]
Test average accuracy drums     :  49.599998 %
Test average accuracy bass      :  49.900002 %
Test average accuracy piano     :  51.000000 %
Test average accuracy guitar    :  50.099998 %
Test average accuracy residuals :  46.599998 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.507197856903076 sec. =
Test knn accuracy drums     : 91.37554585152839%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.607683897018433 sec. =
Test knn accuracy bass      : 21.816168327796234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.446162939071655 sec. =
Test knn accuracy piano     : 34.54987834549878%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.760918855667114 sec. =
Test knn accuracy guitar    : 25.904977375565615%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.798932313919067 sec. =
Test knn accuracy residuals : 59.09580193756727%

Test knn accuracy average   : 46.548474367591254%
Testing DataLoader 5: 100%|██████████| 15/15 [01:39<00:00,  0.15it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.46548473834991… │ 0.46548473834991… │ 0.4654847383499… │
│   Test/knn_bass   │ 0.21816168725490… │ 0.21816168725490… │ 0.2181616872549… │
│  Test/knn_drums   │ 0.913755476474762 │ 0.913755476474762 │ 0.9137554764747… │
│  Test/knn_guitar  │ 0.25904977321624… │ 0.25904977321624… │ 0.2590497732162… │
│  Test/knn_piano   │ 0.34549877047538… │ 0.34549877047538… │ 0.3454987704753… │
│ Test/knn_residua… │ 0.59095799922943… │ 0.59095799922943… │ 0.5909579992294… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.46548473834991… │ 0.46548473834991… │ 0.4654847383499… │
│   Test/knn_bass   │ 0.21816168725490… │ 0.21816168725490… │ 0.2181616872549… │
│  Test/knn_drums   │ 0.913755476474762 │ 0.913755476474762 │ 0.9137554764747… │
│  Test/knn_guitar  │ 0.25904977321624… │ 0.25904977321624… │ 0.2590497732162… │
│  Test/knn_piano   │ 0.34549877047538… │ 0.34549877047538… │ 0.3454987704753… │
│ Test/knn_residua… │ 0.59095799922943… │ 0.59095799922943… │ 0.5909579992294… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-11 06:56:44,902][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-10/10-45-08/checkpoints/epoch_106.ckpt
[2023-11-11 06:56:44,904][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-10/10-45-08
[2023-11-11 06:56:44,909][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 20:11:36

All prosess was Done!
