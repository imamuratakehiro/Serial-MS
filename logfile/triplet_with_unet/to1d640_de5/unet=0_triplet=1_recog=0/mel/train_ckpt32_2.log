
=== Using cuda(utils.func). ===

[2023-11-15 15:56:00,037][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-15 15:56:00,042][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 200                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       num_sanity_val_steps: 0                                                 
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       ckpt_model_path: /home/imamura23/nas02home/outputs/pretrain/runs/2023-11
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-15 15:56:00,133][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-15 15:56:00,154][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet_old). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-15 15:56:03,999][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpfeq9s3k0
[2023-11-15 15:56:04,000][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpfeq9s3k0/_remote_module_non_scriptable.py
== Loading pretrained model...
== pretrained model was loaded!
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-15 15:56:06,400][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-15 15:56:06,400][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-15 15:56:06,408][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-15 15:56:06,410][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-15 15:56:06,411][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-15 15:56:06,411][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-15 15:56:06,464][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-15 15:56:06,832][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-15 15:56:07,087][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.582763671875 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s]Epoch 0:  16%|█▌        | 50/313 [01:14<06:32,  0.67it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=2.930]Epoch 0:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=2.930]Epoch 0:  32%|███▏      | 100/313 [02:09<04:36,  0.77it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=2.580]Epoch 0:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=2.580]Epoch 0:  48%|████▊     | 150/313 [03:06<03:22,  0.81it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.440]Epoch 0:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=2.440]Epoch 0:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0661, Train/loss_recog_step=2.250]Epoch 0:  80%|███████▉  | 250/313 [04:58<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0661, Train/loss_recog_step=2.250]Epoch 0:  80%|███████▉  | 250/313 [04:58<01:15,  0.84it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=2.270]  Epoch 0:  96%|█████████▌| 300/313 [05:52<00:15,  0.85it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=2.270]Epoch 0:  96%|█████████▌| 300/313 [05:52<00:15,  0.85it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=2.180]Epoch 0: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=2.180]Epoch 0: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=2.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:05<00:00,  2.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.13it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178903, 0.180384, 0.188119
Valid average loss UNet            (all)              : 0.547407

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055287, 0.372152, 0.752339
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.166208, 0.384150, 0.450800
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.181301, 0.482584, 0.549784
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.115778, 0.520093, 0.715135
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.129497, 0.652133, 0.787919
Valid average loss all      (Triplet)                 : 0.134369

== Recognize ==
Valid average loss Recognize     : 2.189006
Valid average accuracy drums     : 38.666664 %
Valid average accuracy bass      : 4.333333 %
Valid average accuracy piano     : 21.333334 %
Valid average accuracy guitar    : 42.333336 %
Valid average accuracy residuals : 62.666668 %

== Valid average loss all : 0.134369

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 13.381268501281738 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 13.19797658920288 sec. =
Valid knn accuracy bass      : 38.22674418604651%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 14.911831617355347 sec. =
Valid knn accuracy piano     : 60.54054054054055%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 12.342321395874023 sec. =
Valid knn accuracy guitar    : 57.3051948051948%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 12.51723313331604 sec. =
Valid knn accuracy residuals : 81.13207547169812%

Valid knn accuracy average   : 62.91149923599011%

                                                                        [AEpoch 0: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=2.200, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629]Epoch 0: 100%|██████████| 313/313 [08:08<00:00,  0.64it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=2.200, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.185017, 0.185166, 0.184570
Train average loss UNet            (all)              : 0.554753

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.054822, 0.340824, 0.658978
Train average loss bass     (Triplet, dist_p, dist_n) : 0.159267, 0.345472, 0.416407
Train average loss piano    (Triplet, dist_p, dist_n) : 0.150779, 0.476246, 0.566654
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.130727, 0.474774, 0.625740
Train average loss residuals(Triplet, dist_p, dist_n) : 0.118249, 0.615506, 0.794081
Train average loss all      (Triplet)                 : 0.123739

== Recognize ==
Train average loss Recognize     : 2.528323
Train average accuracy drums     : 16.993334 %
Train average accuracy bass      : 4.760000 %
Train average accuracy piano     : 16.573334 %
Train average accuracy guitar    : 29.628334 %
Train average accuracy residuals : 34.825001 %

== Train average loss all : 0.123739

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=2.200, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=2.200, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  16%|█▌        | 50/313 [01:00<05:20,  0.82it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=2.200, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  16%|█▌        | 50/313 [01:00<05:20,  0.82it/s, v_num=0, Train/loss_all_step=0.0938, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0938, Train/loss_recog_step=2.120, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  32%|███▏      | 100/313 [02:00<04:17,  0.83it/s, v_num=0, Train/loss_all_step=0.0938, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0938, Train/loss_recog_step=2.120, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  32%|███▏      | 100/313 [02:00<04:17,  0.83it/s, v_num=0, Train/loss_all_step=0.0713, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0713, Train/loss_recog_step=2.000, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  48%|████▊     | 150/313 [02:56<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.0713, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0713, Train/loss_recog_step=2.000, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  48%|████▊     | 150/313 [02:56<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.870, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]  Epoch 1:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.870, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=1.810, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.0348, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=1.810, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.061, Train/loss_recog_step=1.740, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]  Epoch 1:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.061, Train/loss_recog_step=1.740, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.0897, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.0897, Train/loss_recog_step=1.740, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0897, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.0897, Train/loss_recog_step=1.740, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.720, Valid/loss_all_step=0.163, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=2.170, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=2.190, Valid/knn_avr=0.629, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.43it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.65it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.73it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178958, 0.180409, 0.188236
Valid average loss UNet            (all)              : 0.547603

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049330, 0.504964, 0.958554
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.158884, 0.544469, 0.648860
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.215527, 0.664939, 0.702643
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.111173, 0.671152, 0.935851
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.112897, 0.832706, 1.015791
Valid average loss all      (Triplet)                 : 0.133767

== Recognize ==
Valid average loss Recognize     : 1.733877
Valid average accuracy drums     : 8.000000 %
Valid average accuracy bass      : 2.333333 %
Valid average accuracy piano     : 83.666664 %
Valid average accuracy guitar    : 31.666666 %
Valid average accuracy residuals : 25.000000 %

== Valid average loss all : 0.133767

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.865085363388062 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.264016389846802 sec. =
Valid knn accuracy bass      : 43.02325581395349%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.431232929229736 sec. =
Valid knn accuracy piano     : 61.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.404713153839111 sec. =
Valid knn accuracy guitar    : 56.493506493506494%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.760037422180176 sec. =
Valid knn accuracy residuals : 83.9622641509434%

Valid knn accuracy average   : 65.25065425829435%

                                                                        [AEpoch 1: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.720, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=2.530]Epoch 1: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.720, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184902, 0.185049, 0.184476
Train average loss UNet            (all)              : 0.554427

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.027417, 0.440580, 0.898670
Train average loss bass     (Triplet, dist_p, dist_n) : 0.114709, 0.470481, 0.630096
Train average loss piano    (Triplet, dist_p, dist_n) : 0.101664, 0.600183, 0.784075
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.089738, 0.583909, 0.831659
Train average loss residuals(Triplet, dist_p, dist_n) : 0.077264, 0.737974, 1.004552
Train average loss all      (Triplet)                 : 0.082836

== Recognize ==
Train average loss Recognize     : 1.907257
Train average accuracy drums     : 50.671665 %
Train average accuracy bass      : 47.745003 %
Train average accuracy piano     : 57.458336 %
Train average accuracy guitar    : 49.360001 %
Train average accuracy residuals : 44.861664 %

== Train average loss all : 0.082836

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.720, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.720, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  16%|█▌        | 50/313 [01:00<05:17,  0.83it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0726, Train/loss_recog_step=1.720, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  16%|█▌        | 50/313 [01:00<05:17,  0.83it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.600, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  32%|███▏      | 100/313 [01:55<04:05,  0.87it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0583, Train/loss_recog_step=1.600, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  32%|███▏      | 100/313 [01:55<04:05,  0.87it/s, v_num=0, Train/loss_all_step=0.0412, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0412, Train/loss_recog_step=1.500, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  48%|████▊     | 150/313 [02:51<03:06,  0.87it/s, v_num=0, Train/loss_all_step=0.0412, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0412, Train/loss_recog_step=1.500, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  48%|████▊     | 150/313 [02:51<03:06,  0.87it/s, v_num=0, Train/loss_all_step=0.0816, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0816, Train/loss_recog_step=1.430, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  64%|██████▍   | 200/313 [03:47<02:08,  0.88it/s, v_num=0, Train/loss_all_step=0.0816, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0816, Train/loss_recog_step=1.430, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  64%|██████▍   | 200/313 [03:47<02:08,  0.88it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=1.420, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=1.420, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.0332, Train/loss_recog_step=1.390, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  96%|█████████▌| 300/313 [05:39<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.0332, Train/loss_recog_step=1.390, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2:  96%|█████████▌| 300/313 [05:39<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.039, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=1.390, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]  Epoch 2: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.039, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.039, Train/loss_recog_step=1.390, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.320, Valid/loss_all_step=0.147, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.740, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.653, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.00it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178930, 0.180363, 0.188119
Valid average loss UNet            (all)              : 0.547412

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.040465, 0.709708, 1.289435
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.158803, 0.749011, 0.888932
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.234827, 0.926952, 0.988594
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.096578, 0.905675, 1.251548
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.130178, 1.051752, 1.301025
Valid average loss all      (Triplet)                 : 0.133711

== Recognize ==
Valid average loss Recognize     : 1.347109
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 93.666664 %
Valid average accuracy guitar    : 84.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.133711

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.945698738098145 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.73034381866455 sec. =
Valid knn accuracy bass      : 41.56976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.864246606826782 sec. =
Valid knn accuracy piano     : 60.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.812971353530884 sec. =
Valid knn accuracy guitar    : 57.7922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.798497915267944 sec. =
Valid knn accuracy residuals : 83.80503144654088%

Valid knn accuracy average   : 64.91321055710752%

                                                                        [AEpoch 2: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.320, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0828, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0828, Train/loss_recog_epoch=1.910]Epoch 2: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.320, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184871, 0.185015, 0.184442
Train average loss UNet            (all)              : 0.554328

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012377, 0.606240, 1.180492
Train average loss bass     (Triplet, dist_p, dist_n) : 0.081488, 0.623804, 0.858301
Train average loss piano    (Triplet, dist_p, dist_n) : 0.062267, 0.791641, 1.067589
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.055067, 0.771956, 1.112957
Train average loss residuals(Triplet, dist_p, dist_n) : 0.044107, 0.954042, 1.313356
Train average loss all      (Triplet)                 : 0.051554

== Recognize ==
Train average loss Recognize     : 1.479761
Train average accuracy drums     : 58.749996 %
Train average accuracy bass      : 67.259995 %
Train average accuracy piano     : 62.591667 %
Train average accuracy guitar    : 71.763329 %
Train average accuracy residuals : 81.531670 %

== Train average loss all : 0.051554

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.320, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.320, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.0178, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=1.320, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.0288, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=1.300, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  32%|███▏      | 100/313 [01:56<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.0288, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=1.300, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  32%|███▏      | 100/313 [01:56<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.240, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  48%|████▊     | 150/313 [02:51<03:06,  0.87it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.240, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  48%|████▊     | 150/313 [02:51<03:06,  0.87it/s, v_num=0, Train/loss_all_step=0.0511, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=1.150, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  64%|██████▍   | 200/313 [03:48<02:09,  0.88it/s, v_num=0, Train/loss_all_step=0.0511, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=1.150, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  64%|██████▍   | 200/313 [03:48<02:09,  0.88it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.210, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=1.210, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=1.180, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=1.180, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=1.230, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=1.230, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.140, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.129, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.134, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.134, Valid/loss_recog_epoch=1.350, Valid/knn_avr=0.649, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.88it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.75it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.95it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178957, 0.180395, 0.188141
Valid average loss UNet            (all)              : 0.547493

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041559, 0.912570, 1.590671
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.189345, 0.965885, 1.101053
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.264876, 1.181401, 1.242633
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.092425, 1.164103, 1.610762
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.162610, 1.373120, 1.628332
Valid average loss all      (Triplet)                 : 0.154277

== Recognize ==
Valid average loss Recognize     : 1.180065
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.154277

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.929579973220825 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.180599212646484 sec. =
Valid knn accuracy bass      : 42.00581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.458585739135742 sec. =
Valid knn accuracy piano     : 60.945945945945944%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.043197870254517 sec. =
Valid knn accuracy guitar    : 56.16883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.82549500465393 sec. =
Valid knn accuracy residuals : 79.87421383647799%

Valid knn accuracy average   : 63.53425509859576%

                                                                        [AEpoch 3: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.140, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0516, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0516, Train/loss_recog_epoch=1.480]Epoch 3: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.140, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184852, 0.185006, 0.184437
Train average loss UNet            (all)              : 0.554295

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003646, 0.814321, 1.526257
Train average loss bass     (Triplet, dist_p, dist_n) : 0.048475, 0.827541, 1.155006
Train average loss piano    (Triplet, dist_p, dist_n) : 0.030397, 1.034105, 1.419669
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.025476, 1.020581, 1.481944
Train average loss residuals(Triplet, dist_p, dist_n) : 0.019116, 1.239548, 1.716155
Train average loss all      (Triplet)                 : 0.025812

== Recognize ==
Train average loss Recognize     : 1.237438
Train average accuracy drums     : 93.800003 %
Train average accuracy bass      : 96.463333 %
Train average accuracy piano     : 89.753334 %
Train average accuracy guitar    : 88.806664 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.025812

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.140, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.140, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  16%|█▌        | 50/313 [01:03<05:35,  0.78it/s, v_num=0, Train/loss_all_step=0.00131, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.140, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  16%|█▌        | 50/313 [01:03<05:35,  0.78it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=1.140, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  32%|███▏      | 100/313 [02:00<04:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00826, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=1.140, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  32%|███▏      | 100/313 [02:00<04:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=1.130, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00539, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=1.130, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=1.020, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]    Epoch 4:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=1.020, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00242, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=1.080, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00242, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=1.080, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=1.030, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  96%|█████████▌| 300/313 [05:46<00:15,  0.87it/s, v_num=0, Train/loss_all_step=0.00785, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=1.030, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4:  96%|█████████▌| 300/313 [05:46<00:15,  0.87it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.130, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]  Epoch 4: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.130, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.635, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.56it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179115, 0.180558, 0.188373
Valid average loss UNet            (all)              : 0.548047

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.036320, 1.144380, 1.967583
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.199633, 1.226764, 1.408869
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.254711, 1.474796, 1.569459
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.128814, 1.480015, 1.942423
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.175322, 1.724873, 2.054659
Valid average loss all      (Triplet)                 : 0.163026

== Recognize ==
Valid average loss Recognize     : 1.071753
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.163026

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.11925220489502 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.784890413284302 sec. =
Valid knn accuracy bass      : 41.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.9835946559906 sec. =
Valid knn accuracy piano     : 62.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.37626838684082 sec. =
Valid knn accuracy guitar    : 57.467532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.448131799697876 sec. =
Valid knn accuracy residuals : 79.71698113207547%

Valid knn accuracy average   : 64.64126919309791%

                                                                        [AEpoch 4: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0258, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0258, Train/loss_recog_epoch=1.240]Epoch 4: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184864, 0.185021, 0.184442
Train average loss UNet            (all)              : 0.554327

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000677, 1.031952, 1.916692
Train average loss bass     (Triplet, dist_p, dist_n) : 0.026600, 1.041955, 1.466381
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013332, 1.299637, 1.805449
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011311, 1.280563, 1.862320
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007618, 1.551258, 2.162189
Train average loss all      (Triplet)                 : 0.012131

== Recognize ==
Train average loss Recognize     : 1.109715
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.012131

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.050, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  32%|███▏      | 100/313 [01:58<04:12,  0.84it/s, v_num=0, Train/loss_all_step=0.00146, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.050, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  32%|███▏      | 100/313 [01:58<04:12,  0.84it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00786, Train/loss_recog_step=1.060, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  48%|████▊     | 150/313 [02:55<03:10,  0.86it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00786, Train/loss_recog_step=1.060, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  48%|████▊     | 150/313 [02:55<03:10,  0.86it/s, v_num=0, Train/loss_all_step=7e-5, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=7e-5, Train/loss_recog_step=0.979, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]      Epoch 5:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=7e-5, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=7e-5, Train/loss_recog_step=0.979, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.000954, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000954, Train/loss_recog_step=1.050, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  80%|███████▉  | 250/313 [04:49<01:12,  0.86it/s, v_num=0, Train/loss_all_step=0.000954, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000954, Train/loss_recog_step=1.050, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  80%|███████▉  | 250/313 [04:49<01:12,  0.86it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=0.994, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]  Epoch 5:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00742, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=0.994, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=1.090, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=1.090, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.966, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.163, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.02it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.33it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.02it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178910, 0.180348, 0.188038
Valid average loss UNet            (all)              : 0.547296

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.029672, 1.348027, 2.307234
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.199548, 1.463832, 1.726193
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.267052, 1.713994, 1.836313
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.108298, 1.758635, 2.358075
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.185355, 2.098529, 2.502412
Valid average loss all      (Triplet)                 : 0.158933

== Recognize ==
Valid average loss Recognize     : 1.020921
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.158933

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.446821451187134 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.800346374511719 sec. =
Valid knn accuracy bass      : 46.94767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.274218797683716 sec. =
Valid knn accuracy piano     : 60.945945945945944%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.971134185791016 sec. =
Valid knn accuracy guitar    : 56.81818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.135732889175415 sec. =
Valid knn accuracy residuals : 77.35849056603774%

Valid knn accuracy average   : 64.59052913798932%

                                                                        [AEpoch 5: 100%|██████████| 313/313 [07:50<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.966, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.0121, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.110]Epoch 5: 100%|██████████| 313/313 [07:50<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.966, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184919, 0.185066, 0.184503
Train average loss UNet            (all)              : 0.554489

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000422, 1.228064, 2.290626
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013256, 1.238680, 1.765754
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006715, 1.520487, 2.151401
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005754, 1.520622, 2.233802
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003047, 1.814981, 2.550916
Train average loss all      (Triplet)                 : 0.005998

== Recognize ==
Train average loss Recognize     : 1.054068
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.005998

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.966, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.966, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  16%|█▌        | 50/313 [01:02<05:29,  0.80it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.966, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  16%|█▌        | 50/313 [01:02<05:29,  0.80it/s, v_num=0, Train/loss_all_step=0.00442, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=0.995, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  32%|███▏      | 100/313 [01:58<04:12,  0.84it/s, v_num=0, Train/loss_all_step=0.00442, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=0.995, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  32%|███▏      | 100/313 [01:58<04:12,  0.84it/s, v_num=0, Train/loss_all_step=0.00151, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=1.010, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.00151, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=1.010, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=0.918, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=0.918, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=1.000, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=1.000, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.928, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.928, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=1.040, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00326, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=1.040, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.159, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.646, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.51it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.55it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.79it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178975, 0.180492, 0.188092
Valid average loss UNet            (all)              : 0.547559

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.029051, 1.484758, 2.481039
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.214410, 1.726064, 2.013903
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.297100, 1.990229, 2.126742
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.135637, 2.016657, 2.617498
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.215404, 2.367112, 2.729692
Valid average loss all      (Triplet)                 : 0.180199

== Recognize ==
Valid average loss Recognize     : 0.962564
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.180199

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.81020998954773 sec. =
Valid knn accuracy drums     : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.847591161727905 sec. =
Valid knn accuracy bass      : 42.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.335500955581665 sec. =
Valid knn accuracy piano     : 62.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.73897910118103 sec. =
Valid knn accuracy guitar    : 58.11688311688312%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.836432218551636 sec. =
Valid knn accuracy residuals : 79.71698113207547%

Valid knn accuracy average   : 63.51051892144477%

                                                                        [AEpoch 6: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.006, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.006, Train/loss_recog_epoch=1.050]Epoch 6: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184988, 0.185125, 0.184557
Train average loss UNet            (all)              : 0.554671

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000473, 1.393227, 2.560031
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009104, 1.434617, 2.068516
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004681, 1.744666, 2.477109
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004591, 1.749155, 2.581242
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002770, 2.060954, 2.888370
Train average loss all      (Triplet)                 : 0.004469

== Recognize ==
Train average loss Recognize     : 1.005533
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.004469

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.954, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00505, Train/loss_recog_step=0.954, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00217, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=0.988, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  48%|████▊     | 150/313 [02:56<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00217, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=0.988, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  48%|████▊     | 150/313 [02:56<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00534, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00534, Train/loss_recog_step=0.882, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00534, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00534, Train/loss_recog_step=0.882, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]    Epoch 7:  80%|███████▉  | 250/313 [04:51<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  80%|███████▉  | 250/313 [04:51<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000898, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000898, Train/loss_recog_step=0.893, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  96%|█████████▌| 300/313 [05:48<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000898, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000898, Train/loss_recog_step=0.893, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7:  96%|█████████▌| 300/313 [05:48<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00753, Train/loss_recog_step=1.020, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]  Epoch 7: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00753, Train/loss_recog_step=1.020, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.177, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.180, Valid/loss_recog_epoch=0.963, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.70it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.74it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.15it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179058, 0.180548, 0.188201
Valid average loss UNet            (all)              : 0.547807

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049323, 1.694229, 2.741488
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.282168, 1.892438, 2.158076
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.313178, 2.134975, 2.298357
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.132917, 2.182021, 2.866160
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.210676, 2.509047, 3.013223
Valid average loss all      (Triplet)                 : 0.203723

== Recognize ==
Valid average loss Recognize     : 0.941838
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.203723

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.973746061325073 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.690412282943726 sec. =
Valid knn accuracy bass      : 45.05813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.888124227523804 sec. =
Valid knn accuracy piano     : 59.32432432432433%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.336322546005249 sec. =
Valid knn accuracy guitar    : 60.3896103896104%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.4629065990448 sec. =
Valid knn accuracy residuals : 81.91823899371069%

Valid knn accuracy average   : 64.80865088379994%

                                                                        [AEpoch 7: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00447, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00447, Train/loss_recog_epoch=1.010]Epoch 7: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184927, 0.185079, 0.184506
Train average loss UNet            (all)              : 0.554512

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000593, 1.562050, 2.831672
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007680, 1.626458, 2.357155
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004094, 1.929401, 2.743506
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002972, 1.921904, 2.860506
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002941, 2.280661, 3.211694
Train average loss all      (Triplet)                 : 0.003763

== Recognize ==
Train average loss Recognize     : 0.972369
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003763

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  16%|█▌        | 50/313 [01:03<05:34,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  16%|█▌        | 50/313 [01:03<05:34,  0.79it/s, v_num=0, Train/loss_all_step=0.00219, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.936, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  32%|███▏      | 100/313 [02:00<04:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00219, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.936, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  32%|███▏      | 100/313 [02:00<04:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=0.972, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  48%|████▊     | 150/313 [02:57<03:12,  0.84it/s, v_num=0, Train/loss_all_step=0.00339, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=0.972, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  48%|████▊     | 150/313 [02:57<03:12,  0.84it/s, v_num=0, Train/loss_all_step=0.00842, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00842, Train/loss_recog_step=0.851, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  64%|██████▍   | 200/313 [03:55<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00842, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00842, Train/loss_recog_step=0.851, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  64%|██████▍   | 200/313 [03:55<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.0023, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.943, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]  Epoch 8:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.0023, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.943, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00678, Train/loss_recog_step=0.890, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  96%|█████████▌| 300/313 [05:47<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.00678, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00678, Train/loss_recog_step=0.890, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8:  96%|█████████▌| 300/313 [05:47<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.010, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]  Epoch 8: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.010, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000965, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.873, Valid/loss_all_step=0.216, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.204, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.66it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.87it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.68it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178748, 0.180207, 0.187909
Valid average loss UNet            (all)              : 0.546865

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050638, 1.817528, 2.978290
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.269326, 2.082919, 2.374960
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.308583, 2.255589, 2.440362
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178916, 2.344535, 3.043315
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.240642, 2.693778, 3.161770
Valid average loss all      (Triplet)                 : 0.206857

== Recognize ==
Valid average loss Recognize     : 0.921606
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.206857

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.60224461555481 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.787676572799683 sec. =
Valid knn accuracy bass      : 37.645348837209305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.266663789749146 sec. =
Valid knn accuracy piano     : 55.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.410756826400757 sec. =
Valid knn accuracy guitar    : 56.65584415584416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.546325445175171 sec. =
Valid knn accuracy residuals : 81.28930817610063%

Valid knn accuracy average   : 61.93686017023781%

                                                                        [AEpoch 8: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000965, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.873, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00376, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00376, Train/loss_recog_epoch=0.972]Epoch 8: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000965, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.873, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184905, 0.185053, 0.184490
Train average loss UNet            (all)              : 0.554447

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001284, 1.704144, 3.073076
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006343, 1.751503, 2.561563
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005223, 2.098665, 2.982946
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004018, 2.068272, 3.074502
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002770, 2.443039, 3.454205
Train average loss all      (Triplet)                 : 0.004006

== Recognize ==
Train average loss Recognize     : 0.955781
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.004006

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000965, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.873, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000965, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.873, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  16%|█▌        | 50/313 [01:01<05:23,  0.81it/s, v_num=0, Train/loss_all_step=0.000965, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000965, Train/loss_recog_step=0.873, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  16%|█▌        | 50/313 [01:01<05:23,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]      Epoch 9:  32%|███▏      | 100/313 [01:56<04:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  32%|███▏      | 100/313 [01:56<04:08,  0.86it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=0.960, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  48%|████▊     | 150/313 [02:50<03:05,  0.88it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=0.960, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  48%|████▊     | 150/313 [02:50<03:05,  0.88it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00575, Train/loss_recog_step=0.837, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  64%|██████▍   | 200/313 [03:47<02:08,  0.88it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00575, Train/loss_recog_step=0.837, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  64%|██████▍   | 200/313 [03:47<02:08,  0.88it/s, v_num=0, Train/loss_all_step=0.00227, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.920, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.00227, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=0.920, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.00177, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.851, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  96%|█████████▌| 300/313 [05:40<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00177, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.851, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9:  96%|█████████▌| 300/313 [05:40<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=0.991, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=0.991, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.857, Valid/loss_all_step=0.162, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.162, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.207, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.922, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178558, 0.180022, 0.187586
Valid average loss UNet            (all)              : 0.546167

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051151, 1.978671, 3.258333
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.264518, 2.204618, 2.499546
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.330724, 2.492490, 2.758978
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.182545, 2.449160, 3.205615
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.217065, 2.840492, 3.343232
Valid average loss all      (Triplet)                 : 0.215444

== Recognize ==
Valid average loss Recognize     : 0.906542
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.215444

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.965792894363403 sec. =
Valid knn accuracy drums     : 75.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.769173622131348 sec. =
Valid knn accuracy bass      : 45.348837209302324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.807902812957764 sec. =
Valid knn accuracy piano     : 60.54054054054055%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.003215074539185 sec. =
Valid knn accuracy guitar    : 56.81818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.726557731628418 sec. =
Valid knn accuracy residuals : 79.55974842767296%

Valid knn accuracy average   : 63.54169689325718%

                                                                        [AEpoch 9: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.857, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00401, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00401, Train/loss_recog_epoch=0.956]Epoch 9: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.857, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184928, 0.185069, 0.184503
Train average loss UNet            (all)              : 0.554501

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001555, 1.824500, 3.285545
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005535, 1.873560, 2.755538
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004179, 2.230576, 3.191055
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002522, 2.205006, 3.293726
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003103, 2.601034, 3.686040
Train average loss all      (Triplet)                 : 0.003515

== Recognize ==
Train average loss Recognize     : 0.937348
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003515

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.857, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.857, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  16%|█▌        | 50/313 [01:00<05:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00259, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00259, Train/loss_recog_step=0.857, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  16%|█▌        | 50/313 [01:00<05:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00315, Train/loss_recog_step=0.890, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  32%|███▏      | 100/313 [01:56<04:08,  0.86it/s, v_num=0, Train/loss_all_step=0.00315, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00315, Train/loss_recog_step=0.890, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  32%|███▏      | 100/313 [01:56<04:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]    Epoch 10:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.00941, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00941, Train/loss_recog_step=0.813, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  64%|██████▍   | 200/313 [03:48<02:09,  0.88it/s, v_num=0, Train/loss_all_step=0.00941, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00941, Train/loss_recog_step=0.813, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  64%|██████▍   | 200/313 [03:48<02:09,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]    Epoch 10:  80%|███████▉  | 250/313 [04:43<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  80%|███████▉  | 250/313 [04:43<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  96%|█████████▌| 300/313 [05:38<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10:  96%|█████████▌| 300/313 [05:38<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.967, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.967, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.236, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.236, Valid/loss_recog_step=0.974, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=0.907, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.01it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.50it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178793, 0.180279, 0.187843
Valid average loss UNet            (all)              : 0.546915

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.052050, 2.157403, 3.565117
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.319151, 2.499883, 2.825966
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.485530, 2.817398, 2.878054
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.170251, 2.759007, 3.566675
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255449, 3.167984, 3.688711
Valid average loss all      (Triplet)                 : 0.263313

== Recognize ==
Valid average loss Recognize     : 0.882308
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.263313

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.769841432571411 sec. =
Valid knn accuracy drums     : 78.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.716407537460327 sec. =
Valid knn accuracy bass      : 44.47674418604651%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.790768146514893 sec. =
Valid knn accuracy piano     : 57.432432432432435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.074413061141968 sec. =
Valid knn accuracy guitar    : 57.467532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.374134063720703 sec. =
Valid knn accuracy residuals : 78.77358490566037%

Valid knn accuracy average   : 63.24770585715789%

                                                                        [AEpoch 10: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.00352, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00352, Train/loss_recog_epoch=0.937]Epoch 10: 100%|██████████| 313/313 [07:42<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184844, 0.185001, 0.184422
Train average loss UNet            (all)              : 0.554268

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001142, 2.021589, 3.706153
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005765, 2.063418, 3.014782
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005751, 2.452295, 3.496178
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003924, 2.408435, 3.597340
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003051, 2.838037, 4.028373
Train average loss all      (Triplet)                 : 0.003899

== Recognize ==
Train average loss Recognize     : 0.919915
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003899

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  16%|█▌        | 50/313 [01:01<05:22,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  16%|█▌        | 50/313 [01:01<05:22,  0.82it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.874, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00244, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00244, Train/loss_recog_step=0.874, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00387, Train/loss_recog_step=0.923, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00387, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00387, Train/loss_recog_step=0.923, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]    Epoch 11:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=0.898, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00592, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=0.898, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]    Epoch 11:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.824, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.945, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.882, Valid/knn_avr=0.632, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.90it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.08it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178840, 0.180349, 0.187902
Valid average loss UNet            (all)              : 0.547091

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062673, 2.271988, 3.680387
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.335145, 2.611061, 2.884837
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.445940, 2.903990, 3.010276
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177721, 2.871003, 3.745631
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255001, 3.240385, 3.888735
Valid average loss all      (Triplet)                 : 0.261178

== Recognize ==
Valid average loss Recognize     : 0.867282
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.261178

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.595722675323486 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.848580837249756 sec. =
Valid knn accuracy bass      : 42.00581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.29263687133789 sec. =
Valid knn accuracy piano     : 54.32432432432432%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.727404356002808 sec. =
Valid knn accuracy guitar    : 58.11688311688312%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.883705615997314 sec. =
Valid knn accuracy residuals : 78.77358490566037%

Valid knn accuracy average   : 61.8794153777183%

                                                                        [AEpoch 11: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.824, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.0039, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=0.920]Epoch 11: 100%|██████████| 313/313 [07:44<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.824, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184782, 0.184922, 0.184362
Train average loss UNet            (all)              : 0.554067

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000817, 2.105074, 3.857240
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005923, 2.187571, 3.225050
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004635, 2.595453, 3.704905
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004169, 2.571830, 3.847026
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003297, 3.022152, 4.300535
Train average loss all      (Triplet)                 : 0.003834

== Recognize ==
Train average loss Recognize     : 0.908668
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003834

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.824, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.824, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  16%|█▌        | 50/313 [01:01<05:24,  0.81it/s, v_num=0, Train/loss_all_step=0.00172, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00172, Train/loss_recog_step=0.824, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  16%|█▌        | 50/313 [01:01<05:24,  0.81it/s, v_num=0, Train/loss_all_step=0.00523, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00523, Train/loss_recog_step=0.856, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  32%|███▏      | 100/313 [01:57<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.00523, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00523, Train/loss_recog_step=0.856, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  32%|███▏      | 100/313 [01:57<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]    Epoch 12:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.00232, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.788, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  64%|██████▍   | 200/313 [03:51<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00232, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.788, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  64%|██████▍   | 200/313 [03:51<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00025, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00025, Train/loss_recog_step=0.902, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00025, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00025, Train/loss_recog_step=0.902, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.831, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.831, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00271, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.961, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12: 100%|██████████| 313/313 [05:53<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00271, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.961, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12: 100%|██████████| 313/313 [05:53<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.822, Valid/loss_all_step=0.267, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.936, Valid/loss_all_epoch=0.261, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.619, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.16it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.40it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.85it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.40it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178777, 0.180220, 0.187929
Valid average loss UNet            (all)              : 0.546926

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066280, 2.309392, 3.564757
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.300141, 2.649354, 3.023855
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.391219, 3.015008, 3.170278
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220291, 2.947034, 3.801371
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270335, 3.351102, 3.919887
Valid average loss all      (Triplet)                 : 0.262622

== Recognize ==
Valid average loss Recognize     : 0.871141
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.262622

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.741979122161865 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.530522346496582 sec. =
Valid knn accuracy bass      : 41.424418604651166%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.902991533279419 sec. =
Valid knn accuracy piano     : 59.05405405405405%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.261709451675415 sec. =
Valid knn accuracy guitar    : 58.76623376623377%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.69090723991394 sec. =
Valid knn accuracy residuals : 78.45911949685535%

Valid knn accuracy average   : 63.511353419652984%

                                                                        [AEpoch 12: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.822, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00383, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00383, Train/loss_recog_epoch=0.909]Epoch 12: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.822, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184805, 0.184958, 0.184400
Train average loss UNet            (all)              : 0.554163

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001030, 2.184249, 3.956051
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005401, 2.266083, 3.347306
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005363, 2.707746, 3.890078
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005799, 2.653297, 3.914612
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002312, 3.098588, 4.420747
Train average loss all      (Triplet)                 : 0.003950

== Recognize ==
Train average loss Recognize     : 0.899675
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003950

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.822, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.822, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  16%|█▌        | 50/313 [01:03<05:35,  0.78it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.822, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  16%|█▌        | 50/313 [01:03<05:35,  0.78it/s, v_num=0, Train/loss_all_step=0.000484, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000484, Train/loss_recog_step=0.853, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  32%|███▏      | 100/313 [02:01<04:18,  0.82it/s, v_num=0, Train/loss_all_step=0.000484, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000484, Train/loss_recog_step=0.853, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  32%|███▏      | 100/313 [02:01<04:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00137, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=0.908, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]  Epoch 13:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00137, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=0.908, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000216, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000216, Train/loss_recog_step=0.786, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.000216, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000216, Train/loss_recog_step=0.786, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.886, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]  Epoch 13:  80%|███████▉  | 250/313 [04:49<01:12,  0.86it/s, v_num=0, Train/loss_all_step=0.00127, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.886, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  80%|███████▉  | 250/313 [04:49<01:12,  0.86it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.811, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00594, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00594, Train/loss_recog_step=0.811, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]    Epoch 13: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.360, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.360, Valid/loss_recog_step=0.940, Valid/loss_all_epoch=0.263, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.263, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.635, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.69it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.92it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.56it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178537, 0.179970, 0.187630
Valid average loss UNet            (all)              : 0.546138

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.063550, 2.508992, 3.974265
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.311614, 2.789562, 3.127679
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.423881, 3.126012, 3.368924
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.175658, 3.138948, 4.089108
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.320008, 3.642572, 4.084048
Valid average loss all      (Triplet)                 : 0.265634

== Recognize ==
Valid average loss Recognize     : 0.857778
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.265634

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.776560544967651 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.728931188583374 sec. =
Valid knn accuracy bass      : 46.80232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.797146320343018 sec. =
Valid knn accuracy piano     : 58.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.322706699371338 sec. =
Valid knn accuracy guitar    : 59.9025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.500258207321167 sec. =
Valid knn accuracy residuals : 77.83018867924528%

Valid knn accuracy average   : 64.2297568318527%

                                                                        [AEpoch 13: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.00395, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00395, Train/loss_recog_epoch=0.900]Epoch 13: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184915, 0.185048, 0.184492
Train average loss UNet            (all)              : 0.554455

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002118, 2.311805, 4.154621
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004703, 2.365259, 3.509085
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003225, 2.768354, 4.029592
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003799, 2.757477, 4.128907
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002619, 3.225843, 4.592888
Train average loss all      (Triplet)                 : 0.003299

== Recognize ==
Train average loss Recognize     : 0.893215
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003299

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  16%|█▌        | 50/313 [01:01<05:25,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  16%|█▌        | 50/313 [01:01<05:25,  0.81it/s, v_num=0, Train/loss_all_step=0.00843, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00843, Train/loss_recog_step=0.853, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.00843, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00843, Train/loss_recog_step=0.853, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.908, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.00331, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=0.908, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.00316, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=0.770, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  64%|██████▍   | 200/313 [03:48<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.00316, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=0.770, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  64%|██████▍   | 200/313 [03:48<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.000461, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000461, Train/loss_recog_step=0.876, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000461, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000461, Train/loss_recog_step=0.876, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.806, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]  Epoch 14:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00448, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.806, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=0.946, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14: 100%|██████████| 313/313 [05:53<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00569, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=0.946, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14: 100%|██████████| 313/313 [05:53<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.807, Valid/loss_all_step=0.327, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.327, Valid/loss_recog_step=0.929, Valid/loss_all_epoch=0.266, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.266, Valid/loss_recog_epoch=0.858, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.64it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.87it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178739, 0.180168, 0.187909
Valid average loss UNet            (all)              : 0.546817

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078938, 2.551732, 4.105829
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.317415, 2.898018, 3.310832
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.432276, 3.250468, 3.456356
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184199, 3.190718, 4.251738
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.276936, 3.684999, 4.300054
Valid average loss all      (Triplet)                 : 0.261508

== Recognize ==
Valid average loss Recognize     : 0.853453
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.261508

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.092506647109985 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.742459774017334 sec. =
Valid knn accuracy bass      : 44.18604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.982449531555176 sec. =
Valid knn accuracy piano     : 59.05405405405405%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.000418663024902 sec. =
Valid knn accuracy guitar    : 58.603896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.706685543060303 sec. =
Valid knn accuracy residuals : 78.77358490566037%

Valid knn accuracy average   : 64.03528102093003%

                                                                        [AEpoch 14: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.807, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.0033, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0033, Train/loss_recog_epoch=0.893]Epoch 14: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.807, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184778, 0.184929, 0.184368
Train average loss UNet            (all)              : 0.554075

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001689, 2.424639, 4.387187
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004285, 2.451855, 3.625566
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003613, 2.877044, 4.190987
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004870, 2.889601, 4.325420
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003382, 3.321707, 4.736655
Train average loss all      (Triplet)                 : 0.003559

== Recognize ==
Train average loss Recognize     : 0.886881
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003559

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.807, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.807, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.807, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.000461, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000461, Train/loss_recog_step=0.845, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  32%|███▏      | 100/313 [01:59<04:15,  0.83it/s, v_num=0, Train/loss_all_step=0.000461, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000461, Train/loss_recog_step=0.845, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  32%|███▏      | 100/313 [01:59<04:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00153, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=0.900, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]  Epoch 15:  48%|████▊     | 150/313 [02:57<03:13,  0.84it/s, v_num=0, Train/loss_all_step=0.00153, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00153, Train/loss_recog_step=0.900, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  48%|████▊     | 150/313 [02:57<03:13,  0.84it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.773, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]  Epoch 15:  64%|██████▍   | 200/313 [03:53<02:12,  0.86it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.773, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  64%|██████▍   | 200/313 [03:53<02:12,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]  Epoch 15:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.791, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.791, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.938, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]  Epoch 15: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.938, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.301, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.301, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.262, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.59it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178551, 0.180011, 0.187664
Valid average loss UNet            (all)              : 0.546225

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073274, 2.660813, 4.417810
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.349366, 3.059674, 3.511274
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.357507, 3.289654, 3.544314
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.221053, 3.303214, 4.274860
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.327120, 3.701216, 4.335094
Valid average loss all      (Triplet)                 : 0.269292

== Recognize ==
Valid average loss Recognize     : 0.837245
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.269292

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.181965112686157 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.706052541732788 sec. =
Valid knn accuracy bass      : 45.348837209302324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.741048574447632 sec. =
Valid knn accuracy piano     : 58.648648648648646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.076904058456421 sec. =
Valid knn accuracy guitar    : 58.92857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.607730150222778 sec. =
Valid knn accuracy residuals : 79.87421383647799%

Valid knn accuracy average   : 64.06005422460008%

                                                                        [AEpoch 15: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00356, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=0.887]Epoch 15: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184781, 0.184931, 0.184361
Train average loss UNet            (all)              : 0.554073

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001246, 2.491693, 4.556460
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004720, 2.538507, 3.752445
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004293, 2.968789, 4.323798
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003477, 2.945551, 4.440170
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003444, 3.429069, 4.905092
Train average loss all      (Triplet)                 : 0.003472

== Recognize ==
Train average loss Recognize     : 0.880856
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003472

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  16%|█▌        | 50/313 [01:03<05:33,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  16%|█▌        | 50/313 [01:03<05:33,  0.79it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.827, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  32%|███▏      | 100/313 [02:00<04:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00195, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=0.827, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  32%|███▏      | 100/313 [02:00<04:15,  0.83it/s, v_num=0, Train/loss_all_step=0.00182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.888, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  48%|████▊     | 150/313 [02:56<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.888, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  48%|████▊     | 150/313 [02:56<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00429, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.764, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00429, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.764, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.861, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  80%|███████▉  | 250/313 [04:51<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00376, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.861, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  80%|███████▉  | 250/313 [04:51<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00407, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=0.787, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  96%|█████████▌| 300/313 [05:46<00:15,  0.87it/s, v_num=0, Train/loss_all_step=0.00407, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=0.787, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16:  96%|█████████▌| 300/313 [05:46<00:15,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]    Epoch 16: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=0.913, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.837, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.45it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.55it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.85it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.92it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178736, 0.180263, 0.187796
Valid average loss UNet            (all)              : 0.546794

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070005, 2.643102, 4.334305
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.384743, 3.127499, 3.500908
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.375599, 3.464978, 3.763641
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.227572, 3.450517, 4.509066
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.345757, 3.703345, 4.344221
Valid average loss all      (Triplet)                 : 0.287958

== Recognize ==
Valid average loss Recognize     : 0.830389
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.287958

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.925888061523438 sec. =
Valid knn accuracy drums     : 78.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.820711851119995 sec. =
Valid knn accuracy bass      : 46.656976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.993436574935913 sec. =
Valid knn accuracy piano     : 60.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.94014859199524 sec. =
Valid knn accuracy guitar    : 59.09090909090909%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.368995904922485 sec. =
Valid knn accuracy residuals : 78.45911949685535%

Valid knn accuracy average   : 64.63551871344893%

                                                                        [AEpoch 16: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00347, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00347, Train/loss_recog_epoch=0.881]Epoch 16: 100%|██████████| 313/313 [07:52<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184810, 0.184964, 0.184396
Train average loss UNet            (all)              : 0.554169

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001303, 2.525636, 4.610316
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004164, 2.613617, 3.880226
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003473, 3.069324, 4.472966
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003571, 3.032718, 4.580310
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002793, 3.527066, 5.071453
Train average loss all      (Triplet)                 : 0.003010

== Recognize ==
Train average loss Recognize     : 0.870771
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003010

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=0.820, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  32%|███▏      | 100/313 [02:00<04:17,  0.83it/s, v_num=0, Train/loss_all_step=0.00425, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=0.820, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  32%|███▏      | 100/313 [02:00<04:17,  0.83it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]    Epoch 17:  48%|████▊     | 150/313 [02:56<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  48%|████▊     | 150/313 [02:56<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.754, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00344, Train/loss_recog_step=0.858, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  80%|███████▉  | 250/313 [04:51<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00344, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00344, Train/loss_recog_step=0.858, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  80%|███████▉  | 250/313 [04:51<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.787, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]    Epoch 17:  96%|█████████▌| 300/313 [05:46<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.787, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17:  96%|█████████▌| 300/313 [05:46<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000751, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000751, Train/loss_recog_step=0.929, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000751, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000751, Train/loss_recog_step=0.929, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.777, Valid/loss_all_step=0.318, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.288, Valid/loss_recog_epoch=0.830, Valid/knn_avr=0.646, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  2.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.69it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.01it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178792, 0.180270, 0.187808
Valid average loss UNet            (all)              : 0.546870

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068190, 2.793235, 4.527505
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.367067, 3.202217, 3.666532
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.337658, 3.503283, 3.789051
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184952, 3.578892, 4.703479
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.378159, 3.813350, 4.601529
Valid average loss all      (Triplet)                 : 0.268829

== Recognize ==
Valid average loss Recognize     : 0.827677
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.268829

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.018395900726318 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.56464695930481 sec. =
Valid knn accuracy bass      : 45.49418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.025190114974976 sec. =
Valid knn accuracy piano     : 57.567567567567565%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.3277587890625 sec. =
Valid knn accuracy guitar    : 56.33116883116883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.703640699386597 sec. =
Valid knn accuracy residuals : 80.66037735849056%

Valid knn accuracy average   : 63.687130548983006%

                                                                        [AEpoch 17: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.777, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.871]Epoch 17: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.777, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184837, 0.184989, 0.184428
Train average loss UNet            (all)              : 0.554254

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000656, 2.618613, 4.872772
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004735, 2.723970, 4.027992
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005485, 3.141569, 4.565340
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003515, 3.141042, 4.735674
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002539, 3.594244, 5.162850
Train average loss all      (Triplet)                 : 0.003393

== Recognize ==
Train average loss Recognize     : 0.867409
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003393

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.777, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.777, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0156, Train/loss_recog_step=0.777, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.821, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]  Epoch 18:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.821, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=0.745, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.0013, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0013, Train/loss_recog_step=0.745, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.00271, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.854, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  80%|███████▉  | 250/313 [04:45<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.00271, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=0.854, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  80%|███████▉  | 250/313 [04:45<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]    Epoch 18:  96%|█████████▌| 300/313 [05:39<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.785, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18:  96%|█████████▌| 300/313 [05:39<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.932, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.932, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.786, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=0.901, Valid/loss_all_epoch=0.269, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.269, Valid/loss_recog_epoch=0.828, Valid/knn_avr=0.637, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.64it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178729, 0.180165, 0.187762
Valid average loss UNet            (all)              : 0.546656

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095577, 2.787882, 4.604420
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.399978, 3.325377, 3.787593
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.331464, 3.559733, 3.934332
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.179992, 3.643764, 4.807453
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.313231, 3.714994, 4.631937
Valid average loss all      (Triplet)                 : 0.276286

== Recognize ==
Valid average loss Recognize     : 0.831064
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.276286

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.349168062210083 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.293036937713623 sec. =
Valid knn accuracy bass      : 47.093023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.165274858474731 sec. =
Valid knn accuracy piano     : 60.13513513513513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.919471740722656 sec. =
Valid knn accuracy guitar    : 54.54545454545454%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.336774587631226 sec. =
Valid knn accuracy residuals : 78.77358490566037%

Valid knn accuracy average   : 64.02120427429516%

                                                                        [AEpoch 18: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.786, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00339, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=0.867]Epoch 18: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.786, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184845, 0.185006, 0.184436
Train average loss UNet            (all)              : 0.554288

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000641, 2.629024, 4.879049
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005128, 2.777277, 4.119416
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004132, 3.183492, 4.657369
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003729, 3.251264, 4.934168
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002372, 3.653622, 5.270989
Train average loss all      (Triplet)                 : 0.003224

== Recognize ==
Train average loss Recognize     : 0.864662
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003224

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.786, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.786, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  16%|█▌        | 50/313 [01:01<05:26,  0.81it/s, v_num=0, Train/loss_all_step=0.00338, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.786, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  16%|█▌        | 50/313 [01:01<05:26,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]    Epoch 19:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.00274, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00274, Train/loss_recog_step=0.873, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.00274, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00274, Train/loss_recog_step=0.873, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]    Epoch 19:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  80%|███████▉  | 250/313 [04:43<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  80%|███████▉  | 250/313 [04:43<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00482, Train/loss_recog_step=0.786, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  96%|█████████▌| 300/313 [05:39<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00482, Train/loss_recog_step=0.786, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19:  96%|█████████▌| 300/313 [05:39<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00144, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.926, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00144, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.926, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.772, Valid/loss_all_step=0.297, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.297, Valid/loss_recog_step=0.894, Valid/loss_all_epoch=0.276, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=0.831, Valid/knn_avr=0.640, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.86it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.63it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179045, 0.180569, 0.188059
Valid average loss UNet            (all)              : 0.547672

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097719, 2.904195, 4.716588
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.445772, 3.362403, 3.833735
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.333051, 3.686383, 3.990406
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.253239, 3.772498, 4.952120
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.356294, 3.993912, 4.849426
Valid average loss all      (Triplet)                 : 0.321298

== Recognize ==
Valid average loss Recognize     : 0.819337
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.321298

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.939189195632935 sec. =
Valid knn accuracy drums     : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.765271186828613 sec. =
Valid knn accuracy bass      : 46.075581395348834%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.939023971557617 sec. =
Valid knn accuracy piano     : 59.32432432432433%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.147899866104126 sec. =
Valid knn accuracy guitar    : 51.461038961038966%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.722470045089722 sec. =
Valid knn accuracy residuals : 79.71698113207547%

Valid knn accuracy average   : 62.31558516255753%

                                                                        [AEpoch 19: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.772, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.865]Epoch 19: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.772, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184775, 0.184914, 0.184363
Train average loss UNet            (all)              : 0.554052

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000336, 2.695862, 4.998602
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006808, 2.859205, 4.217819
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002748, 3.246037, 4.773732
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003045, 3.367005, 5.094158
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002287, 3.780693, 5.447108
Train average loss all      (Triplet)                 : 0.003104

== Recognize ==
Train average loss Recognize     : 0.862877
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003104

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.772, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.772, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  16%|█▌        | 50/313 [01:01<05:23,  0.81it/s, v_num=0, Train/loss_all_step=0.00277, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00277, Train/loss_recog_step=0.772, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  16%|█▌        | 50/313 [01:01<05:23,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]    Epoch 20:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  48%|████▊     | 150/313 [02:55<03:10,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  48%|████▊     | 150/313 [02:55<03:10,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.752, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  64%|██████▍   | 200/313 [03:53<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.752, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  64%|██████▍   | 200/313 [03:53<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  80%|███████▉  | 250/313 [04:52<01:13,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  80%|███████▉  | 250/313 [04:52<01:13,  0.85it/s, v_num=0, Train/loss_all_step=0.00532, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.778, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  96%|█████████▌| 300/313 [05:49<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.00532, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.778, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20:  96%|█████████▌| 300/313 [05:49<00:15,  0.86it/s, v_num=0, Train/loss_all_step=5.02e-5, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=5.02e-5, Train/loss_recog_step=0.922, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=5.02e-5, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=5.02e-5, Train/loss_recog_step=0.922, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.441, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.321, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.321, Valid/loss_recog_epoch=0.819, Valid/knn_avr=0.623, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.99it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.03it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178602, 0.180047, 0.187687
Valid average loss UNet            (all)              : 0.546336

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108200, 2.925322, 4.766961
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.420064, 3.413591, 3.879698
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.427857, 3.740774, 3.990817
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.241585, 3.702240, 4.798470
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.356407, 4.088093, 4.843520
Valid average loss all      (Triplet)                 : 0.333748

== Recognize ==
Valid average loss Recognize     : 0.815681
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.333748

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.115384817123413 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.72473406791687 sec. =
Valid knn accuracy bass      : 45.348837209302324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.677679300308228 sec. =
Valid knn accuracy piano     : 57.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.362422704696655 sec. =
Valid knn accuracy guitar    : 55.032467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.646914005279541 sec. =
Valid knn accuracy residuals : 77.04402515723271%

Valid knn accuracy average   : 62.503348968671745%

                                                                        [AEpoch 20: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.0031, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=0.863]Epoch 20: 100%|██████████| 313/313 [07:57<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184565, 0.184719, 0.184175
Train average loss UNet            (all)              : 0.553459

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000405, 2.713401, 4.998159
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005651, 2.915395, 4.314148
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003051, 3.299042, 4.829062
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002941, 3.378106, 5.118741
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003303, 3.815548, 5.524073
Train average loss all      (Triplet)                 : 0.003220

== Recognize ==
Train average loss Recognize     : 0.864250
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003220

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  16%|█▌        | 50/313 [01:04<05:37,  0.78it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  16%|█▌        | 50/313 [01:04<05:37,  0.78it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00915, Train/loss_recog_step=0.801, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  32%|███▏      | 100/313 [02:00<04:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00915, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00915, Train/loss_recog_step=0.801, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  32%|███▏      | 100/313 [02:00<04:16,  0.83it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00307, Train/loss_recog_step=0.875, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00307, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00307, Train/loss_recog_step=0.875, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=0.743, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00359, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=0.743, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000924, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000924, Train/loss_recog_step=0.847, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000924, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000924, Train/loss_recog_step=0.847, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]      Epoch 21:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.770, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000564, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000564, Train/loss_recog_step=0.920, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000564, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000564, Train/loss_recog_step=0.920, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.766, Valid/loss_all_step=0.466, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.466, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.334, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.816, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.03it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.41it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.37it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.65it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178694, 0.180137, 0.187677
Valid average loss UNet            (all)              : 0.546508

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091633, 3.034073, 4.933368
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.482828, 3.601731, 4.031097
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.464270, 4.022098, 4.268533
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.231112, 3.882005, 5.075007
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.330396, 4.232957, 5.091456
Valid average loss all      (Triplet)                 : 0.347679

== Recognize ==
Valid average loss Recognize     : 0.812077
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.347679

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.294127941131592 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.056333303451538 sec. =
Valid knn accuracy bass      : 41.56976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.734271049499512 sec. =
Valid knn accuracy piano     : 60.13513513513513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.341200590133667 sec. =
Valid knn accuracy guitar    : 59.253246753246756%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.429076910018921 sec. =
Valid knn accuracy residuals : 79.40251572327044%

Valid knn accuracy average   : 64.07213301070256%

                                                                        [AEpoch 21: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.766, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00322, Train/loss_unet_all_epoch=0.553, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=0.864]Epoch 21: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.766, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184703, 0.184851, 0.184287
Train average loss UNet            (all)              : 0.553841

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000641, 2.774834, 5.137821
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002753, 2.947809, 4.403564
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003143, 3.445852, 5.035297
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002567, 3.428011, 5.219502
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001766, 3.888573, 5.661594
Train average loss all      (Triplet)                 : 0.002194

== Recognize ==
Train average loss Recognize     : 0.859232
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002194

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.766, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.766, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  16%|█▌        | 50/313 [01:01<05:22,  0.82it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.766, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  16%|█▌        | 50/313 [01:01<05:22,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.805, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]    Epoch 22:  32%|███▏      | 100/313 [01:56<04:07,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.805, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  32%|███▏      | 100/313 [01:56<04:07,  0.86it/s, v_num=0, Train/loss_all_step=0.00555, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.875, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  48%|████▊     | 150/313 [02:51<03:05,  0.88it/s, v_num=0, Train/loss_all_step=0.00555, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.875, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  48%|████▊     | 150/313 [02:51<03:05,  0.88it/s, v_num=0, Train/loss_all_step=0.00804, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00804, Train/loss_recog_step=0.741, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  64%|██████▍   | 200/313 [03:47<02:08,  0.88it/s, v_num=0, Train/loss_all_step=0.00804, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00804, Train/loss_recog_step=0.741, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  64%|██████▍   | 200/313 [03:47<02:08,  0.88it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.847, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  80%|███████▉  | 250/313 [04:43<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.847, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  80%|███████▉  | 250/313 [04:43<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.766, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  96%|█████████▌| 300/313 [05:38<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.766, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22:  96%|█████████▌| 300/313 [05:38<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.000463, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000463, Train/loss_recog_step=0.919, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000463, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000463, Train/loss_recog_step=0.919, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.760, Valid/loss_all_step=0.471, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.348, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.812, Valid/knn_avr=0.641, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.65it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.60it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.99it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.11it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178739, 0.180151, 0.187712
Valid average loss UNet            (all)              : 0.546602

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103195, 3.102250, 4.896451
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.401128, 3.644809, 4.259172
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.566236, 4.058038, 4.196546
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.283813, 3.872468, 4.935991
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348792, 4.345541, 5.074876
Valid average loss all      (Triplet)                 : 0.359375

== Recognize ==
Valid average loss Recognize     : 0.813428
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.359375

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.095172643661499 sec. =
Valid knn accuracy drums     : 74.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.786645412445068 sec. =
Valid knn accuracy bass      : 36.337209302325576%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.150906562805176 sec. =
Valid knn accuracy piano     : 63.37837837837837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.62148380279541 sec. =
Valid knn accuracy guitar    : 60.71428571428571%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.174866437911987 sec. =
Valid knn accuracy residuals : 77.04402515723271%

Valid knn accuracy average   : 62.465367945738606%

                                                                        [AEpoch 22: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.760, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00219, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00219, Train/loss_recog_epoch=0.859]Epoch 22: 100%|██████████| 313/313 [07:43<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.760, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184785, 0.184943, 0.184382
Train average loss UNet            (all)              : 0.554110

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000308, 2.859590, 5.268140
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004298, 2.993052, 4.440682
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003862, 3.473247, 5.064621
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002985, 3.510399, 5.339143
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002705, 3.973781, 5.785007
Train average loss all      (Triplet)                 : 0.002918

== Recognize ==
Train average loss Recognize     : 0.857364
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002918

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.760, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.760, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  16%|█▌        | 50/313 [01:01<05:22,  0.82it/s, v_num=0, Train/loss_all_step=0.0122, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.760, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  16%|█▌        | 50/313 [01:01<05:22,  0.82it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.803, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00388, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.803, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]    Epoch 23:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  48%|████▊     | 150/313 [02:54<03:09,  0.86it/s, v_num=0, Train/loss_all_step=0.00204, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.735, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.00204, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.735, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.841, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.841, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.766, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]    Epoch 23:  96%|█████████▌| 300/313 [05:38<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.766, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23:  96%|█████████▌| 300/313 [05:38<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.915, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00228, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.915, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.489, Valid/loss_recog_step=0.878, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.625, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.14it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.77it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178622, 0.180054, 0.187726
Valid average loss UNet            (all)              : 0.546402

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113125, 3.119724, 5.084340
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.474983, 3.724252, 4.260372
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.597395, 4.133751, 4.247703
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224813, 3.913097, 5.098105
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.297055, 4.508333, 5.246042
Valid average loss all      (Triplet)                 : 0.363182

== Recognize ==
Valid average loss Recognize     : 0.806555
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.363182

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.185234785079956 sec. =
Valid knn accuracy drums     : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.308067560195923 sec. =
Valid knn accuracy bass      : 39.825581395348834%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.765562295913696 sec. =
Valid knn accuracy piano     : 64.1891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.007345914840698 sec. =
Valid knn accuracy guitar    : 62.01298701298701%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.77652883529663 sec. =
Valid knn accuracy residuals : 80.9748427672956%

Valid knn accuracy average   : 64.40052007296413%

                                                                        [AEpoch 23: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00292, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=0.857]Epoch 23: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184700, 0.184860, 0.184294
Train average loss UNet            (all)              : 0.553854

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000690, 2.892959, 5.287378
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005617, 3.111486, 4.613387
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003984, 3.602134, 5.275488
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003830, 3.582347, 5.414625
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002997, 4.059230, 5.923317
Train average loss all      (Triplet)                 : 0.003446

== Recognize ==
Train average loss Recognize     : 0.853000
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003446

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  16%|█▌        | 50/313 [01:01<05:21,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  16%|█▌        | 50/313 [01:01<05:21,  0.82it/s, v_num=0, Train/loss_all_step=0.00152, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.796, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  32%|███▏      | 100/313 [01:57<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.00152, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.796, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  32%|███▏      | 100/313 [01:57<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]    Epoch 24:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.00128, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.850, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00128, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.850, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]    Epoch 24:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24:  96%|█████████▌| 300/313 [05:41<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.920, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.00311, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.920, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.807, Valid/knn_avr=0.644, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.34it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.78it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178770, 0.180233, 0.187773
Valid average loss UNet            (all)              : 0.546776

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090956, 3.125922, 5.018409
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.430463, 3.800393, 4.391088
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.514172, 4.221333, 4.326837
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220100, 4.084980, 5.266720
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.310712, 4.604880, 5.203765
Valid average loss all      (Triplet)                 : 0.330763

== Recognize ==
Valid average loss Recognize     : 0.813469
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.330763

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.034073829650879 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.668750047683716 sec. =
Valid knn accuracy bass      : 40.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.896759033203125 sec. =
Valid knn accuracy piano     : 62.70270270270271%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.122313022613525 sec. =
Valid knn accuracy guitar    : 62.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.81671953201294 sec. =
Valid knn accuracy residuals : 79.0880503144654%

Valid knn accuracy average   : 65.14440231341993%

                                                                        [AEpoch 24: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00345, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00345, Train/loss_recog_epoch=0.853]Epoch 24: 100%|██████████| 313/313 [07:45<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184797, 0.184951, 0.184389
Train average loss UNet            (all)              : 0.554136

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000767, 2.941655, 5.405255
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003849, 3.167894, 4.734647
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002553, 3.660187, 5.390937
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003975, 3.610236, 5.488611
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002449, 4.075243, 5.947770
Train average loss all      (Triplet)                 : 0.002821

== Recognize ==
Train average loss Recognize     : 0.855397
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002821

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  16%|█▌        | 50/313 [01:02<05:28,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.867, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.00697, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=0.867, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=0.734, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]  Epoch 25:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=0.734, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]  Epoch 25:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.753, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.369, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=0.869, Valid/loss_all_epoch=0.331, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.651, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.93it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.60it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178521, 0.180035, 0.187368
Valid average loss UNet            (all)              : 0.545925

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071462, 3.205458, 5.421589
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.526517, 3.856780, 4.215345
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.535345, 4.201302, 4.325412
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.230120, 4.181112, 5.250419
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.422962, 4.766294, 5.086812
Valid average loss all      (Triplet)                 : 0.383902

== Recognize ==
Valid average loss Recognize     : 0.804763
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.383902

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.809566974639893 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.710641384124756 sec. =
Valid knn accuracy bass      : 45.93023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.939040184020996 sec. =
Valid knn accuracy piano     : 62.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.178329229354858 sec. =
Valid knn accuracy guitar    : 62.33766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.810323715209961 sec. =
Valid knn accuracy residuals : 77.35849056603774%

Valid knn accuracy average   : 65.57519760111197%

                                                                        [AEpoch 25: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00282, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00282, Train/loss_recog_epoch=0.855]Epoch 25: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184816, 0.184973, 0.184404
Train average loss UNet            (all)              : 0.554193

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001611, 3.062214, 5.625988
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005747, 3.281336, 4.926442
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001950, 3.688551, 5.436553
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002598, 3.718435, 5.672445
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002135, 4.130181, 6.028401
Train average loss all      (Triplet)                 : 0.002757

== Recognize ==
Train average loss Recognize     : 0.850168
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002757

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  16%|█▌        | 50/313 [01:03<05:33,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  16%|█▌        | 50/313 [01:03<05:33,  0.79it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.795, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  32%|███▏      | 100/313 [02:00<04:15,  0.83it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=0.795, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  32%|███▏      | 100/313 [02:00<04:15,  0.83it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]  Epoch 26:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.723, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  64%|██████▍   | 200/313 [03:53<02:12,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.723, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  64%|██████▍   | 200/313 [03:53<02:12,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  96%|█████████▌| 300/313 [05:49<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.747, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26:  96%|█████████▌| 300/313 [05:49<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.582, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.582, Valid/loss_recog_step=0.877, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.63it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.62it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.74it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178673, 0.180185, 0.187596
Valid average loss UNet            (all)              : 0.546454

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067326, 3.299052, 5.399208
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.453073, 3.837166, 4.285259
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.563476, 4.267015, 4.353736
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.269329, 4.168578, 5.504739
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.367276, 4.616798, 5.293797
Valid average loss all      (Triplet)                 : 0.359221

== Recognize ==
Valid average loss Recognize     : 0.795658
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.359221

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.395646095275879 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.661471128463745 sec. =
Valid knn accuracy bass      : 44.47674418604651%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.862391948699951 sec. =
Valid knn accuracy piano     : 60.13513513513513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.158363103866577 sec. =
Valid knn accuracy guitar    : 54.87012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.783342838287354 sec. =
Valid knn accuracy residuals : 78.14465408805032%

Valid knn accuracy average   : 63.29003853822531%

                                                                        [AEpoch 26: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.850]Epoch 26: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184921, 0.185069, 0.184494
Train average loss UNet            (all)              : 0.554484

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001211, 3.116159, 5.669979
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003286, 3.267838, 4.903400
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003502, 3.755592, 5.537669
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001651, 3.754667, 5.729745
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001342, 4.164181, 6.090156
Train average loss all      (Triplet)                 : 0.002283

== Recognize ==
Train average loss Recognize     : 0.843143
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002283

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  16%|█▌        | 50/313 [01:00<05:19,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  16%|█▌        | 50/313 [01:00<05:19,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.788, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.788, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  32%|███▏      | 100/313 [01:57<04:10,  0.85it/s, v_num=0, Train/loss_all_step=0.00949, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00949, Train/loss_recog_step=0.860, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  48%|████▊     | 150/313 [02:55<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00949, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00949, Train/loss_recog_step=0.860, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  48%|████▊     | 150/313 [02:55<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00062, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00062, Train/loss_recog_step=0.717, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  64%|██████▍   | 200/313 [03:53<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00062, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00062, Train/loss_recog_step=0.717, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  64%|██████▍   | 200/313 [03:53<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.828, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00251, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.828, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00178, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.738, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  96%|█████████▌| 300/313 [05:49<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.00178, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.738, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27:  96%|█████████▌| 300/313 [05:49<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]    Epoch 27: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.736, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.456, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.359, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.796, Valid/knn_avr=0.633, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.37it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.64it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179035, 0.180519, 0.188125
Valid average loss UNet            (all)              : 0.547679

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081279, 3.411434, 5.697153
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.491742, 4.009385, 4.515788
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.563409, 4.474672, 4.646214
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.194994, 4.213337, 5.501510
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.425783, 4.878349, 5.610106
Valid average loss all      (Triplet)                 : 0.365594

== Recognize ==
Valid average loss Recognize     : 0.788724
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.365594

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.748838901519775 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.152153253555298 sec. =
Valid knn accuracy bass      : 36.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.230173349380493 sec. =
Valid knn accuracy piano     : 59.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.9951913356781 sec. =
Valid knn accuracy guitar    : 59.09090909090909%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.850324630737305 sec. =
Valid knn accuracy residuals : 77.83018867924528%

Valid knn accuracy average   : 61.98404578244807%

                                                                        [AEpoch 27: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.736, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00228, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=0.843]Epoch 27: 100%|██████████| 313/313 [07:55<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.736, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184867, 0.185012, 0.184448
Train average loss UNet            (all)              : 0.554327

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000809, 3.207675, 5.892951
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003103, 3.341801, 4.986255
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002027, 3.897998, 5.766227
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001940, 3.846049, 5.887059
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001952, 4.332184, 6.340286
Train average loss all      (Triplet)                 : 0.002006

== Recognize ==
Train average loss Recognize     : 0.836882
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002006

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.736, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.736, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  16%|█▌        | 50/313 [01:01<05:21,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.736, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  16%|█▌        | 50/313 [01:01<05:21,  0.82it/s, v_num=0, Train/loss_all_step=0.00951, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00951, Train/loss_recog_step=0.784, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00951, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00951, Train/loss_recog_step=0.784, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00149, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=0.858, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.00149, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=0.858, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00477, Train/loss_recog_step=0.712, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  64%|██████▍   | 200/313 [03:51<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00477, Train/loss_recog_step=0.712, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  64%|██████▍   | 200/313 [03:51<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]    Epoch 28:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.742, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.742, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.902, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00403, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00403, Train/loss_recog_step=0.902, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.437, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.366, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.620, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.73it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.69it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.45it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.75it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178852, 0.180358, 0.187825
Valid average loss UNet            (all)              : 0.547035

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081419, 3.471946, 5.745555
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.489009, 4.103442, 4.643763
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.563314, 4.534308, 4.693563
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.245014, 4.432085, 5.614025
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.480379, 5.030432, 5.762461
Valid average loss all      (Triplet)                 : 0.381486

== Recognize ==
Valid average loss Recognize     : 0.793932
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.381486

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.517610311508179 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.885382890701294 sec. =
Valid knn accuracy bass      : 40.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.789344549179077 sec. =
Valid knn accuracy piano     : 62.29729729729729%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.04827094078064 sec. =
Valid knn accuracy guitar    : 63.31168831168831%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.805849552154541 sec. =
Valid knn accuracy residuals : 80.81761006289308%

Valid knn accuracy average   : 65.57259683615413%

                                                                        [AEpoch 28: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.837]Epoch 28: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184970, 0.185125, 0.184553
Train average loss UNet            (all)              : 0.554648

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001106, 3.268602, 5.964254
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002346, 3.431254, 5.150225
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004088, 3.994650, 5.836322
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002642, 3.923192, 5.958069
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002448, 4.424037, 6.488602
Train average loss all      (Triplet)                 : 0.002517

== Recognize ==
Train average loss Recognize     : 0.836995
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002517

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  16%|█▌        | 50/313 [01:03<05:32,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.737, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  16%|█▌        | 50/313 [01:03<05:32,  0.79it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  32%|███▏      | 100/313 [02:01<04:18,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.786, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  32%|███▏      | 100/313 [02:01<04:18,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  48%|████▊     | 150/313 [02:56<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  48%|████▊     | 150/313 [02:56<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00122, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.715, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00122, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.715, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00286, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.830, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00286, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00286, Train/loss_recog_step=0.830, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  80%|███████▉  | 250/313 [04:49<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000577, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000577, Train/loss_recog_step=0.744, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000577, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000577, Train/loss_recog_step=0.744, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00312, Train/loss_recog_step=0.899, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]  Epoch 29: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00312, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00312, Train/loss_recog_step=0.899, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=0.741, Valid/loss_all_step=0.419, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=0.876, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.656, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.71it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179028, 0.180589, 0.187970
Valid average loss UNet            (all)              : 0.547587

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098255, 3.505394, 5.683386
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.470772, 4.271398, 4.791781
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.517521, 4.581379, 4.851757
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.212099, 4.455197, 5.756534
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.375452, 5.089739, 5.996554
Valid average loss all      (Triplet)                 : 0.344972

== Recognize ==
Valid average loss Recognize     : 0.789310
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.344972

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.273147106170654 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.593911170959473 sec. =
Valid knn accuracy bass      : 37.645348837209305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.833002090454102 sec. =
Valid knn accuracy piano     : 58.24324324324325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.476632356643677 sec. =
Valid knn accuracy guitar    : 59.41558441558441%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.483510255813599 sec. =
Valid knn accuracy residuals : 81.44654088050315%

Valid knn accuracy average   : 62.99720229883743%

                                                                        [AEpoch 29: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=0.741, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00252, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00252, Train/loss_recog_epoch=0.837]Epoch 29: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=0.741, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184916, 0.185059, 0.184500
Train average loss UNet            (all)              : 0.554475

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000454, 3.248603, 5.962501
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005873, 3.544215, 5.304773
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002932, 4.052191, 5.981984
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001873, 3.966069, 6.014462
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002308, 4.489708, 6.563015
Train average loss all      (Triplet)                 : 0.002758

== Recognize ==
Train average loss Recognize     : 0.837064
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002758

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=0.741, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=0.741, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  16%|█▌        | 50/313 [01:03<05:32,  0.79it/s, v_num=0, Train/loss_all_step=0.0075, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0075, Train/loss_recog_step=0.741, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  16%|█▌        | 50/313 [01:03<05:32,  0.79it/s, v_num=0, Train/loss_all_step=7.43e-5, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=7.43e-5, Train/loss_recog_step=0.785, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=7.43e-5, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=7.43e-5, Train/loss_recog_step=0.785, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.856, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  48%|████▊     | 150/313 [02:55<03:10,  0.86it/s, v_num=0, Train/loss_all_step=0.00354, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.856, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  48%|████▊     | 150/313 [02:55<03:10,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]    Epoch 30:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.714, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  64%|██████▍   | 200/313 [03:52<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00161, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=0.820, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00161, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=0.820, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.741, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]    Epoch 30:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.741, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.737, Valid/loss_all_step=0.380, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.380, Valid/loss_recog_step=0.862, Valid/loss_all_epoch=0.345, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.630, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.61it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.61it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.08it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.69it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178781, 0.180287, 0.187748
Valid average loss UNet            (all)              : 0.546816

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110695, 3.598626, 5.727926
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.534517, 4.410905, 4.890768
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.430057, 4.644947, 5.020155
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.280687, 4.626292, 5.889061
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.463226, 5.198334, 5.988492
Valid average loss all      (Triplet)                 : 0.377237

== Recognize ==
Valid average loss Recognize     : 0.794577
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.377237

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.749175786972046 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.758326292037964 sec. =
Valid knn accuracy bass      : 40.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.77112102508545 sec. =
Valid knn accuracy piano     : 61.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.969053030014038 sec. =
Valid knn accuracy guitar    : 57.95454545454546%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.742934226989746 sec. =
Valid knn accuracy residuals : 84.11949685534591%

Valid knn accuracy average   : 64.68300826232581%

                                                                        [AEpoch 30: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.737, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00276, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=0.837]Epoch 30: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.737, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184856, 0.185001, 0.184425
Train average loss UNet            (all)              : 0.554283

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000800, 3.327249, 6.057406
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004826, 3.598276, 5.379899
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003732, 4.179390, 6.154007
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002831, 4.105983, 6.240906
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002878, 4.636705, 6.769065
Train average loss all      (Triplet)                 : 0.003006

== Recognize ==
Train average loss Recognize     : 0.835917
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.003006

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.737, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.737, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  16%|█▌        | 50/313 [01:01<05:24,  0.81it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.737, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  16%|█▌        | 50/313 [01:01<05:24,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]  Epoch 31:  32%|███▏      | 100/313 [01:56<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  32%|███▏      | 100/313 [01:56<04:09,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.715, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  64%|██████▍   | 200/313 [03:46<02:07,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.715, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  64%|██████▍   | 200/313 [03:46<02:07,  0.88it/s, v_num=0, Train/loss_all_step=0.00201, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.829, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  80%|███████▉  | 250/313 [04:41<01:10,  0.89it/s, v_num=0, Train/loss_all_step=0.00201, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=0.829, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  80%|███████▉  | 250/313 [04:41<01:10,  0.89it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.750, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  96%|█████████▌| 300/313 [05:37<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.00329, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00329, Train/loss_recog_step=0.750, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31:  96%|█████████▌| 300/313 [05:37<00:14,  0.89it/s, v_num=0, Train/loss_all_step=0.000535, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000535, Train/loss_recog_step=0.900, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000535, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000535, Train/loss_recog_step=0.900, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.387, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.387, Valid/loss_recog_step=0.875, Valid/loss_all_epoch=0.377, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.377, Valid/loss_recog_epoch=0.795, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]      
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.72it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.39it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.87it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.08it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178897, 0.180406, 0.188010
Valid average loss UNet            (all)              : 0.547313

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065273, 3.515134, 5.837822
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.521660, 4.403730, 4.845572
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.549981, 4.451922, 4.756169
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.203002, 4.488144, 5.845539
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.391077, 5.270714, 6.114147
Valid average loss all      (Triplet)                 : 0.371633

== Recognize ==
Valid average loss Recognize     : 0.792229
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.371633

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.066672563552856 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.581498861312866 sec. =
Valid knn accuracy bass      : 38.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.027229309082031 sec. =
Valid knn accuracy piano     : 58.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.016803741455078 sec. =
Valid knn accuracy guitar    : 55.84415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.723627805709839 sec. =
Valid knn accuracy residuals : 80.81761006289308%

Valid knn accuracy average   : 62.907176636876194%

                                                                        [AEpoch 31: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00301, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=0.836]Epoch 31: 100%|██████████| 313/313 [07:41<00:00,  0.68it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.185129, 0.185275, 0.184702
Train average loss UNet            (all)              : 0.555106

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000986, 3.338279, 6.180837
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004033, 3.554625, 5.377295
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001964, 4.147612, 6.147707
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001632, 4.092457, 6.232061
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001689, 4.627450, 6.810734
Train average loss all      (Triplet)                 : 0.002149

== Recognize ==
Train average loss Recognize     : 0.836196
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002149

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  16%|█▌        | 50/313 [01:01<05:25,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.740, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  16%|█▌        | 50/313 [01:01<05:25,  0.81it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.782, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  32%|███▏      | 100/313 [01:56<04:08,  0.86it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.782, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  32%|███▏      | 100/313 [01:56<04:08,  0.86it/s, v_num=0, Train/loss_all_step=0.00106, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=0.852, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.00106, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=0.852, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  48%|████▊     | 150/313 [02:52<03:07,  0.87it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.715, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.715, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]    Epoch 32:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.827, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00055, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00055, Train/loss_recog_step=0.741, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00055, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00055, Train/loss_recog_step=0.741, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.903, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00805, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00805, Train/loss_recog_step=0.903, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.731, Valid/loss_all_step=0.463, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.463, Valid/loss_recog_step=0.857, Valid/loss_all_epoch=0.372, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.629, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.39it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.02it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.13it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178730, 0.180234, 0.187778
Valid average loss UNet            (all)              : 0.546741

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064825, 3.537118, 5.894162
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.517996, 4.330570, 4.722309
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.481059, 4.581107, 4.945693
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329774, 4.667347, 5.705757
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.389320, 5.064176, 5.978906
Valid average loss all      (Triplet)                 : 0.383403

== Recognize ==
Valid average loss Recognize     : 0.788752
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.383403

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.907864332199097 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.517090797424316 sec. =
Valid knn accuracy bass      : 37.7906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.902350425720215 sec. =
Valid knn accuracy piano     : 60.54054054054055%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.60197377204895 sec. =
Valid knn accuracy guitar    : 57.467532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.65157961845398 sec. =
Valid knn accuracy residuals : 80.66037735849056%

Valid knn accuracy average   : 63.11535901996115%

                                                                        [AEpoch 32: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.731, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00215, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=0.836]Epoch 32: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.731, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.185037, 0.185192, 0.184609
Train average loss UNet            (all)              : 0.554838

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000256, 3.287799, 6.094741
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003651, 3.629881, 5.542069
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003560, 4.125517, 6.096188
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002990, 4.108053, 6.228014
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000736, 4.617557, 6.832289
Train average loss all      (Triplet)                 : 0.002329

== Recognize ==
Train average loss Recognize     : 0.834760
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002329

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.731, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.731, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.731, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.776, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  32%|███▏      | 100/313 [01:57<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.776, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  32%|███▏      | 100/313 [01:57<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00219, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.845, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.00219, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.845, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.0027, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.700, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]  Epoch 33:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.0027, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.700, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]  Epoch 33:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=0.735, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  96%|█████████▌| 300/313 [05:42<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=0.735, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33:  96%|█████████▌| 300/313 [05:42<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.897, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00103, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.897, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=0.733, Valid/loss_all_step=0.507, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.507, Valid/loss_recog_step=0.859, Valid/loss_all_epoch=0.383, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.383, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.73it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.62it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.08it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179099, 0.180669, 0.188162
Valid average loss UNet            (all)              : 0.547930

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062105, 3.505067, 5.782336
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.496498, 4.308898, 4.758275
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.618105, 4.793628, 5.009374
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184484, 4.618245, 5.866706
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.417873, 5.128971, 5.824924
Valid average loss all      (Triplet)                 : 0.376448

== Recognize ==
Valid average loss Recognize     : 0.790493
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.376448

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.397003412246704 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.306488513946533 sec. =
Valid knn accuracy bass      : 36.91860465116279%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.059090614318848 sec. =
Valid knn accuracy piano     : 56.75675675675676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.973743677139282 sec. =
Valid knn accuracy guitar    : 60.22727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.257723808288574 sec. =
Valid knn accuracy residuals : 81.76100628930818%

Valid knn accuracy average   : 63.132728084900094%

                                                                        [AEpoch 33: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=0.733, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00233, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00233, Train/loss_recog_epoch=0.835]Epoch 33: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=0.733, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.185123, 0.185280, 0.184698
Train average loss UNet            (all)              : 0.555101

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000361, 3.331559, 6.151235
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003093, 3.587730, 5.426669
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003458, 4.197369, 6.190369
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003466, 4.205041, 6.433077
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000755, 4.587796, 6.756278
Train average loss all      (Triplet)                 : 0.002259

== Recognize ==
Train average loss Recognize     : 0.829226
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002259

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=0.733, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=0.733, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  16%|█▌        | 50/313 [01:03<05:35,  0.78it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=0.733, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  16%|█▌        | 50/313 [01:03<05:35,  0.78it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]    Epoch 34:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.850, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  48%|████▊     | 150/313 [02:58<03:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00685, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.00685, Train/loss_recog_step=0.850, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  48%|████▊     | 150/313 [02:58<03:14,  0.84it/s, v_num=0, Train/loss_all_step=0.000683, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000683, Train/loss_recog_step=0.709, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.000683, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000683, Train/loss_recog_step=0.709, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  64%|██████▍   | 200/313 [03:53<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=0.829, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]  Epoch 34:  80%|███████▉  | 250/313 [04:49<01:12,  0.86it/s, v_num=0, Train/loss_all_step=0.00332, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.00332, Train/loss_recog_step=0.829, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  80%|███████▉  | 250/313 [04:49<01:12,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.744, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]    Epoch 34:  96%|█████████▌| 300/313 [05:47<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.744, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34:  96%|█████████▌| 300/313 [05:47<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.725, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.790, Valid/knn_avr=0.631, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.10it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178852, 0.180438, 0.187778
Valid average loss UNet            (all)              : 0.547068

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.078794, 3.584933, 5.882677
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.516879, 4.194979, 4.706577
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.490784, 4.791080, 5.177656
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.227142, 4.747579, 5.995681
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.408056, 5.215443, 5.914779
Valid average loss all      (Triplet)                 : 0.374911

== Recognize ==
Valid average loss Recognize     : 0.788934
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.374911

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.464290380477905 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.400402545928955 sec. =
Valid knn accuracy bass      : 40.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.054607391357422 sec. =
Valid knn accuracy piano     : 60.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.332354545593262 sec. =
Valid knn accuracy guitar    : 62.33766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.418431043624878 sec. =
Valid knn accuracy residuals : 78.61635220125787%

Valid knn accuracy average   : 64.71269073268144%

                                                                        [AEpoch 34: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.725, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00226, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00226, Train/loss_recog_epoch=0.829]Epoch 34: 100%|██████████| 313/313 [07:53<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.725, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184856, 0.185015, 0.184449
Train average loss UNet            (all)              : 0.554320

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001185, 3.331460, 6.172113
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004770, 3.678672, 5.545307
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001631, 4.177961, 6.220323
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004470, 4.248890, 6.457975
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001290, 4.613026, 6.794048
Train average loss all      (Triplet)                 : 0.002652

== Recognize ==
Train average loss Recognize     : 0.831584
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002652

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.725, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.725, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  16%|█▌        | 50/313 [01:01<05:23,  0.81it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.725, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  16%|█▌        | 50/313 [01:01<05:23,  0.81it/s, v_num=0, Train/loss_all_step=0.00212, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.773, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  32%|███▏      | 100/313 [02:01<04:19,  0.82it/s, v_num=0, Train/loss_all_step=0.00212, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.773, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  32%|███▏      | 100/313 [02:01<04:19,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]    Epoch 35:  48%|████▊     | 150/313 [02:58<03:14,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  48%|████▊     | 150/313 [02:58<03:14,  0.84it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=0.701, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  64%|██████▍   | 200/313 [03:55<02:13,  0.85it/s, v_num=0, Train/loss_all_step=0.00341, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=0.701, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  64%|██████▍   | 200/313 [03:55<02:13,  0.85it/s, v_num=0, Train/loss_all_step=0.00257, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.823, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.00257, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=0.823, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  80%|███████▉  | 250/313 [04:50<01:13,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]    Epoch 35:  96%|█████████▌| 300/313 [05:48<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.735, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35:  96%|█████████▌| 300/313 [05:48<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.728, Valid/loss_all_step=0.546, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=0.865, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.647, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.37it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.43it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.68it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.50it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178989, 0.180504, 0.188023
Valid average loss UNet            (all)              : 0.547517

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067024, 3.582523, 6.128011
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.573652, 4.476770, 4.874341
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.652939, 4.906566, 5.083218
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207510, 4.769110, 6.073930
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.419821, 5.342545, 6.205577
Valid average loss all      (Triplet)                 : 0.415090

== Recognize ==
Valid average loss Recognize     : 0.780137
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.415090

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.554060220718384 sec. =
Valid knn accuracy drums     : 82.79411764705881%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.680558443069458 sec. =
Valid knn accuracy bass      : 40.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.903442859649658 sec. =
Valid knn accuracy piano     : 61.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.048776388168335 sec. =
Valid knn accuracy guitar    : 62.33766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.635957479476929 sec. =
Valid knn accuracy residuals : 81.91823899371069%

Valid knn accuracy average   : 65.7076153607398%

                                                                        [AEpoch 35: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.728, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00265, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00265, Train/loss_recog_epoch=0.832]Epoch 35: 100%|██████████| 313/313 [07:51<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.728, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.185011, 0.185150, 0.184580
Train average loss UNet            (all)              : 0.554740

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000391, 3.395667, 6.170847
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003806, 3.713651, 5.581632
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002129, 4.292688, 6.413512
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002402, 4.322187, 6.599386
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002437, 4.726883, 6.953291
Train average loss all      (Triplet)                 : 0.002169

== Recognize ==
Train average loss Recognize     : 0.827910
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002169

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.728, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.728, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  16%|█▌        | 50/313 [01:02<05:30,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.728, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  16%|█▌        | 50/313 [01:02<05:30,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.773, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  32%|███▏      | 100/313 [01:58<04:13,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.773, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  32%|███▏      | 100/313 [01:58<04:13,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.694, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.694, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  64%|██████▍   | 200/313 [03:49<02:09,  0.87it/s, v_num=0, Train/loss_all_step=0.0015, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=0.821, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.0015, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=0.821, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  80%|███████▉  | 250/313 [04:46<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.734, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]  Epoch 36:  96%|█████████▌| 300/313 [05:42<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.734, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36:  96%|█████████▌| 300/313 [05:42<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00159, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.892, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00159, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=0.892, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.724, Valid/loss_all_step=0.630, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=0.845, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=0.780, Valid/knn_avr=0.657, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.32it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.77it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.76it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178532, 0.179996, 0.187582
Valid average loss UNet            (all)              : 0.546109

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083919, 3.596811, 5.991130
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.512497, 4.533047, 4.978757
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.656421, 4.715014, 4.898177
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.238514, 4.798848, 6.078910
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.385582, 5.365710, 6.225592
Valid average loss all      (Triplet)                 : 0.393267

== Recognize ==
Valid average loss Recognize     : 0.776652
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.393267

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.32646894454956 sec. =
Valid knn accuracy drums     : 82.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.7275071144104 sec. =
Valid knn accuracy bass      : 41.27906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.6595458984375 sec. =
Valid knn accuracy piano     : 58.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.236562967300415 sec. =
Valid knn accuracy guitar    : 61.850649350649356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.720810174942017 sec. =
Valid knn accuracy residuals : 80.81761006289308%

Valid knn accuracy average   : 64.8769062177549%

                                                                        [AEpoch 36: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.724, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00217, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=0.828]Epoch 36: 100%|██████████| 313/313 [07:49<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.724, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184953, 0.185097, 0.184531
Train average loss UNet            (all)              : 0.554582

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000322, 3.449259, 6.314489
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003007, 3.733049, 5.653044
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002052, 4.234079, 6.358789
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002185, 4.355291, 6.709519
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002105, 4.714991, 6.919181
Train average loss all      (Triplet)                 : 0.002010

== Recognize ==
Train average loss Recognize     : 0.825341
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002010

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.724, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.724, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  16%|█▌        | 50/313 [01:02<05:30,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.724, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  16%|█▌        | 50/313 [01:02<05:30,  0.80it/s, v_num=0, Train/loss_all_step=0.0027, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.769, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  32%|███▏      | 100/313 [01:58<04:13,  0.84it/s, v_num=0, Train/loss_all_step=0.0027, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=0.769, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  32%|███▏      | 100/313 [01:58<04:13,  0.84it/s, v_num=0, Train/loss_all_step=0.000209, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000209, Train/loss_recog_step=0.838, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  48%|████▊     | 150/313 [02:55<03:10,  0.85it/s, v_num=0, Train/loss_all_step=0.000209, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.000209, Train/loss_recog_step=0.838, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  48%|████▊     | 150/313 [02:55<03:10,  0.85it/s, v_num=0, Train/loss_all_step=0.00162, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=0.689, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]  Epoch 37:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.00162, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=0.689, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  64%|██████▍   | 200/313 [03:50<02:10,  0.87it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00664, Train/loss_recog_step=0.815, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00664, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.00664, Train/loss_recog_step=0.815, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.723, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]    Epoch 37:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.723, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37:  96%|█████████▌| 300/313 [05:44<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000876, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000876, Train/loss_recog_step=0.717, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.649, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.68it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178856, 0.180331, 0.187789
Valid average loss UNet            (all)              : 0.546976

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090561, 3.875876, 6.358753
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.570363, 4.631264, 5.107466
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.522957, 5.013570, 5.255392
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.236021, 4.982288, 6.352626
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.403714, 5.773521, 6.586787
Valid average loss all      (Triplet)                 : 0.385757

== Recognize ==
Valid average loss Recognize     : 0.773540
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.385757

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.67206358909607 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.697283029556274 sec. =
Valid knn accuracy bass      : 39.825581395348834%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.314507007598877 sec. =
Valid knn accuracy piano     : 59.86486486486486%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.764407634735107 sec. =
Valid knn accuracy guitar    : 63.149350649350644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.062896013259888 sec. =
Valid knn accuracy residuals : 83.01886792452831%

Valid knn accuracy average   : 64.81879179034793%

                                                                        [AEpoch 37: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000876, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000876, Train/loss_recog_step=0.717, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00201, Train/loss_unet_all_epoch=0.555, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=0.825]Epoch 37: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000876, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000876, Train/loss_recog_step=0.717, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184780, 0.184926, 0.184372
Train average loss UNet            (all)              : 0.554078

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000917, 3.579763, 6.485929
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002536, 3.880857, 5.854805
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001823, 4.336948, 6.453806
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001885, 4.461107, 6.855841
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001285, 4.897697, 7.223907
Train average loss all      (Triplet)                 : 0.001762

== Recognize ==
Train average loss Recognize     : 0.820815
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.001762

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000876, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000876, Train/loss_recog_step=0.717, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000876, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000876, Train/loss_recog_step=0.717, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.000876, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.000876, Train/loss_recog_step=0.717, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  16%|█▌        | 50/313 [01:02<05:27,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]      Epoch 38:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  32%|███▏      | 100/313 [01:59<04:14,  0.84it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.836, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.836, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  48%|████▊     | 150/313 [02:57<03:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=0.692, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  64%|██████▍   | 200/313 [03:51<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.00371, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.00371, Train/loss_recog_step=0.692, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  64%|██████▍   | 200/313 [03:51<02:11,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]    Epoch 38:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  80%|███████▉  | 250/313 [04:48<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00859, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00859, Train/loss_recog_step=0.726, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00859, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00859, Train/loss_recog_step=0.726, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38:  96%|█████████▌| 300/313 [05:45<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.888, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00496, Train/loss_recog_step=0.888, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.722, Valid/loss_all_step=0.458, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.458, Valid/loss_recog_step=0.853, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.648, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.45it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.97it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178542, 0.180044, 0.187606
Valid average loss UNet            (all)              : 0.546192

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096137, 3.762695, 6.527783
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.553735, 4.689376, 5.223211
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.441908, 4.709727, 4.939653
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.189528, 4.805800, 6.190741
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.505510, 5.473244, 6.112336
Valid average loss all      (Triplet)                 : 0.373587

== Recognize ==
Valid average loss Recognize     : 0.771062
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.373587

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.110754251480103 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.694927215576172 sec. =
Valid knn accuracy bass      : 40.116279069767444%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.767149686813354 sec. =
Valid knn accuracy piano     : 59.86486486486486%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.204919815063477 sec. =
Valid knn accuracy guitar    : 59.74025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.716223239898682 sec. =
Valid knn accuracy residuals : 81.28930817610063%

Valid knn accuracy average   : 63.43743648784559%

                                                                        [AEpoch 38: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.722, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00176, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00176, Train/loss_recog_epoch=0.821]Epoch 38: 100%|██████████| 313/313 [07:48<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.722, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184746, 0.184891, 0.184324
Train average loss UNet            (all)              : 0.553961

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001487, 3.677450, 6.795609
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003356, 3.928973, 5.944781
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002786, 4.373810, 6.481098
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003686, 4.460243, 6.840602
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002809, 4.902611, 7.147436
Train average loss all      (Triplet)                 : 0.002814

== Recognize ==
Train average loss Recognize     : 0.820262
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002814

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.722, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.722, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  16%|█▌        | 50/313 [01:00<05:20,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.722, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  16%|█▌        | 50/313 [01:00<05:20,  0.82it/s, v_num=0, Train/loss_all_step=0.00266, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.758, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.00266, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.758, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  32%|███▏      | 100/313 [01:58<04:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]    Epoch 39:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  48%|████▊     | 150/313 [02:53<03:08,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.694, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  64%|██████▍   | 200/313 [03:51<02:10,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.694, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  64%|██████▍   | 200/313 [03:51<02:10,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.00171, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=0.722, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.00171, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=0.722, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39:  96%|█████████▌| 300/313 [05:43<00:14,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]    Epoch 39: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00548, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=0.717, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=0.837, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.374, Valid/loss_recog_epoch=0.771, Valid/knn_avr=0.634, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.35it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.38it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.04it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178746, 0.180251, 0.187796
Valid average loss UNet            (all)              : 0.546792

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092789, 3.799381, 6.194870
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.461266, 4.619300, 5.294193
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.516028, 4.978841, 5.174694
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.213219, 5.003980, 6.423162
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.506637, 5.594498, 6.302601
Valid average loss all      (Triplet)                 : 0.360814

== Recognize ==
Valid average loss Recognize     : 0.770203
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.360814

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.264235496520996 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.779490232467651 sec. =
Valid knn accuracy bass      : 41.27906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.958517074584961 sec. =
Valid knn accuracy piano     : 55.00000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.119929313659668 sec. =
Valid knn accuracy guitar    : 65.09740259740259%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.692939043045044 sec. =
Valid knn accuracy residuals : 81.13207547169812%

Valid knn accuracy average   : 63.560533096720285%

                                                                        [AEpoch 39: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00548, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=0.717, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00281, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=0.820]Epoch 39: 100%|██████████| 313/313 [07:47<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.00548, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=0.717, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184697, 0.184843, 0.184288
Train average loss UNet            (all)              : 0.553828

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000320, 3.651045, 6.767774
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004303, 3.885186, 5.860926
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003485, 4.416401, 6.514260
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002115, 4.401773, 6.776836
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001782, 4.899598, 7.191863
Train average loss all      (Triplet)                 : 0.002432

== Recognize ==
Train average loss Recognize     : 0.820798
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002432

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00548, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=0.717, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00548, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=0.717, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  16%|█▌        | 50/313 [01:02<05:26,  0.80it/s, v_num=0, Train/loss_all_step=0.00548, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=0.717, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  16%|█▌        | 50/313 [01:02<05:26,  0.80it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.756, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]    Epoch 40:  32%|███▏      | 100/313 [01:58<04:12,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.756, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  32%|███▏      | 100/313 [01:58<04:12,  0.84it/s, v_num=0, Train/loss_all_step=0.000229, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000229, Train/loss_recog_step=0.835, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  48%|████▊     | 150/313 [02:55<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000229, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000229, Train/loss_recog_step=0.835, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  48%|████▊     | 150/313 [02:55<03:11,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.682, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]      Epoch 40:  64%|██████▍   | 200/313 [03:55<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.682, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  64%|██████▍   | 200/313 [03:55<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000639, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000639, Train/loss_recog_step=0.811, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  80%|███████▉  | 250/313 [04:52<01:13,  0.85it/s, v_num=0, Train/loss_all_step=0.000639, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.000639, Train/loss_recog_step=0.811, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  80%|███████▉  | 250/313 [04:52<01:13,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]      Epoch 40:  96%|█████████▌| 300/313 [05:48<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.711, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40:  96%|█████████▌| 300/313 [05:48<00:15,  0.86it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.882, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.00419, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=0.882, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.391, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=0.849, Valid/loss_all_epoch=0.361, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.636, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.68it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.13it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178623, 0.180136, 0.187726
Valid average loss UNet            (all)              : 0.546485

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132615, 3.899111, 6.241534
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.654924, 4.663116, 5.102876
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.476930, 5.197643, 5.641002
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184697, 4.962629, 6.407701
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.461482, 5.433951, 6.348719
Valid average loss all      (Triplet)                 : 0.413924

== Recognize ==
Valid average loss Recognize     : 0.764876
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.413924

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.215447187423706 sec. =
Valid knn accuracy drums     : 76.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.531376361846924 sec. =
Valid knn accuracy bass      : 43.895348837209305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.072338104248047 sec. =
Valid knn accuracy piano     : 57.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.332725524902344 sec. =
Valid knn accuracy guitar    : 61.850649350649356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.477651834487915 sec. =
Valid knn accuracy residuals : 81.76100628930818%

Valid knn accuracy average   : 64.166742707834%

                                                                        [AEpoch 40: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.00243, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00243, Train/loss_recog_epoch=0.821]Epoch 40: 100%|██████████| 313/313 [07:54<00:00,  0.66it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184685, 0.184839, 0.184278
Train average loss UNet            (all)              : 0.553803

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001009, 3.712606, 6.735590
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003102, 3.928224, 5.946424
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002025, 4.542140, 6.749498
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001995, 4.477435, 6.857420
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002128, 4.912314, 7.209083
Train average loss all      (Triplet)                 : 0.002097

== Recognize ==
Train average loss Recognize     : 0.816432
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002097

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  16%|█▌        | 50/313 [01:04<05:38,  0.78it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.704, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  16%|█▌        | 50/313 [01:04<05:38,  0.78it/s, v_num=0, Train/loss_all_step=0.00111, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=0.746, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  32%|███▏      | 100/313 [02:01<04:18,  0.82it/s, v_num=0, Train/loss_all_step=0.00111, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=0.746, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  32%|███▏      | 100/313 [02:01<04:18,  0.82it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]    Epoch 41:  48%|████▊     | 150/313 [02:59<03:15,  0.84it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  48%|████▊     | 150/313 [02:59<03:15,  0.84it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.683, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.00224, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=0.683, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  64%|██████▍   | 200/313 [03:54<02:12,  0.85it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]    Epoch 41:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  80%|███████▉  | 250/313 [04:47<01:12,  0.87it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.713, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  96%|█████████▌| 300/313 [05:42<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.000, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.713, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41:  96%|█████████▌| 300/313 [05:42<00:14,  0.88it/s, v_num=0, Train/loss_all_step=0.00166, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.887, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00166, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.887, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.702, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.594, Valid/loss_recog_step=0.848, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.546, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.765, Valid/knn_avr=0.642, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.79it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.43it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.40it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  3.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.178730, 0.180242, 0.187702
Valid average loss UNet            (all)              : 0.546674

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128040, 4.025452, 6.408161
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.569405, 4.726480, 5.350954
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.599771, 5.146439, 5.400315
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.252874, 5.023069, 6.500124
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.449201, 5.703943, 6.563880
Valid average loss all      (Triplet)                 : 0.426743

== Recognize ==
Valid average loss Recognize     : 0.763565
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.426743

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.195353507995605 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.54408597946167 sec. =
Valid knn accuracy bass      : 47.52906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.728722095489502 sec. =
Valid knn accuracy piano     : 54.32432432432432%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.376453876495361 sec. =
Valid knn accuracy guitar    : 61.36363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.659146308898926 sec. =
Valid knn accuracy residuals : 79.87421383647799%

Valid knn accuracy average   : 63.7947194466114%

                                                                        [AEpoch 41: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.702, Valid/loss_all_step=0.644, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=0.844, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.638, Train/loss_all_epoch=0.0021, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=0.816]Epoch 41: 100%|██████████| 313/313 [07:46<00:00,  0.67it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.702, Valid/loss_all_step=0.644, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=0.844, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.638, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=0.813]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.184726, 0.184877, 0.184321
Train average loss UNet            (all)              : 0.553923

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001228, 3.729272, 6.688431
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003375, 4.052494, 6.146504
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002117, 4.646431, 6.923496
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001486, 4.531830, 6.954093
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002385, 5.032125, 7.400560
Train average loss all      (Triplet)                 : 0.002120

== Recognize ==
Train average loss Recognize     : 0.813203
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.002120

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.702, Valid/loss_all_step=0.644, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=0.844, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.638, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=0.813]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.702, Valid/loss_all_step=0.644, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=0.844, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.764, Valid/knn_avr=0.638, Train/loss_all_epoch=0.00212, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=0.813]