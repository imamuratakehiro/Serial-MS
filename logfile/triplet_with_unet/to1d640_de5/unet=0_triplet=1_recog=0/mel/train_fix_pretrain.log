
=== Using cuda(utils.func). ===

[2023-11-16 21:58:57,120][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-16 21:58:57,129][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         test_valid_norm: true                                                 
│         mix_minus_inst: false                                                 
│         test_psd_mine: false                                                  
│         mel: true                                                             
│         n_mels: 259                                                           
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/20
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         test_valid_norm: true                                                 
│         mix_minus_inst: false                                                 
│         test_psd_mine: false                                                  
│         mel: true                                                             
│         n_mels: 259                                                           
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 200                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       num_sanity_val_steps: 0                                                 
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       test_valid_norm: true                                                   
│       mix_minus_inst: false                                                   
│       test_psd_mine: false                                                    
│       mel: true                                                               
│       n_mels: 259                                                             
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       ckpt_model_path: /nas02/homes/imamura23-1000067/outputs/pretrain/runs/20
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-16 21:58:57,239][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-16 21:58:57,259][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet_old). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-16 21:58:59,120][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpr69qlpdj
[2023-11-16 21:58:59,120][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpr69qlpdj/_remote_module_non_scriptable.py
== Loading pretrained model...
== pretrained model was loaded!
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-16 21:58:59,931][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-16 21:58:59,932][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-16 21:58:59,937][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-16 21:58:59,939][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-16 21:58:59,939][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-16 21:58:59,939][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-16 21:58:59,982][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-16 21:59:00,341][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-16 21:59:00,644][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6544857025146484 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [01:19<06:58,  0.63it/s]Epoch 0:  16%|█▌        | 50/313 [01:19<06:58,  0.63it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.990]Epoch 0:  32%|███▏      | 100/313 [02:23<05:05,  0.70it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.990]Epoch 0:  32%|███▏      | 100/313 [02:23<05:05,  0.70it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.810]Epoch 0:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.810]Epoch 0:  48%|████▊     | 150/313 [03:28<03:46,  0.72it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.690]Epoch 0:  64%|██████▍   | 200/313 [04:32<02:33,  0.73it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.690]Epoch 0:  64%|██████▍   | 200/313 [04:32<02:33,  0.73it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.430]Epoch 0:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=1.430]Epoch 0:  80%|███████▉  | 250/313 [05:36<01:24,  0.74it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.543, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.440]Epoch 0:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.543, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.440]Epoch 0:  96%|█████████▌| 300/313 [06:41<00:17,  0.75it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.580]Epoch 0: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.580]Epoch 0: 100%|██████████| 313/313 [06:55<00:00,  0.75it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.430]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  2.79it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  2.85it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:04<00:00,  2.88it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  2.88it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  2.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.180818, 0.184250, 0.188379
Valid average loss UNet            (all)              : 0.553447

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079637, 0.224435, 0.433855
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.234282, 0.243938, 0.212071
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.206523, 0.269886, 0.263362
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.145327, 0.223796, 0.301296
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.151464, 0.288851, 0.352968
Valid average loss all      (Triplet)                 : 0.172325

== Recognize ==
Valid average loss Recognize     : 1.474403
Valid average accuracy drums     : 4.000000 %
Valid average accuracy bass      : 95.333328 %
Valid average accuracy piano     : 91.333336 %
Valid average accuracy guitar    : 83.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.172325

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 16.04453420639038 sec. =
Valid knn accuracy drums     : 74.41176470588235%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 16.25250220298767 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 18.176592588424683 sec. =
Valid knn accuracy piano     : 24.72972972972973%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 14.418654441833496 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 14.38052225112915 sec. =
Valid knn accuracy residuals : 62.42138364779875%

Valid knn accuracy average   : 41.51863118901681%

                                                                        [AEpoch 0: 100%|██████████| 313/313 [09:23<00:00,  0.56it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.430, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415]Epoch 0: 100%|██████████| 313/313 [09:23<00:00,  0.56it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.430, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186416, 0.186760, 0.185549
Train average loss UNet            (all)              : 0.558726

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.085031, 0.328629, 0.597522
Train average loss bass     (Triplet, dist_p, dist_n) : 0.210637, 0.318986, 0.317335
Train average loss piano    (Triplet, dist_p, dist_n) : 0.201796, 0.391854, 0.405868
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.178684, 0.393437, 0.453052
Train average loss residuals(Triplet, dist_p, dist_n) : 0.159232, 0.453398, 0.540424
Train average loss all      (Triplet)                 : 0.168231

== Recognize ==
Train average loss Recognize     : 1.788148
Train average accuracy drums     : 55.963333 %
Train average accuracy bass      : 48.693333 %
Train average accuracy piano     : 64.393333 %
Train average accuracy guitar    : 60.636669 %
Train average accuracy residuals : 82.474998 %

== Train average loss all : 0.168231

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.430, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.430, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  16%|█▌        | 50/313 [01:16<06:43,  0.65it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.430, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  16%|█▌        | 50/313 [01:16<06:43,  0.65it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.460, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  32%|███▏      | 100/313 [02:25<05:10,  0.69it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.460, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  32%|███▏      | 100/313 [02:25<05:10,  0.69it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=1.450, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  48%|████▊     | 150/313 [03:32<03:51,  0.71it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=1.450, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  48%|████▊     | 150/313 [03:32<03:51,  0.71it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.540, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.540, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  64%|██████▍   | 200/313 [04:38<02:37,  0.72it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.566, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.440, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.566, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.440, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  80%|███████▉  | 250/313 [05:43<01:26,  0.73it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.545, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.440, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  96%|█████████▌| 300/313 [06:49<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.545, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.440, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1:  96%|█████████▌| 300/313 [06:49<00:17,  0.73it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.440, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1: 100%|██████████| 313/313 [07:03<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.440, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1: 100%|██████████| 313/313 [07:03<00:00,  0.74it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.330, Valid/loss_all_step=0.208, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.208, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.470, Valid/knn_avr=0.415, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.12it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.02it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  2.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.183592, 0.187069, 0.191933
Valid average loss UNet            (all)              : 0.562594

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079587, 0.245915, 0.506791
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.220456, 0.242833, 0.224005
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.206985, 0.306906, 0.312245
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167659, 0.277155, 0.315085
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.156706, 0.319196, 0.398666
Valid average loss all      (Triplet)                 : 0.175661

== Recognize ==
Valid average loss Recognize     : 1.361298
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 30.666668 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.175661

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.975669622421265 sec. =
Valid knn accuracy drums     : 73.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.973437070846558 sec. =
Valid knn accuracy bass      : 8.430232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.93821620941162 sec. =
Valid knn accuracy piano     : 33.108108108108105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.979634284973145 sec. =
Valid knn accuracy guitar    : 31.655844155844154%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.914196729660034 sec. =
Valid knn accuracy residuals : 59.59119496855346%

Valid knn accuracy average   : 41.20413478165846%

                                                                        [AEpoch 1: 100%|██████████| 313/313 [09:37<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.559, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.790]Epoch 1: 100%|██████████| 313/313 [09:37<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.186756, 0.187066, 0.185879
Train average loss UNet            (all)              : 0.559700

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.065583, 0.265704, 0.604921
Train average loss bass     (Triplet, dist_p, dist_n) : 0.181762, 0.242355, 0.279128
Train average loss piano    (Triplet, dist_p, dist_n) : 0.179205, 0.295782, 0.332044
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.150517, 0.293193, 0.389549
Train average loss residuals(Triplet, dist_p, dist_n) : 0.134798, 0.346689, 0.459608
Train average loss all      (Triplet)                 : 0.143682

== Recognize ==
Train average loss Recognize     : 1.462238
Train average accuracy drums     : 58.466667 %
Train average accuracy bass      : 78.268333 %
Train average accuracy piano     : 48.986668 %
Train average accuracy guitar    : 70.064995 %
Train average accuracy residuals : 92.011665 %

== Train average loss all : 0.143682

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  16%|█▌        | 50/313 [01:16<06:41,  0.65it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  16%|█▌        | 50/313 [01:16<06:41,  0.65it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.400, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  32%|███▏      | 100/313 [02:25<05:10,  0.69it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.400, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  32%|███▏      | 100/313 [02:25<05:10,  0.69it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.340, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  48%|████▊     | 150/313 [03:35<03:54,  0.69it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.340, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  48%|████▊     | 150/313 [03:35<03:54,  0.69it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.400, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  64%|██████▍   | 200/313 [04:46<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.572, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.400, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  64%|██████▍   | 200/313 [04:46<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.567, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.370, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  80%|███████▉  | 250/313 [05:54<01:29,  0.71it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.567, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.370, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  80%|███████▉  | 250/313 [05:54<01:29,  0.71it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  96%|█████████▌| 300/313 [07:01<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2:  96%|█████████▌| 300/313 [07:01<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.390, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2: 100%|██████████| 313/313 [07:15<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.390, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2: 100%|██████████| 313/313 [07:15<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.330, Valid/loss_all_step=0.223, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.223, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.176, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=1.360, Valid/knn_avr=0.412, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.71it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.05it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.02it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.182340, 0.185558, 0.190395
Valid average loss UNet            (all)              : 0.558293

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090414, 0.307276, 0.627100
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.210368, 0.259868, 0.257458
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.209391, 0.329353, 0.342211
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.109549, 0.292959, 0.415735
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.184639, 0.392219, 0.430458
Valid average loss all      (Triplet)                 : 0.167086

== Recognize ==
Valid average loss Recognize     : 1.365273
Valid average accuracy drums     : 76.000000 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 87.333336 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.167086

= T-SNE...
T-SNE was finished!
= T-SNE time is 18.318125009536743 sec. =
Valid knn accuracy drums     : 72.6470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.162336587905884 sec. =
Valid knn accuracy bass      : 22.674418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.038170099258423 sec. =
Valid knn accuracy piano     : 28.513513513513512%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.286622524261475 sec. =
Valid knn accuracy guitar    : 31.16883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.902984380722046 sec. =
Valid knn accuracy residuals : 55.660377358490564%

Valid knn accuracy average   : 42.13283989380317%

                                                                        [AEpoch 2: 100%|██████████| 313/313 [09:49<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.144, Train/loss_unet_all_epoch=0.560, Train/loss_triplet_all_epoch=0.144, Train/loss_recog_epoch=1.460]Epoch 2: 100%|██████████| 313/313 [09:49<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187339, 0.187677, 0.186467
Train average loss UNet            (all)              : 0.561482

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.056862, 0.291409, 0.669102
Train average loss bass     (Triplet, dist_p, dist_n) : 0.174861, 0.265814, 0.315279
Train average loss piano    (Triplet, dist_p, dist_n) : 0.164351, 0.330251, 0.390393
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.138482, 0.332567, 0.458288
Train average loss residuals(Triplet, dist_p, dist_n) : 0.121933, 0.395166, 0.539639
Train average loss all      (Triplet)                 : 0.132253

== Recognize ==
Train average loss Recognize     : 1.363435
Train average accuracy drums     : 66.706673 %
Train average accuracy bass      : 87.169998 %
Train average accuracy piano     : 77.300003 %
Train average accuracy guitar    : 82.336662 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.132253

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  16%|█▌        | 50/313 [01:16<06:42,  0.65it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.610, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.330, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  16%|█▌        | 50/313 [01:16<06:42,  0.65it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.280, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  32%|███▏      | 100/313 [02:25<05:09,  0.69it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.280, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  32%|███▏      | 100/313 [02:25<05:09,  0.69it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.270, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  48%|████▊     | 150/313 [03:34<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.270, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  48%|████▊     | 150/313 [03:34<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.240, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  64%|██████▍   | 200/313 [04:41<02:38,  0.71it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.240, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  64%|██████▍   | 200/313 [04:41<02:38,  0.71it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.260, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  80%|███████▉  | 250/313 [05:49<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.260, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  80%|███████▉  | 250/313 [05:49<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0739, Train/loss_recog_step=1.200, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  96%|█████████▌| 300/313 [06:56<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0739, Train/loss_recog_step=1.200, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3:  96%|█████████▌| 300/313 [06:56<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.230, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]  Epoch 3: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.230, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3: 100%|██████████| 313/313 [07:09<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.180, Valid/loss_all_step=0.188, Valid/loss_unet_all_step=0.565, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.167, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.421, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  2.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  2.82it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:04<00:00,  2.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  2.90it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  2.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.181707, 0.185034, 0.190168
Valid average loss UNet            (all)              : 0.556908

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087501, 0.356687, 0.668112
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.196445, 0.333120, 0.362600
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.190313, 0.424116, 0.489130
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.113825, 0.367913, 0.524279
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.209374, 0.475166, 0.505613
Valid average loss all      (Triplet)                 : 0.160936

== Recognize ==
Valid average loss Recognize     : 1.208454
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.160936

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.69386386871338 sec. =
Valid knn accuracy drums     : 69.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 18.748790740966797 sec. =
Valid knn accuracy bass      : 23.982558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.06163215637207 sec. =
Valid knn accuracy piano     : 32.027027027027025%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.116989374160767 sec. =
Valid knn accuracy guitar    : 31.655844155844154%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.002513885498047 sec. =
Valid knn accuracy residuals : 63.05031446540881%

Valid knn accuracy average   : 43.96667816932768%

                                                                        [AEpoch 3: 100%|██████████| 313/313 [09:42<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.180, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.132, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.360]Epoch 3: 100%|██████████| 313/313 [09:42<00:00,  0.54it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.180, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187377, 0.187719, 0.186520
Train average loss UNet            (all)              : 0.561615

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.050580, 0.335013, 0.766878
Train average loss bass     (Triplet, dist_p, dist_n) : 0.165563, 0.306536, 0.374576
Train average loss piano    (Triplet, dist_p, dist_n) : 0.148156, 0.378138, 0.467763
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.128579, 0.376424, 0.526813
Train average loss residuals(Triplet, dist_p, dist_n) : 0.112392, 0.449575, 0.617140
Train average loss all      (Triplet)                 : 0.122222

== Recognize ==
Train average loss Recognize     : 1.265244
Train average accuracy drums     : 89.904999 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.810005 %
Train average accuracy guitar    : 88.770004 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.122222

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.180, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.180, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  16%|█▌        | 50/313 [01:17<06:50,  0.64it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.180, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  16%|█▌        | 50/313 [01:17<06:50,  0.64it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.200, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  32%|███▏      | 100/313 [02:27<05:14,  0.68it/s, v_num=0, Train/loss_all_step=0.133, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.200, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  32%|███▏      | 100/313 [02:27<05:14,  0.68it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.250, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  48%|████▊     | 150/313 [03:37<03:56,  0.69it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.250, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  48%|████▊     | 150/313 [03:37<03:56,  0.69it/s, v_num=0, Train/loss_all_step=0.0938, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.0938, Train/loss_recog_step=1.230, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  64%|██████▍   | 200/313 [04:48<02:42,  0.69it/s, v_num=0, Train/loss_all_step=0.0938, Train/loss_unet_all_step=0.573, Train/loss_triplet_all_step=0.0938, Train/loss_recog_step=1.230, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  64%|██████▍   | 200/313 [04:48<02:42,  0.69it/s, v_num=0, Train/loss_all_step=0.0865, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.240, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  80%|███████▉  | 250/313 [05:56<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0865, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.240, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  80%|███████▉  | 250/313 [05:56<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=1.140, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  96%|█████████▌| 300/313 [07:04<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0879, Train/loss_unet_all_step=0.546, Train/loss_triplet_all_step=0.0879, Train/loss_recog_step=1.140, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4:  96%|█████████▌| 300/313 [07:04<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.240, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]  Epoch 4: 100%|██████████| 313/313 [07:18<00:00,  0.71it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.240, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4: 100%|██████████| 313/313 [07:18<00:00,  0.71it/s, v_num=0, Train/loss_all_step=0.0744, Train/loss_unet_all_step=0.602, Train/loss_triplet_all_step=0.0744, Train/loss_recog_step=1.150, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.558, Valid/loss_triplet_all_step=0.192, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.161, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.440, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  2.79it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:04<00:00,  2.63it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:04<00:00,  2.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  2.72it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  2.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179092, 0.182177, 0.186990
Valid average loss UNet            (all)              : 0.548259

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081571, 0.398926, 0.736807
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.191919, 0.370295, 0.396421
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.197781, 0.469886, 0.527423
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.126715, 0.443049, 0.635256
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.143368, 0.555755, 0.666418
Valid average loss all      (Triplet)                 : 0.150997

== Recognize ==
Valid average loss Recognize     : 1.192367
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.150997

= T-SNE...
T-SNE was finished!
= T-SNE time is 21.110707759857178 sec. =
Valid knn accuracy drums     : 74.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.85461187362671 sec. =
Valid knn accuracy bass      : 23.982558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.76394510269165 sec. =
Valid knn accuracy piano     : 27.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.080623388290405 sec. =
Valid knn accuracy guitar    : 30.357142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.17277503013611 sec. =
Valid knn accuracy residuals : 60.37735849056604%

Valid knn accuracy average   : 43.50859472733747%

                                                                        [AEpoch 4: 100%|██████████| 313/313 [09:59<00:00,  0.52it/s, v_num=0, Train/loss_all_step=0.0744, Train/loss_unet_all_step=0.602, Train/loss_triplet_all_step=0.0744, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.122, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.270]Epoch 4: 100%|██████████| 313/313 [09:59<00:00,  0.52it/s, v_num=0, Train/loss_all_step=0.0744, Train/loss_unet_all_step=0.602, Train/loss_triplet_all_step=0.0744, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187386, 0.187720, 0.186522
Train average loss UNet            (all)              : 0.561628

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.044831, 0.370369, 0.848848
Train average loss bass     (Triplet, dist_p, dist_n) : 0.158727, 0.344155, 0.427408
Train average loss piano    (Triplet, dist_p, dist_n) : 0.138385, 0.423142, 0.535745
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.119885, 0.417269, 0.591792
Train average loss residuals(Triplet, dist_p, dist_n) : 0.103081, 0.484334, 0.673557
Train average loss all      (Triplet)                 : 0.114379

== Recognize ==
Train average loss Recognize     : 1.230026
Train average accuracy drums     : 87.888336 %
Train average accuracy bass      : 96.316666 %
Train average accuracy piano     : 89.203331 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.114379

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0744, Train/loss_unet_all_step=0.602, Train/loss_triplet_all_step=0.0744, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0744, Train/loss_unet_all_step=0.602, Train/loss_triplet_all_step=0.0744, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  16%|█▌        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.0744, Train/loss_unet_all_step=0.602, Train/loss_triplet_all_step=0.0744, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  16%|█▌        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.190, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]  Epoch 5:  32%|███▏      | 100/313 [02:27<05:14,  0.68it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.190, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  32%|███▏      | 100/313 [02:27<05:14,  0.68it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.240, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  48%|████▊     | 150/313 [03:36<03:54,  0.69it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.240, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  48%|████▊     | 150/313 [03:36<03:54,  0.69it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.120, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  64%|██████▍   | 200/313 [04:44<02:40,  0.70it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.120, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  64%|██████▍   | 200/313 [04:44<02:40,  0.70it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.0815, Train/loss_recog_step=1.160, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  80%|███████▉  | 250/313 [05:51<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.0815, Train/loss_recog_step=1.160, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  80%|███████▉  | 250/313 [05:51<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0778, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.0778, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  96%|█████████▌| 300/313 [06:58<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0778, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.0778, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5:  96%|█████████▌| 300/313 [06:58<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0857, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0857, Train/loss_recog_step=1.230, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5: 100%|██████████| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0857, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0857, Train/loss_recog_step=1.230, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5: 100%|██████████| 313/313 [07:12<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.0587, Train/loss_recog_step=1.150, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.132, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.548, Valid/loss_triplet_all_epoch=0.151, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.435, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  2.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.07it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.03it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.179943, 0.183054, 0.187655
Valid average loss UNet            (all)              : 0.550653

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093786, 0.440864, 0.808989
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.171258, 0.442857, 0.508763
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.211125, 0.525765, 0.546688
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.166858, 0.553240, 0.715915
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.142951, 0.626827, 0.740481
Valid average loss all      (Triplet)                 : 0.158497

== Recognize ==
Valid average loss Recognize     : 1.180716
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.158497

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.135976552963257 sec. =
Valid knn accuracy drums     : 74.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.09688115119934 sec. =
Valid knn accuracy bass      : 19.040697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.044281721115112 sec. =
Valid knn accuracy piano     : 34.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.807070016860962 sec. =
Valid knn accuracy guitar    : 32.62987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.343655109405518 sec. =
Valid knn accuracy residuals : 63.9937106918239%

Valid knn accuracy average   : 44.79660768650393%

                                                                        [AEpoch 5: 100%|██████████| 313/313 [09:46<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.0587, Train/loss_recog_step=1.150, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.562, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=1.230]Epoch 5: 100%|██████████| 313/313 [09:46<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.0587, Train/loss_recog_step=1.150, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187277, 0.187568, 0.186406
Train average loss UNet            (all)              : 0.561252

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.039410, 0.411485, 0.938382
Train average loss bass     (Triplet, dist_p, dist_n) : 0.147689, 0.371618, 0.472299
Train average loss piano    (Triplet, dist_p, dist_n) : 0.125438, 0.477392, 0.618069
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.108409, 0.466416, 0.670907
Train average loss residuals(Triplet, dist_p, dist_n) : 0.097906, 0.544632, 0.753544
Train average loss all      (Triplet)                 : 0.105061

== Recognize ==
Train average loss Recognize     : 1.198096
Train average accuracy drums     : 93.159996 %
Train average accuracy bass      : 96.456665 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.105061

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.0587, Train/loss_recog_step=1.150, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.0587, Train/loss_recog_step=1.150, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  16%|█▌        | 50/313 [01:16<06:43,  0.65it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.604, Train/loss_triplet_all_step=0.0587, Train/loss_recog_step=1.150, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  16%|█▌        | 50/313 [01:16<06:43,  0.65it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.160, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]  Epoch 6:  32%|███▏      | 100/313 [02:25<05:09,  0.69it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.160, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  32%|███▏      | 100/313 [02:25<05:09,  0.69it/s, v_num=0, Train/loss_all_step=0.099, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.099, Train/loss_recog_step=1.190, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  48%|████▊     | 150/313 [03:33<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.099, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.099, Train/loss_recog_step=1.190, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  48%|████▊     | 150/313 [03:33<03:52,  0.70it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.065, Train/loss_recog_step=1.070, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  64%|██████▍   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.065, Train/loss_recog_step=1.070, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  64%|██████▍   | 200/313 [04:42<02:39,  0.71it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=1.130, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  80%|███████▉  | 250/313 [05:49<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=1.130, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  80%|███████▉  | 250/313 [05:49<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.0693, Train/loss_recog_step=1.130, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  96%|█████████▌| 300/313 [06:59<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.0693, Train/loss_recog_step=1.130, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6:  96%|█████████▌| 300/313 [06:59<00:18,  0.72it/s, v_num=0, Train/loss_all_step=0.097, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.097, Train/loss_recog_step=1.230, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]  Epoch 6: 100%|██████████| 313/313 [07:13<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.097, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.097, Train/loss_recog_step=1.230, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6: 100%|██████████| 313/313 [07:13<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=1.120, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.158, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.448, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  3.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  3.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.06it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.182379, 0.185458, 0.190588
Valid average loss UNet            (all)              : 0.558424

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085651, 0.503188, 0.960866
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.218765, 0.487003, 0.502036
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199995, 0.579674, 0.650420
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.126544, 0.600440, 0.807964
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.186952, 0.686297, 0.759957
Valid average loss all      (Triplet)                 : 0.171612

== Recognize ==
Valid average loss Recognize     : 1.143948
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.171612

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.794305562973022 sec. =
Valid knn accuracy drums     : 73.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.437700033187866 sec. =
Valid knn accuracy bass      : 20.49418604651163%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.59726595878601 sec. =
Valid knn accuracy piano     : 36.75675675675676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.680567979812622 sec. =
Valid knn accuracy guitar    : 35.064935064935064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.50864028930664 sec. =
Valid knn accuracy residuals : 65.25157232704403%

Valid knn accuracy average   : 46.30760768610832%

                                                                        [AEpoch 6: 100%|██████████| 313/313 [09:45<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=1.120, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.200]Epoch 6: 100%|██████████| 313/313 [09:45<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=1.120, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187173, 0.187519, 0.186361
Train average loss UNet            (all)              : 0.561054

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.034650, 0.469705, 1.060798
Train average loss bass     (Triplet, dist_p, dist_n) : 0.139887, 0.431724, 0.553418
Train average loss piano    (Triplet, dist_p, dist_n) : 0.114901, 0.529862, 0.700315
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.102239, 0.536664, 0.775884
Train average loss residuals(Triplet, dist_p, dist_n) : 0.086009, 0.610075, 0.856043
Train average loss all      (Triplet)                 : 0.096879

== Recognize ==
Train average loss Recognize     : 1.167601
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.096879

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=1.120, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=1.120, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  16%|█▌        | 50/313 [01:16<06:44,  0.65it/s, v_num=0, Train/loss_all_step=0.0444, Train/loss_unet_all_step=0.605, Train/loss_triplet_all_step=0.0444, Train/loss_recog_step=1.120, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  16%|█▌        | 50/313 [01:16<06:44,  0.65it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=1.150, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  32%|███▏      | 100/313 [02:25<05:10,  0.69it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=1.150, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  32%|███▏      | 100/313 [02:25<05:10,  0.69it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=1.160, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  48%|████▊     | 150/313 [03:35<03:53,  0.70it/s, v_num=0, Train/loss_all_step=0.0958, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.0958, Train/loss_recog_step=1.160, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  48%|████▊     | 150/313 [03:35<03:53,  0.70it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=1.120, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  64%|██████▍   | 200/313 [04:44<02:40,  0.70it/s, v_num=0, Train/loss_all_step=0.0891, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.0891, Train/loss_recog_step=1.120, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  64%|██████▍   | 200/313 [04:44<02:40,  0.70it/s, v_num=0, Train/loss_all_step=0.0774, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0774, Train/loss_recog_step=1.140, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  80%|███████▉  | 250/313 [05:53<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0774, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.0774, Train/loss_recog_step=1.140, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  80%|███████▉  | 250/313 [05:53<01:28,  0.71it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.0563, Train/loss_recog_step=1.040, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  96%|█████████▌| 300/313 [07:00<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.0563, Train/loss_recog_step=1.040, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7:  96%|█████████▌| 300/313 [07:00<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0874, Train/loss_recog_step=1.150, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7: 100%|██████████| 313/313 [07:15<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0874, Train/loss_recog_step=1.150, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7: 100%|██████████| 313/313 [07:15<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.042, Train/loss_unet_all_step=0.606, Train/loss_triplet_all_step=0.042, Train/loss_recog_step=1.040, Valid/loss_all_step=0.210, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.463, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  2.79it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  2.94it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  3.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  3.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.180205, 0.183182, 0.188058
Valid average loss UNet            (all)              : 0.551445

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073438, 0.547768, 1.062856
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.223533, 0.526600, 0.531952
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.220607, 0.641532, 0.715626
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.150111, 0.641755, 0.823702
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.150962, 0.731010, 0.930874
Valid average loss all      (Triplet)                 : 0.176897

== Recognize ==
Valid average loss Recognize     : 1.086941
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.176897

= T-SNE...
T-SNE was finished!
= T-SNE time is 18.477036476135254 sec. =
Valid knn accuracy drums     : 69.85294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.43252992630005 sec. =
Valid knn accuracy bass      : 20.348837209302324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.24479603767395 sec. =
Valid knn accuracy piano     : 34.32432432432432%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.76174831390381 sec. =
Valid knn accuracy guitar    : 33.92857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.670448780059814 sec. =
Valid knn accuracy residuals : 67.13836477987421%

Valid knn accuracy average   : 45.11860778370858%

                                                                        [AEpoch 7: 100%|██████████| 313/313 [09:50<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.042, Train/loss_unet_all_step=0.606, Train/loss_triplet_all_step=0.042, Train/loss_recog_step=1.040, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0969, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0969, Train/loss_recog_epoch=1.170]Epoch 7: 100%|██████████| 313/313 [09:50<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.042, Train/loss_unet_all_step=0.606, Train/loss_triplet_all_step=0.042, Train/loss_recog_step=1.040, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187079, 0.187403, 0.186248
Train average loss UNet            (all)              : 0.560730

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.029387, 0.526128, 1.176681
Train average loss bass     (Triplet, dist_p, dist_n) : 0.135207, 0.494468, 0.631207
Train average loss piano    (Triplet, dist_p, dist_n) : 0.103720, 0.595123, 0.800272
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.094772, 0.584105, 0.844928
Train average loss residuals(Triplet, dist_p, dist_n) : 0.077404, 0.671642, 0.945170
Train average loss all      (Triplet)                 : 0.089753

== Recognize ==
Train average loss Recognize     : 1.142911
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.419998 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.089753

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.042, Train/loss_unet_all_step=0.606, Train/loss_triplet_all_step=0.042, Train/loss_recog_step=1.040, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.042, Train/loss_unet_all_step=0.606, Train/loss_triplet_all_step=0.042, Train/loss_recog_step=1.040, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  16%|█▌        | 50/313 [01:17<06:48,  0.64it/s, v_num=0, Train/loss_all_step=0.042, Train/loss_unet_all_step=0.606, Train/loss_triplet_all_step=0.042, Train/loss_recog_step=1.040, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  16%|█▌        | 50/313 [01:17<06:48,  0.64it/s, v_num=0, Train/loss_all_step=0.0807, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0807, Train/loss_recog_step=1.130, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  32%|███▏      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.0807, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.0807, Train/loss_recog_step=1.130, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  32%|███▏      | 100/313 [02:28<05:16,  0.67it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.062, Train/loss_recog_step=1.140, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]  Epoch 8:  48%|████▊     | 150/313 [03:36<03:55,  0.69it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.062, Train/loss_recog_step=1.140, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  48%|████▊     | 150/313 [03:36<03:55,  0.69it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0752, Train/loss_recog_step=1.100, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  64%|██████▍   | 200/313 [04:45<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.0752, Train/loss_recog_step=1.100, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  64%|██████▍   | 200/313 [04:45<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=1.130, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  80%|███████▉  | 250/313 [05:54<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0707, Train/loss_recog_step=1.130, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  80%|███████▉  | 250/313 [05:54<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0678, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.0678, Train/loss_recog_step=1.060, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  96%|█████████▌| 300/313 [07:02<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0678, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.0678, Train/loss_recog_step=1.060, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8:  96%|█████████▌| 300/313 [07:02<00:18,  0.71it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=1.180, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8: 100%|██████████| 313/313 [07:17<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0746, Train/loss_recog_step=1.180, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8: 100%|██████████| 313/313 [07:17<00:00,  0.72it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=1.070, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.555, Valid/loss_triplet_all_step=0.245, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.451, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:03<00:00,  2.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:03<00:00,  2.81it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:04<00:00,  2.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:03<00:00,  2.93it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:03<00:00,  2.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.182135, 0.185247, 0.190169
Valid average loss UNet            (all)              : 0.557552

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117404, 0.663074, 1.191821
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.271456, 0.665225, 0.629417
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.245058, 0.750524, 0.857923
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.135810, 0.784707, 1.070918
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.187558, 0.900377, 1.152596
Valid average loss all      (Triplet)                 : 0.203465

== Recognize ==
Valid average loss Recognize     : 1.107111
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.203465

= T-SNE...
T-SNE was finished!
= T-SNE time is 19.17657494544983 sec. =
Valid knn accuracy drums     : 70.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.94840979576111 sec. =
Valid knn accuracy bass      : 23.691860465116278%
= T-SNE...
T-SNE was finished!
= T-SNE time is 20.437604188919067 sec. =
Valid knn accuracy piano     : 32.972972972972975%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.01154589653015 sec. =
Valid knn accuracy guitar    : 32.3051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.464062452316284 sec. =
Valid knn accuracy residuals : 63.05031446540881%

Valid knn accuracy average   : 44.55112736526799%

                                                                        [AEpoch 8: 100%|██████████| 313/313 [09:51<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=1.070, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0898, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0898, Train/loss_recog_epoch=1.140]Epoch 8: 100%|██████████| 313/313 [09:51<00:00,  0.53it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=1.070, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.187110, 0.187438, 0.186313
Train average loss UNet            (all)              : 0.560861

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.026849, 0.599460, 1.316148
Train average loss bass     (Triplet, dist_p, dist_n) : 0.118758, 0.557028, 0.728495
Train average loss piano    (Triplet, dist_p, dist_n) : 0.092269, 0.668169, 0.914040
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.085754, 0.653290, 0.949234
Train average loss residuals(Triplet, dist_p, dist_n) : 0.065201, 0.759605, 1.086230
Train average loss all      (Triplet)                 : 0.078846

== Recognize ==
Train average loss Recognize     : 1.137220
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.078846

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=1.070, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=1.070, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  16%|█▌        | 50/313 [01:18<06:51,  0.64it/s, v_num=0, Train/loss_all_step=0.0263, Train/loss_unet_all_step=0.607, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=1.070, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  16%|█▌        | 50/313 [01:18<06:51,  0.64it/s, v_num=0, Train/loss_all_step=0.0869, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0869, Train/loss_recog_step=1.050, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  32%|███▏      | 100/313 [02:28<05:15,  0.67it/s, v_num=0, Train/loss_all_step=0.0869, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0869, Train/loss_recog_step=1.050, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  32%|███▏      | 100/313 [02:28<05:15,  0.67it/s, v_num=0, Train/loss_all_step=0.0606, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0606, Train/loss_recog_step=1.110, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  48%|████▊     | 150/313 [03:37<03:56,  0.69it/s, v_num=0, Train/loss_all_step=0.0606, Train/loss_unet_all_step=0.559, Train/loss_triplet_all_step=0.0606, Train/loss_recog_step=1.110, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  48%|████▊     | 150/313 [03:37<03:56,  0.69it/s, v_num=0, Train/loss_all_step=0.0543, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.0543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  64%|██████▍   | 200/313 [04:46<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0543, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.0543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  64%|██████▍   | 200/313 [04:46<02:41,  0.70it/s, v_num=0, Train/loss_all_step=0.0451, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0451, Train/loss_recog_step=1.070, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  80%|███████▉  | 250/313 [05:54<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0451, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.0451, Train/loss_recog_step=1.070, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]Epoch 9:  80%|███████▉  | 250/313 [05:54<01:29,  0.70it/s, v_num=0, Train/loss_all_step=0.0467, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.0467, Train/loss_recog_step=1.010, Valid/loss_all_step=0.272, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.203, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.446, Train/loss_all_epoch=0.0788, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.0788, Train/loss_recog_epoch=1.140]