
=== Using cuda(utils.func). ===

[2023-11-15 21:40:32,624][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-15 21:40:32,629][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mix_minus_inst: true                                                  
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 0                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: false                                                            
│         n_mels: 259                                                           
│       ckpt_model_path: null                                                   
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mix_minus_inst: true                                                  
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 0                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 200                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       num_sanity_val_steps: 0                                                 
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mix_minus_inst: true                                                    
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: false                                                              
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 0                                                         
│       unet_rate: 1                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       ckpt_model_path: null                                                   
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-15 21:40:32,720][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-15 21:40:32,751][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet_old). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-15 21:40:36,052][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp7l5ppfd_
[2023-11-15 21:40:36,053][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp7l5ppfd_/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-15 21:40:36,172][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-15 21:40:36,172][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-15 21:40:36,179][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-15 21:40:36,182][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-15 21:40:36,182][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-15 21:40:36,183][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-15 21:40:36,238][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-15 21:40:36,553][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-15 21:40:36,810][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6433947086334229 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [02:41<14:07,  0.31it/s]Epoch 0:  16%|█▌        | 50/313 [02:41<14:07,  0.31it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.137, Train/loss_triplet_all_step=1.260, Train/loss_recog_step=1.260]Epoch 0:  32%|███▏      | 100/313 [05:03<10:47,  0.33it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.137, Train/loss_triplet_all_step=1.260, Train/loss_recog_step=1.260]Epoch 0:  32%|███▏      | 100/313 [05:03<10:47,  0.33it/s, v_num=0, Train/loss_all_step=0.0994, Train/loss_unet_all_step=0.0994, Train/loss_triplet_all_step=0.985, Train/loss_recog_step=1.130]Epoch 0:  48%|████▊     | 150/313 [07:25<08:03,  0.34it/s, v_num=0, Train/loss_all_step=0.0994, Train/loss_unet_all_step=0.0994, Train/loss_triplet_all_step=0.985, Train/loss_recog_step=1.130]Epoch 0:  48%|████▊     | 150/313 [07:25<08:03,  0.34it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=1.310, Train/loss_recog_step=1.060]Epoch 0:  64%|██████▍   | 200/313 [09:48<05:32,  0.34it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=1.310, Train/loss_recog_step=1.060]Epoch 0:  64%|██████▍   | 200/313 [09:48<05:32,  0.34it/s, v_num=0, Train/loss_all_step=0.0967, Train/loss_unet_all_step=0.0967, Train/loss_triplet_all_step=1.090, Train/loss_recog_step=1.120]Epoch 0:  80%|███████▉  | 250/313 [12:08<03:03,  0.34it/s, v_num=0, Train/loss_all_step=0.0967, Train/loss_unet_all_step=0.0967, Train/loss_triplet_all_step=1.090, Train/loss_recog_step=1.120]Epoch 0:  80%|███████▉  | 250/313 [12:08<03:03,  0.34it/s, v_num=0, Train/loss_all_step=0.0846, Train/loss_unet_all_step=0.0846, Train/loss_triplet_all_step=1.020, Train/loss_recog_step=1.030]Epoch 0:  96%|█████████▌| 300/313 [14:31<00:37,  0.34it/s, v_num=0, Train/loss_all_step=0.0846, Train/loss_unet_all_step=0.0846, Train/loss_triplet_all_step=1.020, Train/loss_recog_step=1.030]Epoch 0:  96%|█████████▌| 300/313 [14:31<00:37,  0.34it/s, v_num=0, Train/loss_all_step=0.0785, Train/loss_unet_all_step=0.0785, Train/loss_triplet_all_step=1.300, Train/loss_recog_step=1.160]Epoch 0: 100%|██████████| 313/313 [15:04<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0785, Train/loss_unet_all_step=0.0785, Train/loss_triplet_all_step=1.300, Train/loss_recog_step=1.160]Epoch 0: 100%|██████████| 313/313 [15:04<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=0.849, Train/loss_recog_step=0.962]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.31it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.31it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025279, 0.024615, 0.030930
Valid average loss UNet            (all)              : 0.080824

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.426611, 2.735243, 4.218614
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.561207, 3.853199, 3.394433
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.782760, 3.557168, 2.405146
Valid average loss guitar   (Triplet, dist_p, dist_n) : 1.343422, 3.316042, 3.273998
Valid average loss residuals(Triplet, dist_p, dist_n) : 1.009699, 3.371154, 4.883063
Valid average loss all      (Triplet)                 : 1.332748

== Recognize ==
Valid average loss Recognize     : 1.006076
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.080824

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 12.859651803970337 sec. =
Valid knn accuracy drums     : 47.35294117647059%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 13.222551107406616 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 14.460915565490723 sec. =
Valid knn accuracy piano     : 19.864864864864863%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 12.070759296417236 sec. =
Valid knn accuracy guitar    : 17.694805194805195%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 12.156546115875244 sec. =
Valid knn accuracy residuals : 40.40880503144654%

Valid knn accuracy average   : 28.40730650933139%

                                                                        [AEpoch 0: 100%|██████████| 313/313 [17:38<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=0.849, Train/loss_recog_step=0.962, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284]Epoch 0: 100%|██████████| 313/313 [17:38<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=0.849, Train/loss_recog_step=0.962, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.042776, 0.042732, 0.042186
Train average loss UNet            (all)              : 0.127694

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.562139, 2.346473, 3.248885
Train average loss bass     (Triplet, dist_p, dist_n) : 1.519594, 3.290823, 2.679477
Train average loss piano    (Triplet, dist_p, dist_n) : 1.320690, 3.197084, 2.991775
Train average loss guitar   (Triplet, dist_p, dist_n) : 1.294863, 3.170846, 2.962738
Train average loss residuals(Triplet, dist_p, dist_n) : 1.045759, 3.017256, 3.205311
Train average loss all      (Triplet)                 : 1.156119

== Recognize ==
Train average loss Recognize     : 1.129780
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.127694

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=0.849, Train/loss_recog_step=0.962, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=0.849, Train/loss_recog_step=0.962, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.0981, Train/loss_triplet_all_step=0.849, Train/loss_recog_step=0.962, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0817, Train/loss_unet_all_step=0.0817, Train/loss_triplet_all_step=1.210, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0817, Train/loss_unet_all_step=0.0817, Train/loss_triplet_all_step=1.210, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.086, Train/loss_unet_all_step=0.086, Train/loss_triplet_all_step=0.820, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]  Epoch 1:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.086, Train/loss_unet_all_step=0.086, Train/loss_triplet_all_step=0.820, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0903, Train/loss_unet_all_step=0.0903, Train/loss_triplet_all_step=1.200, Train/loss_recog_step=0.969, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0903, Train/loss_unet_all_step=0.0903, Train/loss_triplet_all_step=1.200, Train/loss_recog_step=0.969, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0909, Train/loss_unet_all_step=0.0909, Train/loss_triplet_all_step=0.946, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0909, Train/loss_unet_all_step=0.0909, Train/loss_triplet_all_step=0.946, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.999, Train/loss_recog_step=0.958, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.999, Train/loss_recog_step=0.958, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=1.150, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=1.150, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]Epoch 1: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.094, Train/loss_triplet_all_step=0.816, Train/loss_recog_step=0.921, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=1.690, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0808, Valid/loss_unet_all_epoch=0.0808, Valid/loss_triplet_all_epoch=1.330, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.284, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.33it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.024448, 0.024065, 0.029460
Valid average loss UNet            (all)              : 0.077973

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.379833, 2.443274, 3.713032
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.415240, 3.528966, 2.942621
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.578182, 3.283474, 2.275111
Valid average loss guitar   (Triplet, dist_p, dist_n) : 1.185413, 2.841435, 2.928650
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.718669, 2.786799, 3.960275
Valid average loss all      (Triplet)                 : 1.149331

== Recognize ==
Valid average loss Recognize     : 0.977674
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.077973

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.837525844573975 sec. =
Valid knn accuracy drums     : 55.294117647058826%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.966145277023315 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.173383235931396 sec. =
Valid knn accuracy piano     : 19.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.129530906677246 sec. =
Valid knn accuracy guitar    : 16.071428571428573%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.434969425201416 sec. =
Valid knn accuracy residuals : 47.327044025157235%

Valid knn accuracy average   : 30.15539422723301%

                                                                        [AEpoch 1: 100%|██████████| 313/313 [17:13<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.094, Train/loss_triplet_all_step=0.816, Train/loss_recog_step=0.921, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.128, Train/loss_triplet_all_epoch=1.160, Train/loss_recog_epoch=1.130]  Epoch 1: 100%|██████████| 313/313 [17:13<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.094, Train/loss_triplet_all_step=0.816, Train/loss_recog_step=0.921, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.027919, 0.027870, 0.027235
Train average loss UNet            (all)              : 0.083024

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.468427, 2.324711, 3.166828
Train average loss bass     (Triplet, dist_p, dist_n) : 1.402816, 3.218349, 2.611369
Train average loss piano    (Triplet, dist_p, dist_n) : 1.130829, 2.911366, 2.719793
Train average loss guitar   (Triplet, dist_p, dist_n) : 1.142714, 2.968011, 2.744046
Train average loss residuals(Triplet, dist_p, dist_n) : 0.862919, 2.853449, 3.099475
Train average loss all      (Triplet)                 : 1.007150

== Recognize ==
Train average loss Recognize     : 1.052564
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.083024

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.094, Train/loss_triplet_all_step=0.816, Train/loss_recog_step=0.921, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.094, Train/loss_triplet_all_step=0.816, Train/loss_recog_step=0.921, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.094, Train/loss_unet_all_step=0.094, Train/loss_triplet_all_step=0.816, Train/loss_recog_step=0.921, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0823, Train/loss_unet_all_step=0.0823, Train/loss_triplet_all_step=1.030, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  32%|███▏      | 100/313 [04:50<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0823, Train/loss_unet_all_step=0.0823, Train/loss_triplet_all_step=1.030, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  32%|███▏      | 100/313 [04:50<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0832, Train/loss_unet_all_step=0.0832, Train/loss_triplet_all_step=0.693, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0832, Train/loss_unet_all_step=0.0832, Train/loss_triplet_all_step=0.693, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.0874, Train/loss_triplet_all_step=0.968, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0874, Train/loss_unet_all_step=0.0874, Train/loss_triplet_all_step=0.968, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.0887, Train/loss_triplet_all_step=0.770, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  80%|███████▉  | 250/313 [11:54<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0887, Train/loss_unet_all_step=0.0887, Train/loss_triplet_all_step=0.770, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  80%|███████▉  | 250/313 [11:54<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0769, Train/loss_unet_all_step=0.0769, Train/loss_triplet_all_step=0.806, Train/loss_recog_step=0.965, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0769, Train/loss_unet_all_step=0.0769, Train/loss_triplet_all_step=0.806, Train/loss_recog_step=0.965, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.0714, Train/loss_triplet_all_step=1.100, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.0714, Train/loss_triplet_all_step=1.100, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.0915, Train/loss_triplet_all_step=0.791, Train/loss_recog_step=0.923, Valid/loss_all_step=0.0593, Valid/loss_unet_all_step=0.0593, Valid/loss_triplet_all_step=1.410, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.078, Valid/loss_unet_all_epoch=0.078, Valid/loss_triplet_all_epoch=1.150, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.302, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025221, 0.025538, 0.029329
Valid average loss UNet            (all)              : 0.080088

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.384051, 2.471116, 3.379245
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.241588, 3.338443, 2.714179
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.355507, 3.133145, 2.322608
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.967571, 2.797155, 2.880752
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.596278, 2.775238, 3.767667
Valid average loss all      (Triplet)                 : 0.972180

== Recognize ==
Valid average loss Recognize     : 0.925645
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.080088

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.90538215637207 sec. =
Valid knn accuracy drums     : 52.94117647058824%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.874263763427734 sec. =
Valid knn accuracy bass      : 12.209302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.178403377532959 sec. =
Valid knn accuracy piano     : 17.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.111852645874023 sec. =
Valid knn accuracy guitar    : 16.071428571428573%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.210843563079834 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 30.319513209028738%

                                                                        [AEpoch 2: 100%|██████████| 313/313 [17:21<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.0915, Train/loss_triplet_all_step=0.791, Train/loss_recog_step=0.923, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.083, Train/loss_unet_all_epoch=0.083, Train/loss_triplet_all_epoch=1.010, Train/loss_recog_epoch=1.050]Epoch 2: 100%|██████████| 313/313 [17:21<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.0915, Train/loss_triplet_all_step=0.791, Train/loss_recog_step=0.923, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.026972, 0.026884, 0.026286
Train average loss UNet            (all)              : 0.080142

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.404604, 2.299541, 3.031260
Train average loss bass     (Triplet, dist_p, dist_n) : 1.231501, 3.023716, 2.473761
Train average loss piano    (Triplet, dist_p, dist_n) : 1.007515, 2.787630, 2.594471
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.990363, 2.808843, 2.627028
Train average loss residuals(Triplet, dist_p, dist_n) : 0.739750, 2.730507, 2.930805
Train average loss all      (Triplet)                 : 0.879849

== Recognize ==
Train average loss Recognize     : 1.029592
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.080142

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.0915, Train/loss_triplet_all_step=0.791, Train/loss_recog_step=0.923, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.0915, Train/loss_triplet_all_step=0.791, Train/loss_recog_step=0.923, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  16%|█▌        | 50/313 [02:22<12:28,  0.35it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.0915, Train/loss_triplet_all_step=0.791, Train/loss_recog_step=0.923, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  16%|█▌        | 50/313 [02:22<12:28,  0.35it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.078, Train/loss_triplet_all_step=0.950, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]  Epoch 3:  32%|███▏      | 100/313 [04:38<09:52,  0.36it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.078, Train/loss_triplet_all_step=0.950, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  32%|███▏      | 100/313 [04:38<09:52,  0.36it/s, v_num=0, Train/loss_all_step=0.080, Train/loss_unet_all_step=0.080, Train/loss_triplet_all_step=0.679, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  48%|████▊     | 150/313 [06:53<07:29,  0.36it/s, v_num=0, Train/loss_all_step=0.080, Train/loss_unet_all_step=0.080, Train/loss_triplet_all_step=0.679, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  48%|████▊     | 150/313 [06:53<07:29,  0.36it/s, v_num=0, Train/loss_all_step=0.0844, Train/loss_unet_all_step=0.0844, Train/loss_triplet_all_step=0.893, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  64%|██████▍   | 200/313 [09:08<05:09,  0.36it/s, v_num=0, Train/loss_all_step=0.0844, Train/loss_unet_all_step=0.0844, Train/loss_triplet_all_step=0.893, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  64%|██████▍   | 200/313 [09:08<05:09,  0.36it/s, v_num=0, Train/loss_all_step=0.0873, Train/loss_unet_all_step=0.0873, Train/loss_triplet_all_step=0.751, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  80%|███████▉  | 250/313 [11:31<02:54,  0.36it/s, v_num=0, Train/loss_all_step=0.0873, Train/loss_unet_all_step=0.0873, Train/loss_triplet_all_step=0.751, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  80%|███████▉  | 250/313 [11:31<02:54,  0.36it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.0746, Train/loss_triplet_all_step=0.754, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  96%|█████████▌| 300/313 [13:50<00:36,  0.36it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.0746, Train/loss_triplet_all_step=0.754, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3:  96%|█████████▌| 300/313 [13:50<00:36,  0.36it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.0692, Train/loss_triplet_all_step=1.020, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3: 100%|██████████| 313/313 [14:24<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.0692, Train/loss_triplet_all_step=1.020, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]Epoch 3: 100%|██████████| 313/313 [14:24<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.0886, Train/loss_triplet_all_step=0.776, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0594, Valid/loss_unet_all_step=0.0594, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0801, Valid/loss_unet_all_epoch=0.0801, Valid/loss_triplet_all_epoch=0.972, Valid/loss_recog_epoch=0.926, Valid/knn_avr=0.303, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.30it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.22it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023416, 0.022913, 0.027646
Valid average loss UNet            (all)              : 0.073976

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.295366, 2.351353, 3.277278
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.183628, 3.243911, 2.653684
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.397846, 3.119777, 2.279113
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.876585, 2.746431, 2.924752
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.597667, 2.668072, 3.646176
Valid average loss all      (Triplet)                 : 0.937553

== Recognize ==
Valid average loss Recognize     : 0.945367
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.073976

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.335322141647339 sec. =
Valid knn accuracy drums     : 56.470588235294116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.314443588256836 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.023885250091553 sec. =
Valid knn accuracy piano     : 17.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.756406307220459 sec. =
Valid knn accuracy guitar    : 16.071428571428573%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.16906213760376 sec. =
Valid knn accuracy residuals : 46.540880503144656%

Valid knn accuracy average   : 30.376290335637833%

                                                                        [AEpoch 3: 100%|██████████| 313/313 [16:52<00:00,  0.31it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.0886, Train/loss_triplet_all_step=0.776, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.0801, Train/loss_unet_all_epoch=0.0801, Train/loss_triplet_all_epoch=0.880, Train/loss_recog_epoch=1.030]  Epoch 3: 100%|██████████| 313/313 [16:53<00:00,  0.31it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.0886, Train/loss_triplet_all_step=0.776, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.026250, 0.026175, 0.025602
Train average loss UNet            (all)              : 0.078027

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.371237, 2.277248, 2.963056
Train average loss bass     (Triplet, dist_p, dist_n) : 1.183227, 2.986266, 2.443267
Train average loss piano    (Triplet, dist_p, dist_n) : 0.946150, 2.738798, 2.567398
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.961895, 2.840087, 2.677439
Train average loss residuals(Triplet, dist_p, dist_n) : 0.720393, 2.737571, 2.908957
Train average loss all      (Triplet)                 : 0.842089

== Recognize ==
Train average loss Recognize     : 1.020774
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.078027

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.0886, Train/loss_triplet_all_step=0.776, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.0886, Train/loss_triplet_all_step=0.776, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0886, Train/loss_unet_all_step=0.0886, Train/loss_triplet_all_step=0.776, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.921, Train/loss_recog_step=0.991, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  32%|███▏      | 100/313 [04:49<10:16,  0.35it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.921, Train/loss_recog_step=0.991, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  32%|███▏      | 100/313 [04:49<10:16,  0.35it/s, v_num=0, Train/loss_all_step=0.0772, Train/loss_unet_all_step=0.0772, Train/loss_triplet_all_step=0.632, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0772, Train/loss_unet_all_step=0.0772, Train/loss_triplet_all_step=0.632, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0829, Train/loss_unet_all_step=0.0829, Train/loss_triplet_all_step=0.818, Train/loss_recog_step=0.926, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0829, Train/loss_unet_all_step=0.0829, Train/loss_triplet_all_step=0.818, Train/loss_recog_step=0.926, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.766, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.766, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0733, Train/loss_unet_all_step=0.0733, Train/loss_triplet_all_step=0.706, Train/loss_recog_step=0.937, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0733, Train/loss_unet_all_step=0.0733, Train/loss_triplet_all_step=0.706, Train/loss_recog_step=0.937, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0677, Train/loss_unet_all_step=0.0677, Train/loss_triplet_all_step=0.999, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4: 100%|██████████| 313/313 [14:49<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0677, Train/loss_unet_all_step=0.0677, Train/loss_triplet_all_step=0.999, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4: 100%|██████████| 313/313 [14:49<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0881, Train/loss_unet_all_step=0.0881, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0576, Valid/loss_unet_all_step=0.0576, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.074, Valid/loss_unet_all_epoch=0.074, Valid/loss_triplet_all_epoch=0.938, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.304, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023260, 0.023156, 0.027506
Valid average loss UNet            (all)              : 0.073922

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.313742, 2.365120, 3.186478
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.168074, 3.187395, 2.581760
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.271004, 3.029412, 2.259481
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.812745, 2.682521, 2.802248
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.517719, 2.546786, 3.435423
Valid average loss all      (Triplet)                 : 0.879693

== Recognize ==
Valid average loss Recognize     : 0.928222
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.073922

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.051271915435791 sec. =
Valid knn accuracy drums     : 57.79411764705882%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.6065993309021 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.444880247116089 sec. =
Valid knn accuracy piano     : 20.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.091028213500977 sec. =
Valid knn accuracy guitar    : 18.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.250962018966675 sec. =
Valid knn accuracy residuals : 49.84276729559748%

Valid knn accuracy average   : 32.22286173634159%

                                                                        [AEpoch 4: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0881, Train/loss_unet_all_step=0.0881, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.078, Train/loss_unet_all_epoch=0.078, Train/loss_triplet_all_epoch=0.842, Train/loss_recog_epoch=1.020]Epoch 4: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0881, Train/loss_unet_all_step=0.0881, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.025633, 0.025593, 0.025035
Train average loss UNet            (all)              : 0.076262

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.351361, 2.252796, 2.864281
Train average loss bass     (Triplet, dist_p, dist_n) : 1.141169, 2.979531, 2.456579
Train average loss piano    (Triplet, dist_p, dist_n) : 0.898516, 2.697327, 2.538975
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.883333, 2.764994, 2.627417
Train average loss residuals(Triplet, dist_p, dist_n) : 0.683261, 2.697744, 2.850470
Train average loss all      (Triplet)                 : 0.797429

== Recognize ==
Train average loss Recognize     : 1.013457
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.076262

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0881, Train/loss_unet_all_step=0.0881, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0881, Train/loss_unet_all_step=0.0881, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  16%|█▌        | 50/313 [02:24<12:42,  0.35it/s, v_num=0, Train/loss_all_step=0.0881, Train/loss_unet_all_step=0.0881, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=0.911, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  16%|█▌        | 50/313 [02:24<12:42,  0.35it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.914, Train/loss_recog_step=0.994, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]  Epoch 5:  32%|███▏      | 100/313 [04:43<10:04,  0.35it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.914, Train/loss_recog_step=0.994, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  32%|███▏      | 100/313 [04:43<10:04,  0.35it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.0746, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  48%|████▊     | 150/313 [07:02<07:38,  0.36it/s, v_num=0, Train/loss_all_step=0.0746, Train/loss_unet_all_step=0.0746, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  48%|████▊     | 150/313 [07:02<07:38,  0.36it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.814, Train/loss_recog_step=0.926, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  64%|██████▍   | 200/313 [09:22<05:17,  0.36it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.814, Train/loss_recog_step=0.926, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  64%|██████▍   | 200/313 [09:22<05:17,  0.36it/s, v_num=0, Train/loss_all_step=0.0831, Train/loss_unet_all_step=0.0831, Train/loss_triplet_all_step=0.709, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  80%|███████▉  | 250/313 [11:44<02:57,  0.35it/s, v_num=0, Train/loss_all_step=0.0831, Train/loss_unet_all_step=0.0831, Train/loss_triplet_all_step=0.709, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  80%|███████▉  | 250/313 [11:44<02:57,  0.35it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.752, Train/loss_recog_step=0.938, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  96%|█████████▌| 300/313 [14:05<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.752, Train/loss_recog_step=0.938, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5:  96%|█████████▌| 300/313 [14:05<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.967, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5: 100%|██████████| 313/313 [14:39<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.967, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]Epoch 5: 100%|██████████| 313/313 [14:39<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.707, Train/loss_recog_step=0.906, Valid/loss_all_step=0.0572, Valid/loss_unet_all_step=0.0572, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0739, Valid/loss_unet_all_epoch=0.0739, Valid/loss_triplet_all_epoch=0.880, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.322, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022931, 0.022878, 0.027231
Valid average loss UNet            (all)              : 0.073039

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.256479, 2.306852, 3.186052
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.130829, 3.082260, 2.500493
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.238115, 2.999700, 2.244962
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.831083, 2.720283, 2.816664
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.551822, 2.532297, 3.466314
Valid average loss all      (Triplet)                 : 0.866044

== Recognize ==
Valid average loss Recognize     : 0.973170
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.073039

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.995466470718384 sec. =
Valid knn accuracy drums     : 61.617647058823536%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.785009384155273 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.638801574707031 sec. =
Valid knn accuracy piano     : 20.27027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.938918828964233 sec. =
Valid knn accuracy guitar    : 19.155844155844157%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.745070219039917 sec. =
Valid knn accuracy residuals : 49.21383647798742%

Valid knn accuracy average   : 33.161984708864146%

                                                                        [AEpoch 5: 100%|██████████| 313/313 [17:08<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.707, Train/loss_recog_step=0.906, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.0763, Train/loss_unet_all_epoch=0.0763, Train/loss_triplet_all_epoch=0.797, Train/loss_recog_epoch=1.010]  Epoch 5: 100%|██████████| 313/313 [17:08<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.707, Train/loss_recog_step=0.906, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.025205, 0.025150, 0.024628
Train average loss UNet            (all)              : 0.074983

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.349781, 2.287805, 2.891525
Train average loss bass     (Triplet, dist_p, dist_n) : 1.090670, 2.929177, 2.429224
Train average loss piano    (Triplet, dist_p, dist_n) : 0.891105, 2.734735, 2.576751
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.864686, 2.805539, 2.679973
Train average loss residuals(Triplet, dist_p, dist_n) : 0.632868, 2.645757, 2.811992
Train average loss all      (Triplet)                 : 0.771034

== Recognize ==
Train average loss Recognize     : 1.012185
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.074983

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.707, Train/loss_recog_step=0.906, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.707, Train/loss_recog_step=0.906, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.0853, Train/loss_unet_all_step=0.0853, Train/loss_triplet_all_step=0.707, Train/loss_recog_step=0.906, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.0723, Train/loss_unet_all_step=0.0723, Train/loss_triplet_all_step=0.899, Train/loss_recog_step=0.992, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0723, Train/loss_unet_all_step=0.0723, Train/loss_triplet_all_step=0.899, Train/loss_recog_step=0.992, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0741, Train/loss_unet_all_step=0.0741, Train/loss_triplet_all_step=0.585, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0741, Train/loss_unet_all_step=0.0741, Train/loss_triplet_all_step=0.585, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.819, Train/loss_recog_step=0.927, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  64%|██████▍   | 200/313 [09:36<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.819, Train/loss_recog_step=0.927, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  64%|██████▍   | 200/313 [09:36<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0831, Train/loss_unet_all_step=0.0831, Train/loss_triplet_all_step=0.698, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0831, Train/loss_unet_all_step=0.0831, Train/loss_triplet_all_step=0.698, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0717, Train/loss_unet_all_step=0.0717, Train/loss_triplet_all_step=0.762, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0717, Train/loss_unet_all_step=0.0717, Train/loss_triplet_all_step=0.762, Train/loss_recog_step=0.947, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.933, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.933, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0845, Train/loss_unet_all_step=0.0845, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=0.919, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.959, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.866, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.332, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022897, 0.022550, 0.027390
Valid average loss UNet            (all)              : 0.072838

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.276240, 2.290718, 3.032850
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.065166, 2.918837, 2.375341
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.130756, 2.889818, 2.251825
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.737374, 2.549101, 2.670909
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.523878, 2.501563, 3.389103
Valid average loss all      (Triplet)                 : 0.810457

== Recognize ==
Valid average loss Recognize     : 0.968451
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.072838

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.556488513946533 sec. =
Valid knn accuracy drums     : 63.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.49649953842163 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.432948350906372 sec. =
Valid knn accuracy piano     : 19.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.198740482330322 sec. =
Valid knn accuracy guitar    : 20.12987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.739601135253906 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 34.17513302546082%

                                                                        [AEpoch 6: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0845, Train/loss_unet_all_step=0.0845, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=0.919, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.075, Train/loss_unet_all_epoch=0.075, Train/loss_triplet_all_epoch=0.771, Train/loss_recog_epoch=1.010]Epoch 6: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0845, Train/loss_unet_all_step=0.0845, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=0.919, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.024807, 0.024731, 0.024223
Train average loss UNet            (all)              : 0.073761

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.327528, 2.302637, 2.902512
Train average loss bass     (Triplet, dist_p, dist_n) : 1.092026, 2.933909, 2.421663
Train average loss piano    (Triplet, dist_p, dist_n) : 0.873583, 2.753780, 2.595908
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.845968, 2.787494, 2.662007
Train average loss residuals(Triplet, dist_p, dist_n) : 0.638156, 2.722277, 2.892215
Train average loss all      (Triplet)                 : 0.761151

== Recognize ==
Train average loss Recognize     : 1.016097
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.073761

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0845, Train/loss_unet_all_step=0.0845, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=0.919, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0845, Train/loss_unet_all_step=0.0845, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=0.919, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  16%|█▌        | 50/313 [02:29<13:06,  0.33it/s, v_num=0, Train/loss_all_step=0.0845, Train/loss_unet_all_step=0.0845, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=0.919, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  16%|█▌        | 50/313 [02:29<13:06,  0.33it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.0721, Train/loss_triplet_all_step=0.855, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  32%|███▏      | 100/313 [04:52<10:23,  0.34it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.0721, Train/loss_triplet_all_step=0.855, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  32%|███▏      | 100/313 [04:52<10:23,  0.34it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.603, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  48%|████▊     | 150/313 [07:14<07:52,  0.34it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.603, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  48%|████▊     | 150/313 [07:14<07:52,  0.34it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.768, Train/loss_recog_step=0.951, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.768, Train/loss_recog_step=0.951, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.0815, Train/loss_triplet_all_step=0.616, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0815, Train/loss_unet_all_step=0.0815, Train/loss_triplet_all_step=0.616, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.728, Train/loss_recog_step=0.964, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]  Epoch 7:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.728, Train/loss_recog_step=0.964, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.893, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.893, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.0836, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0569, Valid/loss_unet_all_step=0.0569, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0728, Valid/loss_unet_all_epoch=0.0728, Valid/loss_triplet_all_epoch=0.810, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.342, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.21it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023901, 0.023238, 0.028268
Valid average loss UNet            (all)              : 0.075407

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.241658, 2.144625, 2.871128
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.988889, 2.833092, 2.339233
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.057107, 2.732727, 2.151101
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.722400, 2.467222, 2.527617
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.504351, 2.467260, 3.183288
Valid average loss all      (Triplet)                 : 0.759951

== Recognize ==
Valid average loss Recognize     : 0.989495
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.075407

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.285269498825073 sec. =
Valid knn accuracy drums     : 58.970588235294116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.706423997879028 sec. =
Valid knn accuracy bass      : 12.936046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.684520721435547 sec. =
Valid knn accuracy piano     : 21.216216216216218%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.113459587097168 sec. =
Valid knn accuracy guitar    : 20.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.694117546081543 sec. =
Valid knn accuracy residuals : 51.729559748427675%

Valid knn accuracy average   : 33.12632629815734%

                                                                        [AEpoch 7: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.0836, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0738, Train/loss_unet_all_epoch=0.0738, Train/loss_triplet_all_epoch=0.761, Train/loss_recog_epoch=1.020]Epoch 7: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.0836, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.024498, 0.024442, 0.023921
Train average loss UNet            (all)              : 0.072862

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.311627, 2.261453, 2.840279
Train average loss bass     (Triplet, dist_p, dist_n) : 1.052815, 2.894313, 2.403875
Train average loss piano    (Triplet, dist_p, dist_n) : 0.822900, 2.678507, 2.531054
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.802718, 2.713723, 2.606187
Train average loss residuals(Triplet, dist_p, dist_n) : 0.618574, 2.652261, 2.797940
Train average loss all      (Triplet)                 : 0.726853

== Recognize ==
Train average loss Recognize     : 1.032428
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.072862

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.0836, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.0836, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  16%|█▌        | 50/313 [02:27<12:57,  0.34it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.0836, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=0.936, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  16%|█▌        | 50/313 [02:27<12:57,  0.34it/s, v_num=0, Train/loss_all_step=0.0703, Train/loss_unet_all_step=0.0703, Train/loss_triplet_all_step=0.787, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0703, Train/loss_unet_all_step=0.0703, Train/loss_triplet_all_step=0.787, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.077, Train/loss_triplet_all_step=0.737, Train/loss_recog_step=0.957, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]  Epoch 8:  64%|██████▍   | 200/313 [09:38<05:27,  0.35it/s, v_num=0, Train/loss_all_step=0.077, Train/loss_unet_all_step=0.077, Train/loss_triplet_all_step=0.737, Train/loss_recog_step=0.957, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  64%|██████▍   | 200/313 [09:38<05:27,  0.35it/s, v_num=0, Train/loss_all_step=0.080, Train/loss_unet_all_step=0.080, Train/loss_triplet_all_step=0.622, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.080, Train/loss_unet_all_step=0.080, Train/loss_triplet_all_step=0.622, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.713, Train/loss_recog_step=0.970, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.713, Train/loss_recog_step=0.970, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.064, Train/loss_triplet_all_step=0.864, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]  Epoch 8: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.064, Train/loss_triplet_all_step=0.864, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.0835, Train/loss_triplet_all_step=0.621, Train/loss_recog_step=0.945, Valid/loss_all_step=0.0592, Valid/loss_unet_all_step=0.0592, Valid/loss_triplet_all_step=0.870, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.760, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.331, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022753, 0.022989, 0.025971
Valid average loss UNet            (all)              : 0.071713

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.238246, 2.257591, 3.008153
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.027564, 2.918934, 2.389938
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.069232, 2.757335, 2.180928
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.719586, 2.570618, 2.693072
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.509097, 2.549959, 3.233875
Valid average loss all      (Triplet)                 : 0.778814

== Recognize ==
Valid average loss Recognize     : 1.011602
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.071713

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.594749450683594 sec. =
Valid knn accuracy drums     : 62.794117647058826%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.137747287750244 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.605378150939941 sec. =
Valid knn accuracy piano     : 20.81081081081081%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.960268020629883 sec. =
Valid knn accuracy guitar    : 20.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.5814950466156 sec. =
Valid knn accuracy residuals : 50.786163522012586%

Valid knn accuracy average   : 34.028248598332226%

                                                                        [AEpoch 8: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.0835, Train/loss_triplet_all_step=0.621, Train/loss_recog_step=0.945, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.0729, Train/loss_unet_all_epoch=0.0729, Train/loss_triplet_all_epoch=0.727, Train/loss_recog_epoch=1.030]Epoch 8: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.0835, Train/loss_triplet_all_step=0.621, Train/loss_recog_step=0.945, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.024220, 0.024157, 0.023658
Train average loss UNet            (all)              : 0.072035

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.302598, 2.254238, 2.824658
Train average loss bass     (Triplet, dist_p, dist_n) : 1.023154, 2.855524, 2.381116
Train average loss piano    (Triplet, dist_p, dist_n) : 0.784868, 2.611680, 2.477310
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.776440, 2.676287, 2.578527
Train average loss residuals(Triplet, dist_p, dist_n) : 0.596629, 2.601762, 2.736688
Train average loss all      (Triplet)                 : 0.701987

== Recognize ==
Train average loss Recognize     : 1.037264
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.072035

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.0835, Train/loss_triplet_all_step=0.621, Train/loss_recog_step=0.945, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.0835, Train/loss_triplet_all_step=0.621, Train/loss_recog_step=0.945, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.0835, Train/loss_triplet_all_step=0.621, Train/loss_recog_step=0.945, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.758, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  32%|███▏      | 100/313 [04:47<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.758, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  32%|███▏      | 100/313 [04:47<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.0721, Train/loss_triplet_all_step=0.588, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.0721, Train/loss_triplet_all_step=0.588, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0764, Train/loss_unet_all_step=0.0764, Train/loss_triplet_all_step=0.711, Train/loss_recog_step=0.958, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0764, Train/loss_unet_all_step=0.0764, Train/loss_triplet_all_step=0.711, Train/loss_recog_step=0.958, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0798, Train/loss_unet_all_step=0.0798, Train/loss_triplet_all_step=0.588, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0798, Train/loss_unet_all_step=0.0798, Train/loss_triplet_all_step=0.588, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0691, Train/loss_unet_all_step=0.0691, Train/loss_triplet_all_step=0.700, Train/loss_recog_step=0.973, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  96%|█████████▌| 300/313 [14:13<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0691, Train/loss_unet_all_step=0.0691, Train/loss_triplet_all_step=0.700, Train/loss_recog_step=0.973, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9:  96%|█████████▌| 300/313 [14:13<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.0636, Train/loss_triplet_all_step=0.908, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.0636, Train/loss_triplet_all_step=0.908, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0824, Train/loss_unet_all_step=0.0824, Train/loss_triplet_all_step=0.654, Train/loss_recog_step=0.944, Valid/loss_all_step=0.0536, Valid/loss_unet_all_step=0.0536, Valid/loss_triplet_all_step=0.940, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0717, Valid/loss_unet_all_epoch=0.0717, Valid/loss_triplet_all_epoch=0.779, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.340, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022355, 0.022653, 0.025603
Valid average loss UNet            (all)              : 0.070611

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.236621, 2.203416, 2.962680
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.053435, 2.888492, 2.350699
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.061818, 2.713079, 2.162034
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.711136, 2.544271, 2.688157
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.503244, 2.508244, 3.197054
Valid average loss all      (Triplet)                 : 0.782409

== Recognize ==
Valid average loss Recognize     : 1.021575
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070611

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.574540853500366 sec. =
Valid knn accuracy drums     : 63.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.57188892364502 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.488201141357422 sec. =
Valid knn accuracy piano     : 20.81081081081081%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.986457824707031 sec. =
Valid knn accuracy guitar    : 22.07792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.565574645996094 sec. =
Valid knn accuracy residuals : 48.58490566037736%

Valid knn accuracy average   : 34.13946095195611%

                                                                        [AEpoch 9: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0824, Train/loss_unet_all_step=0.0824, Train/loss_triplet_all_step=0.654, Train/loss_recog_step=0.944, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.072, Train/loss_unet_all_epoch=0.072, Train/loss_triplet_all_epoch=0.702, Train/loss_recog_epoch=1.040]Epoch 9: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0824, Train/loss_unet_all_step=0.0824, Train/loss_triplet_all_step=0.654, Train/loss_recog_step=0.944, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.023940, 0.023883, 0.023387
Train average loss UNet            (all)              : 0.071209

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.295552, 2.276881, 2.877687
Train average loss bass     (Triplet, dist_p, dist_n) : 1.014326, 2.863479, 2.392666
Train average loss piano    (Triplet, dist_p, dist_n) : 0.772360, 2.606244, 2.472669
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.773112, 2.693063, 2.599319
Train average loss residuals(Triplet, dist_p, dist_n) : 0.582929, 2.591801, 2.727616
Train average loss all      (Triplet)                 : 0.693104

== Recognize ==
Train average loss Recognize     : 1.040110
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.071209

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0824, Train/loss_unet_all_step=0.0824, Train/loss_triplet_all_step=0.654, Train/loss_recog_step=0.944, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0824, Train/loss_unet_all_step=0.0824, Train/loss_triplet_all_step=0.654, Train/loss_recog_step=0.944, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  16%|█▌        | 50/313 [02:26<12:51,  0.34it/s, v_num=0, Train/loss_all_step=0.0824, Train/loss_unet_all_step=0.0824, Train/loss_triplet_all_step=0.654, Train/loss_recog_step=0.944, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  16%|█▌        | 50/313 [02:26<12:51,  0.34it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.756, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.756, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.587, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]  Epoch 10:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.587, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0753, Train/loss_unet_all_step=0.0753, Train/loss_triplet_all_step=0.739, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0753, Train/loss_unet_all_step=0.0753, Train/loss_triplet_all_step=0.739, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.079, Train/loss_unet_all_step=0.079, Train/loss_triplet_all_step=0.592, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]  Epoch 10:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.079, Train/loss_unet_all_step=0.079, Train/loss_triplet_all_step=0.592, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.701, Train/loss_recog_step=0.979, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  96%|█████████▌| 300/313 [14:13<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.701, Train/loss_recog_step=0.979, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10:  96%|█████████▌| 300/313 [14:13<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.884, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.884, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.0813, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.782, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023769, 0.023785, 0.027826
Valid average loss UNet            (all)              : 0.075380

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.231657, 2.240665, 2.986167
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.024053, 2.922015, 2.398579
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.998726, 2.673984, 2.182172
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.764304, 2.581428, 2.629667
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.454243, 2.425316, 3.197466
Valid average loss all      (Triplet)                 : 0.761677

== Recognize ==
Valid average loss Recognize     : 0.993789
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.075380

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.662264347076416 sec. =
Valid knn accuracy drums     : 60.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.47153639793396 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.81156587600708 sec. =
Valid knn accuracy piano     : 21.216216216216218%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.296574831008911 sec. =
Valid knn accuracy guitar    : 21.1038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.635637283325195 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 34.0728786875123%

                                                                        [AEpoch 10: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.0813, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0712, Train/loss_unet_all_epoch=0.0712, Train/loss_triplet_all_epoch=0.693, Train/loss_recog_epoch=1.040]Epoch 10: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.0813, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.023733, 0.023682, 0.023195
Train average loss UNet            (all)              : 0.070610

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.280812, 2.271494, 2.902632
Train average loss bass     (Triplet, dist_p, dist_n) : 1.051167, 2.916236, 2.419294
Train average loss piano    (Triplet, dist_p, dist_n) : 0.775146, 2.617909, 2.479751
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.773026, 2.697591, 2.603904
Train average loss residuals(Triplet, dist_p, dist_n) : 0.599762, 2.619380, 2.744896
Train average loss all      (Triplet)                 : 0.702606

== Recognize ==
Train average loss Recognize     : 1.042006
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.070610

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.0813, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.0813, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  16%|█▌        | 50/313 [02:25<12:43,  0.34it/s, v_num=0, Train/loss_all_step=0.0813, Train/loss_unet_all_step=0.0813, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  16%|█▌        | 50/313 [02:25<12:43,  0.34it/s, v_num=0, Train/loss_all_step=0.068, Train/loss_unet_all_step=0.068, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]  Epoch 11:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.068, Train/loss_unet_all_step=0.068, Train/loss_triplet_all_step=0.732, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0747, Train/loss_unet_all_step=0.0747, Train/loss_triplet_all_step=0.714, Train/loss_recog_step=0.960, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  64%|██████▍   | 200/313 [09:29<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0747, Train/loss_unet_all_step=0.0747, Train/loss_triplet_all_step=0.714, Train/loss_recog_step=0.960, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  64%|██████▍   | 200/313 [09:29<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.0782, Train/loss_triplet_all_step=0.589, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.0782, Train/loss_triplet_all_step=0.589, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.0681, Train/loss_triplet_all_step=0.683, Train/loss_recog_step=0.978, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  96%|█████████▌| 300/313 [14:09<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.0681, Train/loss_triplet_all_step=0.683, Train/loss_recog_step=0.978, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11:  96%|█████████▌| 300/313 [14:09<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.872, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11: 100%|██████████| 313/313 [14:43<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.872, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11: 100%|██████████| 313/313 [14:43<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.607, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0542, Valid/loss_unet_all_step=0.0542, Valid/loss_triplet_all_step=0.912, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0754, Valid/loss_unet_all_epoch=0.0754, Valid/loss_triplet_all_epoch=0.762, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.341, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021737, 0.022209, 0.025284
Valid average loss UNet            (all)              : 0.069230

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.217300, 2.196270, 2.964725
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.012772, 2.838284, 2.308486
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.017138, 2.650728, 2.147735
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.681004, 2.476536, 2.593232
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.468324, 2.394731, 3.026401
Valid average loss all      (Triplet)                 : 0.742773

== Recognize ==
Valid average loss Recognize     : 1.030638
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.069230

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.576009511947632 sec. =
Valid knn accuracy drums     : 61.617647058823536%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.636729717254639 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.766041994094849 sec. =
Valid knn accuracy piano     : 19.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.122497081756592 sec. =
Valid knn accuracy guitar    : 23.051948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.654332637786865 sec. =
Valid knn accuracy residuals : 51.257861635220124%

Valid knn accuracy average   : 34.57188355535799%

                                                                        [AEpoch 11: 100%|██████████| 313/313 [17:14<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.607, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.0706, Train/loss_unet_all_epoch=0.0706, Train/loss_triplet_all_epoch=0.703, Train/loss_recog_epoch=1.040]Epoch 11: 100%|██████████| 313/313 [17:14<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.607, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.023541, 0.023485, 0.023001
Train average loss UNet            (all)              : 0.070026

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.271446, 2.269925, 2.898883
Train average loss bass     (Triplet, dist_p, dist_n) : 1.018211, 2.879194, 2.400610
Train average loss piano    (Triplet, dist_p, dist_n) : 0.763132, 2.609003, 2.472848
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.763617, 2.697842, 2.602869
Train average loss residuals(Triplet, dist_p, dist_n) : 0.586743, 2.595164, 2.714964
Train average loss all      (Triplet)                 : 0.686942

== Recognize ==
Train average loss Recognize     : 1.045188
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.070026

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.607, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.607, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  16%|█▌        | 50/313 [02:26<12:52,  0.34it/s, v_num=0, Train/loss_all_step=0.0803, Train/loss_unet_all_step=0.0803, Train/loss_triplet_all_step=0.607, Train/loss_recog_step=0.952, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  16%|█▌        | 50/313 [02:26<12:52,  0.34it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.685, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.685, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.583, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.583, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.720, Train/loss_recog_step=0.965, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.720, Train/loss_recog_step=0.965, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.575, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.575, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0674, Train/loss_unet_all_step=0.0674, Train/loss_triplet_all_step=0.689, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0674, Train/loss_unet_all_step=0.0674, Train/loss_triplet_all_step=0.689, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.836, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12: 100%|██████████| 313/313 [14:42<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.836, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12: 100%|██████████| 313/313 [14:42<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0525, Valid/loss_unet_all_step=0.0525, Valid/loss_triplet_all_step=0.873, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0692, Valid/loss_unet_all_epoch=0.0692, Valid/loss_triplet_all_epoch=0.743, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.346, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021322, 0.022008, 0.025198
Valid average loss UNet            (all)              : 0.068528

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.226139, 2.215782, 2.936617
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.081568, 2.855103, 2.267653
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.039123, 2.677063, 2.155638
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.630234, 2.451277, 2.644433
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.500459, 2.414860, 3.114790
Valid average loss all      (Triplet)                 : 0.769806

== Recognize ==
Valid average loss Recognize     : 1.026585
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.068528

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.540207862854004 sec. =
Valid knn accuracy drums     : 62.794117647058826%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.74091625213623 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.69542908668518 sec. =
Valid knn accuracy piano     : 20.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.0868661403656 sec. =
Valid knn accuracy guitar    : 23.376623376623375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.533417224884033 sec. =
Valid knn accuracy residuals : 51.100628930817614%

Valid knn accuracy average   : 35.05688241327583%

                                                                        [AEpoch 12: 100%|██████████| 313/313 [17:11<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.070, Train/loss_unet_all_epoch=0.070, Train/loss_triplet_all_epoch=0.687, Train/loss_recog_epoch=1.050]Epoch 12: 100%|██████████| 313/313 [17:11<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.023345, 0.023283, 0.022804
Train average loss UNet            (all)              : 0.069432

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.273470, 2.281778, 2.875793
Train average loss bass     (Triplet, dist_p, dist_n) : 0.991979, 2.854908, 2.392074
Train average loss piano    (Triplet, dist_p, dist_n) : 0.747808, 2.604632, 2.473034
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.737399, 2.672509, 2.589240
Train average loss residuals(Triplet, dist_p, dist_n) : 0.572337, 2.587486, 2.704368
Train average loss all      (Triplet)                 : 0.670654

== Recognize ==
Train average loss Recognize     : 1.047277
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.069432

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.0797, Train/loss_unet_all_step=0.0797, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.959, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  32%|███▏      | 100/313 [04:48<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.682, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  32%|███▏      | 100/313 [04:48<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0698, Train/loss_unet_all_step=0.0698, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  48%|████▊     | 150/313 [07:10<07:48,  0.35it/s, v_num=0, Train/loss_all_step=0.0698, Train/loss_unet_all_step=0.0698, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  48%|████▊     | 150/313 [07:10<07:48,  0.35it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.711, Train/loss_recog_step=0.966, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.711, Train/loss_recog_step=0.966, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0764, Train/loss_unet_all_step=0.0764, Train/loss_triplet_all_step=0.551, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0764, Train/loss_unet_all_step=0.0764, Train/loss_triplet_all_step=0.551, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.627, Train/loss_recog_step=0.985, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.627, Train/loss_recog_step=0.985, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.826, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.826, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.0793, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=0.968, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.989, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.351, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022306, 0.023068, 0.025394
Valid average loss UNet            (all)              : 0.070769

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.221437, 2.183273, 2.857713
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.037446, 2.772144, 2.204284
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.043669, 2.688184, 2.159019
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.572240, 2.379855, 2.615279
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.447084, 2.340997, 3.019176
Valid average loss all      (Triplet)                 : 0.732969

== Recognize ==
Valid average loss Recognize     : 1.039924
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070769

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.516506433486938 sec. =
Valid knn accuracy drums     : 64.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.4564688205719 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.641464233398438 sec. =
Valid knn accuracy piano     : 19.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.338670253753662 sec. =
Valid knn accuracy guitar    : 24.83766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.59903073310852 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 36.19957851223499%

                                                                        [AEpoch 13: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.0793, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=0.968, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0694, Train/loss_unet_all_epoch=0.0694, Train/loss_triplet_all_epoch=0.671, Train/loss_recog_epoch=1.050]Epoch 13: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.0793, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=0.968, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.023186, 0.023124, 0.022665
Train average loss UNet            (all)              : 0.068975

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.274752, 2.263303, 2.820321
Train average loss bass     (Triplet, dist_p, dist_n) : 0.953408, 2.789120, 2.345855
Train average loss piano    (Triplet, dist_p, dist_n) : 0.729439, 2.576454, 2.451166
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.711803, 2.628571, 2.555591
Train average loss residuals(Triplet, dist_p, dist_n) : 0.567738, 2.574071, 2.681340
Train average loss all      (Triplet)                 : 0.653011

== Recognize ==
Train average loss Recognize     : 1.050487
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.068975

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.0793, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=0.968, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.0793, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=0.968, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0793, Train/loss_unet_all_step=0.0793, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=0.968, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.655, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  32%|███▏      | 100/313 [04:45<10:08,  0.35it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.655, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  32%|███▏      | 100/313 [04:45<10:08,  0.35it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.0692, Train/loss_triplet_all_step=0.567, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0692, Train/loss_unet_all_step=0.0692, Train/loss_triplet_all_step=0.567, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.727, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.727, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0768, Train/loss_unet_all_step=0.0768, Train/loss_triplet_all_step=0.534, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0768, Train/loss_unet_all_step=0.0768, Train/loss_triplet_all_step=0.534, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0665, Train/loss_unet_all_step=0.0665, Train/loss_triplet_all_step=0.648, Train/loss_recog_step=0.991, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0665, Train/loss_unet_all_step=0.0665, Train/loss_triplet_all_step=0.648, Train/loss_recog_step=0.991, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.840, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.840, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.591, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0544, Valid/loss_unet_all_step=0.0544, Valid/loss_triplet_all_step=0.935, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.733, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.362, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.20it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.14it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022337, 0.022991, 0.025293
Valid average loss UNet            (all)              : 0.070620

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.207604, 2.172491, 2.921705
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.056716, 2.830258, 2.258647
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.060001, 2.717837, 2.195688
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.569050, 2.382072, 2.612795
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.493102, 2.379323, 2.963599
Valid average loss all      (Triplet)                 : 0.748582

== Recognize ==
Valid average loss Recognize     : 1.051314
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070620

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.836590051651001 sec. =
Valid knn accuracy drums     : 67.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.770771026611328 sec. =
Valid knn accuracy bass      : 20.930232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.549204111099243 sec. =
Valid knn accuracy piano     : 18.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.018349170684814 sec. =
Valid knn accuracy guitar    : 29.383116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.614595890045166 sec. =
Valid knn accuracy residuals : 50.157232704402524%

Valid knn accuracy average   : 37.35087318588855%

                                                                        [AEpoch 14: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.591, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.069, Train/loss_unet_all_epoch=0.069, Train/loss_triplet_all_epoch=0.653, Train/loss_recog_epoch=1.050]Epoch 14: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.591, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.023015, 0.022984, 0.022520
Train average loss UNet            (all)              : 0.068519

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.261900, 2.275490, 2.862869
Train average loss bass     (Triplet, dist_p, dist_n) : 0.962633, 2.828615, 2.377604
Train average loss piano    (Triplet, dist_p, dist_n) : 0.737748, 2.615778, 2.484218
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.709142, 2.647110, 2.572457
Train average loss residuals(Triplet, dist_p, dist_n) : 0.568004, 2.603685, 2.706268
Train average loss all      (Triplet)                 : 0.654102

== Recognize ==
Train average loss Recognize     : 1.056628
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.068519

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.591, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.591, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0788, Train/loss_unet_all_step=0.0788, Train/loss_triplet_all_step=0.591, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.663, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.663, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.608, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  48%|████▊     | 150/313 [07:15<07:53,  0.34it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.608, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  48%|████▊     | 150/313 [07:15<07:53,  0.34it/s, v_num=0, Train/loss_all_step=0.0725, Train/loss_unet_all_step=0.0725, Train/loss_triplet_all_step=0.734, Train/loss_recog_step=0.969, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  64%|██████▍   | 200/313 [09:41<05:28,  0.34it/s, v_num=0, Train/loss_all_step=0.0725, Train/loss_unet_all_step=0.0725, Train/loss_triplet_all_step=0.734, Train/loss_recog_step=0.969, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  64%|██████▍   | 200/313 [09:41<05:28,  0.34it/s, v_num=0, Train/loss_all_step=0.076, Train/loss_unet_all_step=0.076, Train/loss_triplet_all_step=0.579, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]  Epoch 15:  80%|███████▉  | 250/313 [12:05<03:02,  0.34it/s, v_num=0, Train/loss_all_step=0.076, Train/loss_unet_all_step=0.076, Train/loss_triplet_all_step=0.579, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  80%|███████▉  | 250/313 [12:05<03:02,  0.34it/s, v_num=0, Train/loss_all_step=0.0662, Train/loss_unet_all_step=0.0662, Train/loss_triplet_all_step=0.692, Train/loss_recog_step=0.989, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  96%|█████████▌| 300/313 [14:27<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0662, Train/loss_unet_all_step=0.0662, Train/loss_triplet_all_step=0.692, Train/loss_recog_step=0.989, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15:  96%|█████████▌| 300/313 [14:27<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.0612, Train/loss_triplet_all_step=0.833, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15: 100%|██████████| 313/313 [15:01<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.0612, Train/loss_triplet_all_step=0.833, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15: 100%|██████████| 313/313 [15:01<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.613, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.958, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0706, Valid/loss_unet_all_epoch=0.0706, Valid/loss_triplet_all_epoch=0.749, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023270, 0.024048, 0.026470
Valid average loss UNet            (all)              : 0.073788

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.219794, 2.265009, 2.997009
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.095865, 2.949169, 2.374544
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.090099, 2.866156, 2.294581
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.592739, 2.482630, 2.751484
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.510859, 2.497207, 3.158052
Valid average loss all      (Triplet)                 : 0.769843

== Recognize ==
Valid average loss Recognize     : 1.009084
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.073788

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.576477289199829 sec. =
Valid knn accuracy drums     : 63.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.676903009414673 sec. =
Valid knn accuracy bass      : 21.075581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.7362802028656 sec. =
Valid knn accuracy piano     : 18.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.020164966583252 sec. =
Valid knn accuracy guitar    : 29.383116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.681700706481934 sec. =
Valid knn accuracy residuals : 49.37106918238994%

Valid knn accuracy average   : 36.34989625846684%

                                                                        [AEpoch 15: 100%|██████████| 313/313 [17:31<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.613, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0685, Train/loss_unet_all_epoch=0.0685, Train/loss_triplet_all_epoch=0.654, Train/loss_recog_epoch=1.060]Epoch 15: 100%|██████████| 313/313 [17:31<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.613, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022875, 0.022808, 0.022364
Train average loss UNet            (all)              : 0.068047

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.263120, 2.283648, 2.863358
Train average loss bass     (Triplet, dist_p, dist_n) : 0.981985, 2.873321, 2.412911
Train average loss piano    (Triplet, dist_p, dist_n) : 0.751337, 2.658693, 2.524490
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.714753, 2.668163, 2.596315
Train average loss residuals(Triplet, dist_p, dist_n) : 0.582328, 2.630440, 2.728293
Train average loss all      (Triplet)                 : 0.665261

== Recognize ==
Train average loss Recognize     : 1.057118
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.068047

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.613, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.613, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  16%|█▌        | 50/313 [02:29<13:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0773, Train/loss_unet_all_step=0.0773, Train/loss_triplet_all_step=0.613, Train/loss_recog_step=0.974, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  16%|█▌        | 50/313 [02:29<13:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.675, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  32%|███▏      | 100/313 [04:52<10:23,  0.34it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.675, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  32%|███▏      | 100/313 [04:52<10:23,  0.34it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.602, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  48%|████▊     | 150/313 [07:16<07:54,  0.34it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.602, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  48%|████▊     | 150/313 [07:16<07:54,  0.34it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.695, Train/loss_recog_step=0.976, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  64%|██████▍   | 200/313 [09:39<05:27,  0.35it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.695, Train/loss_recog_step=0.976, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  64%|██████▍   | 200/313 [09:39<05:27,  0.35it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.549, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  80%|███████▉  | 250/313 [12:02<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.549, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  80%|███████▉  | 250/313 [12:02<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.658, Train/loss_recog_step=0.996, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  96%|█████████▌| 300/313 [14:24<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.658, Train/loss_recog_step=0.996, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16:  96%|█████████▌| 300/313 [14:24<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.819, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16: 100%|██████████| 313/313 [14:58<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.819, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16: 100%|██████████| 313/313 [14:58<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0738, Valid/loss_unet_all_epoch=0.0738, Valid/loss_triplet_all_epoch=0.770, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.363, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027353, 0.030267, 0.031281
Valid average loss UNet            (all)              : 0.088901

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.215982, 2.196573, 2.910652
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.966546, 2.776504, 2.307503
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.020205, 2.756367, 2.232843
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.557769, 2.399040, 2.646543
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.501220, 2.439967, 2.996883
Valid average loss all      (Triplet)                 : 0.713126

== Recognize ==
Valid average loss Recognize     : 0.995418
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.088901

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.5619797706604 sec. =
Valid knn accuracy drums     : 68.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.682764768600464 sec. =
Valid knn accuracy bass      : 21.656976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.689120531082153 sec. =
Valid knn accuracy piano     : 18.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.260704278945923 sec. =
Valid knn accuracy guitar    : 30.519480519480517%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.165779829025269 sec. =
Valid knn accuracy residuals : 52.04402515723271%

Valid knn accuracy average   : 38.421997915022466%

                                                                        [AEpoch 16: 100%|██████████| 313/313 [17:29<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.068, Train/loss_unet_all_epoch=0.068, Train/loss_triplet_all_epoch=0.665, Train/loss_recog_epoch=1.060]Epoch 16: 100%|██████████| 313/313 [17:29<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022748, 0.022685, 0.022256
Train average loss UNet            (all)              : 0.067688

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.257361, 2.270898, 2.837909
Train average loss bass     (Triplet, dist_p, dist_n) : 0.952576, 2.840602, 2.396840
Train average loss piano    (Triplet, dist_p, dist_n) : 0.727771, 2.627855, 2.498256
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.704817, 2.653692, 2.578911
Train average loss residuals(Triplet, dist_p, dist_n) : 0.571013, 2.615857, 2.711679
Train average loss all      (Triplet)                 : 0.648751

== Recognize ==
Train average loss Recognize     : 1.061803
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.067688

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  16%|█▌        | 50/313 [02:26<12:48,  0.34it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.0771, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=0.981, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  16%|█▌        | 50/313 [02:26<12:48,  0.34it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.638, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.638, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.562, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.562, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.678, Train/loss_recog_step=0.979, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]  Epoch 17:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.678, Train/loss_recog_step=0.979, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.0752, Train/loss_triplet_all_step=0.541, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  80%|███████▉  | 250/313 [11:57<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.0752, Train/loss_triplet_all_step=0.541, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  80%|███████▉  | 250/313 [11:57<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.620, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.620, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.0609, Train/loss_triplet_all_step=0.796, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.0609, Train/loss_triplet_all_step=0.796, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]Epoch 17: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0766, Train/loss_unet_all_step=0.0766, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.986, Valid/loss_all_step=0.0587, Valid/loss_unet_all_step=0.0587, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.713, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027987, 0.030614, 0.031765
Valid average loss UNet            (all)              : 0.090366

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.210227, 2.221731, 2.974738
Valid average loss bass     (Triplet, dist_p, dist_n) : 1.024336, 2.886170, 2.356022
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.077532, 2.863895, 2.288990
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.609228, 2.467280, 2.688487
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.489905, 2.462367, 3.182569
Valid average loss all      (Triplet)                 : 0.747236

== Recognize ==
Valid average loss Recognize     : 1.001188
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.090366

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.496174812316895 sec. =
Valid knn accuracy drums     : 64.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.629586935043335 sec. =
Valid knn accuracy bass      : 21.511627906976745%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.409969091415405 sec. =
Valid knn accuracy piano     : 18.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.184045553207397 sec. =
Valid knn accuracy guitar    : 30.357142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.724939107894897 sec. =
Valid knn accuracy residuals : 50.47169811320755%

Valid knn accuracy average   : 37.19543876751631%

                                                                        [AEpoch 17: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0766, Train/loss_unet_all_step=0.0766, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.986, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0677, Train/loss_unet_all_epoch=0.0677, Train/loss_triplet_all_epoch=0.649, Train/loss_recog_epoch=1.060]  Epoch 17: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0766, Train/loss_unet_all_step=0.0766, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.986, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022592, 0.022518, 0.022107
Train average loss UNet            (all)              : 0.067217

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.256076, 2.279287, 2.825738
Train average loss bass     (Triplet, dist_p, dist_n) : 0.920410, 2.809331, 2.385903
Train average loss piano    (Triplet, dist_p, dist_n) : 0.709894, 2.612819, 2.488614
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.679734, 2.629105, 2.561970
Train average loss residuals(Triplet, dist_p, dist_n) : 0.558691, 2.610320, 2.706137
Train average loss all      (Triplet)                 : 0.630681

== Recognize ==
Train average loss Recognize     : 1.066197
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.067217

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0766, Train/loss_unet_all_step=0.0766, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.986, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0766, Train/loss_unet_all_step=0.0766, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.986, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0766, Train/loss_unet_all_step=0.0766, Train/loss_triplet_all_step=0.599, Train/loss_recog_step=0.986, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=1.050, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  32%|███▏      | 100/313 [04:48<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.640, Train/loss_recog_step=1.050, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  32%|███▏      | 100/313 [04:48<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.551, Train/loss_recog_step=1.070, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.551, Train/loss_recog_step=1.070, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.667, Train/loss_recog_step=0.987, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.667, Train/loss_recog_step=0.987, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.531, Train/loss_recog_step=1.070, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]  Epoch 18:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.531, Train/loss_recog_step=1.070, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.606, Train/loss_recog_step=1.010, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.606, Train/loss_recog_step=1.010, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.797, Train/loss_recog_step=1.110, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]  Epoch 18: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.797, Train/loss_recog_step=1.110, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=0.989, Valid/loss_all_step=0.070, Valid/loss_unet_all_step=0.070, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0904, Valid/loss_unet_all_epoch=0.0904, Valid/loss_triplet_all_epoch=0.747, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.17it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023911, 0.024778, 0.027182
Valid average loss UNet            (all)              : 0.075871

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.204068, 2.186877, 2.903186
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.978010, 2.829558, 2.331766
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.007975, 2.764655, 2.256670
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.557848, 2.430017, 2.632162
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.506704, 2.461234, 3.059733
Valid average loss all      (Triplet)                 : 0.710052

== Recognize ==
Valid average loss Recognize     : 1.020787
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.075871

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.784934282302856 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.746410846710205 sec. =
Valid knn accuracy bass      : 20.49418604651163%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.667699575424194 sec. =
Valid knn accuracy piano     : 17.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.356863737106323 sec. =
Valid knn accuracy guitar    : 29.707792207792206%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.608794450759888 sec. =
Valid knn accuracy residuals : 49.528301886792455%

Valid knn accuracy average   : 36.513623595786825%

                                                                        [AEpoch 18: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=0.989, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0672, Train/loss_unet_all_epoch=0.0672, Train/loss_triplet_all_epoch=0.631, Train/loss_recog_epoch=1.070]Epoch 18: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=0.989, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022469, 0.022406, 0.021993
Train average loss UNet            (all)              : 0.066868

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.253768, 2.287641, 2.827044
Train average loss bass     (Triplet, dist_p, dist_n) : 0.910614, 2.804098, 2.385612
Train average loss piano    (Triplet, dist_p, dist_n) : 0.692568, 2.599462, 2.482550
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.668677, 2.629733, 2.569372
Train average loss residuals(Triplet, dist_p, dist_n) : 0.549682, 2.593264, 2.687140
Train average loss all      (Triplet)                 : 0.620960

== Recognize ==
Train average loss Recognize     : 1.072534
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.066868

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=0.989, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=0.989, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  16%|█▌        | 50/313 [02:25<12:46,  0.34it/s, v_num=0, Train/loss_all_step=0.0763, Train/loss_unet_all_step=0.0763, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=0.989, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  16%|█▌        | 50/313 [02:25<12:46,  0.34it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.0649, Train/loss_triplet_all_step=0.634, Train/loss_recog_step=1.050, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.0649, Train/loss_triplet_all_step=0.634, Train/loss_recog_step=1.050, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.070, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  48%|████▊     | 150/313 [07:08<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.070, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  48%|████▊     | 150/313 [07:08<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0698, Train/loss_unet_all_step=0.0698, Train/loss_triplet_all_step=0.663, Train/loss_recog_step=0.995, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0698, Train/loss_unet_all_step=0.0698, Train/loss_triplet_all_step=0.663, Train/loss_recog_step=0.995, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.0739, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.080, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.0739, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.080, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.0651, Train/loss_triplet_all_step=0.574, Train/loss_recog_step=1.010, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.0651, Train/loss_triplet_all_step=0.574, Train/loss_recog_step=1.010, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.757, Train/loss_recog_step=1.120, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.757, Train/loss_recog_step=1.120, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.0761, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.000, Valid/loss_all_step=0.059, Valid/loss_unet_all_step=0.059, Valid/loss_triplet_all_step=0.863, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0759, Valid/loss_unet_all_epoch=0.0759, Valid/loss_triplet_all_epoch=0.710, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.22it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.024826, 0.025807, 0.028232
Valid average loss UNet            (all)              : 0.078865

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202369, 2.155102, 2.815862
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.920340, 2.736218, 2.274228
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.957373, 2.703319, 2.224416
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.516263, 2.358563, 2.551153
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.477711, 2.378658, 2.907575
Valid average loss all      (Triplet)                 : 0.669120

== Recognize ==
Valid average loss Recognize     : 1.009866
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.078865

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.637037754058838 sec. =
Valid knn accuracy drums     : 65.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.722241401672363 sec. =
Valid knn accuracy bass      : 19.186046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.73640751838684 sec. =
Valid knn accuracy piano     : 18.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.038972616195679 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.720409870147705 sec. =
Valid knn accuracy residuals : 52.04402515723271%

Valid knn accuracy average   : 36.670827993879904%

                                                                        [AEpoch 19: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.0761, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0669, Train/loss_unet_all_epoch=0.0669, Train/loss_triplet_all_epoch=0.621, Train/loss_recog_epoch=1.070]Epoch 19: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.0761, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022383, 0.022316, 0.021894
Train average loss UNet            (all)              : 0.066592

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.251334, 2.276492, 2.796546
Train average loss bass     (Triplet, dist_p, dist_n) : 0.893826, 2.789691, 2.382847
Train average loss piano    (Triplet, dist_p, dist_n) : 0.680835, 2.586262, 2.472784
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.655871, 2.611223, 2.550857
Train average loss residuals(Triplet, dist_p, dist_n) : 0.539411, 2.582759, 2.675593
Train average loss all      (Triplet)                 : 0.609997

== Recognize ==
Train average loss Recognize     : 1.075632
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.066592

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.0761, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.0761, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0761, Train/loss_unet_all_step=0.0761, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]  Epoch 20:  32%|███▏      | 100/313 [04:49<10:17,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.612, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  32%|███▏      | 100/313 [04:49<10:17,  0.35it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.521, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  48%|████▊     | 150/313 [07:11<07:48,  0.35it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.521, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  48%|████▊     | 150/313 [07:11<07:48,  0.35it/s, v_num=0, Train/loss_all_step=0.0691, Train/loss_unet_all_step=0.0691, Train/loss_triplet_all_step=0.643, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0691, Train/loss_unet_all_step=0.0691, Train/loss_triplet_all_step=0.643, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]  Epoch 20:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.557, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.557, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.754, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.754, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]Epoch 20: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.0758, Train/loss_triplet_all_step=0.573, Train/loss_recog_step=1.000, Valid/loss_all_step=0.0623, Valid/loss_unet_all_step=0.0623, Valid/loss_triplet_all_step=0.806, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.0789, Valid/loss_unet_all_epoch=0.0789, Valid/loss_triplet_all_epoch=0.669, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.026400, 0.028195, 0.029541
Valid average loss UNet            (all)              : 0.084136

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.211692, 2.248847, 2.964878
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.982942, 2.892959, 2.390707
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.015895, 2.839104, 2.335077
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.572962, 2.463233, 2.660818
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.484691, 2.449467, 3.091750
Valid average loss all      (Triplet)                 : 0.713732

== Recognize ==
Valid average loss Recognize     : 1.000822
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.084136

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.549133062362671 sec. =
Valid knn accuracy drums     : 65.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.693316459655762 sec. =
Valid knn accuracy bass      : 19.040697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.603625059127808 sec. =
Valid knn accuracy piano     : 19.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.1178879737854 sec. =
Valid knn accuracy guitar    : 28.246753246753247%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.695171594619751 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 36.861715719425504%

                                                                        [AEpoch 20: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.0758, Train/loss_triplet_all_step=0.573, Train/loss_recog_step=1.000, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.0666, Train/loss_triplet_all_epoch=0.610, Train/loss_recog_epoch=1.080]  Epoch 20: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.0758, Train/loss_triplet_all_step=0.573, Train/loss_recog_step=1.000, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022255, 0.022190, 0.021790
Train average loss UNet            (all)              : 0.066236

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.253529, 2.276870, 2.774027
Train average loss bass     (Triplet, dist_p, dist_n) : 0.865250, 2.753378, 2.361926
Train average loss piano    (Triplet, dist_p, dist_n) : 0.663651, 2.561203, 2.451507
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.636606, 2.590968, 2.537869
Train average loss residuals(Triplet, dist_p, dist_n) : 0.522614, 2.552870, 2.646199
Train average loss all      (Triplet)                 : 0.593741

== Recognize ==
Train average loss Recognize     : 1.082835
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.066236

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.0758, Train/loss_triplet_all_step=0.573, Train/loss_recog_step=1.000, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.0758, Train/loss_triplet_all_step=0.573, Train/loss_recog_step=1.000, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0758, Train/loss_unet_all_step=0.0758, Train/loss_triplet_all_step=0.573, Train/loss_recog_step=1.000, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.0651, Train/loss_triplet_all_step=0.606, Train/loss_recog_step=1.070, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  32%|███▏      | 100/313 [04:49<10:17,  0.35it/s, v_num=0, Train/loss_all_step=0.0651, Train/loss_unet_all_step=0.0651, Train/loss_triplet_all_step=0.606, Train/loss_recog_step=1.070, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  32%|███▏      | 100/313 [04:49<10:17,  0.35it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.529, Train/loss_recog_step=1.080, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  48%|████▊     | 150/313 [07:13<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.529, Train/loss_recog_step=1.080, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  48%|████▊     | 150/313 [07:13<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0694, Train/loss_unet_all_step=0.0694, Train/loss_triplet_all_step=0.619, Train/loss_recog_step=1.000, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0694, Train/loss_unet_all_step=0.0694, Train/loss_triplet_all_step=0.619, Train/loss_recog_step=1.000, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.0739, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.090, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0739, Train/loss_unet_all_step=0.0739, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.090, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.574, Train/loss_recog_step=1.020, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.574, Train/loss_recog_step=1.020, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0592, Train/loss_unet_all_step=0.0592, Train/loss_triplet_all_step=0.733, Train/loss_recog_step=1.130, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0592, Train/loss_unet_all_step=0.0592, Train/loss_triplet_all_step=0.733, Train/loss_recog_step=1.130, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.564, Train/loss_recog_step=1.010, Valid/loss_all_step=0.067, Valid/loss_unet_all_step=0.067, Valid/loss_triplet_all_step=0.883, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.0841, Valid/loss_unet_all_epoch=0.0841, Valid/loss_triplet_all_epoch=0.714, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025766, 0.027244, 0.028874
Valid average loss UNet            (all)              : 0.081884

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.203207, 2.244213, 2.974952
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.926159, 2.845327, 2.377552
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.986798, 2.784429, 2.301445
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.553928, 2.468370, 2.641135
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.482564, 2.485237, 3.061719
Valid average loss all      (Triplet)                 : 0.683129

== Recognize ==
Valid average loss Recognize     : 1.010909
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.081884

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.572237968444824 sec. =
Valid knn accuracy drums     : 65.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.793329000473022 sec. =
Valid knn accuracy bass      : 20.203488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.693325757980347 sec. =
Valid knn accuracy piano     : 17.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.390008449554443 sec. =
Valid knn accuracy guitar    : 29.383116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.418837070465088 sec. =
Valid knn accuracy residuals : 51.57232704402516%

Valid knn accuracy average   : 36.94641285094399%

                                                                        [AEpoch 21: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.564, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0662, Train/loss_unet_all_epoch=0.0662, Train/loss_triplet_all_epoch=0.594, Train/loss_recog_epoch=1.080]Epoch 21: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.564, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022155, 0.022103, 0.021720
Train average loss UNet            (all)              : 0.065978

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.246789, 2.290692, 2.801363
Train average loss bass     (Triplet, dist_p, dist_n) : 0.862697, 2.774589, 2.386516
Train average loss piano    (Triplet, dist_p, dist_n) : 0.659272, 2.575554, 2.465455
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.641739, 2.615821, 2.555316
Train average loss residuals(Triplet, dist_p, dist_n) : 0.521480, 2.567742, 2.657829
Train average loss all      (Triplet)                 : 0.591786

== Recognize ==
Train average loss Recognize     : 1.086649
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.065978

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.564, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.564, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.0755, Train/loss_unet_all_step=0.0755, Train/loss_triplet_all_step=0.564, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  32%|███▏      | 100/313 [04:52<10:22,  0.34it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  32%|███▏      | 100/313 [04:52<10:22,  0.34it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  48%|████▊     | 150/313 [07:15<07:53,  0.34it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  48%|████▊     | 150/313 [07:15<07:53,  0.34it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.619, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.619, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0641, Train/loss_unet_all_step=0.0641, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0641, Train/loss_unet_all_step=0.0641, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.718, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.718, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0655, Valid/loss_unet_all_step=0.0655, Valid/loss_triplet_all_step=0.808, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0819, Valid/loss_unet_all_epoch=0.0819, Valid/loss_triplet_all_epoch=0.683, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025270, 0.026521, 0.028599
Valid average loss UNet            (all)              : 0.080390

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.194077, 2.215956, 2.887077
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.919643, 2.814719, 2.358383
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.939764, 2.756488, 2.285824
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.502454, 2.391837, 2.570499
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.466683, 2.437346, 2.952407
Valid average loss all      (Triplet)                 : 0.659653

== Recognize ==
Valid average loss Recognize     : 0.993193
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.080390

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.571663856506348 sec. =
Valid knn accuracy drums     : 66.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.817314147949219 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.747663497924805 sec. =
Valid knn accuracy piano     : 17.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.259855270385742 sec. =
Valid knn accuracy guitar    : 26.2987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.754679441452026 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 36.6025181937024%

                                                                        [AEpoch 22: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.066, Train/loss_unet_all_epoch=0.066, Train/loss_triplet_all_epoch=0.592, Train/loss_recog_epoch=1.090]Epoch 22: 100%|██████████| 313/313 [17:27<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.022077, 0.022001, 0.021641
Train average loss UNet            (all)              : 0.065719

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.248603, 2.291091, 2.780887
Train average loss bass     (Triplet, dist_p, dist_n) : 0.842585, 2.741116, 2.363128
Train average loss piano    (Triplet, dist_p, dist_n) : 0.649015, 2.565476, 2.458683
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.625351, 2.591510, 2.532262
Train average loss residuals(Triplet, dist_p, dist_n) : 0.504418, 2.540578, 2.634426
Train average loss all      (Triplet)                 : 0.579237

== Recognize ==
Train average loss Recognize     : 1.091639
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.065719

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  16%|█▌        | 50/313 [02:25<12:43,  0.34it/s, v_num=0, Train/loss_all_step=0.075, Train/loss_unet_all_step=0.075, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.010, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  16%|█▌        | 50/313 [02:25<12:43,  0.34it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.0637, Train/loss_triplet_all_step=0.603, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  32%|███▏      | 100/313 [04:45<10:07,  0.35it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.0637, Train/loss_triplet_all_step=0.603, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  32%|███▏      | 100/313 [04:45<10:07,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.524, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  48%|████▊     | 150/313 [07:05<07:42,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.524, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  48%|████▊     | 150/313 [07:05<07:42,  0.35it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  64%|██████▍   | 200/313 [09:26<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.609, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  64%|██████▍   | 200/313 [09:26<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.502, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.502, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.549, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.549, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0592, Train/loss_unet_all_step=0.0592, Train/loss_triplet_all_step=0.734, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23: 100%|██████████| 313/313 [14:42<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0592, Train/loss_unet_all_step=0.0592, Train/loss_triplet_all_step=0.734, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23: 100%|██████████| 313/313 [14:42<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0749, Train/loss_unet_all_step=0.0749, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.807, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0804, Valid/loss_unet_all_epoch=0.0804, Valid/loss_triplet_all_epoch=0.660, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.026220, 0.028090, 0.029586
Valid average loss UNet            (all)              : 0.083896

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202173, 2.266192, 2.944302
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.956698, 2.819731, 2.342571
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.985133, 2.760451, 2.267514
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.503411, 2.411148, 2.601837
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.529335, 2.472339, 2.925969
Valid average loss all      (Triplet)                 : 0.695836

== Recognize ==
Valid average loss Recognize     : 1.015216
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.083896

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.575503587722778 sec. =
Valid knn accuracy drums     : 67.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.741159200668335 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.718655824661255 sec. =
Valid knn accuracy piano     : 19.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.102567911148071 sec. =
Valid knn accuracy guitar    : 28.084415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.777520418167114 sec. =
Valid knn accuracy residuals : 52.04402515723271%

Valid knn accuracy average   : 36.64840970709773%

                                                                        [AEpoch 23: 100%|██████████| 313/313 [17:13<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0749, Train/loss_unet_all_step=0.0749, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0657, Train/loss_unet_all_epoch=0.0657, Train/loss_triplet_all_epoch=0.579, Train/loss_recog_epoch=1.090]Epoch 23: 100%|██████████| 313/313 [17:13<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0749, Train/loss_unet_all_step=0.0749, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021970, 0.021887, 0.021523
Train average loss UNet            (all)              : 0.065380

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.241762, 2.290807, 2.776939
Train average loss bass     (Triplet, dist_p, dist_n) : 0.829969, 2.737102, 2.364123
Train average loss piano    (Triplet, dist_p, dist_n) : 0.636180, 2.551574, 2.445508
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.617204, 2.588437, 2.530439
Train average loss residuals(Triplet, dist_p, dist_n) : 0.492709, 2.530053, 2.623889
Train average loss all      (Triplet)                 : 0.568654

== Recognize ==
Train average loss Recognize     : 1.096010
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.065380

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0749, Train/loss_unet_all_step=0.0749, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0749, Train/loss_unet_all_step=0.0749, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  16%|█▌        | 50/313 [02:24<12:41,  0.35it/s, v_num=0, Train/loss_all_step=0.0749, Train/loss_unet_all_step=0.0749, Train/loss_triplet_all_step=0.555, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  16%|█▌        | 50/313 [02:24<12:41,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  32%|███▏      | 100/313 [04:45<10:08,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.595, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  32%|███▏      | 100/313 [04:45<10:08,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.523, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]  Epoch 24:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.523, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.0681, Train/loss_triplet_all_step=0.614, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.0681, Train/loss_triplet_all_step=0.614, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.0726, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.0726, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.540, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  96%|█████████▌| 300/313 [14:13<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.540, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24:  96%|█████████▌| 300/313 [14:13<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.699, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.699, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0575, Valid/loss_unet_all_step=0.0575, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0839, Valid/loss_unet_all_epoch=0.0839, Valid/loss_triplet_all_epoch=0.696, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.18it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025461, 0.026958, 0.028678
Valid average loss UNet            (all)              : 0.081097

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.184406, 2.184098, 2.855551
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.874764, 2.679199, 2.250110
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.904902, 2.626143, 2.175092
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.463302, 2.317980, 2.500053
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.502586, 2.363104, 2.734924
Valid average loss all      (Triplet)                 : 0.642010

== Recognize ==
Valid average loss Recognize     : 1.052828
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.081097

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.65877389907837 sec. =
Valid knn accuracy drums     : 66.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.718021392822266 sec. =
Valid knn accuracy bass      : 18.8953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.624290466308594 sec. =
Valid knn accuracy piano     : 18.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.058206796646118 sec. =
Valid knn accuracy guitar    : 29.22077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.769131898880005 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 37.17555985483095%

                                                                        [AEpoch 24: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0654, Train/loss_unet_all_epoch=0.0654, Train/loss_triplet_all_epoch=0.569, Train/loss_recog_epoch=1.100]Epoch 24: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021870, 0.021817, 0.021442
Train average loss UNet            (all)              : 0.065129

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.238920, 2.289091, 2.771511
Train average loss bass     (Triplet, dist_p, dist_n) : 0.828783, 2.739625, 2.367029
Train average loss piano    (Triplet, dist_p, dist_n) : 0.634779, 2.553160, 2.445192
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.614674, 2.582393, 2.520575
Train average loss residuals(Triplet, dist_p, dist_n) : 0.494875, 2.529186, 2.613762
Train average loss all      (Triplet)                 : 0.567562

== Recognize ==
Train average loss Recognize     : 1.099208
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.065129

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0748, Train/loss_unet_all_step=0.0748, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.020, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.587, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  32%|███▏      | 100/313 [04:49<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.587, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  32%|███▏      | 100/313 [04:49<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.514, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.514, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.0682, Train/loss_triplet_all_step=0.596, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.0682, Train/loss_triplet_all_step=0.596, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0727, Train/loss_unet_all_step=0.0727, Train/loss_triplet_all_step=0.514, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  80%|███████▉  | 250/313 [11:58<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0727, Train/loss_unet_all_step=0.0727, Train/loss_triplet_all_step=0.514, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  80%|███████▉  | 250/313 [11:58<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.517, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.517, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.0588, Train/loss_triplet_all_step=0.677, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.0588, Train/loss_triplet_all_step=0.677, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]Epoch 25: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0605, Valid/loss_unet_all_step=0.0605, Valid/loss_triplet_all_step=0.804, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0811, Valid/loss_unet_all_epoch=0.0811, Valid/loss_triplet_all_epoch=0.642, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.031091, 0.035656, 0.033962
Valid average loss UNet            (all)              : 0.100709

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.196287, 2.296539, 2.991622
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.916520, 2.824241, 2.385552
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.050219, 2.896627, 2.337190
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.504495, 2.418942, 2.618995
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.492712, 2.497029, 2.983700
Valid average loss all      (Triplet)                 : 0.689296

== Recognize ==
Valid average loss Recognize     : 0.953166
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.100709

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.648944616317749 sec. =
Valid knn accuracy drums     : 66.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.794985055923462 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.730167150497437 sec. =
Valid knn accuracy piano     : 19.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.27449369430542 sec. =
Valid knn accuracy guitar    : 26.948051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.463561534881592 sec. =
Valid knn accuracy residuals : 53.144654088050316%

Valid knn accuracy average   : 36.74833563913526%

                                                                        [AEpoch 25: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0651, Train/loss_unet_all_epoch=0.0651, Train/loss_triplet_all_epoch=0.568, Train/loss_recog_epoch=1.100]  Epoch 25: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021780, 0.021743, 0.021371
Train average loss UNet            (all)              : 0.064895

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.239261, 2.288061, 2.747448
Train average loss bass     (Triplet, dist_p, dist_n) : 0.803960, 2.713722, 2.355763
Train average loss piano    (Triplet, dist_p, dist_n) : 0.618047, 2.538063, 2.436764
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.600881, 2.574144, 2.517744
Train average loss residuals(Triplet, dist_p, dist_n) : 0.487002, 2.524882, 2.605864
Train average loss all      (Triplet)                 : 0.554779

== Recognize ==
Train average loss Recognize     : 1.106220
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.064895

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  16%|█▌        | 50/313 [02:26<12:53,  0.34it/s, v_num=0, Train/loss_all_step=0.074, Train/loss_unet_all_step=0.074, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.030, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  16%|█▌        | 50/313 [02:26<12:53,  0.34it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.590, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.590, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.0648, Train/loss_triplet_all_step=0.507, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.0648, Train/loss_triplet_all_step=0.507, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0677, Train/loss_unet_all_step=0.0677, Train/loss_triplet_all_step=0.578, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0677, Train/loss_unet_all_step=0.0677, Train/loss_triplet_all_step=0.578, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.517, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.517, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.0589, Train/loss_triplet_all_step=0.671, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.0589, Train/loss_triplet_all_step=0.671, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0734, Valid/loss_unet_all_step=0.0734, Valid/loss_triplet_all_step=0.876, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.101, Valid/loss_unet_all_epoch=0.101, Valid/loss_triplet_all_epoch=0.689, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025893, 0.027886, 0.028815
Valid average loss UNet            (all)              : 0.082594

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.186435, 2.225211, 2.841589
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.843097, 2.732032, 2.344632
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.968847, 2.768596, 2.267054
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.475677, 2.369753, 2.588955
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.492565, 2.487186, 2.842913
Valid average loss all      (Triplet)                 : 0.639920

== Recognize ==
Valid average loss Recognize     : 1.005157
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.082594

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.608733654022217 sec. =
Valid knn accuracy drums     : 67.20588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.479264259338379 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.742759943008423 sec. =
Valid knn accuracy piano     : 19.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.182039737701416 sec. =
Valid knn accuracy guitar    : 27.27272727272727%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.669315576553345 sec. =
Valid knn accuracy residuals : 52.358490566037744%

Valid knn accuracy average   : 36.861920352609%

                                                                        [AEpoch 26: 100%|██████████| 313/313 [17:25<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0649, Train/loss_unet_all_epoch=0.0649, Train/loss_triplet_all_epoch=0.555, Train/loss_recog_epoch=1.110]Epoch 26: 100%|██████████| 313/313 [17:25<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021726, 0.021669, 0.021303
Train average loss UNet            (all)              : 0.064699

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.239396, 2.271627, 2.709015
Train average loss bass     (Triplet, dist_p, dist_n) : 0.794023, 2.692509, 2.338239
Train average loss piano    (Triplet, dist_p, dist_n) : 0.606992, 2.515629, 2.417674
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.587115, 2.544196, 2.488300
Train average loss residuals(Triplet, dist_p, dist_n) : 0.475634, 2.495448, 2.580835
Train average loss all      (Triplet)                 : 0.545545

== Recognize ==
Train average loss Recognize     : 1.112261
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.064699

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.511, Train/loss_recog_step=1.040, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.558, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]  Epoch 27:  32%|███▏      | 100/313 [04:48<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.558, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  32%|███▏      | 100/313 [04:48<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.0672, Train/loss_triplet_all_step=0.572, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0672, Train/loss_unet_all_step=0.0672, Train/loss_triplet_all_step=0.572, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.072, Train/loss_unet_all_step=0.072, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]  Epoch 27:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.072, Train/loss_unet_all_step=0.072, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.0634, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  96%|█████████▌| 300/313 [14:16<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.0634, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27:  96%|█████████▌| 300/313 [14:16<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.670, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.670, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0603, Valid/loss_unet_all_step=0.0603, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0826, Valid/loss_unet_all_epoch=0.0826, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021539, 0.021628, 0.024549
Valid average loss UNet            (all)              : 0.067715

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.187187, 2.236767, 2.818729
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.853943, 2.763914, 2.342748
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.839162, 2.642011, 2.275507
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.514238, 2.433584, 2.555602
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.461285, 2.450717, 2.797613
Valid average loss all      (Triplet)                 : 0.624699

== Recognize ==
Valid average loss Recognize     : 1.088655
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.067715

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.555391788482666 sec. =
Valid knn accuracy drums     : 68.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.67113184928894 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.53352665901184 sec. =
Valid knn accuracy piano     : 20.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.26668381690979 sec. =
Valid knn accuracy guitar    : 29.545454545454547%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.791842460632324 sec. =
Valid knn accuracy residuals : 50.314465408805034%

Valid knn accuracy average   : 37.25276374461388%

                                                                        [AEpoch 27: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0647, Train/loss_unet_all_epoch=0.0647, Train/loss_triplet_all_epoch=0.546, Train/loss_recog_epoch=1.110]Epoch 27: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021645, 0.021589, 0.021242
Train average loss UNet            (all)              : 0.064476

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.239192, 2.280617, 2.702552
Train average loss bass     (Triplet, dist_p, dist_n) : 0.780809, 2.681578, 2.336883
Train average loss piano    (Triplet, dist_p, dist_n) : 0.599412, 2.516124, 2.418868
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.580000, 2.544146, 2.489515
Train average loss residuals(Triplet, dist_p, dist_n) : 0.475653, 2.502161, 2.582486
Train average loss all      (Triplet)                 : 0.539812

== Recognize ==
Train average loss Recognize     : 1.121525
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.064476

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0737, Train/loss_unet_all_step=0.0737, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0627, Train/loss_unet_all_step=0.0627, Train/loss_triplet_all_step=0.569, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  32%|███▏      | 100/313 [04:49<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0627, Train/loss_unet_all_step=0.0627, Train/loss_triplet_all_step=0.569, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  32%|███▏      | 100/313 [04:49<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0644, Train/loss_unet_all_step=0.0644, Train/loss_triplet_all_step=0.476, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  48%|████▊     | 150/313 [07:09<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0644, Train/loss_unet_all_step=0.0644, Train/loss_triplet_all_step=0.476, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  48%|████▊     | 150/313 [07:09<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0668, Train/loss_unet_all_step=0.0668, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0668, Train/loss_unet_all_step=0.0668, Train/loss_triplet_all_step=0.580, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.0714, Train/loss_triplet_all_step=0.487, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  80%|███████▉  | 250/313 [11:51<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0714, Train/loss_unet_all_step=0.0714, Train/loss_triplet_all_step=0.487, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  80%|███████▉  | 250/313 [11:51<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.496, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]  Epoch 28:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.496, Train/loss_recog_step=1.070, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.645, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.645, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]Epoch 28: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.0736, Train/loss_triplet_all_step=0.515, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.766, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.0677, Valid/loss_unet_all_epoch=0.0677, Valid/loss_triplet_all_epoch=0.625, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023157, 0.023764, 0.026035
Valid average loss UNet            (all)              : 0.072956

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.181659, 2.201357, 2.811284
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.864791, 2.772391, 2.324741
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.858834, 2.652462, 2.276679
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.506169, 2.408439, 2.547031
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.442215, 2.441393, 2.791594
Valid average loss all      (Triplet)                 : 0.625929

== Recognize ==
Valid average loss Recognize     : 1.078213
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.072956

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.541176080703735 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.529410600662231 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.68000316619873 sec. =
Valid knn accuracy piano     : 18.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.074408769607544 sec. =
Valid knn accuracy guitar    : 28.084415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.695931434631348 sec. =
Valid knn accuracy residuals : 49.056603773584904%

Valid knn accuracy average   : 35.87682109347313%

                                                                        [AEpoch 28: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.0736, Train/loss_triplet_all_step=0.515, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0645, Train/loss_unet_all_epoch=0.0645, Train/loss_triplet_all_epoch=0.540, Train/loss_recog_epoch=1.120]  Epoch 28: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.0736, Train/loss_triplet_all_step=0.515, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021580, 0.021530, 0.021177
Train average loss UNet            (all)              : 0.064287

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.238364, 2.274518, 2.684427
Train average loss bass     (Triplet, dist_p, dist_n) : 0.763344, 2.655713, 2.321175
Train average loss piano    (Triplet, dist_p, dist_n) : 0.588614, 2.496641, 2.402004
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.571975, 2.535082, 2.482690
Train average loss residuals(Triplet, dist_p, dist_n) : 0.468626, 2.482132, 2.559462
Train average loss all      (Triplet)                 : 0.530977

== Recognize ==
Train average loss Recognize     : 1.125983
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.064287

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.0736, Train/loss_triplet_all_step=0.515, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.0736, Train/loss_triplet_all_step=0.515, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0736, Train/loss_unet_all_step=0.0736, Train/loss_triplet_all_step=0.515, Train/loss_recog_step=1.050, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0626, Train/loss_unet_all_step=0.0626, Train/loss_triplet_all_step=0.560, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0626, Train/loss_unet_all_step=0.0626, Train/loss_triplet_all_step=0.560, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.064, Train/loss_triplet_all_step=0.473, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]  Epoch 29:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.064, Train/loss_unet_all_step=0.064, Train/loss_triplet_all_step=0.473, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.577, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.577, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.484, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.071, Train/loss_unet_all_step=0.071, Train/loss_triplet_all_step=0.484, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.473, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.473, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.628, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29: 100%|██████████| 313/313 [14:49<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.628, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29: 100%|██████████| 313/313 [14:49<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.0584, Valid/loss_triplet_all_step=0.782, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.073, Valid/loss_unet_all_epoch=0.073, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021398, 0.021860, 0.024281
Valid average loss UNet            (all)              : 0.067539

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.176661, 2.159388, 2.741127
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.799806, 2.660546, 2.275081
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.826326, 2.554121, 2.178429
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.510824, 2.399582, 2.523934
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.430786, 2.375615, 2.738869
Valid average loss all      (Triplet)                 : 0.598067

== Recognize ==
Valid average loss Recognize     : 1.112336
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.067539

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.429387092590332 sec. =
Valid knn accuracy drums     : 65.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.68671202659607 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.644846200942993 sec. =
Valid knn accuracy piano     : 19.864864864864863%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.010963201522827 sec. =
Valid knn accuracy guitar    : 29.05844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.6468825340271 sec. =
Valid knn accuracy residuals : 50.314465408805034%

Valid knn accuracy average   : 36.628334120184256%

                                                                        [AEpoch 29: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0643, Train/loss_unet_all_epoch=0.0643, Train/loss_triplet_all_epoch=0.531, Train/loss_recog_epoch=1.130]Epoch 29: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021486, 0.021441, 0.021110
Train average loss UNet            (all)              : 0.064037

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.236263, 2.263662, 2.663754
Train average loss bass     (Triplet, dist_p, dist_n) : 0.753437, 2.646443, 2.316175
Train average loss piano    (Triplet, dist_p, dist_n) : 0.581362, 2.485334, 2.393049
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.567319, 2.529723, 2.475233
Train average loss residuals(Triplet, dist_p, dist_n) : 0.465086, 2.477775, 2.553248
Train average loss all      (Triplet)                 : 0.525317

== Recognize ==
Train average loss Recognize     : 1.132966
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.064037

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  16%|█▌        | 50/313 [02:25<12:45,  0.34it/s, v_num=0, Train/loss_all_step=0.0732, Train/loss_unet_all_step=0.0732, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  16%|█▌        | 50/313 [02:25<12:45,  0.34it/s, v_num=0, Train/loss_all_step=0.0624, Train/loss_unet_all_step=0.0624, Train/loss_triplet_all_step=0.556, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0624, Train/loss_unet_all_step=0.0624, Train/loss_triplet_all_step=0.556, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.0648, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  48%|████▊     | 150/313 [07:06<07:43,  0.35it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.0648, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  48%|████▊     | 150/313 [07:06<07:43,  0.35it/s, v_num=0, Train/loss_all_step=0.0674, Train/loss_unet_all_step=0.0674, Train/loss_triplet_all_step=0.570, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  64%|██████▍   | 200/313 [09:26<05:19,  0.35it/s, v_num=0, Train/loss_all_step=0.0674, Train/loss_unet_all_step=0.0674, Train/loss_triplet_all_step=0.570, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  64%|██████▍   | 200/313 [09:26<05:19,  0.35it/s, v_num=0, Train/loss_all_step=0.0713, Train/loss_unet_all_step=0.0713, Train/loss_triplet_all_step=0.473, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  80%|███████▉  | 250/313 [11:46<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0713, Train/loss_unet_all_step=0.0713, Train/loss_triplet_all_step=0.473, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  80%|███████▉  | 250/313 [11:46<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.468, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.468, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.626, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30: 100%|██████████| 313/313 [14:42<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.626, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]Epoch 30: 100%|██████████| 313/313 [14:42<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.508, Train/loss_recog_step=1.060, Valid/loss_all_step=0.0521, Valid/loss_unet_all_step=0.0521, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0675, Valid/loss_unet_all_epoch=0.0675, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.366, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.16it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.024400, 0.025752, 0.027072
Valid average loss UNet            (all)              : 0.077225

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.189331, 2.163299, 2.697086
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.793747, 2.658127, 2.289227
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.868594, 2.609589, 2.226223
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.454282, 2.329255, 2.499914
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.450000, 2.391047, 2.734592
Valid average loss all      (Triplet)                 : 0.597412

== Recognize ==
Valid average loss Recognize     : 1.070920
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.077225

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.46312427520752 sec. =
Valid knn accuracy drums     : 67.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.659201860427856 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.619122505187988 sec. =
Valid knn accuracy piano     : 19.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.955789804458618 sec. =
Valid knn accuracy guitar    : 29.22077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.712886095046997 sec. =
Valid knn accuracy residuals : 51.57232704402516%

Valid knn accuracy average   : 37.297111658551145%

                                                                        [AEpoch 30: 100%|██████████| 313/313 [17:12<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.508, Train/loss_recog_step=1.060, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.064, Train/loss_unet_all_epoch=0.064, Train/loss_triplet_all_epoch=0.525, Train/loss_recog_epoch=1.130]  Epoch 30: 100%|██████████| 313/313 [17:12<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.508, Train/loss_recog_step=1.060, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021426, 0.021387, 0.021047
Train average loss UNet            (all)              : 0.063861

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.236180, 2.249195, 2.631681
Train average loss bass     (Triplet, dist_p, dist_n) : 0.737144, 2.621365, 2.300145
Train average loss piano    (Triplet, dist_p, dist_n) : 0.568929, 2.464239, 2.376399
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.552497, 2.507972, 2.457746
Train average loss residuals(Triplet, dist_p, dist_n) : 0.453877, 2.457051, 2.534567
Train average loss all      (Triplet)                 : 0.514307

== Recognize ==
Train average loss Recognize     : 1.138544
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.063861

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.508, Train/loss_recog_step=1.060, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.508, Train/loss_recog_step=1.060, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  16%|█▌        | 50/313 [02:26<12:51,  0.34it/s, v_num=0, Train/loss_all_step=0.0734, Train/loss_unet_all_step=0.0734, Train/loss_triplet_all_step=0.508, Train/loss_recog_step=1.060, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  16%|█▌        | 50/313 [02:26<12:51,  0.34it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.120, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.550, Train/loss_recog_step=1.120, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.480, Train/loss_recog_step=1.140, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.480, Train/loss_recog_step=1.140, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.562, Train/loss_recog_step=1.070, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.562, Train/loss_recog_step=1.070, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.150, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.150, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.464, Train/loss_recog_step=1.090, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.464, Train/loss_recog_step=1.090, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=1.190, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.617, Train/loss_recog_step=1.190, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.080, Valid/loss_all_step=0.060, Valid/loss_unet_all_step=0.060, Valid/loss_triplet_all_step=0.719, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0772, Valid/loss_unet_all_epoch=0.0772, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023940, 0.025649, 0.026848
Valid average loss UNet            (all)              : 0.076438

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169694, 2.120471, 2.645492
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.780966, 2.610579, 2.228229
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.839917, 2.559675, 2.188431
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.442630, 2.302716, 2.475358
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.418647, 2.328941, 2.660890
Valid average loss all      (Triplet)                 : 0.579961

== Recognize ==
Valid average loss Recognize     : 1.092378
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.076438

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.838419675827026 sec. =
Valid knn accuracy drums     : 65.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.680329084396362 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.536109209060669 sec. =
Valid knn accuracy piano     : 19.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.205178022384644 sec. =
Valid knn accuracy guitar    : 29.22077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.70841383934021 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 36.814433067149686%

                                                                        [AEpoch 31: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0639, Train/loss_unet_all_epoch=0.0639, Train/loss_triplet_all_epoch=0.514, Train/loss_recog_epoch=1.140]Epoch 31: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021353, 0.021304, 0.020963
Train average loss UNet            (all)              : 0.063620

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.234787, 2.240221, 2.611940
Train average loss bass     (Triplet, dist_p, dist_n) : 0.718036, 2.591960, 2.283502
Train average loss piano    (Triplet, dist_p, dist_n) : 0.560348, 2.446881, 2.359962
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.541605, 2.483912, 2.433666
Train average loss residuals(Triplet, dist_p, dist_n) : 0.449205, 2.441080, 2.517467
Train average loss all      (Triplet)                 : 0.505223

== Recognize ==
Train average loss Recognize     : 1.144050
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.063620

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  16%|█▌        | 50/313 [02:26<12:49,  0.34it/s, v_num=0, Train/loss_all_step=0.0728, Train/loss_unet_all_step=0.0728, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  16%|█▌        | 50/313 [02:26<12:49,  0.34it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.534, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  32%|███▏      | 100/313 [04:47<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.534, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  32%|███▏      | 100/313 [04:47<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0635, Train/loss_unet_all_step=0.0635, Train/loss_triplet_all_step=0.447, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  48%|████▊     | 150/313 [07:09<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0635, Train/loss_unet_all_step=0.0635, Train/loss_triplet_all_step=0.447, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  48%|████▊     | 150/313 [07:09<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  64%|██████▍   | 200/313 [09:31<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.445, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.445, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.451, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.451, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.603, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.603, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]Epoch 32: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0597, Valid/loss_unet_all_step=0.0597, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0764, Valid/loss_unet_all_epoch=0.0764, Valid/loss_triplet_all_epoch=0.580, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025167, 0.027376, 0.028507
Valid average loss UNet            (all)              : 0.081050

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.161823, 2.086323, 2.608819
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.752153, 2.541215, 2.186498
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.811346, 2.489626, 2.108588
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.410668, 2.183755, 2.386028
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.439690, 2.266025, 2.569926
Valid average loss all      (Triplet)                 : 0.563786

== Recognize ==
Valid average loss Recognize     : 1.082090
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.081050

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.742383003234863 sec. =
Valid knn accuracy drums     : 66.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.647386074066162 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.716054677963257 sec. =
Valid knn accuracy piano     : 20.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.616475820541382 sec. =
Valid knn accuracy guitar    : 28.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.85830307006836 sec. =
Valid knn accuracy residuals : 51.100628930817614%

Valid knn accuracy average   : 36.571210406057986%

                                                                        [AEpoch 32: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0636, Train/loss_unet_all_epoch=0.0636, Train/loss_triplet_all_epoch=0.505, Train/loss_recog_epoch=1.140]  Epoch 32: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021292, 0.021249, 0.020923
Train average loss UNet            (all)              : 0.063464

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.231382, 2.235201, 2.601034
Train average loss bass     (Triplet, dist_p, dist_n) : 0.707455, 2.577066, 2.274719
Train average loss piano    (Triplet, dist_p, dist_n) : 0.550952, 2.435938, 2.352560
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.534119, 2.475568, 2.427757
Train average loss residuals(Triplet, dist_p, dist_n) : 0.441170, 2.428855, 2.506240
Train average loss all      (Triplet)                 : 0.497341

== Recognize ==
Train average loss Recognize     : 1.151031
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.063464

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  16%|█▌        | 50/313 [02:26<12:50,  0.34it/s, v_num=0, Train/loss_all_step=0.0729, Train/loss_unet_all_step=0.0729, Train/loss_triplet_all_step=0.499, Train/loss_recog_step=1.080, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  16%|█▌        | 50/313 [02:26<12:50,  0.34it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.062, Train/loss_triplet_all_step=0.527, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]  Epoch 33:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.062, Train/loss_triplet_all_step=0.527, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.0634, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.0634, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]  Epoch 33:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.433, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.433, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.602, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.602, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0609, Valid/loss_unet_all_step=0.0609, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.081, Valid/loss_unet_all_epoch=0.081, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:04<00:00,  0.98it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023775, 0.025258, 0.026987
Valid average loss UNet            (all)              : 0.076019

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150424, 2.073483, 2.607245
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.754180, 2.524792, 2.149450
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.796507, 2.454961, 2.095758
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.415763, 2.186468, 2.384139
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.430449, 2.260115, 2.543357
Valid average loss all      (Triplet)                 : 0.557597

== Recognize ==
Valid average loss Recognize     : 1.105743
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.076019

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.588704347610474 sec. =
Valid knn accuracy drums     : 66.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.741933345794678 sec. =
Valid knn accuracy bass      : 18.023255813953487%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.794771909713745 sec. =
Valid knn accuracy piano     : 18.513513513513512%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.493393898010254 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.745976209640503 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 36.79254588398176%

                                                                        [AEpoch 33: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0635, Train/loss_unet_all_epoch=0.0635, Train/loss_triplet_all_epoch=0.497, Train/loss_recog_epoch=1.150]Epoch 33: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021235, 0.021188, 0.020867
Train average loss UNet            (all)              : 0.063290

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.232064, 2.226949, 2.580794
Train average loss bass     (Triplet, dist_p, dist_n) : 0.692656, 2.557307, 2.265739
Train average loss piano    (Triplet, dist_p, dist_n) : 0.542553, 2.416748, 2.334785
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.520508, 2.453615, 2.408698
Train average loss residuals(Triplet, dist_p, dist_n) : 0.432556, 2.414347, 2.491315
Train average loss all      (Triplet)                 : 0.488125

== Recognize ==
Train average loss Recognize     : 1.156809
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.063290

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.073, Train/loss_unet_all_step=0.073, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.522, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  32%|███▏      | 100/313 [04:49<10:16,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.522, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  32%|███▏      | 100/313 [04:49<10:16,  0.35it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.0634, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0634, Train/loss_unet_all_step=0.0634, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.519, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.519, Train/loss_recog_step=1.090, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0701, Train/loss_unet_all_step=0.0701, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0701, Train/loss_unet_all_step=0.0701, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  96%|█████████▌| 300/313 [14:13<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34:  96%|█████████▌| 300/313 [14:13<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.582, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.582, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.0724, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0585, Valid/loss_unet_all_step=0.0585, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.18it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021140, 0.021921, 0.024883
Valid average loss UNet            (all)              : 0.067944

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.156336, 2.090354, 2.613362
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.685569, 2.467097, 2.149213
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.733189, 2.412334, 2.099048
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.457280, 2.265944, 2.372260
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.415581, 2.305502, 2.545751
Valid average loss all      (Triplet)                 : 0.530909

== Recognize ==
Valid average loss Recognize     : 1.159311
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.067944

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.508496761322021 sec. =
Valid knn accuracy drums     : 65.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.57757306098938 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.668701887130737 sec. =
Valid knn accuracy piano     : 22.162162162162165%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.199787616729736 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.597224473953247 sec. =
Valid knn accuracy residuals : 50.943396226415096%

Valid knn accuracy average   : 37.177714445672535%

                                                                        [AEpoch 34: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.0724, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0633, Train/loss_unet_all_epoch=0.0633, Train/loss_triplet_all_epoch=0.488, Train/loss_recog_epoch=1.160]Epoch 34: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.0724, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021166, 0.021107, 0.020797
Train average loss UNet            (all)              : 0.063069

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.229521, 2.216596, 2.567070
Train average loss bass     (Triplet, dist_p, dist_n) : 0.688192, 2.544866, 2.254092
Train average loss piano    (Triplet, dist_p, dist_n) : 0.540691, 2.414573, 2.332529
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.517117, 2.443368, 2.400264
Train average loss residuals(Triplet, dist_p, dist_n) : 0.431293, 2.406390, 2.479339
Train average loss all      (Triplet)                 : 0.485208

== Recognize ==
Train average loss Recognize     : 1.165681
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.063069

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.0724, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.0724, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  16%|█▌        | 50/313 [02:26<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0724, Train/loss_unet_all_step=0.0724, Train/loss_triplet_all_step=0.497, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  16%|█▌        | 50/313 [02:26<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0619, Train/loss_unet_all_step=0.0619, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0619, Train/loss_unet_all_step=0.0619, Train/loss_triplet_all_step=0.525, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0632, Train/loss_unet_all_step=0.0632, Train/loss_triplet_all_step=0.460, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0632, Train/loss_unet_all_step=0.0632, Train/loss_triplet_all_step=0.460, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.518, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.518, Train/loss_recog_step=1.100, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.432, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.432, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0574, Train/loss_unet_all_step=0.0574, Train/loss_triplet_all_step=0.582, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0574, Train/loss_unet_all_step=0.0574, Train/loss_triplet_all_step=0.582, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]Epoch 35: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.0722, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0679, Valid/loss_unet_all_epoch=0.0679, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023672, 0.025264, 0.027050
Valid average loss UNet            (all)              : 0.075986

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.162486, 2.056958, 2.576414
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.721699, 2.496671, 2.152071
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.791318, 2.454694, 2.081458
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.428331, 2.188503, 2.349456
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.433625, 2.246228, 2.524213
Valid average loss all      (Triplet)                 : 0.555517

== Recognize ==
Valid average loss Recognize     : 1.133795
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.075986

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.551814556121826 sec. =
Valid knn accuracy drums     : 66.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.671299934387207 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.705695152282715 sec. =
Valid knn accuracy piano     : 20.27027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.022708177566528 sec. =
Valid knn accuracy guitar    : 29.707792207792206%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.702321529388428 sec. =
Valid knn accuracy residuals : 51.729559748427675%

Valid knn accuracy average   : 37.29740679823921%

                                                                        [AEpoch 35: 100%|██████████| 313/313 [17:14<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.0722, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0631, Train/loss_unet_all_epoch=0.0631, Train/loss_triplet_all_epoch=0.485, Train/loss_recog_epoch=1.170]  Epoch 35: 100%|██████████| 313/313 [17:14<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.0722, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021094, 0.021045, 0.020727
Train average loss UNet            (all)              : 0.062866

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.225476, 2.202165, 2.550807
Train average loss bass     (Triplet, dist_p, dist_n) : 0.678820, 2.530670, 2.243717
Train average loss piano    (Triplet, dist_p, dist_n) : 0.534999, 2.401473, 2.318815
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.511779, 2.431474, 2.389833
Train average loss residuals(Triplet, dist_p, dist_n) : 0.430247, 2.394168, 2.459605
Train average loss all      (Triplet)                 : 0.480103

== Recognize ==
Train average loss Recognize     : 1.173529
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.062866

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.0722, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.0722, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0722, Train/loss_unet_all_step=0.0722, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0614, Train/loss_unet_all_step=0.0614, Train/loss_triplet_all_step=0.518, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0614, Train/loss_unet_all_step=0.0614, Train/loss_triplet_all_step=0.518, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.453, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.453, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.513, Train/loss_recog_step=1.110, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0694, Train/loss_unet_all_step=0.0694, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0694, Train/loss_unet_all_step=0.0694, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.0616, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.0616, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36:  96%|█████████▌| 300/313 [14:12<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.586, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.586, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36: 100%|██████████| 313/313 [14:46<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.500, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0561, Valid/loss_unet_all_step=0.0561, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.076, Valid/loss_unet_all_epoch=0.076, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.17it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023932, 0.024811, 0.027534
Valid average loss UNet            (all)              : 0.076277

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.157542, 2.002480, 2.477449
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.641021, 2.346993, 2.063705
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.735120, 2.350450, 1.999487
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.411226, 2.110038, 2.221137
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.422520, 2.216839, 2.473108
Valid average loss all      (Triplet)                 : 0.514687

== Recognize ==
Valid average loss Recognize     : 1.155730
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.076277

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.580170392990112 sec. =
Valid knn accuracy drums     : 65.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.716434001922607 sec. =
Valid knn accuracy bass      : 18.8953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.80160403251648 sec. =
Valid knn accuracy piano     : 22.162162162162165%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.430171728134155 sec. =
Valid knn accuracy guitar    : 28.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.512370109558105 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 37.63684969736385%

                                                                        [AEpoch 36: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.500, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0629, Train/loss_unet_all_epoch=0.0629, Train/loss_triplet_all_epoch=0.480, Train/loss_recog_epoch=1.170]Epoch 36: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.500, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.021045, 0.020998, 0.020658
Train average loss UNet            (all)              : 0.062701

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.224524, 2.186472, 2.524205
Train average loss bass     (Triplet, dist_p, dist_n) : 0.666479, 2.509809, 2.231069
Train average loss piano    (Triplet, dist_p, dist_n) : 0.530111, 2.386699, 2.303172
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.505372, 2.418757, 2.378013
Train average loss residuals(Triplet, dist_p, dist_n) : 0.421942, 2.374011, 2.439095
Train average loss all      (Triplet)                 : 0.473257

== Recognize ==
Train average loss Recognize     : 1.181626
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.062701

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.500, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.500, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0718, Train/loss_unet_all_step=0.0718, Train/loss_triplet_all_step=0.500, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.061, Train/loss_triplet_all_step=0.509, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]  Epoch 37:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.061, Train/loss_triplet_all_step=0.509, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  48%|████▊     | 150/313 [07:06<07:42,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  48%|████▊     | 150/313 [07:06<07:42,  0.35it/s, v_num=0, Train/loss_all_step=0.0654, Train/loss_unet_all_step=0.0654, Train/loss_triplet_all_step=0.504, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0654, Train/loss_unet_all_step=0.0654, Train/loss_triplet_all_step=0.504, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0691, Train/loss_unet_all_step=0.0691, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0691, Train/loss_unet_all_step=0.0691, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.399, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.399, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37:  96%|█████████▌| 300/313 [14:08<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.0566, Train/loss_triplet_all_step=0.563, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37: 100%|██████████| 313/313 [14:41<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.0566, Train/loss_triplet_all_step=0.563, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37: 100%|██████████| 313/313 [14:41<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.0716, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0579, Valid/loss_unet_all_step=0.0579, Valid/loss_triplet_all_step=0.617, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0763, Valid/loss_unet_all_epoch=0.0763, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023021, 0.024379, 0.026029
Valid average loss UNet            (all)              : 0.073429

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158699, 2.086424, 2.586666
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.714652, 2.467326, 2.119612
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.773998, 2.449425, 2.083105
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.384679, 2.150028, 2.334374
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.432182, 2.260455, 2.564995
Valid average loss all      (Triplet)                 : 0.542310

== Recognize ==
Valid average loss Recognize     : 1.139671
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.073429

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.558221578598022 sec. =
Valid knn accuracy drums     : 66.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.875086784362793 sec. =
Valid knn accuracy bass      : 19.040697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.690601587295532 sec. =
Valid knn accuracy piano     : 19.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.192323446273804 sec. =
Valid knn accuracy guitar    : 30.032467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.861368656158447 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 37.37968588556437%

                                                                        [AEpoch 37: 100%|██████████| 313/313 [17:12<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.0716, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0627, Train/loss_unet_all_epoch=0.0627, Train/loss_triplet_all_epoch=0.473, Train/loss_recog_epoch=1.180]Epoch 37: 100%|██████████| 313/313 [17:12<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.0716, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020988, 0.020938, 0.020618
Train average loss UNet            (all)              : 0.062545

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.222221, 2.171907, 2.505801
Train average loss bass     (Triplet, dist_p, dist_n) : 0.653338, 2.483867, 2.213454
Train average loss piano    (Triplet, dist_p, dist_n) : 0.521577, 2.366655, 2.286867
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.494722, 2.394354, 2.358165
Train average loss residuals(Triplet, dist_p, dist_n) : 0.420022, 2.357229, 2.420345
Train average loss all      (Triplet)                 : 0.465970

== Recognize ==
Train average loss Recognize     : 1.188499
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.062545

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.0716, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.0716, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0716, Train/loss_unet_all_step=0.0716, Train/loss_triplet_all_step=0.491, Train/loss_recog_step=1.120, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  16%|█▌        | 50/313 [02:25<12:47,  0.34it/s, v_num=0, Train/loss_all_step=0.0607, Train/loss_unet_all_step=0.0607, Train/loss_triplet_all_step=0.503, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0607, Train/loss_unet_all_step=0.0607, Train/loss_triplet_all_step=0.503, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0626, Train/loss_unet_all_step=0.0626, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  48%|████▊     | 150/313 [07:06<07:43,  0.35it/s, v_num=0, Train/loss_all_step=0.0626, Train/loss_unet_all_step=0.0626, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  48%|████▊     | 150/313 [07:06<07:43,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.505, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]  Epoch 38:  64%|██████▍   | 200/313 [09:27<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.505, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  64%|██████▍   | 200/313 [09:27<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.405, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.405, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  96%|█████████▌| 300/313 [14:07<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38:  96%|█████████▌| 300/313 [14:07<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38: 100%|██████████| 313/313 [14:41<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.543, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38: 100%|██████████| 313/313 [14:41<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.0734, Valid/loss_unet_all_epoch=0.0734, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021723, 0.021730, 0.025028
Valid average loss UNet            (all)              : 0.068480

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.162608, 2.065581, 2.535542
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.662576, 2.415042, 2.082639
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.688656, 2.349730, 2.071908
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.401206, 2.159717, 2.276999
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.389426, 2.250270, 2.534073
Valid average loss all      (Triplet)                 : 0.503180

== Recognize ==
Valid average loss Recognize     : 1.170961
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.068480

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.578190326690674 sec. =
Valid knn accuracy drums     : 66.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.639858484268188 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.930254459381104 sec. =
Valid knn accuracy piano     : 22.162162162162165%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.254148006439209 sec. =
Valid knn accuracy guitar    : 28.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.766323328018188 sec. =
Valid knn accuracy residuals : 51.57232704402516%

Valid knn accuracy average   : 37.07028068274615%

                                                                        [AEpoch 38: 100%|██████████| 313/313 [17:12<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0625, Train/loss_unet_all_epoch=0.0625, Train/loss_triplet_all_epoch=0.466, Train/loss_recog_epoch=1.190]Epoch 38: 100%|██████████| 313/313 [17:12<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020900, 0.020864, 0.020551
Train average loss UNet            (all)              : 0.062315

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.220887, 2.162076, 2.488465
Train average loss bass     (Triplet, dist_p, dist_n) : 0.642763, 2.470837, 2.206917
Train average loss piano    (Triplet, dist_p, dist_n) : 0.513288, 2.353006, 2.271194
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.486012, 2.379704, 2.344489
Train average loss residuals(Triplet, dist_p, dist_n) : 0.413022, 2.347151, 2.410921
Train average loss all      (Triplet)                 : 0.458671

== Recognize ==
Train average loss Recognize     : 1.198086
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.062315

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  16%|█▌        | 50/313 [02:25<12:46,  0.34it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.0715, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  16%|█▌        | 50/313 [02:25<12:46,  0.34it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.0609, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  32%|███▏      | 100/313 [04:46<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.0609, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  32%|███▏      | 100/313 [04:46<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]  Epoch 39:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=1.140, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0689, Train/loss_unet_all_step=0.0689, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  80%|███████▉  | 250/313 [11:51<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0689, Train/loss_unet_all_step=0.0689, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  80%|███████▉  | 250/313 [11:51<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.537, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.537, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0685, Valid/loss_unet_all_epoch=0.0685, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022314, 0.022598, 0.025921
Valid average loss UNet            (all)              : 0.070833

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.151350, 2.031241, 2.452119
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.668148, 2.378642, 2.042608
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.682972, 2.312957, 2.018531
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371972, 2.078965, 2.223173
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396816, 2.184377, 2.467855
Valid average loss all      (Triplet)                 : 0.499626

== Recognize ==
Valid average loss Recognize     : 1.167761
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070833

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.252227067947388 sec. =
Valid knn accuracy drums     : 65.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.835728406906128 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.797177076339722 sec. =
Valid knn accuracy piano     : 20.81081081081081%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.34000015258789 sec. =
Valid knn accuracy guitar    : 28.8961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.43791151046753 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 36.75406953422982%

                                                                        [AEpoch 39: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0623, Train/loss_unet_all_epoch=0.0623, Train/loss_triplet_all_epoch=0.459, Train/loss_recog_epoch=1.200]Epoch 39: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020854, 0.020809, 0.020502
Train average loss UNet            (all)              : 0.062165

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.220779, 2.153381, 2.470823
Train average loss bass     (Triplet, dist_p, dist_n) : 0.634809, 2.455845, 2.194907
Train average loss piano    (Triplet, dist_p, dist_n) : 0.504000, 2.332788, 2.256649
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.479654, 2.362665, 2.328595
Train average loss residuals(Triplet, dist_p, dist_n) : 0.409069, 2.330412, 2.390094
Train average loss all      (Triplet)                 : 0.453057

== Recognize ==
Train average loss Recognize     : 1.203761
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.062165

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0603, Train/loss_unet_all_step=0.0603, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  32%|███▏      | 100/313 [04:48<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0603, Train/loss_unet_all_step=0.0603, Train/loss_triplet_all_step=0.492, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  32%|███▏      | 100/313 [04:48<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0622, Train/loss_unet_all_step=0.0622, Train/loss_triplet_all_step=0.415, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0622, Train/loss_unet_all_step=0.0622, Train/loss_triplet_all_step=0.415, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0643, Train/loss_unet_all_step=0.0643, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0643, Train/loss_unet_all_step=0.0643, Train/loss_triplet_all_step=0.498, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  80%|███████▉  | 250/313 [11:49<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  80%|███████▉  | 250/313 [11:49<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.0609, Train/loss_triplet_all_step=0.393, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.0609, Train/loss_triplet_all_step=0.393, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.0563, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.0563, Train/loss_triplet_all_step=0.528, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40: 100%|██████████| 313/313 [14:45<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.0708, Valid/loss_unet_all_epoch=0.0708, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.024337, 0.025912, 0.028318
Valid average loss UNet            (all)              : 0.078567

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155677, 2.106150, 2.575173
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.688145, 2.468249, 2.145689
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.775246, 2.481545, 2.107970
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.375931, 2.135201, 2.336728
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.432217, 2.272137, 2.643507
Valid average loss all      (Triplet)                 : 0.533449

== Recognize ==
Valid average loss Recognize     : 1.076521
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.078567

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.629140615463257 sec. =
Valid knn accuracy drums     : 68.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.742360830307007 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.546164512634277 sec. =
Valid knn accuracy piano     : 17.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.974607706069946 sec. =
Valid knn accuracy guitar    : 28.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.782826662063599 sec. =
Valid knn accuracy residuals : 52.83018867924528%

Valid knn accuracy average   : 37.011374953074096%

                                                                        [AEpoch 40: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0622, Train/loss_unet_all_epoch=0.0622, Train/loss_triplet_all_epoch=0.453, Train/loss_recog_epoch=1.200]Epoch 40: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020786, 0.020741, 0.020427
Train average loss UNet            (all)              : 0.061953

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.221603, 2.140976, 2.453298
Train average loss bass     (Triplet, dist_p, dist_n) : 0.629574, 2.438903, 2.181194
Train average loss piano    (Triplet, dist_p, dist_n) : 0.499447, 2.320464, 2.247123
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.475076, 2.348830, 2.314565
Train average loss residuals(Triplet, dist_p, dist_n) : 0.407767, 2.319381, 2.375920
Train average loss all      (Triplet)                 : 0.450103

== Recognize ==
Train average loss Recognize     : 1.211702
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.061953

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  16%|█▌        | 50/313 [02:26<12:52,  0.34it/s, v_num=0, Train/loss_all_step=0.0707, Train/loss_unet_all_step=0.0707, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  16%|█▌        | 50/313 [02:26<12:52,  0.34it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.479, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]  Epoch 41:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.479, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.062, Train/loss_triplet_all_step=0.411, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  48%|████▊     | 150/313 [07:14<07:52,  0.34it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.062, Train/loss_triplet_all_step=0.411, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  48%|████▊     | 150/313 [07:14<07:52,  0.34it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.493, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  64%|██████▍   | 200/313 [09:38<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.493, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  64%|██████▍   | 200/313 [09:38<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.0682, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  80%|███████▉  | 250/313 [12:02<03:02,  0.35it/s, v_num=0, Train/loss_all_step=0.0682, Train/loss_unet_all_step=0.0682, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  80%|███████▉  | 250/313 [12:02<03:02,  0.35it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.061, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]  Epoch 41:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.061, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.529, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.529, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.699, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0786, Valid/loss_unet_all_epoch=0.0786, Valid/loss_triplet_all_epoch=0.533, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.370, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023817, 0.025733, 0.028139
Valid average loss UNet            (all)              : 0.077689

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144029, 2.105403, 2.576915
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.690179, 2.483032, 2.150807
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.773183, 2.486573, 2.099952
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.391019, 2.148582, 2.316878
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.431477, 2.299469, 2.624881
Valid average loss all      (Triplet)                 : 0.533967

== Recognize ==
Valid average loss Recognize     : 1.084342
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.077689

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.239656209945679 sec. =
Valid knn accuracy drums     : 67.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.292089700698853 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.724717378616333 sec. =
Valid knn accuracy piano     : 19.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.39305830001831 sec. =
Valid knn accuracy guitar    : 27.435064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.561314344406128 sec. =
Valid knn accuracy residuals : 52.83018867924528%

Valid knn accuracy average   : 36.87074769479978%

                                                                        [AEpoch 41: 100%|██████████| 313/313 [17:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.062, Train/loss_unet_all_epoch=0.062, Train/loss_triplet_all_epoch=0.450, Train/loss_recog_epoch=1.210]Epoch 41: 100%|██████████| 313/313 [17:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020729, 0.020687, 0.020368
Train average loss UNet            (all)              : 0.061785

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.217518, 2.124800, 2.435688
Train average loss bass     (Triplet, dist_p, dist_n) : 0.622162, 2.420910, 2.167539
Train average loss piano    (Triplet, dist_p, dist_n) : 0.493568, 2.303517, 2.230449
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.471698, 2.332255, 2.297166
Train average loss residuals(Triplet, dist_p, dist_n) : 0.403137, 2.299641, 2.355893
Train average loss all      (Triplet)                 : 0.444786

== Recognize ==
Train average loss Recognize     : 1.219463
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.061785

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  16%|█▌        | 50/313 [02:27<12:54,  0.34it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.0708, Train/loss_triplet_all_step=0.449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  16%|█▌        | 50/313 [02:27<12:54,  0.34it/s, v_num=0, Train/loss_all_step=0.0598, Train/loss_unet_all_step=0.0598, Train/loss_triplet_all_step=0.476, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0598, Train/loss_unet_all_step=0.0598, Train/loss_triplet_all_step=0.476, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0621, Train/loss_unet_all_step=0.0621, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.483, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]  Epoch 42:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.065, Train/loss_unet_all_step=0.065, Train/loss_triplet_all_step=0.483, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.0681, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.0681, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0608, Train/loss_unet_all_step=0.0608, Train/loss_triplet_all_step=0.383, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0608, Train/loss_unet_all_step=0.0608, Train/loss_triplet_all_step=0.383, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0561, Train/loss_unet_all_step=0.0561, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0561, Train/loss_unet_all_step=0.0561, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.441, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0777, Valid/loss_unet_all_epoch=0.0777, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023770, 0.025337, 0.027579
Valid average loss UNet            (all)              : 0.076686

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.170198, 2.139082, 2.580995
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.635730, 2.464099, 2.187896
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.771410, 2.513170, 2.134437
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.389343, 2.181350, 2.333320
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.424736, 2.338357, 2.654077
Valid average loss all      (Triplet)                 : 0.522071

== Recognize ==
Valid average loss Recognize     : 1.098210
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.076686

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.701740026473999 sec. =
Valid knn accuracy drums     : 65.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.799278974533081 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.869063138961792 sec. =
Valid knn accuracy piano     : 20.27027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.147534370422363 sec. =
Valid knn accuracy guitar    : 28.246753246753247%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.87980341911316 sec. =
Valid knn accuracy residuals : 53.61635220125787%

Valid knn accuracy average   : 36.88666146376572%

                                                                        [AEpoch 42: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.441, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0618, Train/loss_unet_all_epoch=0.0618, Train/loss_triplet_all_epoch=0.445, Train/loss_recog_epoch=1.220]Epoch 42: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.441, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020707, 0.020668, 0.020354
Train average loss UNet            (all)              : 0.061728

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.216848, 2.111850, 2.420285
Train average loss bass     (Triplet, dist_p, dist_n) : 0.614780, 2.406182, 2.157575
Train average loss piano    (Triplet, dist_p, dist_n) : 0.492133, 2.294412, 2.222663
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.468410, 2.319412, 2.283105
Train average loss residuals(Triplet, dist_p, dist_n) : 0.401026, 2.285678, 2.340948
Train average loss all      (Triplet)                 : 0.441847

== Recognize ==
Train average loss Recognize     : 1.226435
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.061728

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.441, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.441, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  16%|█▌        | 50/313 [02:25<12:45,  0.34it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.441, Train/loss_recog_step=1.160, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  16%|█▌        | 50/313 [02:25<12:45,  0.34it/s, v_num=0, Train/loss_all_step=0.0595, Train/loss_unet_all_step=0.0595, Train/loss_triplet_all_step=0.470, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  32%|███▏      | 100/313 [04:47<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0595, Train/loss_unet_all_step=0.0595, Train/loss_triplet_all_step=0.470, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  32%|███▏      | 100/313 [04:47<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  48%|████▊     | 150/313 [07:07<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  48%|████▊     | 150/313 [07:07<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0644, Train/loss_unet_all_step=0.0644, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0644, Train/loss_unet_all_step=0.0644, Train/loss_triplet_all_step=0.489, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0679, Train/loss_unet_all_step=0.0679, Train/loss_triplet_all_step=0.381, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  80%|███████▉  | 250/313 [11:49<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0679, Train/loss_unet_all_step=0.0679, Train/loss_triplet_all_step=0.381, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  80%|███████▉  | 250/313 [11:49<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.665, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.0767, Valid/loss_unet_all_epoch=0.0767, Valid/loss_triplet_all_epoch=0.522, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.369, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.18it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021938, 0.022148, 0.025974
Valid average loss UNet            (all)              : 0.070059

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150537, 2.078802, 2.494872
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.654827, 2.428992, 2.097485
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.690007, 2.376350, 2.072515
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.392439, 2.163875, 2.272178
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.364776, 2.252597, 2.530216
Valid average loss all      (Triplet)                 : 0.496264

== Recognize ==
Valid average loss Recognize     : 1.171885
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070059

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.511197328567505 sec. =
Valid knn accuracy drums     : 66.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.738566160202026 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.640290975570679 sec. =
Valid knn accuracy piano     : 19.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.690979480743408 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.533794403076172 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 37.121115090206274%

                                                                        [AEpoch 43: 100%|██████████| 313/313 [17:15<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0617, Train/loss_unet_all_epoch=0.0617, Train/loss_triplet_all_epoch=0.442, Train/loss_recog_epoch=1.230]Epoch 43: 100%|██████████| 313/313 [17:15<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020617, 0.020601, 0.020282
Train average loss UNet            (all)              : 0.061500

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.217722, 2.101011, 2.398491
Train average loss bass     (Triplet, dist_p, dist_n) : 0.607172, 2.385644, 2.140403
Train average loss piano    (Triplet, dist_p, dist_n) : 0.483375, 2.273620, 2.203863
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.457408, 2.293438, 2.262107
Train average loss residuals(Triplet, dist_p, dist_n) : 0.392880, 2.264963, 2.320281
Train average loss all      (Triplet)                 : 0.434767

== Recognize ==
Train average loss Recognize     : 1.233685
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.061500

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0706, Train/loss_unet_all_step=0.0706, Train/loss_triplet_all_step=0.443, Train/loss_recog_step=1.170, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0598, Train/loss_unet_all_step=0.0598, Train/loss_triplet_all_step=0.458, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0598, Train/loss_unet_all_step=0.0598, Train/loss_triplet_all_step=0.458, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  48%|████▊     | 150/313 [07:14<07:52,  0.34it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  48%|████▊     | 150/313 [07:14<07:52,  0.34it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.478, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  64%|██████▍   | 200/313 [09:38<05:27,  0.35it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.478, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  64%|██████▍   | 200/313 [09:38<05:27,  0.35it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.399, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  80%|███████▉  | 250/313 [12:01<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.399, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  80%|███████▉  | 250/313 [12:01<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.510, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.0704, Train/loss_triplet_all_step=0.436, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.496, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023591, 0.024932, 0.027168
Valid average loss UNet            (all)              : 0.075691

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.162605, 2.167615, 2.571522
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.677136, 2.524110, 2.200537
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.744020, 2.537290, 2.186540
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.353535, 2.211485, 2.398813
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.409501, 2.328419, 2.660489
Valid average loss all      (Triplet)                 : 0.517331

== Recognize ==
Valid average loss Recognize     : 1.077796
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.075691

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.437208652496338 sec. =
Valid knn accuracy drums     : 67.05882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.69937777519226 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.825111627578735 sec. =
Valid knn accuracy piano     : 20.27027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.338932752609253 sec. =
Valid knn accuracy guitar    : 28.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.615015029907227 sec. =
Valid knn accuracy residuals : 54.87421383647799%

Valid knn accuracy average   : 37.14913328802935%

                                                                        [AEpoch 44: 100%|██████████| 313/313 [17:30<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.0704, Train/loss_triplet_all_step=0.436, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0615, Train/loss_unet_all_epoch=0.0615, Train/loss_triplet_all_epoch=0.435, Train/loss_recog_epoch=1.230]Epoch 44: 100%|██████████| 313/313 [17:30<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.0704, Train/loss_triplet_all_step=0.436, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020546, 0.020530, 0.020222
Train average loss UNet            (all)              : 0.061298

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.215005, 2.088873, 2.385441
Train average loss bass     (Triplet, dist_p, dist_n) : 0.602858, 2.372386, 2.130329
Train average loss piano    (Triplet, dist_p, dist_n) : 0.479320, 2.259633, 2.190453
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.453179, 2.280809, 2.248529
Train average loss residuals(Triplet, dist_p, dist_n) : 0.391752, 2.252054, 2.305924
Train average loss all      (Triplet)                 : 0.431880

== Recognize ==
Train average loss Recognize     : 1.241184
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.061298

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.0704, Train/loss_triplet_all_step=0.436, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.0704, Train/loss_triplet_all_step=0.436, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.0704, Train/loss_triplet_all_step=0.436, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  16%|█▌        | 50/313 [02:27<12:56,  0.34it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  32%|███▏      | 100/313 [04:50<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  32%|███▏      | 100/313 [04:50<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0617, Train/loss_unet_all_step=0.0617, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0617, Train/loss_unet_all_step=0.0617, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.483, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.483, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0678, Train/loss_unet_all_step=0.0678, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0678, Train/loss_unet_all_step=0.0678, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  96%|█████████▌| 300/313 [14:20<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45:  96%|█████████▌| 300/313 [14:20<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.0556, Train/loss_triplet_all_step=0.493, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.0556, Train/loss_triplet_all_step=0.493, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]Epoch 45: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.180, Valid/loss_all_step=0.0559, Valid/loss_unet_all_step=0.0559, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0757, Valid/loss_unet_all_epoch=0.0757, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023022, 0.024733, 0.027175
Valid average loss UNet            (all)              : 0.074930

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168243, 2.151113, 2.565295
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.654248, 2.467043, 2.157743
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.723979, 2.491418, 2.145030
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371252, 2.169614, 2.341927
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.415579, 2.344251, 2.618142
Valid average loss all      (Triplet)                 : 0.512731

== Recognize ==
Valid average loss Recognize     : 1.106964
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.074930

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.66437578201294 sec. =
Valid knn accuracy drums     : 67.20588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.879197597503662 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.955420017242432 sec. =
Valid knn accuracy piano     : 21.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.184471607208252 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.870298624038696 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 37.59147224626795%

                                                                        [AEpoch 45: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.180, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0613, Train/loss_unet_all_epoch=0.0613, Train/loss_triplet_all_epoch=0.432, Train/loss_recog_epoch=1.240]  Epoch 45: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.180, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020538, 0.020491, 0.020169
Train average loss UNet            (all)              : 0.061198

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.213090, 2.077404, 2.370290
Train average loss bass     (Triplet, dist_p, dist_n) : 0.596735, 2.360449, 2.120239
Train average loss piano    (Triplet, dist_p, dist_n) : 0.476015, 2.251559, 2.184477
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.446696, 2.266549, 2.237487
Train average loss residuals(Triplet, dist_p, dist_n) : 0.385635, 2.239078, 2.294085
Train average loss all      (Triplet)                 : 0.427052

== Recognize ==
Train average loss Recognize     : 1.250083
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.061198

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.180, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.180, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  16%|█▌        | 50/313 [02:29<13:06,  0.33it/s, v_num=0, Train/loss_all_step=0.0709, Train/loss_unet_all_step=0.0709, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.180, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  16%|█▌        | 50/313 [02:29<13:06,  0.33it/s, v_num=0, Train/loss_all_step=0.059, Train/loss_unet_all_step=0.059, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=1.240, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]  Epoch 46:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.059, Train/loss_unet_all_step=0.059, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=1.240, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0608, Train/loss_unet_all_step=0.0608, Train/loss_triplet_all_step=0.383, Train/loss_recog_step=1.260, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0608, Train/loss_unet_all_step=0.0608, Train/loss_triplet_all_step=0.383, Train/loss_recog_step=1.260, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.0636, Train/loss_triplet_all_step=0.472, Train/loss_recog_step=1.200, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  64%|██████▍   | 200/313 [09:36<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.0636, Train/loss_triplet_all_step=0.472, Train/loss_recog_step=1.200, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  64%|██████▍   | 200/313 [09:36<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=1.270, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=1.270, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.220, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  96%|█████████▌| 300/313 [14:19<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.220, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46:  96%|█████████▌| 300/313 [14:19<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0554, Train/loss_unet_all_step=0.0554, Train/loss_triplet_all_step=0.490, Train/loss_recog_step=1.280, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46: 100%|██████████| 313/313 [14:53<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0554, Train/loss_unet_all_step=0.0554, Train/loss_triplet_all_step=0.490, Train/loss_recog_step=1.280, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46: 100%|██████████| 313/313 [14:53<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.0702, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.055, Valid/loss_unet_all_step=0.055, Valid/loss_triplet_all_step=0.668, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.0749, Valid/loss_unet_all_epoch=0.0749, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022366, 0.023245, 0.026263
Valid average loss UNet            (all)              : 0.071874

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149664, 2.079628, 2.493191
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.653805, 2.452366, 2.132619
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.670235, 2.404733, 2.089900
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.359626, 2.100847, 2.248878
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396961, 2.258171, 2.490599
Valid average loss all      (Triplet)                 : 0.492050

== Recognize ==
Valid average loss Recognize     : 1.131687
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.071874

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.706449747085571 sec. =
Valid knn accuracy drums     : 66.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.79635739326477 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.766507148742676 sec. =
Valid knn accuracy piano     : 21.216216216216218%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.015390396118164 sec. =
Valid knn accuracy guitar    : 28.084415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.815815687179565 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 37.528556786267856%

                                                                        [AEpoch 46: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.0702, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0612, Train/loss_unet_all_epoch=0.0612, Train/loss_triplet_all_epoch=0.427, Train/loss_recog_epoch=1.250]Epoch 46: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.0702, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020457, 0.020427, 0.020117
Train average loss UNet            (all)              : 0.061000

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.213550, 2.068964, 2.357503
Train average loss bass     (Triplet, dist_p, dist_n) : 0.592824, 2.349670, 2.112847
Train average loss piano    (Triplet, dist_p, dist_n) : 0.472754, 2.239721, 2.171264
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.444245, 2.255197, 2.224774
Train average loss residuals(Triplet, dist_p, dist_n) : 0.383714, 2.227289, 2.279734
Train average loss all      (Triplet)                 : 0.424733

== Recognize ==
Train average loss Recognize     : 1.256422
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.061000

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.0702, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.0702, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  16%|█▌        | 50/313 [02:29<13:07,  0.33it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.0702, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.190, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  16%|█▌        | 50/313 [02:29<13:07,  0.33it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.0588, Train/loss_triplet_all_step=0.456, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  32%|███▏      | 100/313 [04:49<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.0588, Train/loss_triplet_all_step=0.456, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  32%|███▏      | 100/313 [04:49<10:17,  0.34it/s, v_num=0, Train/loss_all_step=0.0608, Train/loss_unet_all_step=0.0608, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0608, Train/loss_unet_all_step=0.0608, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.0637, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.0637, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0671, Train/loss_unet_all_step=0.0671, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0597, Train/loss_unet_all_step=0.0597, Train/loss_triplet_all_step=0.379, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0597, Train/loss_unet_all_step=0.0597, Train/loss_triplet_all_step=0.379, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.0552, Train/loss_triplet_all_step=0.487, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.0552, Train/loss_triplet_all_step=0.487, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.0699, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.0719, Valid/loss_unet_all_epoch=0.0719, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022262, 0.023125, 0.025527
Valid average loss UNet            (all)              : 0.070914

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.163335, 2.102650, 2.496670
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.652349, 2.440727, 2.119433
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.678805, 2.429573, 2.127482
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.360770, 2.131904, 2.282739
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.401242, 2.304432, 2.625911
Valid average loss all      (Triplet)                 : 0.497870

== Recognize ==
Valid average loss Recognize     : 1.149157
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070914

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.50462293624878 sec. =
Valid knn accuracy drums     : 67.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.272090911865234 sec. =
Valid knn accuracy bass      : 18.023255813953487%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.718882322311401 sec. =
Valid knn accuracy piano     : 20.675675675675677%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.985642194747925 sec. =
Valid knn accuracy guitar    : 29.05844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.652208805084229 sec. =
Valid knn accuracy residuals : 54.87421383647799%

Valid knn accuracy average   : 38.05572914161563%

                                                                        [AEpoch 47: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.0699, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.061, Train/loss_unet_all_epoch=0.061, Train/loss_triplet_all_epoch=0.425, Train/loss_recog_epoch=1.260]Epoch 47: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.0699, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020407, 0.020394, 0.020053
Train average loss UNet            (all)              : 0.060854

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.212425, 2.057287, 2.335804
Train average loss bass     (Triplet, dist_p, dist_n) : 0.588805, 2.335808, 2.100299
Train average loss piano    (Triplet, dist_p, dist_n) : 0.467612, 2.224361, 2.156311
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.435867, 2.233030, 2.205426
Train average loss residuals(Triplet, dist_p, dist_n) : 0.379563, 2.210693, 2.262227
Train average loss all      (Triplet)                 : 0.420121

== Recognize ==
Train average loss Recognize     : 1.263726
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.060854

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.0699, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.0699, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  16%|█▌        | 50/313 [02:27<12:54,  0.34it/s, v_num=0, Train/loss_all_step=0.0699, Train/loss_unet_all_step=0.0699, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  16%|█▌        | 50/313 [02:27<12:54,  0.34it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.0591, Train/loss_triplet_all_step=0.452, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  32%|███▏      | 100/313 [04:47<10:12,  0.35it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.0591, Train/loss_triplet_all_step=0.452, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  32%|███▏      | 100/313 [04:47<10:12,  0.35it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.0611, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.0611, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.210, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  64%|██████▍   | 200/313 [09:29<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]  Epoch 48:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.378, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.378, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48:  96%|█████████▌| 300/313 [14:11<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.055, Train/loss_unet_all_step=0.055, Train/loss_triplet_all_step=0.471, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]  Epoch 48: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.055, Train/loss_unet_all_step=0.055, Train/loss_triplet_all_step=0.471, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.0695, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0529, Valid/loss_unet_all_step=0.0529, Valid/loss_triplet_all_step=0.652, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.0709, Valid/loss_unet_all_epoch=0.0709, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.18it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021806, 0.022924, 0.025330
Valid average loss UNet            (all)              : 0.070060

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153667, 2.045688, 2.442264
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.642548, 2.405052, 2.078385
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.620712, 2.343986, 2.089677
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.365689, 2.115981, 2.234384
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.369635, 2.206723, 2.508104
Valid average loss all      (Triplet)                 : 0.476008

== Recognize ==
Valid average loss Recognize     : 1.178205
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070060

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.6871919631958 sec. =
Valid knn accuracy drums     : 66.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.449007987976074 sec. =
Valid knn accuracy bass      : 17.441860465116278%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.613966464996338 sec. =
Valid knn accuracy piano     : 20.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.335089683532715 sec. =
Valid knn accuracy guitar    : 30.1948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.097429275512695 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 37.902366878272204%

                                                                        [AEpoch 48: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.0695, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0609, Train/loss_unet_all_epoch=0.0609, Train/loss_triplet_all_epoch=0.420, Train/loss_recog_epoch=1.260]Epoch 48: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.0695, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020328, 0.020309, 0.019997
Train average loss UNet            (all)              : 0.060634

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.213919, 2.049891, 2.323677
Train average loss bass     (Triplet, dist_p, dist_n) : 0.582354, 2.321573, 2.089617
Train average loss piano    (Triplet, dist_p, dist_n) : 0.464228, 2.211856, 2.145946
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.433092, 2.227150, 2.200476
Train average loss residuals(Triplet, dist_p, dist_n) : 0.376651, 2.203784, 2.255746
Train average loss all      (Triplet)                 : 0.417389

== Recognize ==
Train average loss Recognize     : 1.271427
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.060634

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.0695, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.0695, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.0695, Train/loss_unet_all_step=0.0695, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.200, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.0587, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  32%|███▏      | 100/313 [04:52<10:22,  0.34it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.0587, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  32%|███▏      | 100/313 [04:52<10:22,  0.34it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.379, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.379, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  48%|████▊     | 150/313 [07:14<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  80%|███████▉  | 250/313 [11:59<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.0551, Train/loss_triplet_all_step=0.478, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.0551, Train/loss_triplet_all_step=0.478, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0696, Train/loss_unet_all_step=0.0696, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.0701, Valid/loss_unet_all_epoch=0.0701, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021696, 0.022484, 0.025408
Valid average loss UNet            (all)              : 0.069588

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.151448, 2.047979, 2.401893
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.608233, 2.349005, 2.061148
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.616550, 2.310457, 2.054715
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.350136, 2.075391, 2.204341
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.373056, 2.217319, 2.502106
Valid average loss all      (Triplet)                 : 0.462589

== Recognize ==
Valid average loss Recognize     : 1.190503
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.069588

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.30231261253357 sec. =
Valid knn accuracy drums     : 67.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.898850440979004 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.51123046875 sec. =
Valid knn accuracy piano     : 19.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.17565369606018 sec. =
Valid knn accuracy guitar    : 30.032467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.238253593444824 sec. =
Valid knn accuracy residuals : 53.77358490566038%

Valid knn accuracy average   : 37.46705586788957%

                                                                        [AEpoch 49: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0696, Train/loss_unet_all_step=0.0696, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0606, Train/loss_unet_all_epoch=0.0606, Train/loss_triplet_all_epoch=0.417, Train/loss_recog_epoch=1.270]Epoch 49: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0696, Train/loss_unet_all_step=0.0696, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020290, 0.020266, 0.019940
Train average loss UNet            (all)              : 0.060496

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.211494, 2.037575, 2.310006
Train average loss bass     (Triplet, dist_p, dist_n) : 0.577552, 2.311140, 2.080967
Train average loss piano    (Triplet, dist_p, dist_n) : 0.460168, 2.202341, 2.136224
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.428829, 2.214311, 2.189573
Train average loss residuals(Triplet, dist_p, dist_n) : 0.373640, 2.187924, 2.236269
Train average loss all      (Triplet)                 : 0.413756

== Recognize ==
Train average loss Recognize     : 1.279629
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.060496

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0696, Train/loss_unet_all_step=0.0696, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0696, Train/loss_unet_all_step=0.0696, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  16%|█▌        | 50/313 [02:29<13:06,  0.33it/s, v_num=0, Train/loss_all_step=0.0696, Train/loss_unet_all_step=0.0696, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  16%|█▌        | 50/313 [02:29<13:06,  0.33it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.0586, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.0586, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0628, Train/loss_unet_all_step=0.0628, Train/loss_triplet_all_step=0.451, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0628, Train/loss_unet_all_step=0.0628, Train/loss_triplet_all_step=0.451, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  64%|██████▍   | 200/313 [09:37<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]  Epoch 50:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  80%|███████▉  | 250/313 [12:00<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0595, Train/loss_unet_all_step=0.0595, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0595, Train/loss_unet_all_step=0.0595, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50:  96%|█████████▌| 300/313 [14:22<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.0552, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.0552, Train/loss_triplet_all_step=0.463, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50: 100%|██████████| 313/313 [14:55<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.598, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.0696, Valid/loss_unet_all_epoch=0.0696, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.00it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021694, 0.022376, 0.025423
Valid average loss UNet            (all)              : 0.069494

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165329, 2.047340, 2.409480
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.630277, 2.380728, 2.072105
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.604639, 2.280490, 2.046706
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.352756, 2.086319, 2.215792
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.368320, 2.208717, 2.515960
Valid average loss all      (Triplet)                 : 0.468734

== Recognize ==
Valid average loss Recognize     : 1.198778
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.069494

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.167060852050781 sec. =
Valid knn accuracy drums     : 67.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.009523153305054 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.156543493270874 sec. =
Valid knn accuracy piano     : 19.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.23237919807434 sec. =
Valid knn accuracy guitar    : 30.357142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.308586835861206 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 37.426451437517954%

                                                                        [AEpoch 50: 100%|██████████| 313/313 [17:31<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0605, Train/loss_unet_all_epoch=0.0605, Train/loss_triplet_all_epoch=0.414, Train/loss_recog_epoch=1.280]Epoch 50: 100%|██████████| 313/313 [17:31<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020264, 0.020236, 0.019922
Train average loss UNet            (all)              : 0.060421

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.209901, 2.025510, 2.294429
Train average loss bass     (Triplet, dist_p, dist_n) : 0.570819, 2.292127, 2.065397
Train average loss piano    (Triplet, dist_p, dist_n) : 0.456257, 2.186116, 2.120591
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.423560, 2.199730, 2.178008
Train average loss residuals(Triplet, dist_p, dist_n) : 0.369473, 2.171106, 2.219921
Train average loss all      (Triplet)                 : 0.409400

== Recognize ==
Train average loss Recognize     : 1.285395
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.060421

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  16%|█▌        | 50/313 [02:29<13:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0693, Train/loss_unet_all_step=0.0693, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.220, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  16%|█▌        | 50/313 [02:29<13:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.0586, Train/loss_triplet_all_step=0.438, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.0586, Train/loss_triplet_all_step=0.438, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  80%|███████▉  | 250/313 [11:57<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  80%|███████▉  | 250/313 [11:57<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  96%|█████████▌| 300/313 [14:19<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51:  96%|█████████▌| 300/313 [14:19<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0548, Train/loss_unet_all_step=0.0548, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51: 100%|██████████| 313/313 [14:53<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0548, Train/loss_unet_all_step=0.0548, Train/loss_triplet_all_step=0.454, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]Epoch 51: 100%|██████████| 313/313 [14:53<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.069, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0523, Valid/loss_unet_all_step=0.0523, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.0695, Valid/loss_unet_all_epoch=0.0695, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.020938, 0.021267, 0.025035
Valid average loss UNet            (all)              : 0.067239

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.160329, 2.082519, 2.424712
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.609500, 2.388856, 2.095412
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.607023, 2.296585, 2.073450
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.360776, 2.134775, 2.251322
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.336428, 2.264161, 2.500415
Valid average loss all      (Triplet)                 : 0.454124

== Recognize ==
Valid average loss Recognize     : 1.239550
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.067239

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.400655031204224 sec. =
Valid knn accuracy drums     : 69.70588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.520148277282715 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.314417123794556 sec. =
Valid knn accuracy piano     : 21.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.88751769065857 sec. =
Valid knn accuracy guitar    : 29.87012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.898722887039185 sec. =
Valid knn accuracy residuals : 53.61635220125787%

Valid knn accuracy average   : 38.654657674306385%

                                                                        [AEpoch 51: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.069, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.230, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0604, Train/loss_unet_all_epoch=0.0604, Train/loss_triplet_all_epoch=0.409, Train/loss_recog_epoch=1.290]  Epoch 51: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.069, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.230, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020191, 0.020179, 0.019834
Train average loss UNet            (all)              : 0.060204

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.207847, 2.016091, 2.284268
Train average loss bass     (Triplet, dist_p, dist_n) : 0.568598, 2.282792, 2.057505
Train average loss piano    (Triplet, dist_p, dist_n) : 0.452394, 2.175790, 2.110564
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.418920, 2.189027, 2.167521
Train average loss residuals(Triplet, dist_p, dist_n) : 0.365995, 2.160814, 2.210034
Train average loss all      (Triplet)                 : 0.406157

== Recognize ==
Train average loss Recognize     : 1.292030
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.060204

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.069, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.230, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.069, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.230, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.069, Train/loss_unet_all_step=0.069, Train/loss_triplet_all_step=0.414, Train/loss_recog_step=1.230, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.440, Train/loss_recog_step=1.290, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.440, Train/loss_recog_step=1.290, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.290, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.290, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.240, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.448, Train/loss_recog_step=1.240, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.300, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]  Epoch 52:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.364, Train/loss_recog_step=1.300, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.260, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.260, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.0547, Train/loss_triplet_all_step=0.471, Train/loss_recog_step=1.320, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.0547, Train/loss_triplet_all_step=0.471, Train/loss_recog_step=1.320, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.053, Valid/loss_unet_all_step=0.053, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0672, Valid/loss_unet_all_epoch=0.0672, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.240, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.021741, 0.022700, 0.024822
Valid average loss UNet            (all)              : 0.069264

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.154900, 2.011085, 2.370796
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.603839, 2.328228, 2.034020
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.608654, 2.253642, 2.007858
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.341447, 2.056657, 2.190179
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.351433, 2.237580, 2.417092
Valid average loss all      (Triplet)                 : 0.453550

== Recognize ==
Valid average loss Recognize     : 1.251307
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.069264

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.534356832504272 sec. =
Valid knn accuracy drums     : 69.85294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.594873905181885 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.662899255752563 sec. =
Valid knn accuracy piano     : 19.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.990580558776855 sec. =
Valid knn accuracy guitar    : 31.006493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.607043504714966 sec. =
Valid knn accuracy residuals : 50.47169811320755%

Valid knn accuracy average   : 37.55519576099422%

                                                                        [AEpoch 52: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.406, Train/loss_recog_epoch=1.290]Epoch 52: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020182, 0.020177, 0.019834
Train average loss UNet            (all)              : 0.060192

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.206854, 2.005868, 2.273762
Train average loss bass     (Triplet, dist_p, dist_n) : 0.564744, 2.271348, 2.047523
Train average loss piano    (Triplet, dist_p, dist_n) : 0.450527, 2.165755, 2.099856
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.415358, 2.178477, 2.157795
Train average loss residuals(Triplet, dist_p, dist_n) : 0.365386, 2.152114, 2.199080
Train average loss all      (Triplet)                 : 0.403821

== Recognize ==
Train average loss Recognize     : 1.297121
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.060192

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0697, Train/loss_unet_all_step=0.0697, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.230, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.433, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  32%|███▏      | 100/313 [04:47<10:12,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.433, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  32%|███▏      | 100/313 [04:47<10:12,  0.35it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0624, Train/loss_unet_all_step=0.0624, Train/loss_triplet_all_step=0.444, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0624, Train/loss_unet_all_step=0.0624, Train/loss_triplet_all_step=0.444, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0654, Train/loss_unet_all_step=0.0654, Train/loss_triplet_all_step=0.362, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0654, Train/loss_unet_all_step=0.0654, Train/loss_triplet_all_step=0.362, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.0551, Train/loss_triplet_all_step=0.455, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.0551, Train/loss_triplet_all_step=0.455, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0539, Valid/loss_unet_all_step=0.0539, Valid/loss_triplet_all_step=0.572, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0693, Valid/loss_unet_all_epoch=0.0693, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025769, 0.024982, 0.030454
Valid average loss UNet            (all)              : 0.081205

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.206877, 2.228710, 2.666088
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.684018, 2.626328, 2.287164
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.540797, 2.383045, 2.185215
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.439483, 2.346430, 2.425695
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.350466, 2.386081, 2.760145
Valid average loss all      (Triplet)                 : 0.482182

== Recognize ==
Valid average loss Recognize     : 1.044287
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.081205

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.578558683395386 sec. =
Valid knn accuracy drums     : 67.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.758295059204102 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.584483861923218 sec. =
Valid knn accuracy piano     : 20.81081081081081%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.97355604171753 sec. =
Valid knn accuracy guitar    : 28.8961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.66468358039856 sec. =
Valid knn accuracy residuals : 46.069182389937104%

Valid knn accuracy average   : 35.591265930998276%

                                                                        [AEpoch 53: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0602, Train/loss_unet_all_epoch=0.0602, Train/loss_triplet_all_epoch=0.404, Train/loss_recog_epoch=1.300]Epoch 53: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020146, 0.020142, 0.019802
Train average loss UNet            (all)              : 0.060090

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.207135, 2.000221, 2.263457
Train average loss bass     (Triplet, dist_p, dist_n) : 0.561848, 2.261562, 2.037911
Train average loss piano    (Triplet, dist_p, dist_n) : 0.446005, 2.156255, 2.093990
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.411883, 2.166975, 2.147669
Train average loss residuals(Triplet, dist_p, dist_n) : 0.364137, 2.144071, 2.191169
Train average loss all      (Triplet)                 : 0.401655

== Recognize ==
Train average loss Recognize     : 1.304203
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.060090

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0688, Train/loss_unet_all_step=0.0688, Train/loss_triplet_all_step=0.397, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.352, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0594, Train/loss_unet_all_step=0.0594, Train/loss_triplet_all_step=0.352, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.455, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  64%|██████▍   | 200/313 [09:38<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.0631, Train/loss_triplet_all_step=0.455, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  64%|██████▍   | 200/313 [09:38<05:26,  0.35it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  80%|███████▉  | 250/313 [12:01<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  80%|███████▉  | 250/313 [12:01<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  96%|█████████▌| 300/313 [14:24<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.366, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54:  96%|█████████▌| 300/313 [14:24<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.0547, Train/loss_triplet_all_step=0.458, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54: 100%|██████████| 313/313 [14:57<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.0547, Train/loss_triplet_all_step=0.458, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54: 100%|██████████| 313/313 [14:57<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0507, Valid/loss_unet_all_step=0.0507, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.0812, Valid/loss_unet_all_epoch=0.0812, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.022314, 0.022295, 0.026064
Valid average loss UNet            (all)              : 0.070673

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.177983, 2.086282, 2.447748
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.605310, 2.432878, 2.131775
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.542383, 2.249298, 2.071178
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371972, 2.144568, 2.227711
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334524, 2.294985, 2.488341
Valid average loss all      (Triplet)                 : 0.441267

== Recognize ==
Valid average loss Recognize     : 1.205719
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.070673

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.519813537597656 sec. =
Valid knn accuracy drums     : 69.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.661142349243164 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.754403591156006 sec. =
Valid knn accuracy piano     : 22.972972972972975%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.927969217300415 sec. =
Valid knn accuracy guitar    : 29.707792207792206%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.171336889266968 sec. =
Valid knn accuracy residuals : 47.0125786163522%

Valid knn accuracy average   : 36.98996834902676%

                                                                        [AEpoch 54: 100%|██████████| 313/313 [17:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0601, Train/loss_unet_all_epoch=0.0601, Train/loss_triplet_all_epoch=0.402, Train/loss_recog_epoch=1.300]Epoch 54: 100%|██████████| 313/313 [17:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020092, 0.020088, 0.019738
Train average loss UNet            (all)              : 0.059918

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.207302, 1.996777, 2.256533
Train average loss bass     (Triplet, dist_p, dist_n) : 0.559398, 2.255614, 2.034454
Train average loss piano    (Triplet, dist_p, dist_n) : 0.446676, 2.151329, 2.087724
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.408611, 2.161401, 2.141903
Train average loss residuals(Triplet, dist_p, dist_n) : 0.362095, 2.137093, 2.181887
Train average loss all      (Triplet)                 : 0.400265

== Recognize ==
Train average loss Recognize     : 1.309741
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.059918

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0686, Train/loss_unet_all_step=0.0686, Train/loss_triplet_all_step=0.406, Train/loss_recog_step=1.240, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.0583, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.0583, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.0589, Train/loss_triplet_all_step=0.362, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.0589, Train/loss_triplet_all_step=0.362, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  48%|████▊     | 150/313 [07:09<07:46,  0.35it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.062, Train/loss_triplet_all_step=0.459, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]  Epoch 55:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.062, Train/loss_unet_all_step=0.062, Train/loss_triplet_all_step=0.459, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.0649, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.0649, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.0591, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.0591, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.0544, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.0544, Train/loss_triplet_all_step=0.457, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0683, Train/loss_unet_all_step=0.0683, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0499, Valid/loss_unet_all_step=0.0499, Valid/loss_triplet_all_step=0.503, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0707, Valid/loss_unet_all_epoch=0.0707, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=1.210, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.025823, 0.025175, 0.030730
Valid average loss UNet            (all)              : 0.081729

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.216374, 2.278846, 2.733627
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.686611, 2.682166, 2.354708
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.569847, 2.426074, 2.236070
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.452457, 2.384079, 2.459565
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.370858, 2.537284, 2.925015
Valid average loss all      (Triplet)                 : 0.493134

== Recognize ==
Valid average loss Recognize     : 1.023128
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.081729

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.643398761749268 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.793709993362427 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.62461256980896 sec. =
Valid knn accuracy piano     : 21.216216216216218%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.062904357910156 sec. =
Valid knn accuracy guitar    : 29.05844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.70768928527832 sec. =
Valid knn accuracy residuals : 47.327044025157235%

Valid knn accuracy average   : 36.659875243683935%

                                                                        [AEpoch 55: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0683, Train/loss_unet_all_step=0.0683, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0599, Train/loss_unet_all_epoch=0.0599, Train/loss_triplet_all_epoch=0.400, Train/loss_recog_epoch=1.310]Epoch 55: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0683, Train/loss_unet_all_step=0.0683, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.020004, 0.020002, 0.019653
Train average loss UNet            (all)              : 0.059658

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.206241, 1.988082, 2.243124
Train average loss bass     (Triplet, dist_p, dist_n) : 0.554110, 2.242191, 2.024058
Train average loss piano    (Triplet, dist_p, dist_n) : 0.442493, 2.139748, 2.077637
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.406313, 2.150165, 2.130271
Train average loss residuals(Triplet, dist_p, dist_n) : 0.361385, 2.132464, 2.176036
Train average loss all      (Triplet)                 : 0.397401

== Recognize ==
Train average loss Recognize     : 1.314747
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.059658

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0683, Train/loss_unet_all_step=0.0683, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0683, Train/loss_unet_all_step=0.0683, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0683, Train/loss_unet_all_step=0.0683, Train/loss_triplet_all_step=0.409, Train/loss_recog_step=1.250, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0579, Train/loss_unet_all_step=0.0579, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0579, Train/loss_unet_all_step=0.0579, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.0591, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0591, Train/loss_unet_all_step=0.0591, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.445, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0623, Train/loss_unet_all_step=0.0623, Train/loss_triplet_all_step=0.445, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.357, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.357, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.0588, Train/loss_triplet_all_step=0.357, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  96%|█████████▌| 300/313 [14:16<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0588, Train/loss_unet_all_step=0.0588, Train/loss_triplet_all_step=0.357, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56:  96%|█████████▌| 300/313 [14:16<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.0541, Train/loss_triplet_all_step=0.462, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.0541, Train/loss_triplet_all_step=0.462, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0508, Valid/loss_unet_all_step=0.0508, Valid/loss_triplet_all_step=0.496, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.0817, Valid/loss_unet_all_epoch=0.0817, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027021, 0.026055, 0.032134
Valid average loss UNet            (all)              : 0.085210

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.234535, 2.355120, 2.854814
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.731096, 2.778103, 2.421397
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.596286, 2.518245, 2.301542
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.491056, 2.478615, 2.586228
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.404533, 2.516346, 2.995171
Valid average loss all      (Triplet)                 : 0.526459

== Recognize ==
Valid average loss Recognize     : 0.966719
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.085210

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.395413160324097 sec. =
Valid knn accuracy drums     : 70.44117647058825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.896393060684204 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.904320478439331 sec. =
Valid knn accuracy piano     : 21.756756756756758%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.382608652114868 sec. =
Valid knn accuracy guitar    : 27.110389610389614%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.593976020812988 sec. =
Valid knn accuracy residuals : 46.855345911949684%

Valid knn accuracy average   : 36.16878026156476%

                                                                        [AEpoch 56: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0597, Train/loss_unet_all_epoch=0.0597, Train/loss_triplet_all_epoch=0.397, Train/loss_recog_epoch=1.310]Epoch 56: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019973, 0.019971, 0.019617
Train average loss UNet            (all)              : 0.059562

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.206059, 1.980247, 2.230568
Train average loss bass     (Triplet, dist_p, dist_n) : 0.552293, 2.233531, 2.016254
Train average loss piano    (Triplet, dist_p, dist_n) : 0.438073, 2.128454, 2.068113
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.401574, 2.140980, 2.123078
Train average loss residuals(Triplet, dist_p, dist_n) : 0.355721, 2.116004, 2.159038
Train average loss all      (Triplet)                 : 0.394075

== Recognize ==
Train average loss Recognize     : 1.320246
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.683334 %

== Train average loss all : 0.059562

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0685, Train/loss_unet_all_step=0.0685, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0576, Train/loss_unet_all_step=0.0576, Train/loss_triplet_all_step=0.415, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  32%|███▏      | 100/313 [04:48<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0576, Train/loss_unet_all_step=0.0576, Train/loss_triplet_all_step=0.415, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  32%|███▏      | 100/313 [04:48<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.356, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.356, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0619, Train/loss_unet_all_step=0.0619, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0619, Train/loss_unet_all_step=0.0619, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.0649, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0649, Train/loss_unet_all_step=0.0649, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.0589, Train/loss_triplet_all_step=0.351, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  96%|█████████▌| 300/313 [14:13<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.0589, Train/loss_triplet_all_step=0.351, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57:  96%|█████████▌| 300/313 [14:13<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.0541, Train/loss_triplet_all_step=0.444, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.0541, Train/loss_triplet_all_step=0.444, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0517, Valid/loss_unet_all_step=0.0517, Valid/loss_triplet_all_step=0.512, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.0852, Valid/loss_unet_all_epoch=0.0852, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=0.967, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027136, 0.026147, 0.032096
Valid average loss UNet            (all)              : 0.085379

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.234853, 2.404330, 2.950724
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.777729, 2.850207, 2.460281
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.612985, 2.567505, 2.333723
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.494655, 2.526605, 2.635169
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.419055, 2.580033, 3.143990
Valid average loss all      (Triplet)                 : 0.549443

== Recognize ==
Valid average loss Recognize     : 0.951350
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.085379

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.269231081008911 sec. =
Valid knn accuracy drums     : 72.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.465633392333984 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.878079652786255 sec. =
Valid knn accuracy piano     : 21.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.321967124938965 sec. =
Valid knn accuracy guitar    : 30.357142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.742080450057983 sec. =
Valid knn accuracy residuals : 46.069182389937104%

Valid knn accuracy average   : 36.959785328929435%

                                                                        [AEpoch 57: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0596, Train/loss_unet_all_epoch=0.0596, Train/loss_triplet_all_epoch=0.394, Train/loss_recog_epoch=1.320]Epoch 57: 100%|██████████| 313/313 [17:19<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019921, 0.019925, 0.019583
Train average loss UNet            (all)              : 0.059429

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.205251, 1.970629, 2.217959
Train average loss bass     (Triplet, dist_p, dist_n) : 0.546418, 2.221190, 2.008149
Train average loss piano    (Triplet, dist_p, dist_n) : 0.437817, 2.123802, 2.063183
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.400180, 2.132323, 2.114328
Train average loss residuals(Triplet, dist_p, dist_n) : 0.353295, 2.104375, 2.146729
Train average loss all      (Triplet)                 : 0.391745

== Recognize ==
Train average loss Recognize     : 1.323750
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.059429

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  16%|█▌        | 50/313 [02:25<12:46,  0.34it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.0684, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  16%|█▌        | 50/313 [02:25<12:46,  0.34it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  32%|███▏      | 100/313 [04:46<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  32%|███▏      | 100/313 [04:46<10:11,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.352, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.352, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.430, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  64%|██████▍   | 200/313 [09:27<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.0618, Train/loss_unet_all_step=0.0618, Train/loss_triplet_all_step=0.430, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  64%|██████▍   | 200/313 [09:27<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.0645, Train/loss_unet_all_step=0.0645, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0645, Train/loss_unet_all_step=0.0645, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  80%|███████▉  | 250/313 [11:48<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.0587, Train/loss_triplet_all_step=0.345, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  96%|█████████▌| 300/313 [14:09<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.0587, Train/loss_triplet_all_step=0.345, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58:  96%|█████████▌| 300/313 [14:09<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0535, Train/loss_unet_all_step=0.0535, Train/loss_triplet_all_step=0.445, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58: 100%|██████████| 313/313 [14:43<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0535, Train/loss_unet_all_step=0.0535, Train/loss_triplet_all_step=0.445, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58: 100%|██████████| 313/313 [14:43<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0518, Valid/loss_unet_all_step=0.0518, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0854, Valid/loss_unet_all_epoch=0.0854, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027324, 0.026421, 0.032736
Valid average loss UNet            (all)              : 0.086480

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.250352, 2.424715, 2.987124
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.806586, 2.895151, 2.486476
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.643844, 2.606437, 2.344823
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.534531, 2.572796, 2.669666
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.442836, 2.664187, 3.213331
Valid average loss all      (Triplet)                 : 0.576911

== Recognize ==
Valid average loss Recognize     : 0.941848
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.086480

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.613555431365967 sec. =
Valid knn accuracy drums     : 69.85294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.741671562194824 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.550528287887573 sec. =
Valid knn accuracy piano     : 20.405405405405403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.736972093582153 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.754204511642456 sec. =
Valid knn accuracy residuals : 46.38364779874214%

Valid knn accuracy average   : 36.12747770427222%

                                                                        [AEpoch 58: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0594, Train/loss_unet_all_epoch=0.0594, Train/loss_triplet_all_epoch=0.392, Train/loss_recog_epoch=1.320]Epoch 58: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019872, 0.019874, 0.019529
Train average loss UNet            (all)              : 0.059275

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.205013, 1.960546, 2.208431
Train average loss bass     (Triplet, dist_p, dist_n) : 0.545776, 2.214365, 2.000410
Train average loss piano    (Triplet, dist_p, dist_n) : 0.434093, 2.109209, 2.049181
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.397742, 2.120914, 2.103359
Train average loss residuals(Triplet, dist_p, dist_n) : 0.353194, 2.096253, 2.137764
Train average loss all      (Triplet)                 : 0.390440

== Recognize ==
Train average loss Recognize     : 1.330889
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.806664 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.059275

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0673, Train/loss_unet_all_step=0.0673, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.260, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0579, Train/loss_unet_all_step=0.0579, Train/loss_triplet_all_step=0.418, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0579, Train/loss_unet_all_step=0.0579, Train/loss_triplet_all_step=0.418, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.0587, Train/loss_triplet_all_step=0.351, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0587, Train/loss_unet_all_step=0.0587, Train/loss_triplet_all_step=0.351, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0614, Train/loss_unet_all_step=0.0614, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0614, Train/loss_unet_all_step=0.0614, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0646, Train/loss_unet_all_step=0.0646, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0585, Train/loss_unet_all_step=0.0585, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0537, Train/loss_unet_all_step=0.0537, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0537, Train/loss_unet_all_step=0.0537, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0865, Valid/loss_unet_all_epoch=0.0865, Valid/loss_triplet_all_epoch=0.577, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.026337, 0.025629, 0.031531
Valid average loss UNet            (all)              : 0.083497

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.224068, 2.319824, 2.809880
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.719820, 2.729086, 2.378048
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.579616, 2.466909, 2.255508
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.457366, 2.408312, 2.504491
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.393592, 2.521265, 2.920491
Valid average loss all      (Triplet)                 : 0.512167

== Recognize ==
Valid average loss Recognize     : 1.010664
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.083497

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.664889574050903 sec. =
Valid knn accuracy drums     : 71.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.130322456359863 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.769459247589111 sec. =
Valid knn accuracy piano     : 21.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.484492063522339 sec. =
Valid knn accuracy guitar    : 30.1948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.05108904838562 sec. =
Valid knn accuracy residuals : 47.64150943396226%

Valid knn accuracy average   : 37.181591686799074%

                                                                        [AEpoch 59: 100%|██████████| 313/313 [17:14<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0593, Train/loss_unet_all_epoch=0.0593, Train/loss_triplet_all_epoch=0.390, Train/loss_recog_epoch=1.330]Epoch 59: 100%|██████████| 313/313 [17:14<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019839, 0.019850, 0.019495
Train average loss UNet            (all)              : 0.059183

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.204715, 1.953011, 2.194684
Train average loss bass     (Triplet, dist_p, dist_n) : 0.539221, 2.202878, 1.992757
Train average loss piano    (Triplet, dist_p, dist_n) : 0.429962, 2.100587, 2.041490
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.393819, 2.110198, 2.092835
Train average loss residuals(Triplet, dist_p, dist_n) : 0.350492, 2.087237, 2.128918
Train average loss all      (Triplet)                 : 0.386855

== Recognize ==
Train average loss Recognize     : 1.338285
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.790001 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.680000 %

== Train average loss all : 0.059183

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.067, Train/loss_unet_all_step=0.067, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  16%|█▌        | 50/313 [02:27<12:55,  0.34it/s, v_num=0, Train/loss_all_step=0.0579, Train/loss_unet_all_step=0.0579, Train/loss_triplet_all_step=0.405, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  32%|███▏      | 100/313 [04:48<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0579, Train/loss_unet_all_step=0.0579, Train/loss_triplet_all_step=0.405, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  32%|███▏      | 100/313 [04:48<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.0584, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.0584, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0617, Train/loss_unet_all_step=0.0617, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0617, Train/loss_unet_all_step=0.0617, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0645, Train/loss_unet_all_step=0.0645, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0645, Train/loss_unet_all_step=0.0645, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  80%|███████▉  | 250/313 [11:53<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.0586, Train/loss_triplet_all_step=0.348, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.0586, Train/loss_triplet_all_step=0.348, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0539, Train/loss_unet_all_step=0.0539, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0539, Train/loss_unet_all_step=0.0539, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]Epoch 60: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0515, Valid/loss_unet_all_step=0.0515, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.0835, Valid/loss_unet_all_epoch=0.0835, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.372, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027386, 0.026479, 0.033148
Valid average loss UNet            (all)              : 0.087013

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.257563, 2.448074, 3.000056
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.820701, 2.911136, 2.494475
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.613912, 2.576664, 2.349041
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.530105, 2.578134, 2.658026
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.427909, 2.636316, 3.197221
Valid average loss all      (Triplet)                 : 0.573359

== Recognize ==
Valid average loss Recognize     : 0.931027
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.087013

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.921155214309692 sec. =
Valid knn accuracy drums     : 70.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.687652349472046 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.810819149017334 sec. =
Valid knn accuracy piano     : 20.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.136821031570435 sec. =
Valid knn accuracy guitar    : 27.435064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.762138366699219 sec. =
Valid knn accuracy residuals : 48.58490566037736%

Valid knn accuracy average   : 36.395207562353896%

                                                                        [AEpoch 60: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0592, Train/loss_unet_all_epoch=0.0592, Train/loss_triplet_all_epoch=0.387, Train/loss_recog_epoch=1.340]  Epoch 60: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019801, 0.019816, 0.019458
Train average loss UNet            (all)              : 0.059075

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.201914, 1.943066, 2.185704
Train average loss bass     (Triplet, dist_p, dist_n) : 0.534757, 2.191128, 1.984408
Train average loss piano    (Triplet, dist_p, dist_n) : 0.428131, 2.091177, 2.030443
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.391511, 2.103692, 2.089066
Train average loss residuals(Triplet, dist_p, dist_n) : 0.349342, 2.076520, 2.116465
Train average loss all      (Triplet)                 : 0.384452

== Recognize ==
Train average loss Recognize     : 1.342389
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.796669 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.673332 %

== Train average loss all : 0.059075

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  16%|█▌        | 50/313 [02:31<13:16,  0.33it/s, v_num=0, Train/loss_all_step=0.0675, Train/loss_unet_all_step=0.0675, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.270, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  16%|█▌        | 50/313 [02:31<13:16,  0.33it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  32%|███▏      | 100/313 [04:58<10:35,  0.34it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  32%|███▏      | 100/313 [04:58<10:35,  0.34it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.345, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  48%|████▊     | 150/313 [07:21<08:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.345, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  48%|████▊     | 150/313 [07:21<08:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.0616, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  64%|██████▍   | 200/313 [09:47<05:31,  0.34it/s, v_num=0, Train/loss_all_step=0.0616, Train/loss_unet_all_step=0.0616, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  64%|██████▍   | 200/313 [09:47<05:31,  0.34it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  80%|███████▉  | 250/313 [12:12<03:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  80%|███████▉  | 250/313 [12:12<03:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.0584, Train/loss_triplet_all_step=0.339, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  96%|█████████▌| 300/313 [14:37<00:38,  0.34it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.0584, Train/loss_triplet_all_step=0.339, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61:  96%|█████████▌| 300/313 [14:37<00:38,  0.34it/s, v_num=0, Train/loss_all_step=0.053, Train/loss_unet_all_step=0.053, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]  Epoch 61: 100%|██████████| 313/313 [15:11<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.053, Train/loss_unet_all_step=0.053, Train/loss_triplet_all_step=0.437, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61: 100%|██████████| 313/313 [15:11<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.580, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.087, Valid/loss_unet_all_epoch=0.087, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028116, 0.027011, 0.033903
Valid average loss UNet            (all)              : 0.089030

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.261567, 2.571731, 3.193687
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.870219, 3.095991, 2.656015
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.667443, 2.751143, 2.471083
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.599817, 2.741907, 2.840679
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.479862, 2.805701, 3.470338
Valid average loss all      (Triplet)                 : 0.621008

== Recognize ==
Valid average loss Recognize     : 0.866375
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.089030

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.837921857833862 sec. =
Valid knn accuracy drums     : 71.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.804183959960938 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.85509991645813 sec. =
Valid knn accuracy piano     : 20.675675675675677%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.355206489562988 sec. =
Valid knn accuracy guitar    : 26.623376623376622%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.741339445114136 sec. =
Valid knn accuracy residuals : 48.113207547169814%

Valid knn accuracy average   : 36.427869205906525%

                                                                        [AEpoch 61: 100%|██████████| 313/313 [17:43<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0591, Train/loss_unet_all_epoch=0.0591, Train/loss_triplet_all_epoch=0.384, Train/loss_recog_epoch=1.340]Epoch 61: 100%|██████████| 313/313 [17:43<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019739, 0.019738, 0.019407
Train average loss UNet            (all)              : 0.058884

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200961, 1.937888, 2.179348
Train average loss bass     (Triplet, dist_p, dist_n) : 0.533258, 2.184804, 1.978295
Train average loss piano    (Triplet, dist_p, dist_n) : 0.424567, 2.086541, 2.028515
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.389364, 2.099099, 2.085560
Train average loss residuals(Triplet, dist_p, dist_n) : 0.347288, 2.072507, 2.112448
Train average loss all      (Triplet)                 : 0.382272

== Recognize ==
Train average loss Recognize     : 1.349263
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.790001 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.680000 %

== Train average loss all : 0.058884

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.0676, Train/loss_unet_all_step=0.0676, Train/loss_triplet_all_step=0.384, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  16%|█▌        | 50/313 [02:28<12:59,  0.34it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  32%|███▏      | 100/313 [04:48<10:14,  0.35it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.0583, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.0583, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.427, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0615, Train/loss_unet_all_step=0.0615, Train/loss_triplet_all_step=0.427, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0644, Train/loss_unet_all_step=0.0644, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  80%|███████▉  | 250/313 [11:54<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0644, Train/loss_unet_all_step=0.0644, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  80%|███████▉  | 250/313 [11:54<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]  Epoch 62:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.053, Train/loss_unet_all_step=0.053, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.053, Train/loss_unet_all_step=0.053, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0545, Valid/loss_unet_all_step=0.0545, Valid/loss_triplet_all_step=0.606, Valid/loss_recog_step=0.939, Valid/loss_all_epoch=0.089, Valid/loss_unet_all_epoch=0.089, Valid/loss_triplet_all_epoch=0.621, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.16it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027909, 0.027013, 0.033589
Valid average loss UNet            (all)              : 0.088510

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.268739, 2.625987, 3.303009
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.891528, 3.177841, 2.729996
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.704556, 2.841839, 2.555268
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.631381, 2.841592, 2.902623
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.502552, 2.881356, 3.635609
Valid average loss all      (Triplet)                 : 0.644876

== Recognize ==
Valid average loss Recognize     : 0.858870
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.088510

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.602721929550171 sec. =
Valid knn accuracy drums     : 69.70588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.769351482391357 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.881314754486084 sec. =
Valid knn accuracy piano     : 21.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.387778043746948 sec. =
Valid knn accuracy guitar    : 25.324675324675322%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.00322937965393 sec. =
Valid knn accuracy residuals : 48.42767295597484%

Valid knn accuracy average   : 36.04739722665542%

                                                                        [AEpoch 62: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0589, Train/loss_unet_all_epoch=0.0589, Train/loss_triplet_all_epoch=0.382, Train/loss_recog_epoch=1.350]Epoch 62: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019718, 0.019720, 0.019378
Train average loss UNet            (all)              : 0.058815

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.201344, 1.933902, 2.170455
Train average loss bass     (Triplet, dist_p, dist_n) : 0.529099, 2.177213, 1.973348
Train average loss piano    (Triplet, dist_p, dist_n) : 0.423593, 2.080387, 2.022419
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.388738, 2.091392, 2.075077
Train average loss residuals(Triplet, dist_p, dist_n) : 0.345036, 2.068191, 2.108908
Train average loss all      (Triplet)                 : 0.380672

== Recognize ==
Train average loss Recognize     : 1.353621
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.793327 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.673332 %

== Train average loss all : 0.058815

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0669, Train/loss_unet_all_step=0.0669, Train/loss_triplet_all_step=0.382, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0577, Train/loss_unet_all_step=0.0577, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0577, Train/loss_unet_all_step=0.0577, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  48%|████▊     | 150/313 [07:13<07:51,  0.35it/s, v_num=0, Train/loss_all_step=0.0613, Train/loss_unet_all_step=0.0613, Train/loss_triplet_all_step=0.435, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0613, Train/loss_unet_all_step=0.0613, Train/loss_triplet_all_step=0.435, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.0583, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  96%|█████████▌| 300/313 [14:19<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0583, Train/loss_unet_all_step=0.0583, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63:  96%|█████████▌| 300/313 [14:19<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0533, Train/loss_unet_all_step=0.0533, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63: 100%|██████████| 313/313 [14:52<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0533, Train/loss_unet_all_step=0.0533, Train/loss_triplet_all_step=0.422, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]Epoch 63: 100%|██████████| 313/313 [14:52<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.632, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.0885, Valid/loss_unet_all_epoch=0.0885, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=0.859, Valid/knn_avr=0.360, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:04<00:00,  1.00it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028471, 0.027419, 0.034137
Valid average loss UNet            (all)              : 0.090026

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.270509, 2.588008, 3.272352
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.894186, 3.167584, 2.716686
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.665912, 2.796985, 2.521112
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.649667, 2.844166, 2.922829
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.515533, 2.852457, 3.616240
Valid average loss all      (Triplet)                 : 0.641469

== Recognize ==
Valid average loss Recognize     : 0.837948
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.090026

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.51267147064209 sec. =
Valid knn accuracy drums     : 69.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.678308010101318 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.864325284957886 sec. =
Valid knn accuracy piano     : 17.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.318581104278564 sec. =
Valid knn accuracy guitar    : 22.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.946566581726074 sec. =
Valid knn accuracy residuals : 47.9559748427673%

Valid knn accuracy average   : 34.384066948497946%

                                                                        [AEpoch 63: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0588, Train/loss_unet_all_epoch=0.0588, Train/loss_triplet_all_epoch=0.381, Train/loss_recog_epoch=1.350]  Epoch 63: 100%|██████████| 313/313 [17:23<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019686, 0.019686, 0.019321
Train average loss UNet            (all)              : 0.058692

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.201520, 1.929091, 2.164303
Train average loss bass     (Triplet, dist_p, dist_n) : 0.525943, 2.170335, 1.968610
Train average loss piano    (Triplet, dist_p, dist_n) : 0.421175, 2.075165, 2.017092
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.384743, 2.082220, 2.067654
Train average loss residuals(Triplet, dist_p, dist_n) : 0.343642, 2.060444, 2.100565
Train average loss all      (Triplet)                 : 0.378510

== Recognize ==
Train average loss Recognize     : 1.359517
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.453331 %
Train average accuracy piano     : 89.776665 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.629997 %

== Train average loss all : 0.058692

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.0666, Train/loss_unet_all_step=0.0666, Train/loss_triplet_all_step=0.372, Train/loss_recog_step=1.280, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  16%|█▌        | 50/313 [02:29<13:05,  0.33it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.057, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]  Epoch 64:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.057, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.339, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  48%|████▊     | 150/313 [07:13<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.339, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  48%|████▊     | 150/313 [07:13<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.061, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]  Epoch 64:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.061, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.325, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  80%|███████▉  | 250/313 [11:57<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0642, Train/loss_unet_all_step=0.0642, Train/loss_triplet_all_step=0.325, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  80%|███████▉  | 250/313 [11:57<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]  Epoch 64:  96%|█████████▌| 300/313 [14:20<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64:  96%|█████████▌| 300/313 [14:20<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0531, Train/loss_unet_all_step=0.0531, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64: 100%|██████████| 313/313 [14:53<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0531, Train/loss_unet_all_step=0.0531, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64: 100%|██████████| 313/313 [14:53<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0551, Valid/loss_unet_all_step=0.0551, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.090, Valid/loss_unet_all_epoch=0.090, Valid/loss_triplet_all_epoch=0.641, Valid/loss_recog_epoch=0.838, Valid/knn_avr=0.344, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027048, 0.026098, 0.032320
Valid average loss UNet            (all)              : 0.085466

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.238404, 2.406392, 2.991441
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.796564, 2.868431, 2.459410
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.635617, 2.581108, 2.341427
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.527303, 2.543411, 2.622196
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.436338, 2.644194, 3.162596
Valid average loss all      (Triplet)                 : 0.566209

== Recognize ==
Valid average loss Recognize     : 0.951971
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.085466

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.582242488861084 sec. =
Valid knn accuracy drums     : 72.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.544729709625244 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.869120359420776 sec. =
Valid knn accuracy piano     : 19.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.306383848190308 sec. =
Valid knn accuracy guitar    : 26.785714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.66999363899231 sec. =
Valid knn accuracy residuals : 46.855345911949684%

Valid knn accuracy average   : 36.11122124572942%

                                                                        [AEpoch 64: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0587, Train/loss_unet_all_epoch=0.0587, Train/loss_triplet_all_epoch=0.379, Train/loss_recog_epoch=1.360]Epoch 64: 100%|██████████| 313/313 [17:24<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019661, 0.019659, 0.019314
Train average loss UNet            (all)              : 0.058635

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200568, 1.922777, 2.156857
Train average loss bass     (Triplet, dist_p, dist_n) : 0.523068, 2.163226, 1.962382
Train average loss piano    (Triplet, dist_p, dist_n) : 0.419393, 2.066281, 2.008447
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.383743, 2.076779, 2.061312
Train average loss residuals(Triplet, dist_p, dist_n) : 0.340906, 2.051616, 2.092538
Train average loss all      (Triplet)                 : 0.376683

== Recognize ==
Train average loss Recognize     : 1.363236
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.433334 %
Train average accuracy piano     : 89.786667 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.669998 %

== Train average loss all : 0.058635

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  16%|█▌        | 50/313 [02:26<12:49,  0.34it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.389, Train/loss_recog_step=1.290, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  16%|█▌        | 50/313 [02:26<12:49,  0.34it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.057, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]  Epoch 65:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.057, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.330, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.330, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.0611, Train/loss_triplet_all_step=0.432, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0611, Train/loss_unet_all_step=0.0611, Train/loss_triplet_all_step=0.432, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.0637, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.0637, Train/loss_triplet_all_step=0.331, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  80%|███████▉  | 250/313 [11:50<02:58,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]  Epoch 65:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0528, Train/loss_unet_all_step=0.0528, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65: 100%|██████████| 313/313 [14:43<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0528, Train/loss_unet_all_step=0.0528, Train/loss_triplet_all_step=0.423, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65: 100%|██████████| 313/313 [14:43<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0528, Valid/loss_unet_all_step=0.0528, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=0.952, Valid/knn_avr=0.361, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.31it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027775, 0.026818, 0.033123
Valid average loss UNet            (all)              : 0.087716

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.245974, 2.457555, 3.062665
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.831205, 2.936046, 2.518401
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.648486, 2.595766, 2.346417
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.533685, 2.604074, 2.678701
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.469130, 2.685818, 3.274764
Valid average loss all      (Triplet)                 : 0.588095

== Recognize ==
Valid average loss Recognize     : 0.905555
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.087716

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.02301549911499 sec. =
Valid knn accuracy drums     : 68.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.771578550338745 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.877405881881714 sec. =
Valid knn accuracy piano     : 19.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.368913173675537 sec. =
Valid knn accuracy guitar    : 25.811688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.766639709472656 sec. =
Valid knn accuracy residuals : 47.64150943396226%

Valid knn accuracy average   : 35.312686356539444%

                                                                        [AEpoch 65: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0586, Train/loss_unet_all_epoch=0.0586, Train/loss_triplet_all_epoch=0.377, Train/loss_recog_epoch=1.360]Epoch 65: 100%|██████████| 313/313 [17:16<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019602, 0.019612, 0.019261
Train average loss UNet            (all)              : 0.058475

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200888, 1.919297, 2.151611
Train average loss bass     (Triplet, dist_p, dist_n) : 0.523314, 2.156860, 1.956086
Train average loss piano    (Triplet, dist_p, dist_n) : 0.418530, 2.061825, 2.004771
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.381611, 2.068555, 2.053321
Train average loss residuals(Triplet, dist_p, dist_n) : 0.341744, 2.046630, 2.085202
Train average loss all      (Triplet)                 : 0.376338

== Recognize ==
Train average loss Recognize     : 1.369984
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.419998 %
Train average accuracy piano     : 89.753334 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.650002 %

== Train average loss all : 0.058475

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0663, Train/loss_unet_all_step=0.0663, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0568, Train/loss_unet_all_step=0.0568, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0568, Train/loss_unet_all_step=0.0568, Train/loss_triplet_all_step=0.385, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  48%|████▊     | 150/313 [07:11<07:48,  0.35it/s, v_num=0, Train/loss_all_step=0.0582, Train/loss_unet_all_step=0.0582, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  48%|████▊     | 150/313 [07:11<07:48,  0.35it/s, v_num=0, Train/loss_all_step=0.0603, Train/loss_unet_all_step=0.0603, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0603, Train/loss_unet_all_step=0.0603, Train/loss_triplet_all_step=0.424, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.329, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0639, Train/loss_unet_all_step=0.0639, Train/loss_triplet_all_step=0.329, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]  Epoch 66:  96%|█████████▌| 300/313 [14:16<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66:  96%|█████████▌| 300/313 [14:16<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0529, Train/loss_unet_all_step=0.0529, Train/loss_triplet_all_step=0.427, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0529, Train/loss_unet_all_step=0.0529, Train/loss_triplet_all_step=0.427, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0543, Valid/loss_unet_all_step=0.0543, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=0.978, Valid/loss_all_epoch=0.0877, Valid/loss_unet_all_epoch=0.0877, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.14it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028704, 0.027671, 0.034406
Valid average loss UNet            (all)              : 0.090780

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.279050, 2.745560, 3.491123
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.972690, 3.375481, 2.862685
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.760471, 2.973222, 2.661928
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.685056, 2.969095, 3.034045
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.575558, 3.051660, 3.867468
Valid average loss all      (Triplet)                 : 0.703741

== Recognize ==
Valid average loss Recognize     : 0.808922
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.090780

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.588828086853027 sec. =
Valid knn accuracy drums     : 66.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.549354553222656 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.817657470703125 sec. =
Valid knn accuracy piano     : 18.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.354206085205078 sec. =
Valid knn accuracy guitar    : 24.025974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.872145891189575 sec. =
Valid knn accuracy residuals : 49.37106918238994%

Valid knn accuracy average   : 34.70118554853862%

                                                                        [AEpoch 66: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0585, Train/loss_unet_all_epoch=0.0585, Train/loss_triplet_all_epoch=0.376, Train/loss_recog_epoch=1.370]Epoch 66: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019567, 0.019565, 0.019222
Train average loss UNet            (all)              : 0.058354

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.202652, 1.914615, 2.142300
Train average loss bass     (Triplet, dist_p, dist_n) : 0.517644, 2.146315, 1.949580
Train average loss piano    (Triplet, dist_p, dist_n) : 0.416041, 2.050803, 1.993212
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.378097, 2.058781, 2.044764
Train average loss residuals(Triplet, dist_p, dist_n) : 0.338338, 2.037810, 2.076673
Train average loss all      (Triplet)                 : 0.373577

== Recognize ==
Train average loss Recognize     : 1.372836
Train average accuracy drums     : 93.793335 %
Train average accuracy bass      : 96.423332 %
Train average accuracy piano     : 89.713333 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.643333 %

== Train average loss all : 0.058354

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  16%|█▌        | 50/313 [02:24<12:41,  0.35it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.373, Train/loss_recog_step=1.300, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  16%|█▌        | 50/313 [02:24<12:41,  0.35it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.392, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  32%|███▏      | 100/313 [04:46<10:09,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.336, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.336, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  64%|██████▍   | 200/313 [09:26<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.0605, Train/loss_unet_all_step=0.0605, Train/loss_triplet_all_step=0.429, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  64%|██████▍   | 200/313 [09:26<05:20,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.330, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  80%|███████▉  | 250/313 [11:46<02:57,  0.35it/s, v_num=0, Train/loss_all_step=0.0638, Train/loss_unet_all_step=0.0638, Train/loss_triplet_all_step=0.330, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  80%|███████▉  | 250/313 [11:46<02:57,  0.35it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.332, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  96%|█████████▌| 300/313 [14:06<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.332, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67:  96%|█████████▌| 300/313 [14:06<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.0526, Train/loss_triplet_all_step=0.425, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67: 100%|██████████| 313/313 [14:40<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.0526, Train/loss_triplet_all_step=0.425, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67: 100%|██████████| 313/313 [14:40<00:00,  0.36it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0564, Valid/loss_unet_all_step=0.0564, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=0.889, Valid/loss_all_epoch=0.0908, Valid/loss_unet_all_epoch=0.0908, Valid/loss_triplet_all_epoch=0.704, Valid/loss_recog_epoch=0.809, Valid/knn_avr=0.347, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027467, 0.026266, 0.032621
Valid average loss UNet            (all)              : 0.086354

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.221656, 2.266567, 2.767046
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.722848, 2.674417, 2.316226
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.570950, 2.365133, 2.164470
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.439036, 2.338985, 2.439487
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.401934, 2.502171, 2.849458
Valid average loss all      (Triplet)                 : 0.505406

== Recognize ==
Valid average loss Recognize     : 0.995837
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.086354

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.717221975326538 sec. =
Valid knn accuracy drums     : 68.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.76597809791565 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.824492454528809 sec. =
Valid knn accuracy piano     : 19.864864864864863%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.135928630828857 sec. =
Valid knn accuracy guitar    : 26.461038961038962%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.774467468261719 sec. =
Valid knn accuracy residuals : 48.270440251572325%

Valid knn accuracy average   : 35.56051368553627%

                                                                        [AEpoch 67: 100%|██████████| 313/313 [17:10<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0584, Train/loss_unet_all_epoch=0.0584, Train/loss_triplet_all_epoch=0.374, Train/loss_recog_epoch=1.370]Epoch 67: 100%|██████████| 313/313 [17:10<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019540, 0.019537, 0.019184
Train average loss UNet            (all)              : 0.058261

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200391, 1.909223, 2.137764
Train average loss bass     (Triplet, dist_p, dist_n) : 0.515803, 2.140683, 1.943576
Train average loss piano    (Triplet, dist_p, dist_n) : 0.412282, 2.041950, 1.986155
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.374157, 2.052920, 2.041984
Train average loss residuals(Triplet, dist_p, dist_n) : 0.337268, 2.031342, 2.070950
Train average loss all      (Triplet)                 : 0.371050

== Recognize ==
Train average loss Recognize     : 1.377720
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.406670 %
Train average accuracy piano     : 89.670006 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.659996 %

== Train average loss all : 0.058261

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0667, Train/loss_unet_all_step=0.0667, Train/loss_triplet_all_step=0.376, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  16%|█▌        | 50/313 [02:28<13:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.0563, Train/loss_triplet_all_step=0.394, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.0563, Train/loss_unet_all_step=0.0563, Train/loss_triplet_all_step=0.394, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  32%|███▏      | 100/313 [04:51<10:20,  0.34it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]  Epoch 68:  48%|████▊     | 150/313 [07:14<07:52,  0.35it/s, v_num=0, Train/loss_all_step=0.058, Train/loss_unet_all_step=0.058, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  48%|████▊     | 150/313 [07:14<07:52,  0.35it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.418, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.418, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  64%|██████▍   | 200/313 [09:35<05:25,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.327, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  80%|███████▉  | 250/313 [11:58<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.327, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  80%|███████▉  | 250/313 [11:58<03:01,  0.35it/s, v_num=0, Train/loss_all_step=0.0576, Train/loss_unet_all_step=0.0576, Train/loss_triplet_all_step=0.327, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0576, Train/loss_unet_all_step=0.0576, Train/loss_triplet_all_step=0.327, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68:  96%|█████████▌| 300/313 [14:21<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0531, Train/loss_unet_all_step=0.0531, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0531, Train/loss_unet_all_step=0.0531, Train/loss_triplet_all_step=0.426, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68: 100%|██████████| 313/313 [14:54<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0524, Valid/loss_unet_all_step=0.0524, Valid/loss_triplet_all_step=0.498, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.0864, Valid/loss_unet_all_epoch=0.0864, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:04<00:00,  0.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027016, 0.025900, 0.032398
Valid average loss UNet            (all)              : 0.085314

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.245366, 2.367590, 2.927935
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.783137, 2.825601, 2.433695
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.632376, 2.508975, 2.277126
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.499896, 2.440430, 2.550325
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.428924, 2.602268, 3.062739
Valid average loss all      (Triplet)                 : 0.557494

== Recognize ==
Valid average loss Recognize     : 0.967784
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.085314

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.545872688293457 sec. =
Valid knn accuracy drums     : 67.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.61741852760315 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.835578441619873 sec. =
Valid knn accuracy piano     : 20.81081081081081%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.31130337715149 sec. =
Valid knn accuracy guitar    : 28.246753246753247%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.836981058120728 sec. =
Valid knn accuracy residuals : 46.855345911949684%

Valid knn accuracy average   : 35.91035217174133%

                                                                        [AEpoch 68: 100%|██████████| 313/313 [17:25<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0583, Train/loss_unet_all_epoch=0.0583, Train/loss_triplet_all_epoch=0.371, Train/loss_recog_epoch=1.380]Epoch 68: 100%|██████████| 313/313 [17:25<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019503, 0.019487, 0.019157
Train average loss UNet            (all)              : 0.058147

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200707, 1.900861, 2.126139
Train average loss bass     (Triplet, dist_p, dist_n) : 0.512313, 2.130407, 1.936546
Train average loss piano    (Triplet, dist_p, dist_n) : 0.409738, 2.032869, 1.976942
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.374127, 2.046021, 2.033461
Train average loss residuals(Triplet, dist_p, dist_n) : 0.336122, 2.025791, 2.064954
Train average loss all      (Triplet)                 : 0.369570

== Recognize ==
Train average loss Recognize     : 1.383028
Train average accuracy drums     : 93.790001 %
Train average accuracy bass      : 96.346664 %
Train average accuracy piano     : 89.556664 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.559998 %

== Train average loss all : 0.058147

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  16%|█▌        | 50/313 [02:29<13:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0664, Train/loss_unet_all_step=0.0664, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.310, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  16%|█▌        | 50/313 [02:29<13:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  32%|███▏      | 100/313 [04:49<10:16,  0.35it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.396, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  32%|███▏      | 100/313 [04:49<10:16,  0.35it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0603, Train/loss_unet_all_step=0.0603, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0603, Train/loss_unet_all_step=0.0603, Train/loss_triplet_all_step=0.412, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  64%|██████▍   | 200/313 [09:32<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0632, Train/loss_unet_all_step=0.0632, Train/loss_triplet_all_step=0.326, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0632, Train/loss_unet_all_step=0.0632, Train/loss_triplet_all_step=0.326, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  80%|███████▉  | 250/313 [11:52<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.333, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0578, Train/loss_unet_all_step=0.0578, Train/loss_triplet_all_step=0.333, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.0526, Train/loss_triplet_all_step=0.428, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.0526, Train/loss_triplet_all_step=0.428, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0527, Valid/loss_unet_all_step=0.0527, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.0853, Valid/loss_unet_all_epoch=0.0853, Valid/loss_triplet_all_epoch=0.557, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028823, 0.027405, 0.035128
Valid average loss UNet            (all)              : 0.091355

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.272293, 2.513726, 3.134231
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.871182, 3.010717, 2.565215
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.668179, 2.689498, 2.417628
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.578263, 2.650218, 2.756752
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.477359, 2.720090, 3.310816
Valid average loss all      (Triplet)                 : 0.616929

== Recognize ==
Valid average loss Recognize     : 0.871175
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.091355

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.600175380706787 sec. =
Valid knn accuracy drums     : 65.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.774113893508911 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.6649169921875 sec. =
Valid knn accuracy piano     : 19.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.305272579193115 sec. =
Valid knn accuracy guitar    : 27.110389610389614%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.932307481765747 sec. =
Valid knn accuracy residuals : 48.742138364779876%

Valid knn accuracy average   : 35.28676617846274%

                                                                        [AEpoch 69: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.0581, Train/loss_unet_all_epoch=0.0581, Train/loss_triplet_all_epoch=0.370, Train/loss_recog_epoch=1.380]Epoch 69: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019458, 0.019459, 0.019114
Train average loss UNet            (all)              : 0.058030

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200296, 1.896230, 2.119651
Train average loss bass     (Triplet, dist_p, dist_n) : 0.513570, 2.127448, 1.932817
Train average loss piano    (Triplet, dist_p, dist_n) : 0.408045, 2.026953, 1.972695
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.372681, 2.038505, 2.024876
Train average loss residuals(Triplet, dist_p, dist_n) : 0.337306, 2.020565, 2.057682
Train average loss all      (Triplet)                 : 0.369352

== Recognize ==
Train average loss Recognize     : 1.387717
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.350006 %
Train average accuracy piano     : 89.590004 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.583336 %

== Train average loss all : 0.058030

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  16%|█▌        | 50/313 [02:26<12:48,  0.34it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.066, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  16%|█▌        | 50/313 [02:26<12:48,  0.34it/s, v_num=0, Train/loss_all_step=0.0561, Train/loss_unet_all_step=0.0561, Train/loss_triplet_all_step=0.395, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  32%|███▏      | 100/313 [04:47<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0561, Train/loss_unet_all_step=0.0561, Train/loss_triplet_all_step=0.395, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  32%|███▏      | 100/313 [04:47<10:13,  0.35it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  48%|████▊     | 150/313 [07:10<07:47,  0.35it/s, v_num=0, Train/loss_all_step=0.0607, Train/loss_unet_all_step=0.0607, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0607, Train/loss_unet_all_step=0.0607, Train/loss_triplet_all_step=0.417, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  64%|██████▍   | 200/313 [09:31<05:23,  0.35it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.0636, Train/loss_triplet_all_step=0.320, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  80%|███████▉  | 250/313 [11:54<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0636, Train/loss_unet_all_step=0.0636, Train/loss_triplet_all_step=0.320, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  80%|███████▉  | 250/313 [11:54<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0574, Train/loss_unet_all_step=0.0574, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0574, Train/loss_unet_all_step=0.0574, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70:  96%|█████████▌| 300/313 [14:15<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0525, Train/loss_unet_all_step=0.0525, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0525, Train/loss_unet_all_step=0.0525, Train/loss_triplet_all_step=0.434, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0556, Valid/loss_unet_all_step=0.0556, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=0.948, Valid/loss_all_epoch=0.0914, Valid/loss_unet_all_epoch=0.0914, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=0.871, Valid/knn_avr=0.353, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.20it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028839, 0.027590, 0.034743
Valid average loss UNet            (all)              : 0.091172

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.257496, 2.533076, 3.206895
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.896804, 3.078349, 2.624502
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.687934, 2.710779, 2.439975
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.601607, 2.697173, 2.769449
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.523939, 2.804029, 3.454131
Valid average loss all      (Triplet)                 : 0.637021

== Recognize ==
Valid average loss Recognize     : 0.852801
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.091172

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.3324294090271 sec. =
Valid knn accuracy drums     : 66.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.66879391670227 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.87015175819397 sec. =
Valid knn accuracy piano     : 19.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.40581226348877 sec. =
Valid knn accuracy guitar    : 25.811688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.547207832336426 sec. =
Valid knn accuracy residuals : 49.37106918238994%

Valid knn accuracy average   : 35.22287530552249%

                                                                        [AEpoch 70: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.058, Train/loss_unet_all_epoch=0.058, Train/loss_triplet_all_epoch=0.369, Train/loss_recog_epoch=1.390]Epoch 70: 100%|██████████| 313/313 [17:17<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019423, 0.019416, 0.019071
Train average loss UNet            (all)              : 0.057910

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.198145, 1.885475, 2.109576
Train average loss bass     (Triplet, dist_p, dist_n) : 0.507958, 2.115843, 1.924397
Train average loss piano    (Triplet, dist_p, dist_n) : 0.407232, 2.020931, 1.965986
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.369804, 2.030385, 2.018859
Train average loss residuals(Triplet, dist_p, dist_n) : 0.334407, 2.010596, 2.048973
Train average loss all      (Triplet)                 : 0.366447

== Recognize ==
Train average loss Recognize     : 1.391224
Train average accuracy drums     : 93.786667 %
Train average accuracy bass      : 96.279999 %
Train average accuracy piano     : 89.416664 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.576668 %

== Train average loss all : 0.057910

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  16%|█▌        | 50/313 [02:29<13:03,  0.34it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.370, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  16%|█▌        | 50/313 [02:29<13:03,  0.34it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.393, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.393, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0568, Train/loss_unet_all_step=0.0568, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0568, Train/loss_unet_all_step=0.0568, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.404, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.323, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0633, Train/loss_unet_all_step=0.0633, Train/loss_triplet_all_step=0.323, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71:  96%|█████████▌| 300/313 [14:17<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0523, Train/loss_unet_all_step=0.0523, Train/loss_triplet_all_step=0.430, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0523, Train/loss_unet_all_step=0.0523, Train/loss_triplet_all_step=0.430, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71: 100%|██████████| 313/313 [14:50<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0563, Valid/loss_unet_all_step=0.0563, Valid/loss_triplet_all_step=0.608, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.0912, Valid/loss_unet_all_epoch=0.0912, Valid/loss_triplet_all_epoch=0.637, Valid/loss_recog_epoch=0.853, Valid/knn_avr=0.352, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028511, 0.027138, 0.034659
Valid average loss UNet            (all)              : 0.090308

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.236492, 2.375799, 2.978495
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.799684, 2.838355, 2.439655
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.637719, 2.527982, 2.289466
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.523459, 2.489635, 2.586889
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.474904, 2.615635, 3.138076
Valid average loss all      (Triplet)                 : 0.570626

== Recognize ==
Valid average loss Recognize     : 0.904103
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.090308

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.439313888549805 sec. =
Valid knn accuracy drums     : 66.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.978139638900757 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.890128135681152 sec. =
Valid knn accuracy piano     : 19.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.513237714767456 sec. =
Valid knn accuracy guitar    : 26.461038961038962%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.681928157806396 sec. =
Valid knn accuracy residuals : 50.0%

Valid knn accuracy average   : 35.61979495529427%

                                                                        [AEpoch 71: 100%|██████████| 313/313 [17:21<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0579, Train/loss_unet_all_epoch=0.0579, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.390]Epoch 71: 100%|██████████| 313/313 [17:21<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019391, 0.019382, 0.019033
Train average loss UNet            (all)              : 0.057806

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.199352, 1.884414, 2.106815
Train average loss bass     (Triplet, dist_p, dist_n) : 0.507121, 2.113317, 1.922470
Train average loss piano    (Triplet, dist_p, dist_n) : 0.405498, 2.018387, 1.966504
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.369588, 2.028962, 2.016896
Train average loss residuals(Triplet, dist_p, dist_n) : 0.332930, 2.007462, 2.045927
Train average loss all      (Triplet)                 : 0.365924

== Recognize ==
Train average loss Recognize     : 1.395646
Train average accuracy drums     : 93.793335 %
Train average accuracy bass      : 96.240005 %
Train average accuracy piano     : 89.416664 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.379997 %

== Train average loss all : 0.057806

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  16%|█▌        | 50/313 [02:27<12:54,  0.34it/s, v_num=0, Train/loss_all_step=0.0661, Train/loss_unet_all_step=0.0661, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.320, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  16%|█▌        | 50/313 [02:27<12:54,  0.34it/s, v_num=0, Train/loss_all_step=0.056, Train/loss_unet_all_step=0.056, Train/loss_triplet_all_step=0.392, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]  Epoch 72:  32%|███▏      | 100/313 [04:49<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.056, Train/loss_unet_all_step=0.056, Train/loss_triplet_all_step=0.392, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  32%|███▏      | 100/313 [04:49<10:15,  0.35it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.341, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0569, Train/loss_unet_all_step=0.0569, Train/loss_triplet_all_step=0.341, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  48%|████▊     | 150/313 [07:11<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.401, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0604, Train/loss_unet_all_step=0.0604, Train/loss_triplet_all_step=0.401, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  64%|██████▍   | 200/313 [09:35<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.319, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.319, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.052, Train/loss_triplet_all_step=0.428, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]  Epoch 72: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.052, Train/loss_triplet_all_step=0.428, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72: 100%|██████████| 313/313 [14:51<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0552, Valid/loss_unet_all_step=0.0552, Valid/loss_triplet_all_step=0.525, Valid/loss_recog_step=0.977, Valid/loss_all_epoch=0.0903, Valid/loss_unet_all_epoch=0.0903, Valid/loss_triplet_all_epoch=0.571, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028212, 0.026929, 0.034396
Valid average loss UNet            (all)              : 0.089537

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.239979, 2.394399, 3.011537
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.818728, 2.899832, 2.493511
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.631781, 2.547300, 2.304616
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.547405, 2.550963, 2.658115
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.479873, 2.638206, 3.179381
Valid average loss all      (Triplet)                 : 0.580891

== Recognize ==
Valid average loss Recognize     : 0.909985
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.089537

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.565502882003784 sec. =
Valid knn accuracy drums     : 66.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.843079090118408 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.868443012237549 sec. =
Valid knn accuracy piano     : 20.405405405405403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.187014102935791 sec. =
Valid knn accuracy guitar    : 26.2987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.9492769241333 sec. =
Valid knn accuracy residuals : 50.47169811320755%

Valid knn accuracy average   : 35.751508432683096%

                                                                        [AEpoch 72: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0578, Train/loss_unet_all_epoch=0.0578, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 72: 100%|██████████| 313/313 [17:20<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019343, 0.019347, 0.018998
Train average loss UNet            (all)              : 0.057688

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200542, 1.880807, 2.099600
Train average loss bass     (Triplet, dist_p, dist_n) : 0.506739, 2.110850, 1.920123
Train average loss piano    (Triplet, dist_p, dist_n) : 0.406224, 2.013416, 1.959474
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.367837, 2.024653, 2.015321
Train average loss residuals(Triplet, dist_p, dist_n) : 0.333516, 2.002355, 2.039904
Train average loss all      (Triplet)                 : 0.366000

== Recognize ==
Train average loss Recognize     : 1.399555
Train average accuracy drums     : 93.786667 %
Train average accuracy bass      : 96.173332 %
Train average accuracy piano     : 89.233330 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.486664 %

== Train average loss all : 0.057688

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  16%|█▌        | 50/313 [02:25<12:45,  0.34it/s, v_num=0, Train/loss_all_step=0.0659, Train/loss_unet_all_step=0.0659, Train/loss_triplet_all_step=0.365, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  16%|█▌        | 50/313 [02:25<12:45,  0.34it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.392, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  32%|███▏      | 100/313 [04:47<10:12,  0.35it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.392, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  32%|███▏      | 100/313 [04:47<10:12,  0.35it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.0566, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0566, Train/loss_unet_all_step=0.0566, Train/loss_triplet_all_step=0.342, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  48%|████▊     | 150/313 [07:08<07:45,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.401, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.401, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  64%|██████▍   | 200/313 [09:30<05:22,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.325, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  80%|███████▉  | 250/313 [11:51<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.325, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  80%|███████▉  | 250/313 [11:51<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  96%|█████████▌| 300/313 [14:13<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.338, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73:  96%|█████████▌| 300/313 [14:13<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0523, Train/loss_unet_all_step=0.0523, Train/loss_triplet_all_step=0.425, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0523, Train/loss_unet_all_step=0.0523, Train/loss_triplet_all_step=0.425, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73: 100%|██████████| 313/313 [14:47<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.359, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0546, Valid/loss_unet_all_step=0.0546, Valid/loss_triplet_all_step=0.536, Valid/loss_recog_step=0.981, Valid/loss_all_epoch=0.0895, Valid/loss_unet_all_epoch=0.0895, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=0.910, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.21it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028284, 0.027146, 0.034269
Valid average loss UNet            (all)              : 0.089699

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.218429, 2.355430, 2.943978
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.795136, 2.812602, 2.406861
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.596876, 2.473618, 2.271961
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.497329, 2.473187, 2.584793
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.438139, 2.512130, 3.041719
Valid average loss all      (Triplet)                 : 0.548457

== Recognize ==
Valid average loss Recognize     : 0.935426
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.089699

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.004270792007446 sec. =
Valid knn accuracy drums     : 67.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.739020824432373 sec. =
Valid knn accuracy bass      : 16.27906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.137683868408203 sec. =
Valid knn accuracy piano     : 18.513513513513512%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.353065967559814 sec. =
Valid knn accuracy guitar    : 28.40909090909091%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.311238527297974 sec. =
Valid knn accuracy residuals : 49.056603773584904%

Valid knn accuracy average   : 35.92224382802036%

                                                                        [AEpoch 73: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.359, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0577, Train/loss_unet_all_epoch=0.0577, Train/loss_triplet_all_epoch=0.366, Train/loss_recog_epoch=1.400]Epoch 73: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.359, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019320, 0.019337, 0.018983
Train average loss UNet            (all)              : 0.057640

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.199789, 1.876878, 2.092261
Train average loss bass     (Triplet, dist_p, dist_n) : 0.503785, 2.102604, 1.913618
Train average loss piano    (Triplet, dist_p, dist_n) : 0.404348, 2.009093, 1.955153
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.364258, 2.016947, 2.007681
Train average loss residuals(Triplet, dist_p, dist_n) : 0.332647, 1.995012, 2.032335
Train average loss all      (Triplet)                 : 0.363933

== Recognize ==
Train average loss Recognize     : 1.404809
Train average accuracy drums     : 93.779999 %
Train average accuracy bass      : 96.173332 %
Train average accuracy piano     : 89.190002 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.393333 %

== Train average loss all : 0.057640

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.359, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.359, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  16%|█▌        | 50/313 [02:28<13:02,  0.34it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.359, Train/loss_recog_step=1.330, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  16%|█▌        | 50/313 [02:28<13:02,  0.34it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.394, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.394, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  32%|███▏      | 100/313 [04:51<10:21,  0.34it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.411, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0601, Train/loss_unet_all_step=0.0601, Train/loss_triplet_all_step=0.411, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  64%|██████▍   | 200/313 [09:34<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0628, Train/loss_unet_all_step=0.0628, Train/loss_triplet_all_step=0.328, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0628, Train/loss_unet_all_step=0.0628, Train/loss_triplet_all_step=0.328, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  80%|███████▉  | 250/313 [11:56<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0575, Train/loss_unet_all_step=0.0575, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74:  96%|█████████▌| 300/313 [14:18<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.0526, Train/loss_triplet_all_step=0.416, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74: 100%|██████████| 313/313 [14:52<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0526, Train/loss_unet_all_step=0.0526, Train/loss_triplet_all_step=0.416, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74: 100%|██████████| 313/313 [14:52<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0553, Valid/loss_unet_all_step=0.0553, Valid/loss_triplet_all_step=0.530, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.0897, Valid/loss_unet_all_epoch=0.0897, Valid/loss_triplet_all_epoch=0.548, Valid/loss_recog_epoch=0.935, Valid/knn_avr=0.359, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.026975, 0.026151, 0.032397
Valid average loss UNet            (all)              : 0.085523

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.194667, 2.211837, 2.709175
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.683706, 2.585812, 2.248095
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.571152, 2.321832, 2.127983
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.418984, 2.267065, 2.367473
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.383642, 2.392649, 2.742848
Valid average loss all      (Triplet)                 : 0.483918

== Recognize ==
Valid average loss Recognize     : 1.040917
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.085523

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.769774675369263 sec. =
Valid knn accuracy drums     : 68.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.858113765716553 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.892454862594604 sec. =
Valid knn accuracy piano     : 20.81081081081081%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.278003692626953 sec. =
Valid knn accuracy guitar    : 29.545454545454547%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.89422869682312 sec. =
Valid knn accuracy residuals : 47.327044025157235%

Valid knn accuracy average   : 36.29555380514909%

                                                                        [AEpoch 74: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.364, Train/loss_recog_epoch=1.400]Epoch 74: 100%|██████████| 313/313 [17:22<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019282, 0.019297, 0.018944
Train average loss UNet            (all)              : 0.057523

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200056, 1.874869, 2.090351
Train average loss bass     (Triplet, dist_p, dist_n) : 0.502427, 2.095485, 1.905816
Train average loss piano    (Triplet, dist_p, dist_n) : 0.402086, 2.003000, 1.950326
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.362425, 2.010192, 2.000637
Train average loss residuals(Triplet, dist_p, dist_n) : 0.329664, 1.990382, 2.027805
Train average loss all      (Triplet)                 : 0.362326

== Recognize ==
Train average loss Recognize     : 1.408073
Train average accuracy drums     : 93.739998 %
Train average accuracy bass      : 96.096664 %
Train average accuracy piano     : 89.139999 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.146667 %

== Train average loss all : 0.057523

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0658, Train/loss_unet_all_step=0.0658, Train/loss_triplet_all_step=0.369, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  16%|█▌        | 50/313 [02:27<12:58,  0.34it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  32%|███▏      | 100/313 [04:50<10:19,  0.34it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.057, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]  Epoch 75:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.057, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  48%|████▊     | 150/313 [07:12<07:49,  0.35it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.408, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.060, Train/loss_unet_all_step=0.060, Train/loss_triplet_all_step=0.408, Train/loss_recog_step=1.360, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0627, Train/loss_unet_all_step=0.0627, Train/loss_triplet_all_step=0.319, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0627, Train/loss_unet_all_step=0.0627, Train/loss_triplet_all_step=0.319, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  80%|███████▉  | 250/313 [11:55<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.340, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75:  96%|█████████▌| 300/313 [14:14<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.0524, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.0524, Train/loss_triplet_all_step=0.413, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75: 100%|██████████| 313/313 [14:48<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0533, Valid/loss_unet_all_step=0.0533, Valid/loss_triplet_all_step=0.497, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.0855, Valid/loss_unet_all_epoch=0.0855, Valid/loss_triplet_all_epoch=0.484, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:10<00:00,  1.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:07<00:00,  1.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.028207, 0.026943, 0.033767
Valid average loss UNet            (all)              : 0.088917

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.219212, 2.377504, 3.015231
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.794087, 2.849285, 2.446298
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.652751, 2.525146, 2.293355
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.517128, 2.487925, 2.594896
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.464223, 2.575001, 3.116901
Valid average loss all      (Triplet)                 : 0.565030

== Recognize ==
Valid average loss Recognize     : 0.930932
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.088917

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.468618392944336 sec. =
Valid knn accuracy drums     : 65.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.147462844848633 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.850839376449585 sec. =
Valid knn accuracy piano     : 19.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.53863525390625 sec. =
Valid knn accuracy guitar    : 28.246753246753247%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.680636405944824 sec. =
Valid knn accuracy residuals : 48.58490566037736%

Valid knn accuracy average   : 35.51233688365558%

                                                                        [AEpoch 75: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0575, Train/loss_unet_all_epoch=0.0575, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 75: 100%|██████████| 313/313 [17:18<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019294, 0.019300, 0.018961
Train average loss UNet            (all)              : 0.057555

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200068, 1.870090, 2.082903
Train average loss bass     (Triplet, dist_p, dist_n) : 0.500960, 2.092941, 1.905220
Train average loss piano    (Triplet, dist_p, dist_n) : 0.401474, 1.999706, 1.947030
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.359651, 2.002112, 1.993559
Train average loss residuals(Triplet, dist_p, dist_n) : 0.330810, 1.987665, 2.024343
Train average loss all      (Triplet)                 : 0.361737

== Recognize ==
Train average loss Recognize     : 1.411395
Train average accuracy drums     : 93.720001 %
Train average accuracy bass      : 95.990005 %
Train average accuracy piano     : 88.988335 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.259995 %

== Train average loss all : 0.057555

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  16%|█▌        | 50/313 [02:26<12:53,  0.34it/s, v_num=0, Train/loss_all_step=0.0653, Train/loss_unet_all_step=0.0653, Train/loss_triplet_all_step=0.363, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  16%|█▌        | 50/313 [02:26<12:53,  0.34it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.390, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  32%|███▏      | 100/313 [04:46<10:10,  0.35it/s, v_num=0, Train/loss_all_step=0.0565, Train/loss_unet_all_step=0.0565, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0565, Train/loss_unet_all_step=0.0565, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=1.410, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  48%|████▊     | 150/313 [07:07<07:44,  0.35it/s, v_num=0, Train/loss_all_step=0.0602, Train/loss_unet_all_step=0.0602, Train/loss_triplet_all_step=0.393, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.0602, Train/loss_unet_all_step=0.0602, Train/loss_triplet_all_step=0.393, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  64%|██████▍   | 200/313 [09:28<05:21,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.324, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]  Epoch 76:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.324, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  80%|███████▉  | 250/313 [11:50<02:59,  0.35it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.333, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.333, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76:  96%|█████████▌| 300/313 [14:10<00:36,  0.35it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.0524, Train/loss_triplet_all_step=0.410, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0524, Train/loss_unet_all_step=0.0524, Train/loss_triplet_all_step=0.410, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]Epoch 76: 100%|██████████| 313/313 [14:44<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0541, Valid/loss_unet_all_step=0.0541, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.000, Valid/loss_all_epoch=0.0889, Valid/loss_unet_all_epoch=0.0889, Valid/loss_triplet_all_epoch=0.565, Valid/loss_recog_epoch=0.931, Valid/knn_avr=0.355, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:04<00:00,  0.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.027724, 0.026644, 0.033583
Valid average loss UNet            (all)              : 0.087951

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.211594, 2.266058, 2.815904
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.730133, 2.656928, 2.295583
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.581036, 2.363815, 2.160007
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.459269, 2.322939, 2.437913
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.418674, 2.446668, 2.853461
Valid average loss all      (Triplet)                 : 0.513026

== Recognize ==
Valid average loss Recognize     : 0.995950
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.087951

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.84457278251648 sec. =
Valid knn accuracy drums     : 65.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.826562404632568 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.845718383789062 sec. =
Valid knn accuracy piano     : 20.675675675675677%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.147729873657227 sec. =
Valid knn accuracy guitar    : 29.545454545454547%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.933966636657715 sec. =
Valid knn accuracy residuals : 47.327044025157235%

Valid knn accuracy average   : 35.70936125144627%

                                                                        [AEpoch 76: 100%|██████████| 313/313 [17:15<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0576, Train/loss_unet_all_epoch=0.0576, Train/loss_triplet_all_epoch=0.362, Train/loss_recog_epoch=1.410]  Epoch 76: 100%|██████████| 313/313 [17:15<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019262, 0.019266, 0.018915
Train average loss UNet            (all)              : 0.057444

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.198224, 1.866144, 2.077464
Train average loss bass     (Triplet, dist_p, dist_n) : 0.497968, 2.087339, 1.900373
Train average loss piano    (Triplet, dist_p, dist_n) : 0.398351, 1.996928, 1.945469
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.358715, 1.999954, 1.991092
Train average loss residuals(Triplet, dist_p, dist_n) : 0.329356, 1.984364, 2.021784
Train average loss all      (Triplet)                 : 0.359665

== Recognize ==
Train average loss Recognize     : 1.415595
Train average accuracy drums     : 93.695000 %
Train average accuracy bass      : 95.959999 %
Train average accuracy piano     : 88.736664 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.233337 %

== Train average loss all : 0.057444

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  16%|█▌        | 50/313 [02:28<13:02,  0.34it/s, v_num=0, Train/loss_all_step=0.0655, Train/loss_unet_all_step=0.0655, Train/loss_triplet_all_step=0.368, Train/loss_recog_step=1.340, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  16%|█▌        | 50/313 [02:28<13:02,  0.34it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.395, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.395, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  32%|███▏      | 100/313 [04:50<10:18,  0.34it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.336, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0564, Train/loss_unet_all_step=0.0564, Train/loss_triplet_all_step=0.336, Train/loss_recog_step=1.420, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  48%|████▊     | 150/313 [07:12<07:50,  0.35it/s, v_num=0, Train/loss_all_step=0.0595, Train/loss_unet_all_step=0.0595, Train/loss_triplet_all_step=0.391, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0595, Train/loss_unet_all_step=0.0595, Train/loss_triplet_all_step=0.391, Train/loss_recog_step=1.370, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  64%|██████▍   | 200/313 [09:33<05:24,  0.35it/s, v_num=0, Train/loss_all_step=0.0626, Train/loss_unet_all_step=0.0626, Train/loss_triplet_all_step=0.316, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  80%|███████▉  | 250/313 [11:58<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0626, Train/loss_unet_all_step=0.0626, Train/loss_triplet_all_step=0.316, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  80%|███████▉  | 250/313 [11:58<03:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0572, Train/loss_unet_all_step=0.0572, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0572, Train/loss_unet_all_step=0.0572, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77:  96%|█████████▌| 300/313 [14:23<00:37,  0.35it/s, v_num=0, Train/loss_all_step=0.0522, Train/loss_unet_all_step=0.0522, Train/loss_triplet_all_step=0.411, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0522, Train/loss_unet_all_step=0.0522, Train/loss_triplet_all_step=0.411, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77: 100%|██████████| 313/313 [14:56<00:00,  0.35it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0535, Valid/loss_unet_all_step=0.0535, Valid/loss_triplet_all_step=0.485, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.088, Valid/loss_unet_all_epoch=0.088, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.00it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:08<00:00,  1.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.024439, 0.023924, 0.029093
Valid average loss UNet            (all)              : 0.077456

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.174180, 2.064448, 2.459675
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.562871, 2.315832, 2.064934
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.507603, 2.123690, 1.986386
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337638, 2.056660, 2.154619
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334749, 2.227272, 2.395790
Valid average loss all      (Triplet)                 : 0.410830

== Recognize ==
Valid average loss Recognize     : 1.195864
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.077456

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.615425825119019 sec. =
Valid knn accuracy drums     : 69.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.745329141616821 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.585850954055786 sec. =
Valid knn accuracy piano     : 21.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.28516936302185 sec. =
Valid knn accuracy guitar    : 30.357142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.848145484924316 sec. =
Valid knn accuracy residuals : 48.270440251572325%

Valid knn accuracy average   : 36.608997229573845%

                                                                        [AEpoch 77: 100%|██████████| 313/313 [17:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.350, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.360, Train/loss_recog_epoch=1.420]Epoch 77: 100%|██████████| 313/313 [17:28<00:00,  0.30it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.350, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019240, 0.019243, 0.018906
Train average loss UNet            (all)              : 0.057390

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.198921, 1.863157, 2.073163
Train average loss bass     (Triplet, dist_p, dist_n) : 0.495961, 2.081234, 1.896158
Train average loss piano    (Triplet, dist_p, dist_n) : 0.396240, 1.991418, 1.941943
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.356702, 1.994445, 1.986460
Train average loss residuals(Triplet, dist_p, dist_n) : 0.327386, 1.978786, 2.015619
Train average loss all      (Triplet)                 : 0.358035

== Recognize ==
Train average loss Recognize     : 1.419601
Train average accuracy drums     : 93.620003 %
Train average accuracy bass      : 95.766670 %
Train average accuracy piano     : 88.706665 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.101669 %

== Train average loss all : 0.057390

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.350, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.350, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  16%|█▌        | 50/313 [02:31<13:15,  0.33it/s, v_num=0, Train/loss_all_step=0.0652, Train/loss_unet_all_step=0.0652, Train/loss_triplet_all_step=0.371, Train/loss_recog_step=1.350, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  16%|█▌        | 50/313 [02:31<13:15,  0.33it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=1.430, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  32%|███▏      | 100/313 [04:56<10:31,  0.34it/s, v_num=0, Train/loss_all_step=0.0558, Train/loss_unet_all_step=0.0558, Train/loss_triplet_all_step=0.387, Train/loss_recog_step=1.430, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  32%|███▏      | 100/313 [04:56<10:31,  0.34it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=1.430, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  48%|████▊     | 150/313 [07:21<08:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.0559, Train/loss_triplet_all_step=0.334, Train/loss_recog_step=1.430, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  48%|████▊     | 150/313 [07:21<08:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.370, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  64%|██████▍   | 200/313 [09:46<05:31,  0.34it/s, v_num=0, Train/loss_all_step=0.0599, Train/loss_unet_all_step=0.0599, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.370, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  64%|██████▍   | 200/313 [09:46<05:31,  0.34it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.317, Train/loss_recog_step=1.430, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]  Epoch 78:  80%|███████▉  | 250/313 [12:11<03:04,  0.34it/s, v_num=0, Train/loss_all_step=0.063, Train/loss_unet_all_step=0.063, Train/loss_triplet_all_step=0.317, Train/loss_recog_step=1.430, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  80%|███████▉  | 250/313 [12:11<03:04,  0.34it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.390, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  96%|█████████▌| 300/313 [14:36<00:37,  0.34it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.390, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78:  96%|█████████▌| 300/313 [14:36<00:37,  0.34it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.052, Train/loss_triplet_all_step=0.407, Train/loss_recog_step=1.440, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]  Epoch 78: 100%|██████████| 313/313 [15:10<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.052, Train/loss_triplet_all_step=0.407, Train/loss_recog_step=1.440, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78: 100%|██████████| 313/313 [15:10<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.0657, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.350, Valid/loss_all_step=0.051, Valid/loss_unet_all_step=0.051, Valid/loss_triplet_all_step=0.430, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.0775, Valid/loss_unet_all_epoch=0.0775, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:08<00:00,  1.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:08<00:00,  1.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023676, 0.023413, 0.028512
Valid average loss UNet            (all)              : 0.075600

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.171002, 2.039636, 2.432939
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.595863, 2.332430, 2.046343
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.493306, 2.096350, 1.971656
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.337518, 2.042090, 2.140607
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334304, 2.175944, 2.407957
Valid average loss all      (Triplet)                 : 0.419331

== Recognize ==
Valid average loss Recognize     : 1.228714
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.075600

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.41570520401001 sec. =
Valid knn accuracy drums     : 69.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.685476779937744 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.112760543823242 sec. =
Valid knn accuracy piano     : 23.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.262385129928589 sec. =
Valid knn accuracy guitar    : 28.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.47292184829712 sec. =
Valid knn accuracy residuals : 48.89937106918239%

Valid knn accuracy average   : 36.817559935516734%

                                                                        [AEpoch 78: 100%|██████████| 313/313 [17:42<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.0657, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 78: 100%|██████████| 313/313 [17:42<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.0657, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019234, 0.019234, 0.018893
Train average loss UNet            (all)              : 0.057361

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.198387, 1.859494, 2.070004
Train average loss bass     (Triplet, dist_p, dist_n) : 0.493891, 2.076215, 1.892099
Train average loss piano    (Triplet, dist_p, dist_n) : 0.397493, 1.989725, 1.937271
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.357099, 1.990682, 1.981721
Train average loss residuals(Triplet, dist_p, dist_n) : 0.326780, 1.974639, 2.011960
Train average loss all      (Triplet)                 : 0.357653

== Recognize ==
Train average loss Recognize     : 1.423103
Train average accuracy drums     : 93.519997 %
Train average accuracy bass      : 95.720001 %
Train average accuracy piano     : 88.386665 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 91.896667 %

== Train average loss all : 0.057361

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.0657, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.0657, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  16%|█▌        | 50/313 [02:32<13:24,  0.33it/s, v_num=0, Train/loss_all_step=0.0657, Train/loss_unet_all_step=0.0657, Train/loss_triplet_all_step=0.361, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  16%|█▌        | 50/313 [02:32<13:24,  0.33it/s, v_num=0, Train/loss_all_step=0.0555, Train/loss_unet_all_step=0.0555, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  32%|███▏      | 100/313 [05:00<10:39,  0.33it/s, v_num=0, Train/loss_all_step=0.0555, Train/loss_unet_all_step=0.0555, Train/loss_triplet_all_step=0.386, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  32%|███▏      | 100/313 [05:00<10:39,  0.33it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.326, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  48%|████▊     | 150/313 [07:27<08:06,  0.34it/s, v_num=0, Train/loss_all_step=0.0567, Train/loss_unet_all_step=0.0567, Train/loss_triplet_all_step=0.326, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  48%|████▊     | 150/313 [07:27<08:06,  0.34it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  64%|██████▍   | 200/313 [09:54<05:35,  0.34it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.0596, Train/loss_triplet_all_step=0.402, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  64%|██████▍   | 200/313 [09:54<05:35,  0.34it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  80%|███████▉  | 250/313 [12:20<03:06,  0.34it/s, v_num=0, Train/loss_all_step=0.0629, Train/loss_unet_all_step=0.0629, Train/loss_triplet_all_step=0.318, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  80%|███████▉  | 250/313 [12:20<03:06,  0.34it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  96%|█████████▌| 300/313 [14:45<00:38,  0.34it/s, v_num=0, Train/loss_all_step=0.0571, Train/loss_unet_all_step=0.0571, Train/loss_triplet_all_step=0.337, Train/loss_recog_step=1.390, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79:  96%|█████████▌| 300/313 [14:45<00:38,  0.34it/s, v_num=0, Train/loss_all_step=0.0523, Train/loss_unet_all_step=0.0523, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79: 100%|██████████| 313/313 [15:19<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0523, Train/loss_unet_all_step=0.0523, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79: 100%|██████████| 313/313 [15:19<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0498, Valid/loss_unet_all_step=0.0498, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.0756, Valid/loss_unet_all_epoch=0.0756, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=1.230, Valid/knn_avr=0.368, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:09<00:00,  1.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:09<00:00,  1.15it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:09<00:00,  1.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:07<00:00,  1.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:08<00:00,  1.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.023012, 0.022888, 0.027172
Valid average loss UNet            (all)              : 0.073072

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.157165, 1.980367, 2.348014
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.570703, 2.262299, 1.982903
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.486649, 2.062274, 1.944230
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.315224, 1.983502, 2.063850
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.307065, 2.134874, 2.313104
Valid average loss all      (Triplet)                 : 0.400456

== Recognize ==
Valid average loss Recognize     : 1.283961
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.073072

= T-SNE...
T-SNE was finished!
= T-SNE time is 13.57753038406372 sec. =
Valid knn accuracy drums     : 67.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.40197467803955 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.747642278671265 sec. =
Valid knn accuracy piano     : 22.702702702702705%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.172403573989868 sec. =
Valid knn accuracy guitar    : 29.707792207792206%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.973853826522827 sec. =
Valid knn accuracy residuals : 49.685534591194966%

Valid knn accuracy average   : 37.117564313470666%

                                                                        [AEpoch 79: 100%|██████████| 313/313 [17:49<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0574, Train/loss_unet_all_epoch=0.0574, Train/loss_triplet_all_epoch=0.358, Train/loss_recog_epoch=1.420]Epoch 79: 100%|██████████| 313/313 [17:49<00:00,  0.29it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.019214, 0.019210, 0.018873
Train average loss UNet            (all)              : 0.057297

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.198957, 1.858298, 2.065227
Train average loss bass     (Triplet, dist_p, dist_n) : 0.491367, 2.070593, 1.886818
Train average loss piano    (Triplet, dist_p, dist_n) : 0.395085, 1.986088, 1.935037
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.354250, 1.985235, 1.977010
Train average loss residuals(Triplet, dist_p, dist_n) : 0.326312, 1.970931, 2.006479
Train average loss all      (Triplet)                 : 0.356034

== Recognize ==
Train average loss Recognize     : 1.425996
Train average accuracy drums     : 93.493332 %
Train average accuracy bass      : 95.426666 %
Train average accuracy piano     : 88.283333 %
Train average accuracy guitar    : 88.980003 %
Train average accuracy residuals : 91.986671 %

== Train average loss all : 0.057297

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  16%|█▌        | 50/313 [02:33<13:25,  0.33it/s, v_num=0, Train/loss_all_step=0.0656, Train/loss_unet_all_step=0.0656, Train/loss_triplet_all_step=0.347, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  16%|█▌        | 50/313 [02:33<13:25,  0.33it/s, v_num=0, Train/loss_all_step=0.0557, Train/loss_unet_all_step=0.0557, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  32%|███▏      | 100/313 [04:59<10:37,  0.33it/s, v_num=0, Train/loss_all_step=0.0557, Train/loss_unet_all_step=0.0557, Train/loss_triplet_all_step=0.374, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  32%|███▏      | 100/313 [04:59<10:37,  0.33it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.0556, Train/loss_triplet_all_step=0.333, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  48%|████▊     | 150/313 [07:26<08:05,  0.34it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.0556, Train/loss_triplet_all_step=0.333, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  48%|████▊     | 150/313 [07:26<08:05,  0.34it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  64%|██████▍   | 200/313 [09:52<05:34,  0.34it/s, v_num=0, Train/loss_all_step=0.0593, Train/loss_unet_all_step=0.0593, Train/loss_triplet_all_step=0.403, Train/loss_recog_step=1.380, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  64%|██████▍   | 200/313 [09:52<05:34,  0.34it/s, v_num=0, Train/loss_all_step=0.0622, Train/loss_unet_all_step=0.0622, Train/loss_triplet_all_step=0.313, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  80%|███████▉  | 250/313 [12:19<03:06,  0.34it/s, v_num=0, Train/loss_all_step=0.0622, Train/loss_unet_all_step=0.0622, Train/loss_triplet_all_step=0.313, Train/loss_recog_step=1.430, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  80%|███████▉  | 250/313 [12:19<03:06,  0.34it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  96%|█████████▌| 300/313 [14:45<00:38,  0.34it/s, v_num=0, Train/loss_all_step=0.0573, Train/loss_unet_all_step=0.0573, Train/loss_triplet_all_step=0.335, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80:  96%|█████████▌| 300/313 [14:45<00:38,  0.34it/s, v_num=0, Train/loss_all_step=0.0521, Train/loss_unet_all_step=0.0521, Train/loss_triplet_all_step=0.400, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80: 100%|██████████| 313/313 [15:19<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0521, Train/loss_unet_all_step=0.0521, Train/loss_triplet_all_step=0.400, Train/loss_recog_step=1.440, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]Epoch 80: 100%|██████████| 313/313 [15:19<00:00,  0.34it/s, v_num=0, Train/loss_all_step=0.0654, Train/loss_unet_all_step=0.0654, Train/loss_triplet_all_step=0.351, Train/loss_recog_step=1.350, Valid/loss_all_step=0.0516, Valid/loss_unet_all_step=0.0516, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.0731, Valid/loss_unet_all_epoch=0.0731, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=1.280, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0573, Train/loss_unet_all_epoch=0.0573, Train/loss_triplet_all_epoch=0.356, Train/loss_recog_epoch=1.430]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:03<00:00,  1.05it/s][A