/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/utilities/parsing.py:198: Attribute 'net' is an instance of `nn.Module` and is already saved during checkpointing. It is recommended to ignore them using `self.save_hyperparameters(ignore=['net'])`.
/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/lightning_fabric/connector.py:565: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:191: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 ./train.py experiment=pretrain task_name=pretrain ...
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name            | Type                          | Params
------------------------------------------------------------------
0 | net             | UNetForTriplet_2d_de5_to1d640 | 38.6 M
1 | loss_triplet    | MarginRankingLoss             | 0     
2 | loss_mse        | MSELoss                       | 0     
3 | train_loss_mix  | MeanMetric                    | 0     
4 | train_loss_inst | MeanMetric                    | 0     
------------------------------------------------------------------
38.6 M    Trainable params
0         Non-trainable params
38.6 M    Total params
154.432   Total estimated model params size (MB)
Metric val/knn_avr improved. New best score: 0.254
Epoch 0, global step 507: 'val/knn_avr' reached 0.25381 (best 0.25381), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_000.ckpt' as top 1
Epoch 1, global step 1014: 'val/knn_avr' reached 0.22513 (best 0.25381), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_001.ckpt' as top 2
Epoch 2, global step 1521: 'val/knn_avr' reached 0.24045 (best 0.25381), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_002.ckpt' as top 3
Metric val/knn_avr improved by 0.022 >= min_delta = 0.0. New best score: 0.276
Epoch 3, global step 2028: 'val/knn_avr' reached 0.27587 (best 0.27587), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_003.ckpt' as top 4
Metric val/knn_avr improved by 0.059 >= min_delta = 0.0. New best score: 0.334
Epoch 4, global step 2535: 'val/knn_avr' reached 0.33441 (best 0.33441), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_004.ckpt' as top 5
Metric val/knn_avr improved by 0.069 >= min_delta = 0.0. New best score: 0.403
Epoch 5, global step 3042: 'val/knn_avr' reached 0.40297 (best 0.40297), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_005.ckpt' as top 6
Metric val/knn_avr improved by 0.039 >= min_delta = 0.0. New best score: 0.442
Epoch 6, global step 3549: 'val/knn_avr' reached 0.44241 (best 0.44241), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_006.ckpt' as top 7
Metric val/knn_avr improved by 0.026 >= min_delta = 0.0. New best score: 0.468
Epoch 7, global step 4056: 'val/knn_avr' reached 0.46817 (best 0.46817), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_007.ckpt' as top 8
Metric val/knn_avr improved by 0.015 >= min_delta = 0.0. New best score: 0.483
Epoch 8, global step 4563: 'val/knn_avr' reached 0.48337 (best 0.48337), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_008.ckpt' as top 9
Metric val/knn_avr improved by 0.014 >= min_delta = 0.0. New best score: 0.497
Epoch 9, global step 5070: 'val/knn_avr' reached 0.49736 (best 0.49736), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_009.ckpt' as top 10
Metric val/knn_avr improved by 0.004 >= min_delta = 0.0. New best score: 0.502
Epoch 10, global step 5577: 'val/knn_avr' reached 0.50178 (best 0.50178), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_010.ckpt' as top 11
Epoch 11, global step 6084: 'val/knn_avr' reached 0.49660 (best 0.50178), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_011.ckpt' as top 12
Epoch 12, global step 6591: 'val/knn_avr' reached 0.50007 (best 0.50178), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_012.ckpt' as top 13
Epoch 13, global step 7098: 'val/knn_avr' reached 0.49540 (best 0.50178), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_013.ckpt' as top 14
Metric val/knn_avr improved by 0.015 >= min_delta = 0.0. New best score: 0.516
Epoch 14, global step 7605: 'val/knn_avr' reached 0.51637 (best 0.51637), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_014.ckpt' as top 15
Epoch 15, global step 8112: 'val/knn_avr' reached 0.49424 (best 0.51637), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_015.ckpt' as top 16
Epoch 16, global step 8619: 'val/knn_avr' reached 0.51301 (best 0.51637), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_016.ckpt' as top 17
Metric val/knn_avr improved by 0.005 >= min_delta = 0.0. New best score: 0.521
Epoch 17, global step 9126: 'val/knn_avr' reached 0.52121 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_017.ckpt' as top 18
Epoch 18, global step 9633: 'val/knn_avr' reached 0.51404 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_018.ckpt' as top 19
Epoch 19, global step 10140: 'val/knn_avr' reached 0.49512 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_019.ckpt' as top 20
Epoch 20, global step 10647: 'val/knn_avr' reached 0.49299 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_020.ckpt' as top 21
Epoch 21, global step 11154: 'val/knn_avr' reached 0.50509 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_021.ckpt' as top 22
Epoch 22, global step 11661: 'val/knn_avr' reached 0.50522 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_022.ckpt' as top 23
Epoch 23, global step 12168: 'val/knn_avr' reached 0.49390 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_023.ckpt' as top 24
Epoch 24, global step 12675: 'val/knn_avr' reached 0.50528 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_024.ckpt' as top 25
Epoch 25, global step 13182: 'val/knn_avr' reached 0.50305 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_025.ckpt' as top 26
Epoch 26, global step 13689: 'val/knn_avr' reached 0.50585 (best 0.52121), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_026.ckpt' as top 27
Metric val/knn_avr improved by 0.006 >= min_delta = 0.0. New best score: 0.527
Epoch 27, global step 14196: 'val/knn_avr' reached 0.52735 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_027.ckpt' as top 28
Epoch 28, global step 14703: 'val/knn_avr' reached 0.52319 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_028.ckpt' as top 29
Epoch 29, global step 15210: 'val/knn_avr' reached 0.50553 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_029.ckpt' as top 30
Epoch 30, global step 15717: 'val/knn_avr' reached 0.51266 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_030.ckpt' as top 31
Epoch 31, global step 16224: 'val/knn_avr' reached 0.49484 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_031.ckpt' as top 32
Epoch 32, global step 16731: 'val/knn_avr' reached 0.49180 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_032.ckpt' as top 33
Epoch 33, global step 17238: 'val/knn_avr' reached 0.47956 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_033.ckpt' as top 34
Epoch 34, global step 17745: 'val/knn_avr' reached 0.48818 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_034.ckpt' as top 35
Epoch 35, global step 18252: 'val/knn_avr' reached 0.49617 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_035.ckpt' as top 36
Epoch 36, global step 18759: 'val/knn_avr' reached 0.50779 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_036.ckpt' as top 37
Epoch 37, global step 19266: 'val/knn_avr' reached 0.48531 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_037.ckpt' as top 38
Epoch 38, global step 19773: 'val/knn_avr' reached 0.49078 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_038.ckpt' as top 39
Epoch 39, global step 20280: 'val/knn_avr' reached 0.49102 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_039.ckpt' as top 40
Epoch 40, global step 20787: 'val/knn_avr' reached 0.49890 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_040.ckpt' as top 41
Epoch 41, global step 21294: 'val/knn_avr' reached 0.49687 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_041.ckpt' as top 42
Epoch 42, global step 21801: 'val/knn_avr' reached 0.50436 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_042.ckpt' as top 43
Epoch 43, global step 22308: 'val/knn_avr' reached 0.49991 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_043.ckpt' as top 44
Epoch 44, global step 22815: 'val/knn_avr' reached 0.51347 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_044.ckpt' as top 45
Epoch 45, global step 23322: 'val/knn_avr' reached 0.50736 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_045.ckpt' as top 46
Epoch 46, global step 23829: 'val/knn_avr' reached 0.48434 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_046.ckpt' as top 47
Epoch 47, global step 24336: 'val/knn_avr' reached 0.51356 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_047.ckpt' as top 48
Epoch 48, global step 24843: 'val/knn_avr' reached 0.50070 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_048.ckpt' as top 49
Epoch 49, global step 25350: 'val/knn_avr' reached 0.50085 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_049.ckpt' as top 50
Epoch 50, global step 25857: 'val/knn_avr' reached 0.51232 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_050.ckpt' as top 51
Epoch 51, global step 26364: 'val/knn_avr' reached 0.49479 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_051.ckpt' as top 52
Epoch 52, global step 26871: 'val/knn_avr' reached 0.49490 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_052.ckpt' as top 53
Epoch 53, global step 27378: 'val/knn_avr' reached 0.50031 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_053.ckpt' as top 54
Epoch 54, global step 27885: 'val/knn_avr' reached 0.49260 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_054.ckpt' as top 55
Epoch 55, global step 28392: 'val/knn_avr' reached 0.48191 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_055.ckpt' as top 56
Epoch 56, global step 28899: 'val/knn_avr' reached 0.50525 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_056.ckpt' as top 57
Epoch 57, global step 29406: 'val/knn_avr' reached 0.49924 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_057.ckpt' as top 58
Epoch 58, global step 29913: 'val/knn_avr' reached 0.49052 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_058.ckpt' as top 59
Epoch 59, global step 30420: 'val/knn_avr' reached 0.49199 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_059.ckpt' as top 60
Epoch 60, global step 30927: 'val/knn_avr' reached 0.50706 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_060.ckpt' as top 61
Epoch 61, global step 31434: 'val/knn_avr' reached 0.48028 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_061.ckpt' as top 62
Epoch 62, global step 31941: 'val/knn_avr' reached 0.49226 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_062.ckpt' as top 63
Epoch 63, global step 32448: 'val/knn_avr' reached 0.50045 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_063.ckpt' as top 64
Epoch 64, global step 32955: 'val/knn_avr' reached 0.50048 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_064.ckpt' as top 65
Epoch 65, global step 33462: 'val/knn_avr' reached 0.49702 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_065.ckpt' as top 66
Epoch 66, global step 33969: 'val/knn_avr' reached 0.50129 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_066.ckpt' as top 67
Epoch 67, global step 34476: 'val/knn_avr' reached 0.50037 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_067.ckpt' as top 68
Epoch 68, global step 34983: 'val/knn_avr' reached 0.49805 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_068.ckpt' as top 69
Epoch 69, global step 35490: 'val/knn_avr' reached 0.49907 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_069.ckpt' as top 70
Epoch 70, global step 35997: 'val/knn_avr' reached 0.49173 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_070.ckpt' as top 71
Epoch 71, global step 36504: 'val/knn_avr' reached 0.48987 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_071.ckpt' as top 72
Epoch 72, global step 37011: 'val/knn_avr' reached 0.50412 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_072.ckpt' as top 73
Epoch 73, global step 37518: 'val/knn_avr' reached 0.50378 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_073.ckpt' as top 74
Epoch 74, global step 38025: 'val/knn_avr' reached 0.48963 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_074.ckpt' as top 75
Epoch 75, global step 38532: 'val/knn_avr' reached 0.49542 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_075.ckpt' as top 76
Epoch 76, global step 39039: 'val/knn_avr' reached 0.50123 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_076.ckpt' as top 77
Epoch 77, global step 39546: 'val/knn_avr' reached 0.49266 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_077.ckpt' as top 78
Epoch 78, global step 40053: 'val/knn_avr' reached 0.50617 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_078.ckpt' as top 79
Epoch 79, global step 40560: 'val/knn_avr' reached 0.49497 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_079.ckpt' as top 80
Epoch 80, global step 41067: 'val/knn_avr' reached 0.50336 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_080.ckpt' as top 81
Epoch 81, global step 41574: 'val/knn_avr' reached 0.48782 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_081.ckpt' as top 82
Epoch 82, global step 42081: 'val/knn_avr' reached 0.50157 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_082.ckpt' as top 83
Epoch 83, global step 42588: 'val/knn_avr' reached 0.49510 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_083.ckpt' as top 84
Epoch 84, global step 43095: 'val/knn_avr' reached 0.48789 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_084.ckpt' as top 85
Epoch 85, global step 43602: 'val/knn_avr' reached 0.49135 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_085.ckpt' as top 86
Epoch 86, global step 44109: 'val/knn_avr' reached 0.49420 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_086.ckpt' as top 87
Epoch 87, global step 44616: 'val/knn_avr' reached 0.49408 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_087.ckpt' as top 88
Epoch 88, global step 45123: 'val/knn_avr' reached 0.48985 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_088.ckpt' as top 89
Epoch 89, global step 45630: 'val/knn_avr' reached 0.48454 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_089.ckpt' as top 90
Epoch 90, global step 46137: 'val/knn_avr' reached 0.48302 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_090.ckpt' as top 91
Epoch 91, global step 46644: 'val/knn_avr' reached 0.48721 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_091.ckpt' as top 92
Epoch 92, global step 47151: 'val/knn_avr' reached 0.48349 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_092.ckpt' as top 93
Epoch 93, global step 47658: 'val/knn_avr' reached 0.48749 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_093.ckpt' as top 94
Epoch 94, global step 48165: 'val/knn_avr' reached 0.49060 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_094.ckpt' as top 95
Epoch 95, global step 48672: 'val/knn_avr' reached 0.49083 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_095.ckpt' as top 96
Epoch 96, global step 49179: 'val/knn_avr' reached 0.48834 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_096.ckpt' as top 97
Epoch 97, global step 49686: 'val/knn_avr' reached 0.48921 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_097.ckpt' as top 98
Epoch 98, global step 50193: 'val/knn_avr' reached 0.49036 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_098.ckpt' as top 99
Epoch 99, global step 50700: 'val/knn_avr' reached 0.48502 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_099.ckpt' as top 100
Epoch 100, global step 51207: 'val/knn_avr' reached 0.49225 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_100.ckpt' as top 101
Epoch 101, global step 51714: 'val/knn_avr' reached 0.48572 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_101.ckpt' as top 102
Epoch 102, global step 52221: 'val/knn_avr' reached 0.49715 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_102.ckpt' as top 103
Epoch 103, global step 52728: 'val/knn_avr' reached 0.48031 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_103.ckpt' as top 104
Epoch 104, global step 53235: 'val/knn_avr' reached 0.48422 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_104.ckpt' as top 105
Epoch 105, global step 53742: 'val/knn_avr' reached 0.48696 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_105.ckpt' as top 106
Epoch 106, global step 54249: 'val/knn_avr' reached 0.47610 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_106.ckpt' as top 107
Epoch 107, global step 54756: 'val/knn_avr' reached 0.48322 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_107.ckpt' as top 108
Epoch 108, global step 55263: 'val/knn_avr' reached 0.47820 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_108.ckpt' as top 109
Epoch 109, global step 55770: 'val/knn_avr' reached 0.48861 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_109.ckpt' as top 110
Epoch 110, global step 56277: 'val/knn_avr' reached 0.48602 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_110.ckpt' as top 111
Epoch 111, global step 56784: 'val/knn_avr' reached 0.48776 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_111.ckpt' as top 112
Epoch 112, global step 57291: 'val/knn_avr' reached 0.48695 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_112.ckpt' as top 113
Epoch 113, global step 57798: 'val/knn_avr' reached 0.49172 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_113.ckpt' as top 114
Epoch 114, global step 58305: 'val/knn_avr' reached 0.48918 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_114.ckpt' as top 115
Epoch 115, global step 58812: 'val/knn_avr' reached 0.49714 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_115.ckpt' as top 116
Epoch 116, global step 59319: 'val/knn_avr' reached 0.49697 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_116.ckpt' as top 117
Epoch 117, global step 59826: 'val/knn_avr' reached 0.49828 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_117.ckpt' as top 118
Epoch 118, global step 60333: 'val/knn_avr' reached 0.49707 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_118.ckpt' as top 119
Epoch 119, global step 60840: 'val/knn_avr' reached 0.49137 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_119.ckpt' as top 120
Epoch 120, global step 61347: 'val/knn_avr' reached 0.49390 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_120.ckpt' as top 121
Epoch 121, global step 61854: 'val/knn_avr' reached 0.49801 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_121.ckpt' as top 122
Epoch 122, global step 62361: 'val/knn_avr' reached 0.49431 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_122.ckpt' as top 123
Epoch 123, global step 62868: 'val/knn_avr' reached 0.49398 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_123.ckpt' as top 124
Epoch 124, global step 63375: 'val/knn_avr' reached 0.48884 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_124.ckpt' as top 125
Epoch 125, global step 63882: 'val/knn_avr' reached 0.49297 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_125.ckpt' as top 126
Epoch 126, global step 64389: 'val/knn_avr' reached 0.49469 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_126.ckpt' as top 127
Monitored metric val/knn_avr did not improve in the last 100 records. Best score: 0.527. Signaling Trainer to stop.
Epoch 127, global step 64896: 'val/knn_avr' reached 0.48987 (best 0.52735), saving model to '/nas02/homes/imamura23-1000067/outputs/pretrain/runs/2023-11-15/15-31-05/checkpoints/epoch_127.ckpt' as top 128
Error executing job with overrides: ['experiment=pretrain', 'task_name=pretrain']
Traceback (most recent call last):
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/./train.py", line 20, in <module>
    train()
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/source/train.py", line 126, in main
    metric_dict, _ = train(cfg)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/utils/utils.py", line 78, in wrap
    raise ex
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/utils/utils.py", line 68, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/source/train.py", line 102, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 755, in test
    return call._call_and_handle_interrupt(
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 795, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 951, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 92, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/imamura23/nas01home/codes/env/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 179, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/dataset/dataset_datamodule.py", line 55, in setup
    self.testset = [PsdLoader(mode="test", cfg=self.cfg, inst=inst) for inst in self.cfg.inst_list]
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/dataset/dataset_datamodule.py", line 55, in <listcomp>
    self.testset = [PsdLoader(mode="test", cfg=self.cfg, inst=inst) for inst in self.cfg.inst_list]
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/dataset/dataset_zume.py", line 262, in __init__
    ):
  File "/nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/dataset/dataset_zume.py", line 239, in load_lst
    return mix_spec, stems_spec, self.load_embvec(track_id, seg_id), self.load_embvec_stems(track_id, seg_id)
FileNotFoundError: [Errno 2] No such file or directory: './metadata/lst/psds_test_10_drums.lst'
