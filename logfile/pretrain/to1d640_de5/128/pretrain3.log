
=== Using cuda(utils.func). ===


=== Using cuda(utils.logger). ===

[2023-10-29 07:41:10,160][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-10-29 07:41:10,167][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.PreTrainDataModule                                    
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         batch_train: 16                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         normalize128: true                                                    
│         condition32: false                                                    
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: val/knn_avr                                               
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         output_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUN
│                                                                               
├── model
│   └── _target_: model.PreTrain                                                
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.0001                                                            
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640                         
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         batch_train: 16                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         normalize128: true                                                    
│         condition32: false                                                    
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640                           
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: val/knn_avr                                               
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0                                                          
│         recog_rate: 0                                                         
│         output_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUN
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/
│         filename: epoch_{epoch:03d}                                           
│         monitor: val/knn_avr                                                  
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 1                                                         
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: val/knn_avr                                                  
│         min_delta: 0.0                                                        
│         patience: 3                                                           
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWi
│       min_epochs: 1                                                           
│       max_epochs: 100                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/logs/  
│       output_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── pretrain                                                                
├── train
│   └── n_epoch: 100                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       batch_train: 16                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       train_dirname: 3s_on1.5                                                 
│       test_dirname: 3s_on1.5                                                  
│       normalize128: true                                                      
│       condition32: false                                                      
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_train: 3                                                        
│       seconds_test: 3                                                         
│       sr: 44100                                                               
│       mel: false                                                              
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640                             
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 0.001                                                               
│       monitor_es: val/knn_avr                                                 
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0                                                            
│       recog_rate: 0                                                           
│       output_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['dev']                                                                 
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-10-29 07:41:10,242][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.PreTrainDataModule>
[2023-10-29 07:41:10,263][source.train][INFO] - [rank: 0] Instantiating model <model.PreTrain>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-10-29 07:41:14,814][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpyhb48p1r
[2023-10-29 07:41:14,815][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpyhb48p1r/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-10-29 07:41:14,902][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-10-29 07:41:14,902][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-10-29 07:41:14,911][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-10-29 07:41:14,914][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-10-29 07:41:14,915][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-10-29 07:41:14,915][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-10-29 07:41:14,992][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-10-29 07:41:15,360][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-10-29 07:41:15,681][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.05331873893737793 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:07<00:00,  0.27it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:01<00:00,  1.83it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:01<00:00,  1.83it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:01<00:00,  1.83it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:04<00:00,  0.48it/s]knn
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.6681623458862305 sec. =
knn accuracy valid drums     : 71.09375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.40602445602417 sec. =
knn accuracy valid bass      : 34.375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.331179618835449 sec. =
knn accuracy valid piano     : 39.84375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.571601629257202 sec. =
knn accuracy valid guitar    : 50.0%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.5972654819488525 sec. =
knn accuracy valid residuals : 80.46875%

knn accuracy valid average   : 55.15624999999999%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/2027 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/2027 [00:00<?, ?it/s] Epoch 0:   2%|▏         | 50/2027 [01:09<46:06,  0.71it/s]Epoch 0:   2%|▏         | 50/2027 [01:10<46:10,  0.71it/s, v_num=0, train/loss_mix_step=0.00181, train/loss_inst_step=0.00251]Epoch 0:   5%|▍         | 100/2027 [02:08<41:11,  0.78it/s, v_num=0, train/loss_mix_step=0.00181, train/loss_inst_step=0.00251]Epoch 0:   5%|▍         | 100/2027 [02:08<41:13,  0.78it/s, v_num=0, train/loss_mix_step=0.00153, train/loss_inst_step=0.00186]Epoch 0:   7%|▋         | 150/2027 [03:01<37:47,  0.83it/s, v_num=0, train/loss_mix_step=0.00153, train/loss_inst_step=0.00186]Epoch 0:   7%|▋         | 150/2027 [03:01<37:48,  0.83it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.00178]Epoch 0:  10%|▉         | 200/2027 [03:55<35:51,  0.85it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.00178]Epoch 0:  10%|▉         | 200/2027 [03:55<35:51,  0.85it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.00167]Epoch 0:  12%|█▏        | 250/2027 [04:48<34:12,  0.87it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.00167]Epoch 0:  12%|█▏        | 250/2027 [04:48<34:13,  0.87it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.0017] Epoch 0:  15%|█▍        | 300/2027 [05:43<32:54,  0.87it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.0017]Epoch 0:  15%|█▍        | 300/2027 [05:43<32:55,  0.87it/s, v_num=0, train/loss_mix_step=0.00153, train/loss_inst_step=0.00173]Epoch 0:  17%|█▋        | 350/2027 [06:36<31:42,  0.88it/s, v_num=0, train/loss_mix_step=0.00153, train/loss_inst_step=0.00173]Epoch 0:  17%|█▋        | 350/2027 [06:37<31:42,  0.88it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00164]Epoch 0:  20%|█▉        | 400/2027 [07:30<30:32,  0.89it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00164]Epoch 0:  20%|█▉        | 400/2027 [07:30<30:32,  0.89it/s, v_num=0, train/loss_mix_step=0.00144, train/loss_inst_step=0.00159]Epoch 0:  22%|██▏       | 450/2027 [08:26<29:36,  0.89it/s, v_num=0, train/loss_mix_step=0.00144, train/loss_inst_step=0.00159]Epoch 0:  22%|██▏       | 450/2027 [08:26<29:36,  0.89it/s, v_num=0, train/loss_mix_step=0.00149, train/loss_inst_step=0.00165]Epoch 0:  25%|██▍       | 500/2027 [09:31<29:04,  0.88it/s, v_num=0, train/loss_mix_step=0.00149, train/loss_inst_step=0.00165]Epoch 0:  25%|██▍       | 500/2027 [09:31<29:04,  0.88it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00158]Epoch 0:  27%|██▋       | 550/2027 [10:22<27:51,  0.88it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00158]Epoch 0:  27%|██▋       | 550/2027 [10:22<27:51,  0.88it/s, v_num=0, train/loss_mix_step=0.0015, train/loss_inst_step=0.00171] Epoch 0:  30%|██▉       | 600/2027 [11:19<26:56,  0.88it/s, v_num=0, train/loss_mix_step=0.0015, train/loss_inst_step=0.00171]Epoch 0:  30%|██▉       | 600/2027 [11:19<26:57,  0.88it/s, v_num=0, train/loss_mix_step=0.00138, train/loss_inst_step=0.00158]Epoch 0:  32%|███▏      | 650/2027 [12:14<25:56,  0.88it/s, v_num=0, train/loss_mix_step=0.00138, train/loss_inst_step=0.00158]Epoch 0:  32%|███▏      | 650/2027 [12:14<25:56,  0.88it/s, v_num=0, train/loss_mix_step=0.00145, train/loss_inst_step=0.00175]Epoch 0:  35%|███▍      | 700/2027 [13:12<25:01,  0.88it/s, v_num=0, train/loss_mix_step=0.00145, train/loss_inst_step=0.00175]Epoch 0:  35%|███▍      | 700/2027 [13:12<25:01,  0.88it/s, v_num=0, train/loss_mix_step=0.00148, train/loss_inst_step=0.00177]Epoch 0:  37%|███▋      | 750/2027 [14:12<24:12,  0.88it/s, v_num=0, train/loss_mix_step=0.00148, train/loss_inst_step=0.00177]Epoch 0:  37%|███▋      | 750/2027 [14:12<24:12,  0.88it/s, v_num=0, train/loss_mix_step=0.00114, train/loss_inst_step=0.00137]Epoch 0:  39%|███▉      | 800/2027 [15:10<23:16,  0.88it/s, v_num=0, train/loss_mix_step=0.00114, train/loss_inst_step=0.00137]Epoch 0:  39%|███▉      | 800/2027 [15:10<23:17,  0.88it/s, v_num=0, train/loss_mix_step=0.00144, train/loss_inst_step=0.00168]Epoch 0:  42%|████▏     | 850/2027 [16:15<22:31,  0.87it/s, v_num=0, train/loss_mix_step=0.00144, train/loss_inst_step=0.00168]Epoch 0:  42%|████▏     | 850/2027 [16:15<22:31,  0.87it/s, v_num=0, train/loss_mix_step=0.00129, train/loss_inst_step=0.0015] Epoch 0:  44%|████▍     | 900/2027 [17:22<21:45,  0.86it/s, v_num=0, train/loss_mix_step=0.00129, train/loss_inst_step=0.0015]Epoch 0:  44%|████▍     | 900/2027 [17:22<21:45,  0.86it/s, v_num=0, train/loss_mix_step=0.00124, train/loss_inst_step=0.00161]Epoch 0:  47%|████▋     | 950/2027 [18:18<20:45,  0.86it/s, v_num=0, train/loss_mix_step=0.00124, train/loss_inst_step=0.00161]Epoch 0:  47%|████▋     | 950/2027 [18:18<20:45,  0.86it/s, v_num=0, train/loss_mix_step=0.00139, train/loss_inst_step=0.00172]Epoch 0:  49%|████▉     | 1000/2027 [19:13<19:44,  0.87it/s, v_num=0, train/loss_mix_step=0.00139, train/loss_inst_step=0.00172]Epoch 0:  49%|████▉     | 1000/2027 [19:13<19:44,  0.87it/s, v_num=0, train/loss_mix_step=0.00133, train/loss_inst_step=0.00165]Epoch 0:  52%|█████▏    | 1050/2027 [20:09<18:45,  0.87it/s, v_num=0, train/loss_mix_step=0.00133, train/loss_inst_step=0.00165]Epoch 0:  52%|█████▏    | 1050/2027 [20:09<18:45,  0.87it/s, v_num=0, train/loss_mix_step=0.00125, train/loss_inst_step=0.00151]Epoch 0:  54%|█████▍    | 1100/2027 [21:11<17:51,  0.87it/s, v_num=0, train/loss_mix_step=0.00125, train/loss_inst_step=0.00151]Epoch 0:  54%|█████▍    | 1100/2027 [21:11<17:51,  0.87it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.00148]Epoch 0:  57%|█████▋    | 1150/2027 [22:15<16:58,  0.86it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.00148]Epoch 0:  57%|█████▋    | 1150/2027 [22:15<16:58,  0.86it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.0016] Epoch 0:  59%|█████▉    | 1200/2027 [23:06<15:55,  0.87it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.0016]Epoch 0:  59%|█████▉    | 1200/2027 [23:06<15:55,  0.87it/s, v_num=0, train/loss_mix_step=0.0013, train/loss_inst_step=0.00161]Epoch 0:  62%|██████▏   | 1250/2027 [24:12<15:02,  0.86it/s, v_num=0, train/loss_mix_step=0.0013, train/loss_inst_step=0.00161]Epoch 0:  62%|██████▏   | 1250/2027 [24:12<15:02,  0.86it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.0016]Epoch 0:  64%|██████▍   | 1300/2027 [25:09<14:04,  0.86it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.0016]Epoch 0:  64%|██████▍   | 1300/2027 [25:09<14:04,  0.86it/s, v_num=0, train/loss_mix_step=0.00136, train/loss_inst_step=0.00167]Epoch 0:  67%|██████▋   | 1350/2027 [26:05<13:04,  0.86it/s, v_num=0, train/loss_mix_step=0.00136, train/loss_inst_step=0.00167]Epoch 0:  67%|██████▋   | 1350/2027 [26:05<13:04,  0.86it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00167]Epoch 0:  69%|██████▉   | 1400/2027 [27:13<12:11,  0.86it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00167]Epoch 0:  69%|██████▉   | 1400/2027 [27:13<12:11,  0.86it/s, v_num=0, train/loss_mix_step=0.00121, train/loss_inst_step=0.00146]Epoch 0:  72%|███████▏  | 1450/2027 [28:18<11:15,  0.85it/s, v_num=0, train/loss_mix_step=0.00121, train/loss_inst_step=0.00146]Epoch 0:  72%|███████▏  | 1450/2027 [28:18<11:15,  0.85it/s, v_num=0, train/loss_mix_step=0.0012, train/loss_inst_step=0.00158] Epoch 0:  74%|███████▍  | 1500/2027 [29:16<10:17,  0.85it/s, v_num=0, train/loss_mix_step=0.0012, train/loss_inst_step=0.00158]Epoch 0:  74%|███████▍  | 1500/2027 [29:16<10:17,  0.85it/s, v_num=0, train/loss_mix_step=0.00118, train/loss_inst_step=0.00153]Epoch 0:  76%|███████▋  | 1550/2027 [30:36<09:25,  0.84it/s, v_num=0, train/loss_mix_step=0.00118, train/loss_inst_step=0.00153]Epoch 0:  76%|███████▋  | 1550/2027 [30:36<09:25,  0.84it/s, v_num=0, train/loss_mix_step=0.00135, train/loss_inst_step=0.00155]Epoch 0:  79%|███████▉  | 1600/2027 [31:53<08:30,  0.84it/s, v_num=0, train/loss_mix_step=0.00135, train/loss_inst_step=0.00155]Epoch 0:  79%|███████▉  | 1600/2027 [31:53<08:30,  0.84it/s, v_num=0, train/loss_mix_step=0.00112, train/loss_inst_step=0.00151]Epoch 0:  81%|████████▏ | 1650/2027 [32:53<07:30,  0.84it/s, v_num=0, train/loss_mix_step=0.00112, train/loss_inst_step=0.00151]Epoch 0:  81%|████████▏ | 1650/2027 [32:53<07:30,  0.84it/s, v_num=0, train/loss_mix_step=0.00131, train/loss_inst_step=0.00148]Epoch 0:  84%|████████▍ | 1700/2027 [33:58<06:32,  0.83it/s, v_num=0, train/loss_mix_step=0.00131, train/loss_inst_step=0.00148]Epoch 0:  84%|████████▍ | 1700/2027 [33:58<06:32,  0.83it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00152]Epoch 0:  86%|████████▋ | 1750/2027 [35:02<05:32,  0.83it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00152]Epoch 0:  86%|████████▋ | 1750/2027 [35:02<05:32,  0.83it/s, v_num=0, train/loss_mix_step=0.000908, train/loss_inst_step=0.00132]Epoch 0:  89%|████████▉ | 1800/2027 [36:04<04:32,  0.83it/s, v_num=0, train/loss_mix_step=0.000908, train/loss_inst_step=0.00132]Epoch 0:  89%|████████▉ | 1800/2027 [36:04<04:32,  0.83it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00159] Epoch 0:  91%|█████████▏| 1850/2027 [38:10<03:39,  0.81it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00159]Epoch 0:  91%|█████████▏| 1850/2027 [38:11<03:39,  0.81it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00166]Epoch 0:  94%|█████████▎| 1900/2027 [39:22<02:37,  0.80it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00166]Epoch 0:  94%|█████████▎| 1900/2027 [39:22<02:37,  0.80it/s, v_num=0, train/loss_mix_step=0.00125, train/loss_inst_step=0.00151]Epoch 0:  96%|█████████▌| 1950/2027 [40:22<01:35,  0.80it/s, v_num=0, train/loss_mix_step=0.00125, train/loss_inst_step=0.00151]Epoch 0:  96%|█████████▌| 1950/2027 [40:23<01:35,  0.80it/s, v_num=0, train/loss_mix_step=0.00141, train/loss_inst_step=0.00172]Epoch 0:  99%|█████████▊| 2000/2027 [41:13<00:33,  0.81it/s, v_num=0, train/loss_mix_step=0.00141, train/loss_inst_step=0.00172]Epoch 0:  99%|█████████▊| 2000/2027 [41:13<00:33,  0.81it/s, v_num=0, train/loss_mix_step=0.00126, train/loss_inst_step=0.00154]Epoch 0: 100%|██████████| 2027/2027 [41:42<00:00,  0.81it/s, v_num=0, train/loss_mix_step=0.00126, train/loss_inst_step=0.00154]Epoch 0: 100%|██████████| 2027/2027 [41:42<00:00,  0.81it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00155]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 8/8 [00:03<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:04<00:00,  1.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:25<00:00,  0.32it/s][A
Validation DataLoader 2:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 7/7 [00:04<00:00,  1.73it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:24<00:00,  0.29it/s][Aknn
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.744752645492554 sec. =
knn accuracy valid drums     : 58.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.907058715820312 sec. =
knn accuracy valid bass      : 12.701612903225806%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.879165887832642 sec. =
knn accuracy valid piano     : 29.296875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.030304193496704 sec. =
knn accuracy valid guitar    : 49.330357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.375213861465454 sec. =
knn accuracy valid residuals : 70.0%

knn accuracy valid average   : 43.91794292226006%

                                                                      [AEpoch 0: 100%|██████████| 2027/2027 [45:50<00:00,  0.74it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00155, val/knn_avr=0.439]Epoch 0: 100%|██████████| 2027/2027 [45:50<00:00,  0.74it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00155, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]
Train average loss <input mix > : 0.001390502555295825
Train average loss <input inst> : 0.001862474367953837

Epoch 0:   0%|          | 0/2027 [00:00<?, ?it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00155, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]           Epoch 1:   0%|          | 0/2027 [00:00<?, ?it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00155, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:   2%|▏         | 50/2027 [01:08<45:24,  0.73it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00155, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:   2%|▏         | 50/2027 [01:08<45:28,  0.72it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00161, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:   5%|▍         | 100/2027 [01:59<38:17,  0.84it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00161, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:   5%|▍         | 100/2027 [01:59<38:19,  0.84it/s, v_num=0, train/loss_mix_step=0.00124, train/loss_inst_step=0.0017, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186] Epoch 1:   7%|▋         | 150/2027 [02:54<36:25,  0.86it/s, v_num=0, train/loss_mix_step=0.00124, train/loss_inst_step=0.0017, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:   7%|▋         | 150/2027 [02:54<36:27,  0.86it/s, v_num=0, train/loss_mix_step=0.00114, train/loss_inst_step=0.00165, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  10%|▉         | 200/2027 [03:45<34:22,  0.89it/s, v_num=0, train/loss_mix_step=0.00114, train/loss_inst_step=0.00165, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  10%|▉         | 200/2027 [03:45<34:23,  0.89it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.0016, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186] Epoch 1:  12%|█▏        | 250/2027 [04:42<33:27,  0.89it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.0016, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  12%|█▏        | 250/2027 [04:42<33:28,  0.88it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00163, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  15%|█▍        | 300/2027 [05:39<32:33,  0.88it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00163, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  15%|█▍        | 300/2027 [05:39<32:34,  0.88it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00139, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186] Epoch 1:  17%|█▋        | 350/2027 [06:30<31:13,  0.90it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00139, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  17%|█▋        | 350/2027 [06:31<31:13,  0.90it/s, v_num=0, train/loss_mix_step=0.00127, train/loss_inst_step=0.00151, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  20%|█▉        | 400/2027 [07:20<29:52,  0.91it/s, v_num=0, train/loss_mix_step=0.00127, train/loss_inst_step=0.00151, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  20%|█▉        | 400/2027 [07:20<29:53,  0.91it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.0013, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186] Epoch 1:  22%|██▏       | 450/2027 [08:13<28:49,  0.91it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.0013, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  22%|██▏       | 450/2027 [08:13<28:50,  0.91it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  25%|██▍       | 500/2027 [09:04<27:43,  0.92it/s, v_num=0, train/loss_mix_step=0.00122, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  25%|██▍       | 500/2027 [09:04<27:44,  0.92it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00152, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186] Epoch 1:  27%|██▋       | 550/2027 [09:55<26:38,  0.92it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00152, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  27%|██▋       | 550/2027 [09:55<26:39,  0.92it/s, v_num=0, train/loss_mix_step=0.000866, train/loss_inst_step=0.0015, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  30%|██▉       | 600/2027 [10:46<25:38,  0.93it/s, v_num=0, train/loss_mix_step=0.000866, train/loss_inst_step=0.0015, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  30%|██▉       | 600/2027 [10:46<25:38,  0.93it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.00158, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  32%|███▏      | 650/2027 [11:37<24:36,  0.93it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.00158, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  32%|███▏      | 650/2027 [11:37<24:37,  0.93it/s, v_num=0, train/loss_mix_step=0.00117, train/loss_inst_step=0.00145, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  35%|███▍      | 700/2027 [12:27<23:37,  0.94it/s, v_num=0, train/loss_mix_step=0.00117, train/loss_inst_step=0.00145, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  35%|███▍      | 700/2027 [12:27<23:37,  0.94it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00135, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  37%|███▋      | 750/2027 [13:16<22:36,  0.94it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00135, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  37%|███▋      | 750/2027 [13:16<22:36,  0.94it/s, v_num=0, train/loss_mix_step=0.00099, train/loss_inst_step=0.00157, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  39%|███▉      | 800/2027 [14:07<21:39,  0.94it/s, v_num=0, train/loss_mix_step=0.00099, train/loss_inst_step=0.00157, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  39%|███▉      | 800/2027 [14:07<21:39,  0.94it/s, v_num=0, train/loss_mix_step=0.00137, train/loss_inst_step=0.00153, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  42%|████▏     | 850/2027 [14:59<20:44,  0.95it/s, v_num=0, train/loss_mix_step=0.00137, train/loss_inst_step=0.00153, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  42%|████▏     | 850/2027 [14:59<20:44,  0.95it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  44%|████▍     | 900/2027 [15:52<19:52,  0.95it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  44%|████▍     | 900/2027 [15:52<19:52,  0.95it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  47%|████▋     | 950/2027 [16:45<18:59,  0.95it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  47%|████▋     | 950/2027 [16:45<18:59,  0.94it/s, v_num=0, train/loss_mix_step=0.00115, train/loss_inst_step=0.00158, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  49%|████▉     | 1000/2027 [17:38<18:07,  0.94it/s, v_num=0, train/loss_mix_step=0.00115, train/loss_inst_step=0.00158, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  49%|████▉     | 1000/2027 [17:38<18:07,  0.94it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.00147, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  52%|█████▏    | 1050/2027 [18:29<17:12,  0.95it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.00147, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  52%|█████▏    | 1050/2027 [18:29<17:12,  0.95it/s, v_num=0, train/loss_mix_step=0.00114, train/loss_inst_step=0.00135, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  54%|█████▍    | 1100/2027 [19:19<16:17,  0.95it/s, v_num=0, train/loss_mix_step=0.00114, train/loss_inst_step=0.00135, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  54%|█████▍    | 1100/2027 [19:19<16:17,  0.95it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00131, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  57%|█████▋    | 1150/2027 [20:17<15:28,  0.94it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00131, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  57%|█████▋    | 1150/2027 [20:17<15:28,  0.94it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00152, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  59%|█████▉    | 1200/2027 [21:35<14:52,  0.93it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00152, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  59%|█████▉    | 1200/2027 [21:35<14:52,  0.93it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00139, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  62%|██████▏   | 1250/2027 [22:25<13:56,  0.93it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00139, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  62%|██████▏   | 1250/2027 [22:25<13:56,  0.93it/s, v_num=0, train/loss_mix_step=0.00117, train/loss_inst_step=0.00137, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  64%|██████▍   | 1300/2027 [23:25<13:06,  0.92it/s, v_num=0, train/loss_mix_step=0.00117, train/loss_inst_step=0.00137, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  64%|██████▍   | 1300/2027 [23:25<13:06,  0.92it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.00154, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  67%|██████▋   | 1350/2027 [24:20<12:12,  0.92it/s, v_num=0, train/loss_mix_step=0.00128, train/loss_inst_step=0.00154, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  67%|██████▋   | 1350/2027 [24:20<12:12,  0.92it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.0014, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186] Epoch 1:  69%|██████▉   | 1400/2027 [25:14<11:18,  0.92it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.0014, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  69%|██████▉   | 1400/2027 [25:14<11:18,  0.92it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00158, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  72%|███████▏  | 1450/2027 [26:19<10:28,  0.92it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00158, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  72%|███████▏  | 1450/2027 [26:19<10:28,  0.92it/s, v_num=0, train/loss_mix_step=0.00125, train/loss_inst_step=0.00157, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  74%|███████▍  | 1500/2027 [27:17<09:35,  0.92it/s, v_num=0, train/loss_mix_step=0.00125, train/loss_inst_step=0.00157, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  74%|███████▍  | 1500/2027 [27:18<09:35,  0.92it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00133, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  76%|███████▋  | 1550/2027 [28:43<08:50,  0.90it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00133, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  76%|███████▋  | 1550/2027 [28:43<08:50,  0.90it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00157, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  79%|███████▉  | 1600/2027 [29:48<07:57,  0.89it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00157, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  79%|███████▉  | 1600/2027 [29:48<07:57,  0.89it/s, v_num=0, train/loss_mix_step=0.00134, train/loss_inst_step=0.00167, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  81%|████████▏ | 1650/2027 [30:47<07:02,  0.89it/s, v_num=0, train/loss_mix_step=0.00134, train/loss_inst_step=0.00167, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  81%|████████▏ | 1650/2027 [30:47<07:02,  0.89it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00137, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  84%|████████▍ | 1700/2027 [31:40<06:05,  0.89it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00137, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  84%|████████▍ | 1700/2027 [31:40<06:05,  0.89it/s, v_num=0, train/loss_mix_step=0.000868, train/loss_inst_step=0.00127, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  86%|████████▋ | 1750/2027 [32:46<05:11,  0.89it/s, v_num=0, train/loss_mix_step=0.000868, train/loss_inst_step=0.00127, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  86%|████████▋ | 1750/2027 [32:46<05:11,  0.89it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186] Epoch 1:  89%|████████▉ | 1800/2027 [33:44<04:15,  0.89it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00149, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  89%|████████▉ | 1800/2027 [33:44<04:15,  0.89it/s, v_num=0, train/loss_mix_step=0.00116, train/loss_inst_step=0.00145, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  91%|█████████▏| 1850/2027 [34:36<03:18,  0.89it/s, v_num=0, train/loss_mix_step=0.00116, train/loss_inst_step=0.00145, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  91%|█████████▏| 1850/2027 [34:36<03:18,  0.89it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00127, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  94%|█████████▎| 1900/2027 [35:26<02:22,  0.89it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00127, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  94%|█████████▎| 1900/2027 [35:26<02:22,  0.89it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00141, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  96%|█████████▌| 1950/2027 [36:24<01:26,  0.89it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00141, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  96%|█████████▌| 1950/2027 [36:24<01:26,  0.89it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00142, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  99%|█████████▊| 2000/2027 [37:31<00:30,  0.89it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00142, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1:  99%|█████████▊| 2000/2027 [37:31<00:30,  0.89it/s, v_num=0, train/loss_mix_step=0.00121, train/loss_inst_step=0.00142, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1: 100%|██████████| 2027/2027 [37:57<00:00,  0.89it/s, v_num=0, train/loss_mix_step=0.00121, train/loss_inst_step=0.00142, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1: 100%|██████████| 2027/2027 [37:57<00:00,  0.89it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00153, val/knn_avr=0.439, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 8/8 [00:04<00:00,  1.63it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:04<00:00,  1.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:04<00:00,  1.86it/s][A
Validation DataLoader 2:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 7/7 [00:03<00:00,  1.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s][Aknn
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.226213455200195 sec. =
knn accuracy valid drums     : 51.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.32339859008789 sec. =
knn accuracy valid bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.513412714004517 sec. =
knn accuracy valid piano     : 30.859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.990446090698242 sec. =
knn accuracy valid guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.604358196258545 sec. =
knn accuracy valid residuals : 66.5909090909091%

knn accuracy valid average   : 42.73850402315076%

                                                                      [AEpoch 1: 100%|██████████| 2027/2027 [40:34<00:00,  0.83it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00153, val/knn_avr=0.427, train/loss_mix_epoch=0.00139, train/loss_inst_epoch=0.00186]Epoch 1: 100%|██████████| 2027/2027 [40:34<00:00,  0.83it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00153, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]
Train average loss <input mix > : 0.001108043477870524
Train average loss <input inst> : 0.0014727346133440733

Epoch 1:   0%|          | 0/2027 [00:00<?, ?it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00153, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]           Epoch 2:   0%|          | 0/2027 [00:00<?, ?it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00153, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:   2%|▏         | 50/2027 [00:54<35:51,  0.92it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00153, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:   2%|▏         | 50/2027 [00:54<35:55,  0.92it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:   5%|▍         | 100/2027 [01:46<34:11,  0.94it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:   5%|▍         | 100/2027 [01:46<34:13,  0.94it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00134, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:   7%|▋         | 150/2027 [02:39<33:14,  0.94it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00134, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:   7%|▋         | 150/2027 [02:39<33:15,  0.94it/s, v_num=0, train/loss_mix_step=0.00112, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  10%|▉         | 200/2027 [03:30<32:01,  0.95it/s, v_num=0, train/loss_mix_step=0.00112, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  10%|▉         | 200/2027 [03:30<32:02,  0.95it/s, v_num=0, train/loss_mix_step=0.00097, train/loss_inst_step=0.00137, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  12%|█▏        | 250/2027 [04:23<31:13,  0.95it/s, v_num=0, train/loss_mix_step=0.00097, train/loss_inst_step=0.00137, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  12%|█▏        | 250/2027 [04:23<31:14,  0.95it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00146, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  15%|█▍        | 300/2027 [05:13<30:02,  0.96it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00146, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  15%|█▍        | 300/2027 [05:13<30:03,  0.96it/s, v_num=0, train/loss_mix_step=0.000987, train/loss_inst_step=0.0014, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  17%|█▋        | 350/2027 [06:04<29:05,  0.96it/s, v_num=0, train/loss_mix_step=0.000987, train/loss_inst_step=0.0014, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  17%|█▋        | 350/2027 [06:04<29:06,  0.96it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00137, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  20%|█▉        | 400/2027 [06:59<28:27,  0.95it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00137, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  20%|█▉        | 400/2027 [06:59<28:27,  0.95it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00168, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  22%|██▏       | 450/2027 [07:49<27:26,  0.96it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00168, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  22%|██▏       | 450/2027 [07:50<27:27,  0.96it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00155, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  25%|██▍       | 500/2027 [08:41<26:32,  0.96it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00155, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  25%|██▍       | 500/2027 [08:41<26:33,  0.96it/s, v_num=0, train/loss_mix_step=0.000977, train/loss_inst_step=0.00156, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  27%|██▋       | 550/2027 [09:30<25:32,  0.96it/s, v_num=0, train/loss_mix_step=0.000977, train/loss_inst_step=0.00156, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  27%|██▋       | 550/2027 [09:30<25:32,  0.96it/s, v_num=0, train/loss_mix_step=0.00094, train/loss_inst_step=0.00138, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  30%|██▉       | 600/2027 [10:22<24:39,  0.96it/s, v_num=0, train/loss_mix_step=0.00094, train/loss_inst_step=0.00138, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  30%|██▉       | 600/2027 [10:22<24:39,  0.96it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00156, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  32%|███▏      | 650/2027 [11:13<23:45,  0.97it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00156, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  32%|███▏      | 650/2027 [11:13<23:46,  0.97it/s, v_num=0, train/loss_mix_step=0.00126, train/loss_inst_step=0.00157, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  35%|███▍      | 700/2027 [12:04<22:53,  0.97it/s, v_num=0, train/loss_mix_step=0.00126, train/loss_inst_step=0.00157, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  35%|███▍      | 700/2027 [12:04<22:53,  0.97it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00139, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  37%|███▋      | 750/2027 [13:01<22:10,  0.96it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00139, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  37%|███▋      | 750/2027 [13:01<22:10,  0.96it/s, v_num=0, train/loss_mix_step=0.000983, train/loss_inst_step=0.00132, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  39%|███▉      | 800/2027 [13:51<21:15,  0.96it/s, v_num=0, train/loss_mix_step=0.000983, train/loss_inst_step=0.00132, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  39%|███▉      | 800/2027 [13:51<21:15,  0.96it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00147, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  42%|████▏     | 850/2027 [14:42<20:21,  0.96it/s, v_num=0, train/loss_mix_step=0.00109, train/loss_inst_step=0.00147, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  42%|████▏     | 850/2027 [14:42<20:22,  0.96it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00148, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  44%|████▍     | 900/2027 [15:33<19:28,  0.96it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00148, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  44%|████▍     | 900/2027 [15:33<19:29,  0.96it/s, v_num=0, train/loss_mix_step=0.00115, train/loss_inst_step=0.00142, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  47%|████▋     | 950/2027 [16:23<18:34,  0.97it/s, v_num=0, train/loss_mix_step=0.00115, train/loss_inst_step=0.00142, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  47%|████▋     | 950/2027 [16:23<18:34,  0.97it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00138, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  49%|████▉     | 1000/2027 [17:12<17:40,  0.97it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00138, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  49%|████▉     | 1000/2027 [17:12<17:40,  0.97it/s, v_num=0, train/loss_mix_step=0.00136, train/loss_inst_step=0.00148, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  52%|█████▏    | 1050/2027 [18:03<16:47,  0.97it/s, v_num=0, train/loss_mix_step=0.00136, train/loss_inst_step=0.00148, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  52%|█████▏    | 1050/2027 [18:03<16:47,  0.97it/s, v_num=0, train/loss_mix_step=0.000926, train/loss_inst_step=0.00146, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  54%|█████▍    | 1100/2027 [18:54<15:56,  0.97it/s, v_num=0, train/loss_mix_step=0.000926, train/loss_inst_step=0.00146, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  54%|█████▍    | 1100/2027 [18:54<15:56,  0.97it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00135, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  57%|█████▋    | 1150/2027 [19:46<15:04,  0.97it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00135, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  57%|█████▋    | 1150/2027 [19:46<15:04,  0.97it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00143, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  59%|█████▉    | 1200/2027 [20:42<14:15,  0.97it/s, v_num=0, train/loss_mix_step=0.00111, train/loss_inst_step=0.00143, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  59%|█████▉    | 1200/2027 [20:42<14:16,  0.97it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00125, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  62%|██████▏   | 1250/2027 [21:34<13:24,  0.97it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00125, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  62%|██████▏   | 1250/2027 [21:34<13:24,  0.97it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00142, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  64%|██████▍   | 1300/2027 [22:31<12:35,  0.96it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00142, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  64%|██████▍   | 1300/2027 [22:31<12:35,  0.96it/s, v_num=0, train/loss_mix_step=0.00127, train/loss_inst_step=0.00154, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  67%|██████▋   | 1350/2027 [23:25<11:44,  0.96it/s, v_num=0, train/loss_mix_step=0.00127, train/loss_inst_step=0.00154, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  67%|██████▋   | 1350/2027 [23:25<11:44,  0.96it/s, v_num=0, train/loss_mix_step=0.000783, train/loss_inst_step=0.0013, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  69%|██████▉   | 1400/2027 [24:25<10:56,  0.96it/s, v_num=0, train/loss_mix_step=0.000783, train/loss_inst_step=0.0013, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  69%|██████▉   | 1400/2027 [24:25<10:56,  0.96it/s, v_num=0, train/loss_mix_step=0.000993, train/loss_inst_step=0.00139, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  72%|███████▏  | 1450/2027 [25:17<10:04,  0.96it/s, v_num=0, train/loss_mix_step=0.000993, train/loss_inst_step=0.00139, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  72%|███████▏  | 1450/2027 [25:17<10:04,  0.96it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00126, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  74%|███████▍  | 1500/2027 [26:12<09:12,  0.95it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00126, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  74%|███████▍  | 1500/2027 [26:13<09:12,  0.95it/s, v_num=0, train/loss_mix_step=0.000807, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  76%|███████▋  | 1550/2027 [27:17<08:23,  0.95it/s, v_num=0, train/loss_mix_step=0.000807, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  76%|███████▋  | 1550/2027 [27:17<08:23,  0.95it/s, v_num=0, train/loss_mix_step=0.00104, train/loss_inst_step=0.00136, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  79%|███████▉  | 1600/2027 [28:11<07:31,  0.95it/s, v_num=0, train/loss_mix_step=0.00104, train/loss_inst_step=0.00136, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  79%|███████▉  | 1600/2027 [28:11<07:31,  0.95it/s, v_num=0, train/loss_mix_step=0.001, train/loss_inst_step=0.00118, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]  Epoch 2:  81%|████████▏ | 1650/2027 [29:09<06:39,  0.94it/s, v_num=0, train/loss_mix_step=0.001, train/loss_inst_step=0.00118, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  81%|████████▏ | 1650/2027 [29:09<06:39,  0.94it/s, v_num=0, train/loss_mix_step=0.000852, train/loss_inst_step=0.00128, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  84%|████████▍ | 1700/2027 [30:05<05:47,  0.94it/s, v_num=0, train/loss_mix_step=0.000852, train/loss_inst_step=0.00128, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  84%|████████▍ | 1700/2027 [30:05<05:47,  0.94it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00134, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  86%|████████▋ | 1750/2027 [31:35<04:59,  0.92it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00134, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  86%|████████▋ | 1750/2027 [31:35<04:59,  0.92it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00151, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  89%|████████▉ | 1800/2027 [32:52<04:08,  0.91it/s, v_num=0, train/loss_mix_step=0.0011, train/loss_inst_step=0.00151, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  89%|████████▉ | 1800/2027 [32:52<04:08,  0.91it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00143, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  91%|█████████▏| 1850/2027 [33:43<03:13,  0.91it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00143, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  91%|█████████▏| 1850/2027 [33:43<03:13,  0.91it/s, v_num=0, train/loss_mix_step=0.000914, train/loss_inst_step=0.00136, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  94%|█████████▎| 1900/2027 [34:48<02:19,  0.91it/s, v_num=0, train/loss_mix_step=0.000914, train/loss_inst_step=0.00136, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  94%|█████████▎| 1900/2027 [34:48<02:19,  0.91it/s, v_num=0, train/loss_mix_step=0.00118, train/loss_inst_step=0.00141, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] Epoch 2:  96%|█████████▌| 1950/2027 [35:46<01:24,  0.91it/s, v_num=0, train/loss_mix_step=0.00118, train/loss_inst_step=0.00141, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  96%|█████████▌| 1950/2027 [35:47<01:24,  0.91it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  99%|█████████▊| 2000/2027 [37:10<00:30,  0.90it/s, v_num=0, train/loss_mix_step=0.00113, train/loss_inst_step=0.00152, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2:  99%|█████████▊| 2000/2027 [37:10<00:30,  0.90it/s, v_num=0, train/loss_mix_step=0.000966, train/loss_inst_step=0.00127, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2: 100%|██████████| 2027/2027 [37:39<00:00,  0.90it/s, v_num=0, train/loss_mix_step=0.000966, train/loss_inst_step=0.00127, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2: 100%|██████████| 2027/2027 [37:39<00:00,  0.90it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00154, val/knn_avr=0.427, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 8/8 [00:16<00:00,  0.48it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:04<00:00,  1.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:04<00:00,  1.87it/s][A
Validation DataLoader 2:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 7/7 [00:04<00:00,  1.56it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:03<00:00,  1.89it/s][Aknn
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.511631727218628 sec. =
knn accuracy valid drums     : 61.95652173913043%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.693756341934204 sec. =
knn accuracy valid bass      : 14.516129032258066%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.888449907302856 sec. =
knn accuracy valid piano     : 30.859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.88405966758728 sec. =
knn accuracy valid guitar    : 47.767857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.342773199081421 sec. =
knn accuracy valid residuals : 60.909090909090914%

knn accuracy valid average   : 43.201794764667305%

                                                                      [AEpoch 2: 100%|██████████| 2027/2027 [40:32<00:00,  0.83it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00154, val/knn_avr=0.432, train/loss_mix_epoch=0.00111, train/loss_inst_epoch=0.00147]Epoch 2: 100%|██████████| 2027/2027 [40:32<00:00,  0.83it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00154, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]
Train average loss <input mix > : 0.0010690566850826144
Train average loss <input inst> : 0.0014200086006894708

Epoch 2:   0%|          | 0/2027 [00:00<?, ?it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00154, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]           Epoch 3:   0%|          | 0/2027 [00:00<?, ?it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00154, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:   2%|▏         | 50/2027 [01:03<41:53,  0.79it/s, v_num=0, train/loss_mix_step=0.00132, train/loss_inst_step=0.00154, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:   2%|▏         | 50/2027 [01:03<41:57,  0.79it/s, v_num=0, train/loss_mix_step=0.000972, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:   5%|▍         | 100/2027 [01:54<36:55,  0.87it/s, v_num=0, train/loss_mix_step=0.000972, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:   5%|▍         | 100/2027 [01:55<36:57,  0.87it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00121, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142] Epoch 3:   7%|▋         | 150/2027 [02:46<34:45,  0.90it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00121, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:   7%|▋         | 150/2027 [02:46<34:46,  0.90it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00142, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  10%|▉         | 200/2027 [03:39<33:23,  0.91it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00142, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  10%|▉         | 200/2027 [03:39<33:24,  0.91it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00141, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  12%|█▏        | 250/2027 [04:28<31:48,  0.93it/s, v_num=0, train/loss_mix_step=0.00102, train/loss_inst_step=0.00141, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  12%|█▏        | 250/2027 [04:28<31:49,  0.93it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00131, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  15%|█▍        | 300/2027 [05:18<30:32,  0.94it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00131, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  15%|█▍        | 300/2027 [05:18<30:32,  0.94it/s, v_num=0, train/loss_mix_step=0.000923, train/loss_inst_step=0.00146, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  17%|█▋        | 350/2027 [06:07<29:21,  0.95it/s, v_num=0, train/loss_mix_step=0.000923, train/loss_inst_step=0.00146, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  17%|█▋        | 350/2027 [06:07<29:22,  0.95it/s, v_num=0, train/loss_mix_step=0.000995, train/loss_inst_step=0.00147, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  20%|█▉        | 400/2027 [06:57<28:16,  0.96it/s, v_num=0, train/loss_mix_step=0.000995, train/loss_inst_step=0.00147, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  20%|█▉        | 400/2027 [06:57<28:16,  0.96it/s, v_num=0, train/loss_mix_step=0.00118, train/loss_inst_step=0.00159, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142] Epoch 3:  22%|██▏       | 450/2027 [07:47<27:19,  0.96it/s, v_num=0, train/loss_mix_step=0.00118, train/loss_inst_step=0.00159, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  22%|██▏       | 450/2027 [07:48<27:20,  0.96it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00144, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  25%|██▍       | 500/2027 [08:40<26:28,  0.96it/s, v_num=0, train/loss_mix_step=0.00106, train/loss_inst_step=0.00144, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  25%|██▍       | 500/2027 [08:40<26:28,  0.96it/s, v_num=0, train/loss_mix_step=0.00116, train/loss_inst_step=0.00145, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  27%|██▋       | 550/2027 [09:32<25:36,  0.96it/s, v_num=0, train/loss_mix_step=0.00116, train/loss_inst_step=0.00145, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  27%|██▋       | 550/2027 [09:32<25:36,  0.96it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  30%|██▉       | 600/2027 [10:22<24:40,  0.96it/s, v_num=0, train/loss_mix_step=0.00103, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  30%|██▉       | 600/2027 [10:22<24:40,  0.96it/s, v_num=0, train/loss_mix_step=0.000933, train/loss_inst_step=0.00142, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  32%|███▏      | 650/2027 [11:11<23:42,  0.97it/s, v_num=0, train/loss_mix_step=0.000933, train/loss_inst_step=0.00142, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  32%|███▏      | 650/2027 [11:11<23:42,  0.97it/s, v_num=0, train/loss_mix_step=0.000755, train/loss_inst_step=0.00119, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  35%|███▍      | 700/2027 [12:00<22:45,  0.97it/s, v_num=0, train/loss_mix_step=0.000755, train/loss_inst_step=0.00119, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  35%|███▍      | 700/2027 [12:00<22:46,  0.97it/s, v_num=0, train/loss_mix_step=0.00119, train/loss_inst_step=0.00149, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142] Epoch 3:  37%|███▋      | 750/2027 [12:54<21:59,  0.97it/s, v_num=0, train/loss_mix_step=0.00119, train/loss_inst_step=0.00149, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  37%|███▋      | 750/2027 [12:54<21:59,  0.97it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00165, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  39%|███▉      | 800/2027 [13:53<21:17,  0.96it/s, v_num=0, train/loss_mix_step=0.00105, train/loss_inst_step=0.00165, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  39%|███▉      | 800/2027 [13:53<21:18,  0.96it/s, v_num=0, train/loss_mix_step=0.000881, train/loss_inst_step=0.0013, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  42%|████▏     | 850/2027 [14:42<20:21,  0.96it/s, v_num=0, train/loss_mix_step=0.000881, train/loss_inst_step=0.0013, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  42%|████▏     | 850/2027 [14:42<20:21,  0.96it/s, v_num=0, train/loss_mix_step=0.000921, train/loss_inst_step=0.00141, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  44%|████▍     | 900/2027 [15:34<19:29,  0.96it/s, v_num=0, train/loss_mix_step=0.000921, train/loss_inst_step=0.00141, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  44%|████▍     | 900/2027 [15:34<19:30,  0.96it/s, v_num=0, train/loss_mix_step=0.000934, train/loss_inst_step=0.00147, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  47%|████▋     | 950/2027 [16:25<18:36,  0.96it/s, v_num=0, train/loss_mix_step=0.000934, train/loss_inst_step=0.00147, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  47%|████▋     | 950/2027 [16:25<18:37,  0.96it/s, v_num=0, train/loss_mix_step=0.0012, train/loss_inst_step=0.0015, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]   Epoch 3:  49%|████▉     | 1000/2027 [17:14<17:42,  0.97it/s, v_num=0, train/loss_mix_step=0.0012, train/loss_inst_step=0.0015, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  49%|████▉     | 1000/2027 [17:14<17:42,  0.97it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00145, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  52%|█████▏    | 1050/2027 [18:03<16:48,  0.97it/s, v_num=0, train/loss_mix_step=0.00107, train/loss_inst_step=0.00145, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  52%|█████▏    | 1050/2027 [18:03<16:48,  0.97it/s, v_num=0, train/loss_mix_step=0.000885, train/loss_inst_step=0.0012, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  54%|█████▍    | 1100/2027 [18:54<15:55,  0.97it/s, v_num=0, train/loss_mix_step=0.000885, train/loss_inst_step=0.0012, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  54%|█████▍    | 1100/2027 [18:54<15:55,  0.97it/s, v_num=0, train/loss_mix_step=0.00119, train/loss_inst_step=0.00133, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  57%|█████▋    | 1150/2027 [19:46<15:04,  0.97it/s, v_num=0, train/loss_mix_step=0.00119, train/loss_inst_step=0.00133, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  57%|█████▋    | 1150/2027 [19:46<15:04,  0.97it/s, v_num=0, train/loss_mix_step=0.00126, train/loss_inst_step=0.00149, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  59%|█████▉    | 1200/2027 [20:39<14:13,  0.97it/s, v_num=0, train/loss_mix_step=0.00126, train/loss_inst_step=0.00149, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  59%|█████▉    | 1200/2027 [20:39<14:14,  0.97it/s, v_num=0, train/loss_mix_step=0.00117, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  62%|██████▏   | 1250/2027 [21:33<13:24,  0.97it/s, v_num=0, train/loss_mix_step=0.00117, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  62%|██████▏   | 1250/2027 [21:33<13:24,  0.97it/s, v_num=0, train/loss_mix_step=0.0012, train/loss_inst_step=0.00141, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142] Epoch 3:  64%|██████▍   | 1300/2027 [22:25<12:32,  0.97it/s, v_num=0, train/loss_mix_step=0.0012, train/loss_inst_step=0.00141, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  64%|██████▍   | 1300/2027 [22:25<12:32,  0.97it/s, v_num=0, train/loss_mix_step=0.00116, train/loss_inst_step=0.00135, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  67%|██████▋   | 1350/2027 [23:16<11:40,  0.97it/s, v_num=0, train/loss_mix_step=0.00116, train/loss_inst_step=0.00135, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  67%|██████▋   | 1350/2027 [23:16<11:40,  0.97it/s, v_num=0, train/loss_mix_step=0.000981, train/loss_inst_step=0.00146, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  69%|██████▉   | 1400/2027 [24:06<10:47,  0.97it/s, v_num=0, train/loss_mix_step=0.000981, train/loss_inst_step=0.00146, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  69%|██████▉   | 1400/2027 [24:06<10:47,  0.97it/s, v_num=0, train/loss_mix_step=0.00104, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142] Epoch 3:  72%|███████▏  | 1450/2027 [24:56<09:55,  0.97it/s, v_num=0, train/loss_mix_step=0.00104, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  72%|███████▏  | 1450/2027 [24:56<09:55,  0.97it/s, v_num=0, train/loss_mix_step=0.000944, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  74%|███████▍  | 1500/2027 [25:47<09:03,  0.97it/s, v_num=0, train/loss_mix_step=0.000944, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  74%|███████▍  | 1500/2027 [25:47<09:03,  0.97it/s, v_num=0, train/loss_mix_step=0.000963, train/loss_inst_step=0.00139, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  76%|███████▋  | 1550/2027 [26:39<08:12,  0.97it/s, v_num=0, train/loss_mix_step=0.000963, train/loss_inst_step=0.00139, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  76%|███████▋  | 1550/2027 [26:39<08:12,  0.97it/s, v_num=0, train/loss_mix_step=0.00115, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142] Epoch 3:  79%|███████▉  | 1600/2027 [27:30<07:20,  0.97it/s, v_num=0, train/loss_mix_step=0.00115, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  79%|███████▉  | 1600/2027 [27:30<07:20,  0.97it/s, v_num=0, train/loss_mix_step=0.00098, train/loss_inst_step=0.00132, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  81%|████████▏ | 1650/2027 [28:19<06:28,  0.97it/s, v_num=0, train/loss_mix_step=0.00098, train/loss_inst_step=0.00132, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  81%|████████▏ | 1650/2027 [28:19<06:28,  0.97it/s, v_num=0, train/loss_mix_step=0.000921, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  84%|████████▍ | 1700/2027 [29:11<05:36,  0.97it/s, v_num=0, train/loss_mix_step=0.000921, train/loss_inst_step=0.00138, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  84%|████████▍ | 1700/2027 [29:11<05:37,  0.97it/s, v_num=0, train/loss_mix_step=0.000964, train/loss_inst_step=0.00139, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  86%|████████▋ | 1750/2027 [30:01<04:45,  0.97it/s, v_num=0, train/loss_mix_step=0.000964, train/loss_inst_step=0.00139, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  86%|████████▋ | 1750/2027 [30:01<04:45,  0.97it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142] Epoch 3:  89%|████████▉ | 1800/2027 [30:52<03:53,  0.97it/s, v_num=0, train/loss_mix_step=0.00101, train/loss_inst_step=0.00137, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  89%|████████▉ | 1800/2027 [30:52<03:53,  0.97it/s, v_num=0, train/loss_mix_step=0.00092, train/loss_inst_step=0.00145, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  91%|█████████▏| 1850/2027 [31:44<03:02,  0.97it/s, v_num=0, train/loss_mix_step=0.00092, train/loss_inst_step=0.00145, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  91%|█████████▏| 1850/2027 [31:44<03:02,  0.97it/s, v_num=0, train/loss_mix_step=0.00177, train/loss_inst_step=0.00292, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  94%|█████████▎| 1900/2027 [32:36<02:10,  0.97it/s, v_num=0, train/loss_mix_step=0.00177, train/loss_inst_step=0.00292, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  94%|█████████▎| 1900/2027 [32:36<02:10,  0.97it/s, v_num=0, train/loss_mix_step=0.00284, train/loss_inst_step=0.00643, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  96%|█████████▌| 1950/2027 [33:29<01:19,  0.97it/s, v_num=0, train/loss_mix_step=0.00284, train/loss_inst_step=0.00643, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  96%|█████████▌| 1950/2027 [33:29<01:19,  0.97it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.00164, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  99%|█████████▊| 2000/2027 [34:23<00:27,  0.97it/s, v_num=0, train/loss_mix_step=0.00152, train/loss_inst_step=0.00164, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3:  99%|█████████▊| 2000/2027 [34:23<00:27,  0.97it/s, v_num=0, train/loss_mix_step=0.00144, train/loss_inst_step=0.00157, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3: 100%|██████████| 2027/2027 [34:50<00:00,  0.97it/s, v_num=0, train/loss_mix_step=0.00144, train/loss_inst_step=0.00157, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3: 100%|██████████| 2027/2027 [34:50<00:00,  0.97it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00156, val/knn_avr=0.432, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 8/8 [00:03<00:00,  2.07it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:04<00:00,  1.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:04<00:00,  1.86it/s][A
Validation DataLoader 2:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 7/7 [00:03<00:00,  1.83it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:06<00:00,  1.10it/s][Aknn
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.622334241867065 sec. =
knn accuracy valid drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.747401237487793 sec. =
knn accuracy valid bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.046956300735474 sec. =
knn accuracy valid piano     : 23.2421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.342975854873657 sec. =
knn accuracy valid guitar    : 33.482142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.566537380218506 sec. =
knn accuracy valid residuals : 54.54545454545454%

knn accuracy valid average   : 39.41103972946759%

                                                                      [AEpoch 3: 100%|██████████| 2027/2027 [37:24<00:00,  0.90it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00156, val/knn_avr=0.394, train/loss_mix_epoch=0.00107, train/loss_inst_epoch=0.00142]Epoch 3: 100%|██████████| 2027/2027 [37:24<00:00,  0.90it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00156, val/knn_avr=0.394, train/loss_mix_epoch=0.00151, train/loss_inst_epoch=0.00261]
Train average loss <input mix > : 0.0015099381562322378
Train average loss <input inst> : 0.0026068929582834244

Epoch 3: 100%|██████████| 2027/2027 [37:24<00:00,  0.90it/s, v_num=0, train/loss_mix_step=0.00142, train/loss_inst_step=0.00156, val/knn_avr=0.394, train/loss_mix_epoch=0.00151, train/loss_inst_epoch=0.00261]
[2023-10-29 10:27:09,856][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 0: 100%|██████████| 15/15 [00:18<00:00,  0.82it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:12<00:00,  1.20it/s]Testing DataLoader 1:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 13/13 [00:10<00:00,  1.21it/s]Testing DataLoader 2:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 14/14 [00:10<00:00,  1.35it/s]Testing DataLoader 3:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 15/15 [00:11<00:00,  1.32it/s]= T-SNE...
T-SNE was finished!
= T-SNE time is 22.566683292388916 sec. =
knn accuracy test drums     : 53.38427947598253%
= T-SNE...
T-SNE was finished!
= T-SNE time is 22.4542338848114 sec. =
knn accuracy test bass      : 16.832779623477297%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.311009168624878 sec. =
knn accuracy test piano     : 28.588807785888076%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.750545024871826 sec. =
knn accuracy test guitar    : 21.040723981900452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.929283142089844 sec. =
knn accuracy test residuals : 49.40796555435953%

knn accuracy test average   : 33.850911284321576%
Testing DataLoader 4: 100%|██████████| 15/15 [02:22<00:00,  0.11it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   test/knn_avr    │ 0.33850911259651… │ 0.33850911259651… │ 0.3385091125965… │
│   test/knn_bass   │ 0.16832779347896… │ 0.16832779347896… │ 0.1683277934789… │
│  test/knn_drums   │ 0.53384280204772… │ 0.53384280204772… │ 0.5338428020477… │
│  test/knn_guitar  │ 0.21040724217891… │ 0.21040724217891… │ 0.2104072421789… │
│  test/knn_piano   │ 0.28588807582855… │ 0.28588807582855… │ 0.2858880758285… │
│ test/knn_residua… │ 0.49407964944839… │ 0.49407964944839… │ 0.4940796494483… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃       Test metric       ┃      DataLoader 3       ┃       DataLoader 4       ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│      test/knn_avr       │   0.33850911259651184   │   0.33850911259651184    │
│      test/knn_bass      │   0.16832779347896576   │   0.16832779347896576    │
│     test/knn_drums      │   0.5338428020477295    │    0.5338428020477295    │
│     test/knn_guitar     │   0.21040724217891693   │   0.21040724217891693    │
│     test/knn_piano      │   0.28588807582855225   │   0.28588807582855225    │
│   test/knn_residuals    │   0.4940796494483948    │    0.4940796494483948    │
└─────────────────────────┴─────────────────────────┴──────────────────────────┘
[2023-10-29 10:31:32,223][source.train][INFO] - [rank: 0] Best ckpt path: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/outputs/2023-10-29/07-41-10/checkpoints/epoch_000.ckpt
[2023-10-29 10:31:32,224][utils.utils][INFO] - [rank: 0] Output dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet/outputs/2023-10-29/07-41-10
[2023-10-29 10:31:32,226][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 02:50:22

All prosess was Done!
